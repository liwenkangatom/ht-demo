!function(U,_,k){"use strict";var y="px",b="0",s="innerHTML",j="className",W=ht.Default,t=ht.Color,K=ht.Node,r="position",T="top",O="left",x=W.animate,C=W.getInternal(),m="width",b="0",H="none",L="max-height",E="font",I="background",q="border-box",w="user-select",i="box-sizing",l="overflow",G=W.isTouchable,C=W.getInternal(),u=t.titleIconBackground,J=W.scrollBarInteractiveSize,e=/msie 9/.test(U.navigator?U.navigator.userAgent.toLowerCase():""),o=null,d=function(){return document},X=function(l){return d().createElement(l)},v=function(){return X("div")},V=function(){var q=v(),P=q.style;return P.msTouchAction=H,P.cursor="default",G&&P.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",o),P.position="absolute",P.left=b,P.top=b,q},S=function(){return X("canvas")},$=function(){return document.body},M=function(O,_,F){O.style.setProperty(_,F,o)},Z=function(H,E){H.style.removeProperty(E)},f=function(p,v,E){W.def(ht.widget[p],v,E)},N=function(f,w){f.appendChild(w)},Q=function(R,q){R.removeChild(q)},P=W.eventListenerOptionsFalse,A=(W.eventListenerOptionsTrue,function(i,D,k,B){i.addEventListener(D,k,B?P:P)});C.addMethod(W,{paletteExpandIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:u,rotation:3.14}]},paletteCollapseIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:u}]},paletteTitleLabelColor:W.labelSelectColor,paletteTitleLabelFont:W.labelFont,paletteContentLabelFont:W.labelFont,paletteContentLabelColor:"#777",paletteContentBackground:"#fff",paletteTitleHeight:W.widgetTitleHeight,paletteTitleBackground:t.titleBackground,paletteTitleHoverBackground:t.titleBackground,paletteSeparatorWidth:1,paletteSeparatorColor:k,paletteItemHoverBorderColor:t.highlight,paletteItemSelectBackground:t.highlight},!0);var h=".palette-item:hover{border: 1px solid "+W.paletteItemHoverBorderColor+" !important}"+" .palette-header:hover{background: "+W.paletteTitleHoverBackground+" !important}",R=document.createElement("style");G||(R.styleSheet?R.styleSheet.cssText=h:R.appendChild(d().createTextNode(h))),d().getElementsByTagName("head")[0].appendChild(R);var n=function(f){var n=this;n.$22h=f,n.addListeners()};W.def(n,_,{ms_listener:1,getView:function(){return this.$22h.getView()},$26h:function(){var f=this;f.$36h&&$().removeChild(f.$36h),f.$23h=f.$24h=f.$25h=f.$35h=f.$36h=o},handle_touchstart:function(b){for(var A,G=this,B=G.$22h,s=b.target,v=B.sm(),h=B.dm(),K="palette-header",o="palette-header-tool",S="palette-item",c=!1,P=!1,L=!1;s&&(s[j]||"").indexOf(K)<0&&(s[j]||"").indexOf(S)<0;)s=s.parentNode;if(s&&s[j].indexOf(o)>=0?c=!0:s&&s[j].indexOf(K)>=0?L=!0:s&&s[j].indexOf(S)>=0&&(P=!0),W.isLeftButton(b))if(G.$27h(b))G.$24h=W.getClientPoint(b),G.$25h=B.ty();else if(c){W.preventDefault(b),A=s.parentNode.$11h;var e=h.getDataById(A),y=e.s("tools")[s.toolIndex];y.action&&y.action.call(B)}else if(L){W.preventDefault(b),A=s.$11h;var e=h.getDataById(A);e.isExpanded()?e.setExpanded(!1):e.setExpanded(!0)}else if(P){A=s.$11h;var p=h.getDataById(A);v.ss(p),B.handleDragAndDrop&&(W.preventDefault(b),p.s("draggable")&&(B.handleDragAndDrop(b,"prepare"),G.$35h=0)),p.s("draggable")||(W.preventDefault(b),G.$24h=W.getClientPoint(b),G.$25h=B.ty())}else W.preventDefault(b),G.$24h=W.getClientPoint(b),G.$25h=B.ty();else G.$26h(b)},handle_mousedown:function(u){this.handle_touchstart(u)},handle_mousewheel:function(D){this.handleScroll(D,D.wheelDelta/40,D.wheelDelta!==D.wheelDeltaX)},handle_DOMMouseScroll:function(P){this.handleScroll(P,-P.detail,1)},handleScroll:function(l,O,b){var o=this.$22h;W.preventDefault(l),b&&o._41o()&&o.ty(o.ty()+20*O)},handle_mouseup:function(u){this.handle_touchend(u)},handle_touchend:function(O){var M=this;M.$37h(O),M.$26h(O)},handleWindowMouseUp:function(S){this.handleWindowTouchEnd(S)},handleWindowTouchEnd:function(I){var r=this;r.$37h(I),r.$26h(I)},$37h:function(R){var Y=this,y=Y.$22h;2===Y.$35h&&(Y.$35h=3,y.handleDragAndDrop(R,"end"))},handleWindowMouseMove:function(X){this.handleWindowTouchMove(X)},handleWindowTouchMove:function(Q){var e=this,o=e.$22h,h=e.$23h,H=e.$24h,E=e.$25h,F=W.getClientPoint(Q),_=o._29I,i=e.$36h;if(1===e.$35h||2===e.$35h){if(e.$35h=2,o.handleDragAndDrop(Q,"between"),G){var N=Q.touches[0];Q=N?N:Q.changedTouches[0]}i.style.left=Q.pageX-parseInt(i.width)/2+y,i.style.top=Q.pageY-parseInt(i.height)/2+y}else"p"===h?o.ty(E+F.y-H.y):"v"===h&&o.ty(E+(H.y-F.y)/_.height*o._59I)},handle_mousemove:function(Y){this.handle_touchmove(Y)},handle_touchmove:function(B){if(!W.isDragging()&&W.isLeftButton(B)){var Z=this,r=Z.$22h,E=Z.$27h(B);if(Z.$24h){if(!Z.$23h){if(W.getDistance(W.getClientPoint(B),Z.$24h)<2)return;Z.$23h=E?"v":"p",W.startDragging(Z)}}else if(E)r._43o();else if(0===Z.$35h){if(Z.$35h=1,r.handleDragAndDrop(B,"begin"),G){var i=B.touches[0];B=i?i:B.changedTouches[0]}var m=Z.$36h=new Image,f=r.$10h[r.sm().ld().getId()].querySelector(".image-box"),n=parseInt(f.style.width),L=parseInt(f.style.height);m.draggable=!1,m.src=f.toDataURL(),m.width=n,m.height=L,m.style.position="absolute",m.style.left=B.pageX-n/2+y,m.style.top=B.pageY-L/2+y,$().appendChild(m),W.startDragging(Z)}}},$27h:function(G){var H=this.$22h,L=H.getView(),B=L.getBoundingClientRect(),S=H._29I,_=G.clientX-B.left+L.scrollLeft;return H._41o()&&S.x+S.width-_<J}}),ht.widget.Palette=function(h){var r=this,x=r._view=C.createView(null,r);r.$9h={},r.$10h={},r.$4h={},r._29I={x:0,y:0,width:0,height:0},r._59I=0,r.dm(h?h:new ht.DataModel),x[j]="ht-widget-palette",r.$29h=new n(r),M(x,I,W.paletteContentBackground),M(x,l,"auto"),M(x,i,q),M(x,"-moz-"+i,q),M(x,"-webkit-"+w,H),M(x,"-moz-"+w,H),M(x,"-ms-"+w,H),M(x,w,H),M(x,"position","absolute"),M(x,"overflow","hidden"),N(x,r._79O=V()),A(x,"dragstart",function($){$.dataTransfer&&($.dataTransfer.setData("Text","nodeid:"+$.target.$11h),$.dataTransfer.effectAllowed="all",r.$29h.$26h())})},f("Palette",_,{ms_v:1,ms_fire:1,ms_dm:1,ms_sm:1,ms_vs:1,ms_ac:["itemImageWidth","itemImageHeight","itemImagePadding","itemMargin","layout","autoHideScrollBar","scrollBarSize","scrollBarColor"],$30h:0,_itemImagePadding:4,_itemImageWidth:70,_itemImageHeight:50,_itemMargin:10,_layout:"largeicons",_autoHideScrollBar:W.autoHideScrollBar,_scrollBarSize:W.scrollBarSize,_scrollBarColor:W.scrollBarColor,getViewRect:function(){return this._29I},ty:function(B){return B==o?this.getTranslateY():(this.setTranslateY(B),void 0)},setTranslateY:function(G){if(this.$32h==o){var O=this,Q=O.$33h(G),A=O.$30h;O.$30h=Q,O.fp("translateY",A,Q)}},getTranslateY:function(){return this.$30h},setLayout:function(h){var z,b,p=this,l=p._layout;p._layout=h,"smallicons"===h?z=b=20:"iconsonly"===h?z=b=50:(z=70,b=50),p.setItemImageWidth(z),p.setItemImageHeight(b),p.setItemImagePadding(4),p.fp("layout",l,h)},getDataAt:function(u){for(var Q=u.target;Q&&Q.$11h==o;)Q=Q.parentNode;return Q&&Q.$11h!=o?this.getDataModel().getDataById(Q.$11h):void 0},$20h:function(){var p=16;return G&&(p*=1.2),p},$19h:function(){return W.paletteTitleHeight},$18h:function(){var f=W.paletteSeparatorWidth,v=W.paletteTitleBackground,w=W.paletteSeparatorColor||W.brighter(v);return f+y+" solid "+w},$17h:function(Y){M(Y,"cursor","pointer"),M(Y,"display","inline-block"),M(Y,"margin-right",(G?8:4)+y),M(Y,"vertical-align",T)},$1h:function(A){var h=this,k=v(),D=v(),H=X("span");k[j]="palette-header",M(k,r,"relative"),M(k,I,W.paletteTitleBackground),M(k,"color",W.paletteTitleLabelColor),M(k,T,b),M(k,i,q),M(k,"-moz-"+i,q),M(k,"padding","0 5px 0 0"),M(k,"border-top",h.$18h()),M(k,m,"100%"),M(k,"cursor","pointer"),M(k,"white-space","nowrap"),M(k,l,"hidden"),M(k,E,W.paletteTitleLabelFont),M(k,"line-height",h.$19h()+y),k.$11h=A.getId();var J=S(),x=h.$19h(),Y=h.$20h();h.$17h(J),C.setCanvas(J,Y,x),N(k,J);var $=A.s("tools");if($)for(var R=0;R<$.length;R++){var f=S();h.$17h(f),C.setCanvas(f,Y,x),f[j]="palette-header-tool palette-header-tool"+A.getId()+"-"+R,f.style.position="absolute",f.style.right=(Y+10)*R+"px",f.toolIndex=R,N(k,f)}return J[j]="palette-toggle-icon-"+A.getId(),D[j]="palette-content",M(D,"max-height",0+y),M(D,E,W.paletteContentLabelFont),M(D,l,"hidden"),D.$11h=A.getId(),h.$9h[A.getId()]=D,H[s]=A.getName(),M(H,E,W.paletteTitleLabelFont),N(k,J),N(k,H),[k,D]},$2h:function(x){var P=this,g=P._layout,u=e&&x.s("draggable")?X("a"):v(),D=S(),I=v(),Z=x.getName()||"",n=x.s("title")||x.getToolTip()||Z,Q=P._itemMargin;D[j]="image-box";var J=P.getItemImageWidth(),i=P.getItemImageHeight();return C.setCanvas(D,J,i),N(u,D),I[s]=Z,I[j]="label-box","iconsonly"!==g&&N(u,I),u[j]="palette-item",M(u,"vertical-align",T),M(u,"cursor","pointer"),M(u,"border-radius",5+y),M(u,"border","1px solid transparent"),M(u,"text-align","center"),M(u,"display","inline-block"),M(u,"margin-left",Q+y),M(u,"margin-top",Q+y),M(u,"color",W.paletteContentLabelColor),"smallicons"===g?(M(D,"vertical-align","middle"),M(u,"margin-left",2+y),M(u,"margin-top",2+y),M(u,"padding",2+y),M(u,"text-align",O),M(I,"display","inline-block"),M(I,"min-width",P.$21h+P._itemMargin+y)):"largeicons"===g&&(M(I,"max-width",J+y),M(I,"overflow","hidden")),u.$11h=x.getId(),n&&(u.title=n),x.s("draggable")&&!P.handleDragAndDrop&&(e?(u.href="#",M(u,"text-decoration",H)):u.draggable="true"),u},$16h:function(j,D,r,E){var Y=C.initContext(j);C.translateAndScale(Y,0,0,1),Y.clearRect(0,0,r,r);var B=(r-E)/2;W.drawStretchImage(Y,W.getImage(D),"fill",0,B,E,E),Y.restore()},$15h:function(h){var B=this,R=h.getId(),t=B._view.querySelector(".palette-toggle-icon-"+R),x=h.isExpanded()?W.paletteCollapseIcon:W.paletteExpandIcon;if(t&&x){var q=B.$19h(),j=B.$20h();B.$16h(t,x,q,j)}},_drawToolsIcon:function(U){var $=this,H=U.s("tools");if(H)for(var F=0;F<H.length;F++){var M=$._view.querySelector(".palette-header-tool"+U.getId()+"-"+F),p=H[F].icon,K=$.$19h(),V=$.$20h();$.$16h(M,p,K,V)}},$14h:function(e){var u=this,n=e.getId(),$=u.$10h[n].querySelector(".image-box"),X=e.getImage(),z=e.s("image.stretch");if($&&X){var f=C.initContext($),R=u.getItemImagePadding();R="smallicons"===u._layout?R/2:R;var H=u.getItemImageWidth()-2*R,M=u.getItemImageHeight()-2*R;C.translateAndScale(f,0,0,1),f.clearRect(0,0,H,M),W.drawStretchImage(f,W.getImage(X),z,R,R,H,M,e,u),f.restore()}},validateImpl:function(){var n,z,u,P=this,B=P.$9h,q=P._layout,U=P.$10h,w=P.$4h,f=P._view,V=P.dm();if(P.$13h&&(delete P.$13h,w={},V.each(function(q){w[q.getId()]=q})),"smallicons"===q)for(var e in w){var T=w[e];if(T instanceof K){var l=T.getName()||"",r=W.getTextSize(W.paletteContentLabelFont,l).width;P.$21h!=o&&P.$21h>r||(P.$21h=r)}}for(var e in w){u=w[e];var $,a;if(V.contains(u)){if(u instanceof ht.Group){var j,H=P.$1h(u),O=U[u.getId()];O&&(j=O.nextSibling,Q(f,j),Q(f,O)),z=V.getSiblings(u).indexOf(u);var Y=f.children[2*z]||P._79O;Y&&Y.parentNode?(f.insertBefore(H[0],Y),f.insertBefore(j||H[1],Y)):(f.appendChild(H[0]),f.appendChild(j||H[1])),U[u.getId()]=H[0],n=B[u.getId()]=j||H[1],a=u.$12h;var Z=u.s("promptText");a||(u.$12h=X("div"),u.$12h[s]=Z||"",a=u.$12h),0===u.getChildren().size()?n.contains(a)||N(n,a):n.contains(a)&&Q(n,a)}else if($=u.getParent()){var c=P.$2h(u),M=U[u.getId()];n=B[$.getId()],M&&Q(M.parentNode,M),z=V.getSiblings(u).indexOf(u);var C=n.children[z];C?n.insertBefore(c,C):N(n,c),U[u.getId()]=c,P.$14h(u)}}else{var F=U[u.getId()],d=F.parentNode;if(u instanceof ht.Group){var D=F.nextSibling;Q(f,F),Q(f,D),delete B[u.getId()]}else Q(d,F),0===d.children.length&&($=V.getDataById(d.$11h),$&&(a=$.$12h,a&&!d.contains(a)&&N(d,a)));delete U[u.getId()]}}P.$4h={};var p=function(){var t=P._59I,S=0;P.$32h!=o&&(clearInterval(P.$32h),S=0,delete P.$32h),P.$32h=setInterval(function(){P.$31h(),t===P._59I?(S++,S>=2&&(clearInterval(P.$32h),delete P.$32h)):(S=0,t=P._59I)},30)};for(var R in B)if(n=B[R],u=V.getDataById(B[R].$11h),P.$15h(u),P._drawToolsIcon(u),u.isExpanded()){if(n.style.maxHeight===0+y){var G=n.scrollHeight+P._itemMargin+y;x(n).duration(200).set(L,G).set("padding-bottom",P._itemMargin+y).end(function(){return function(){p()}}(G))}else n.style.maxHeight=n.scrollHeight+y;n.style.paddingBottom=P._itemMargin+y}else n.style.maxHeight!==0+y&&x(n).duration(200).set(L,b).set("padding-bottom",b).end(function(){return function(){p()}}(n));P.$28h(),P.$31h()},$31h:function(){for(var G=this,v=G._view,Y=0,h=v.children,N=0;N<h.length;N++){var o=h[N];o.className&&o.className.indexOf("palette-")>=0&&(Y+=o.offsetHeight)}G._59I=Y,G.$30h=G.$33h(G.ty());var j=G.ty();v.scrollTop=-j,G._29I={x:0,y:-j,width:v.clientWidth,height:v.clientHeight},M(G._79O,T,-j+y),G._93I()},$33h:function(A){var O=this,f=O._29I.height-O._59I;return f>A&&(A=f),A>0?0:Math.round(A)},redraw:function(){this.$13h||(this.$13h=1,this.iv())},onPropertyChanged:function(D){["autoHideScrollBar","scrollBarSize","scrollBarColor","translateY"].indexOf(D.property)<0&&this.redraw(),"translateY"===D.property&&(this.iv(),this._43o())},findDataByName:function(G){for(var C=this.dm().getDatas(),r=0;r<C.size();r++){var E=C.get(r);if(E.getName()===G)return E}},setDataModel:function(t){var i=this,D=i._dataModel,v=i._selectionModel;D!==t&&(D&&(D.umm(i.$6h,i),D.umd(i.$8h,i),D.umh(i.$7h,i),v||D.sm().ums(i.$28h,i)),i._dataModel=t,t.mm(i.$6h,i),t.md(i.$8h,i),t.mh(i.$7h,i),v?v._21I(t):t.sm().ms(i.$28h,i),i.sm().setSelectionMode("single"),i.fp("dataModel",D,t))},$6h:function(Q){var l=this,q=l._view,n=Q.data,c=l.$4h;"add"===Q.kind?c[n.getId()]=n:"remove"===Q.kind?c[n.getId()]=n:"clear"===Q.kind&&(l.$10h={},l.$9h={},l.$4h={},q[s]=""),l.iv()},$7h:function(Q){var S=this,U=Q.data;S.$4h[U.getId()]=U,S.iv()},$8h:function(Z){var D=this,w=Z.data,T=Z.property;"expanded"===T?D.iv():(D.$4h[w.getId()]=w,D.iv())},$28h:function(){var n,L=this,r=L.sm(),X="palette-item",w=r.ld();this.dm().each(function(T){n=L.$10h[T.getId()],n&&n[j].indexOf(X)>=0&&(T===w?M(n,I,W.paletteItemSelectBackground):Z(n,I))})}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);