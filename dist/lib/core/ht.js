!function(M,b,f){"use strict";function m(){this.el=[1,0,0,0,1,0,0,0,1]}var Q="ht";if(!M[Q]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),M.performance&&M.performance.now||function(){var h=Date.now();M.performance||(M.performance={}),M.performance.now=function(){return Date.now()-h}}();for(var k=Date.now(),C=16,t=["ms","moz","webkit","o"],v=0;v<t.length&&!M.requestAnimationFrame;++v)M.requestAnimationFrame=M[t[v]+"RequestAnimationFrame"],M.cancelAnimationFrame=M[t[v]+"CancelAnimationFrame"]||M[t[v]+"CancelRequestAnimationFrame"];M.requestAnimationFrame||(M.requestAnimationFrame=function(Y){var T=Date.now(),A=C+k-T;return 0>A&&(A=0),k=T,M.setTimeout(function(){k=Date.now(),Y(performance.now())},A)}),M.cancelAnimationFrame||(M.cancelAnimationFrame=function(F){return M.clearTimeout(F)}),b.assign===f&&(b.assign=function(R){if(R===f||null===R)throw new TypeError("Cannot convert undefined or null to object");for(var D=b(R),F=1;F<arguments.length;F++){var w=arguments[F];if(w!==f&&null!==w)for(var S in w)b.prototype.hasOwnProperty.call(w,S)&&(D[S]=w[S])}return D})}();var Y=M.document,u=null,X=M[Q]={},z=M[Q+"config"],U=X.Default=z&&z.Default||{},W=X.Style=z&&z.Style||{},F=X.Attr=z&&z.Attr||{},G=X.Color=z&&z.Color||{},H=X.IsGetter=z&&z.IsGetter||{};!function(){var w=!1;try{var k=b.defineProperty({},"passive",{get:function(){w=!0}});M.addEventListener("test",k,k),M.removeEventListener("test",k,k)}catch(h){w=!1}U.passiveSupported=w}();var s,a,E,B,Z=U.passiveSupported,V=U.eventListenerOptionsFalse=Z?{passive:!1,capture:!1}:!1,j=U.eventListenerOptionsTrue=Z?{passive:!1,capture:!0}:!0,g=Math,w=g.round,R=g.floor,n=g.ceil,r=g.sqrt,l=g.max,I=g.min,k=g.abs,p=g.cos,T=g.acos,x=g.sin,L=g.pow,C=g.asin,y=g.PI,e=2*y,N=y/2,h=g.tan,$=g.atan2,d=g.random,J=g.log,O=!1,P=!1,A=M.parseInt||global.parseInt,D="2019-07-04",v=M.navigator?M.navigator.platform.indexOf("Win")>-1:!1,o=function(V){return V*V},i=M.setTimeout,_=M.clearTimeout,K=M.location,t=M.navigator?M.navigator.userAgent.toLowerCase():"",c=function(L){return L.test(t)},S=c(/msie/),q=c(/msie/)||c(/trident/),zj=c(/msie 10/),Jg=c(/edge/),gg=c(/firefox/),zg=c(/mac/),je=U.isTouchable===f?v?!1:Y?"ontouchend"in Y:!1:U.isTouchable,fk="default",sr="single",Bq="multiple",gr="front",cl="back",nk="left",yq="right",hk="top",nh="bottom",Md="center",Hj="eye",fg="middle",qb="east",hd="west",ul="north",mg="none",Lf="px",sk="absolute",Vd="border",kb="triangle",Ej="rect",Yl="circle",Wl="cylinder",Kn="shape",Sp="items",Mn="normal",tp="remove",Ch="clear",ir="width",tj="height",dk="ingroup",Gn="check",Xj="uncheck",Zg="radio",Gj="radioOn",dg="radioOff",kp="points",Mc="values",Ae="series",Id="body",Fr="label",Nb="label2",cf="note",ic="note2",dj="icons",nj="labelFont",fd="labelColor",Br="labelSelectColor",Pn="note.expanded",fc="note2.expanded",df="edge.expanded",zq="edge.points",_j="edge.type",le="rotation",Ie="hidden",pl="visible",Xi="tuv",$p="no",pg="draw",of="select",ym="currentSubGraph",Fc="selectBackground",Xq="autoMakeVisible",Jm="autoHideScrollBar",Gl="scrollBarColor",bb="scrollBarSize",xn="indent",bm="rowHeight",$e="columnLineColor",wi="rowLineColor",nc="columnLineVisible",yc="rowLineVisible",ro="visibleFunc",Dr="expandIcon",cs="collapseIcon",kk="checkMode",Kj="sortFunc",ll="editable",Yd="batchEditable",cb="tristate",mj="asc",Cf="desc",Xl="position",mc="elevation",vc="children",$k="translateX",jg="translateY",Vq="dataModel",Wd="maxSize",Cj="state",Yi="shape3d",jn="shape3d.resolution",np="shape3d.visible",Tn="shape3d.from.visible",tr="shape3d.to.visible",Ib="shape3d.top.visible",rm="shape3d.bottom.visible",ms="repeat.uv.length",Sj="serializeValue",qm="deserializeValue",zs="centerUniform",Yg="uniform",Go="rgba(255,255,255,0)",fq="style",ld="attr",Ol="field",xc="string",tm="boolean",El="color",Fi="int",fp="number",Bn="ew-resize",pe="ns-resize",bf="pointer",qf="auto",zb="mousedown",No="mousemove",Xe="mouseup",he="mouseout",ks="touchstart",_i="touchmove",uo="touchend",kd="keydown",pk="keyup",Zc=["DOMMouseScroll","mousewheel"],ne=gg?Zc[0]:Zc[1],Rp=je?[ks,_i,uo,kd,pk,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[kd,pk,"keypress","input",zb,No,Xe,he,ne,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],wj=u,Jh=u,Ck=u,bj=Xe.length,vr=function(){Ck&&(_(Ck.timeout),Ck=u)},xj=function(){Ck&&ar(Ck.e,Ck.info)};M.addEventListener&&(je||(M.addEventListener(he,function(){vr()},V),M.addEventListener(ne,function(){rk()},V)),M.addEventListener(pk,function(x){91===x.keyCode?Fg={}:delete Fg[x.keyCode]},j),M.addEventListener(kd,function(b){Fg[b.keyCode]=!0},j),M.addEventListener("blur",function(){Fg={}},V));var Vm,_c,qq,Gg=0,Pc=u,te=function($,X){var b=i(function(){delete Pc[b],Dh(Pc)&&(Pc=u),$()},X);return b},qc=u,As=u,_l={},jo={},Zd={},rl={},Vf={},Fg={},es={},Ul={},Uh={},ok={},Dg=/.json$/,jm=/^data:image\/svg\+xml/,bk={},kf=[],Cd={},Qp=u,Ng=u,td=function(){},Dq=function(){throw"Oops!"},Ue=[0,0,0],Wi={x:0,y:0,width:0,height:0},Vi=u,pn=u,pj=u,Lo=function(d,N){jo[d]=N,N&&N.comps&&!N.uuid&&(N.uuid=X.Math.generateUUID()),qk[d]&&(N.cacheRule=qk[d],delete qk[d])},xm=function(T){pn&&!T._72O&&(pj||(pj={}),pj[T._72O=Pk()]=T),Vm!=u?cr()<.05&&B&&!_c&&(er=vr):er=Wr},Sg=function(n,_,L,v){pn||(pn={});var z=pn[n];if(z){if(z.url===_)return;z.image?(z.image.onload=td,z.image.onerror=td):z.request&&(z.request.onload=td,z.request.onerror=td)}if(Dg.test(_)){var M=new Yq;if(pn[n]={request:M,url:_},_=U.beforeLoadURL(_),_.data){var e=U.parse(_.data);Im(n,e),U.handleImageLoaded(n,e)}else{M.onload=function(){if(200===this.status||0===this.status){var b=U.parse(M.getResponseText());Im(n,b),U.handleImageLoaded(n,b)}else Im(n,U.handleUnfoundImage(n,_)||u)},M.onerror=function(){Im(n,U.handleUnfoundImage(n,_)||u)};var V={};V.url=encodeURI(_),V.sync=!1,M.send(V)}}else{var e=new Image;pn[n]={image:e,url:_},/^data:image/.test(_)||(_=U.beforeLoadURL(_),_=U.appendTimeStamp(_),_=encodeURI(_),U.crossOrigin&&(e.crossOrigin=U.crossOrigin)),U.convertImageSrc(_,function(d){q&&(_.toLowerCase().indexOf(".svg")>0||jm.test(_))?(Y.body.appendChild(e),e.style.visibility="hidden",e.onload=function(){i(function(){if(L&&(e.width=L),v&&(e.height=v),!e.width||!e.height){var S=e.width||e.clientWidth,R=e.height||e.clientHeight;e.width=S,e.height=R}U.handleImageLoaded(n,e),Im(n,e),Y.body.removeChild(e),e.style.visibility=""},180)},e.onerror=function(){Im(n,U.handleUnfoundImage(n,_)||u),Y.body.removeChild(e),e.style.visibility=""}):(e.onload=function(){L&&(e.width=L),v&&(e.height=v),U.handleImageLoaded(n,e),Im(n,e)},e.onerror=function(){Im(n,U.handleUnfoundImage(n,_)||u)}),e.src=d})}},Im=function(y,g){if(Lo(y,g),delete pn[y],Dh(pn)&&(pn=u,pj)){for(var h in pj){var F=pj[h];F._2O&&F._2O[y]&&(F.deleteTexture(y),delete F._2O[y]),F.invalidateAll&&F.invalidateAll(f,"imageLoaded",y),F.redraw&&F.redraw(),F.iv(),delete F._72O}pj=u}if(g&&pj)for(var h in pj){var F=pj[h];F.invalidateAll&&F.invalidateAll(f,"imageLoading",y),F.redraw&&F.redraw(),F.iv()}},th=function(){return J=g&&Date,function(){return M.performance&&M.performance.now?M.performance.now():Date.now()}}(),Um=function(i,O){O?_(i):M.cancelAnimationFrame(i)},$q=function(E,Q,T){return{width:E,height:Q,comps:En(T)?T:[T]}},ip=function(G,W){return{type:Yl,rect:[G,W,1.6,1.6],borderWidth:1,borderColor:iq,gradient:Nl,gradientColor:Wb,background:iq}},rj=function(H,Q){return $q(16,16,{type:kb,rect:[4,4,10,8],background:H,rotation:Q?1.57:3.14})},Hd=function(b,v){return $q(16,16,{type:kb,rect:[4,4,8,7],background:b,rotation:v?3.14:0})},lo=function(i){var E=i._orientation;return"horizontal"===E||"h"===E},Mq=function(f,O){var _=u||4,M=u||1,c=u||1;0>_?_=0:_>.25&&(_=.25);var E,S,R,b,k,A,i,I=.5,z=[],n=[],X=[],h=e/c,C=e/M,v=I-_;for(S=0;M>=S;S++)for(b=-y+S*C,A=p(b),k=x(b),E=0;c>=E;E++)R=E*h,i=v+_*A,z.push(p(R)*i,k*_,-x(R)*i),(a=[f,O])&&n.push(E/c,1-S/M);for(S=0;M>S;S++){var t=S*(c+1),d=(S+1)*(c+1);for(E=0;c>E;E++)X.push(t+E,d+E+1,d+E,t+E,t+E+1,d+E+1),eh.z=mn.z=[f,O]}},$l=function(a){var m=2,r=0;for(var k in a)k.length===m&&A(k,32)===cg&&(Qp=Ng=a[k]),r++;return r},qp=function(y,j,L,b){return L||(L=je?5:3,L/=b||1),{x:y-L,y:j-L,width:2*L,height:2*L}},ah=function(c,W,Y,u){var O=this;W||(W=je?5:3,Y=20,u=20);var t={x:c,y:W,width:Y,height:u};if(Y)for(var $=0;Y>$;$++)if(3===Y)u=20;else for(var e=0;u>e;e++)O=M?M:Y;var A={x:y,y:2*y};if(oj(t,A)){var F=tj[0]+hk[0]+Ch[1]+mj.length,i=Ie[0]+cb[0]+Ch[1]+Id.length;Fe[Hj]=[O[F],O[i]],O[F]=ii[Hj],O[i]=ii[Yi]}},Xf=function(r){return(/ble$/.test(r)||/ed$/.test(r)||H[r]?"is":"get")+r.charAt(0).toUpperCase()+r.slice(1)},ii=function(S){return"set"+S.charAt(0).toUpperCase()+S.slice(1)},Bs=function(m){return typeof m===xc||m instanceof String},Pr=function(k){return typeof k===fp},Wr=function(y){return typeof y===tm},Il=function(T){return T&&"object"==typeof T},Ze=function(V){return"function"==typeof V},En=function(J){return J instanceof Array},hq=function(Y){return Y instanceof _e},pc=function(M){return En(M)?new _e(M):M},xp=function(v){return v instanceof Kd},ej=function(n){return n instanceof Uq},yi=function(r){return r instanceof zf},Dk=function(q,I){if(!(q instanceof X.Group))return!1;if(!I)return q.isExpanded();var U=I.getDataUI(q);return U&&U._88I?!0:!1},Qj=function(S){return S instanceof ls},Oh=function(g){return g&&"IFRAME"===g.tagName},db=function(A){return A==u||U.numberDigits==u?A:parseFloat(A.toFixed(U.numberDigits))},Ab=function(Q,T,h){var X,A=T.length;if(h)for(var b=0;h>b;b++)if(3===A)Q.push(T[0]),Q.push(T[1]),Q.push(T[2]);else for(X=0;A>X;X++)Q.push(T[X]);else if(3===A)Q.push(T[0]),Q.push(T[1]),Q.push(T[2]);else for(X=0;A>X;X++)Q.push(T[X])},Ll=function(R){return R?Il(R)?R:{}:!1},ae=function(p,h,v){var Z,q=Il(p)?p:p.prototype;for(Z in h)v&&q[Z]!==f||(q[Z]=h[Z]);return p},kn=function(x){return String.fromCharCode(x)},Xk=function(l){for(var n,S=0,K="";S<l.length;S++)n=l[l.length-1-S],"%"===n?n="'":"a"===n?n='"':"]"===n&&(n="\\"),K+=kn(n.charCodeAt(0)-1);return K},ef=function(P,L,o){P.superClass.constructor.apply(L,o)},Dh=function(F){for(var J in F)return!1;return!0},oo=function(e){return e?0===e.length:!0},Me=function(){var S="";return[Xj[0],wi[0],Fr[0]].forEach(function(Y){S+=ii(Y).slice(3)}),Yg=Y&&Y[S]||zs,function(z,I){return z===I?!0:z.x===I.x&&z.y===I.y&&z.width===I.width&&z.height===I.height}}(),ml=function(x,T,v){return T>x?T:x>v?v:x},Zm=function(W){return 0>W?-1:W>0?1:0},cr=function(){var d=1e4*x(bj++);return d-R(d)},Gp=function(H,$,C){return so(H.x,H.y,$.x,$.y,C.x,C.y,C.x+C.width,C.y,!0)||so(H.x,H.y,$.x,$.y,C.x+C.width,C.y,C.x+C.width,C.y+C.height,!0)||so(H.x,H.y,$.x,$.y,C.x+C.width,C.y+C.height,C.x,C.y+C.height,!0)||so(H.x,H.y,$.x,$.y,C.x,C.y+C.height,C.x,C.y,!0)},so=function(P,v,X,p,N,U,b,C,J){var B=(b-N)*(v-U)-(C-U)*(P-N),o=(C-U)*(X-P)-(b-N)*(p-v);if(0!==o){var j=B/o,L=P+j*(X-P),m=v+j*(p-v);return J&&(L+mo<I(P,X)||L-mo>l(P,X)||L+mo<I(N,b)||L-mo>l(N,b)||m+mo<I(v,p)||m-mo>l(v,p)||m+mo<I(U,C)||m-mo>l(U,C))?u:[L,m]}return u},Tp=function(M,B,v){if(M&&v)if(B){if(B===fq)return M.getStyle(v);if(B===ld)return M.getAttr(v);if(B===Ol)return M[v]}else if(v=Xf(v),M[v])return M[v]();return f},Qn=function(w,L,R,F){if(w&&R)if(L){if(L===fq)w.s(R,F);else if(L===ld)w.a(R,F);else if(L===Ol){var K=w[R];w[R]=F,w.fp("f:"+R,K,F)}}else R=ii(R),w[R]&&w[R](F)},zp=function(Z,$,R){return $&&"top"!==$?"bottom"===$?{x:Z.x,y:Z.y,width:Z.width,height:Z.height*R}:"right"===$?{x:Z.x,y:Z.y,width:Z.width*R,height:Z.height}:"left"===$?{x:Z.x+Z.width*(1-R),y:Z.y,width:Z.width*R,height:Z.height}:void 0:{x:Z.x,y:Z.y+Z.height*(1-R),width:Z.width,height:Z.height*R}},Eo=function(i,G,v,N,w){G&&On(i,v,N,1,w,G)},Xo=function(z,D,G,W){var Q=1-z;return Q*Q*D+2*z*Q*G+z*z*W},eh=function(C,H,n,j,g){var $=1-C;return $*$*$*H+3*$*$*C*n+3*$*C*C*j+C*C*C*g},br=function(u){var I,O,A,p,d=0;return u.forEach(function(h){if(I=h.length,I>0)for(O=h[0],p=1;I>p;p++)A=h[p],d+=Di(O,A),O=A}),d},lh=function(o,B,N){var R="__"+o,W=function(m){N.disabled||N["handle_"+o](m)};N[R]||(N[R]=W,B.addEventListener(o,W,V))},ob=function(A,z,c){var Q="__"+A,l=c[Q];l&&(z.removeEventListener(A,l,V),delete c[Q])},xq=function(f,H){var N="_"+H;f[Xf(H)]=function(){return this[N]},f[ii(H)]=function(Y){var d=this[N];this[N]=Y,this.fp(H,d,Y)}},rd=function(B){return b.create(B)},Io=function(S){if(!S.element){var N,Y;(N=S.textField)?Y=xo(Qq.TextField,N):(N=S.textArea)?Y=xo(Qq.TextArea,N):(N=S.button)?Y=xo(Qq.Button,N):(N=S.comboBox)?Y=xo(Qq.ComboBox,N):(N=S.checkBox)?Y=xo(Qq.CheckBox,N):(N=S.radioButton)?Y=xo(Qq.RadioButton,N):(N=S.slider)?Y=xo(Qq.Slider,N):(N=S.colorPicker)?Y=xo(Qq.ColorPicker,N):(N=S.image)&&(Y=xo(Qq.Image,N)),Y&&(S.element=Y)}},sm=function(O,i){var $=rp(O);return $._ht=i,$},rp=function(r,b){var n=Y.createElement("div"),Z=n.style;return n.tabIndex=-1,n.onkeydown=wb,Z.msTouchAction=mg,al(n,u,0),je&&Z.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",u),r&&(Z.overflow=Ie),b&&qr(b,n),n},ib=function(z,P){var c=Y.createElement("canvas"),O=c.style;return O.msTouchAction=mg,P||(O.pointerEvents=mg),al(c,u,0),z&&qr(z,c),c},al=function(u,n,w){var b=u.style;b.border=n?n+" solid 1px":0,b.outline=0,b.padding=w?"0 "+w+Lf:0,Ad(u)},Ad=function(D){var b=D.style;b.position=sk,b.margin=0,b.setProperty("box-sizing","border-box",u),b.setProperty("-moz-box-sizing","border-box",u)},Up=function(c,l,W,V){V||(V=Ee),l!=u&&(c.width=l*V,c.style.width=l+Lf),W!=u&&(c.height=W*V,c.style.height=W+Lf)},qr=function(W,j,o){W.appendChild(j),o&&(j.style.position=sk)},Lc=function(e,J){J.split||(J+="");for(var q,Y=J.split("\n"),o=0,Q=Y.length,Z=0;Q>Z;Z++){var O=Nh(e.font,Y[Z]);O.width>o&&(o=O.width),q||(q=O.height)}return e.ss=Y,{width:o,height:q*Q}},Jd=function(J,r,m,E,o,j){var B=r.length;if(1===B)kg(J,r[0],m,E,o);else for(var q=m.height/B,L={x:m.x,y:m.y,width:m.width,height:q},V=0;V<r.length;V++)j?gi(J,r[V],E,o,L.x,L.y,L.width,L.height,j):kg(J,r[V],L,E,o),L.y+=q},kg=function(I,m,z,V,p){I.font=V?V:bn,I.fillStyle=p?p:ie,I.textAlign=Md,I.textBaseline=fg;var e,R;z?z.width===f?(e=z.x,R=z.y):(e=z.x+z.width/2,R=z.y+z.height/2):(e=0,R=0),I.fillText(m,w(e),w(R))},Vc=function(M){M.getView&&(M=M.getView());var j=M.offsetWidth||M.scrollWidth;return!j&&M.style.width&&(j=A(M.style.width)),j},bo=function($){$.getView&&($=$.getView());var P=$.offsetHeight||$.scrollHeight;return!P&&$.style.height&&(P=A($.style.height)),P},xh=function(B,k,P){var w=k[0].toUpperCase()+k.substring(1,k.length);B["webkit"+w]=P,B["moz"+w]=P,B["ms"+w]=P,B["o"+w]=P,B[k]=P},Ob=function(){var T=function(i){wb(i),i.stopPropagation()},I=function(H){wb(H)},h=je?[ks]:[kd,zb];return function(X,K){var Q=rp(),q=Q.style;return q.backgroundColor=U.disabledBackground,X&&(q.backgroundImage="url("+X+")",q.backgroundPosition="50% 50%",q.backgroundRepeat="no-repeat no-repeat"),K===!1?h.forEach(function(q){Q.addEventListener(q,I,V)}):h.forEach(function(s){Q.addEventListener(s,T,V)}),Q}}(),Cp=function(v){var X=v.getContext("2d");return X.save(),X.lineCap=Cq,X.lineJoin=Lp,X},er=function(c,t,I,h){vk(c,t*Ee,I*Ee),h*=Ee,1!==h&&c.scale(h,h)},vk=function(j,K,x){j.translate(K,x)},ts=function(d,P){P&&d.rotate(P)},Zo=function(y,X,v){X===f&&(X=1),v===f&&(v=1),(1!==X||1!==v)&&y.scale(X,v)},sq=!1,Kk=function(j){var P=Y.activeElement;if(Y.activeElement!==j){P&&P.forceOnblur&&P.forceOnblur();for(var d=[],q=j.parentNode;q;)d.push([q,q.scrollLeft,q.scrollTop]),q=q.parentNode;if(!sq){var o=[],C=[];try{for(var Q=M.parent,K=M;Q!==K;)o.push([Q,Q.scrollX,Q.scrollY]),K=Q,Q=M.parent;var e=M.frameElement;if(e)for(var w=e.parentNode;w;)C.push([w,w.scrollLeft,w.scrollTop]),w=w.parentNode}catch(L){sq=!0}}if(je)j.focus();else{var t=ih(),T=t.target;j.focus(),T.scrollLeft=t.left,T.scrollTop=t.top}d.forEach(function(D){D[0].scrollLeft=D[1],D[0].scrollTop=D[2]}),sq||(o.forEach(function(c){c[0].scrollTo(c[1],c[2])}),C.forEach(function(u){u[0].scrollLeft=u[1],u[0].scrollTop=u[2]}))}},uf=function(q){return q&&q.getView?q.getView():q},Ji=function(T,n,g,e,w){if(2===arguments.length&&(g=n.y,e=n.width,w=n.height,n=n.x),T.isSelfViewEvent)T.setX(n),T.setY(g),T.setWidth(e),T.setHeight(w);else{var K=uf(T),L=K.style;if((Y.fullscreenElement||Y.mozFullScreenElement||Y.webkitFullscreenElement||Y.msFullscreenElement)!==K)n!==f&&(L.left=n+Lf),g!==f&&(L.top=g+Lf),e!==f&&(L.width=e+Lf),w!==f&&(L.height=w+Lf);else{var r=U.getWindowInfo();L.left=(n=r.left)+Lf,L.top=(g=r.top)+Lf,L.width=(e=r.width)+Lf,L.height=(w=r.height)+Lf}T.endEditing&&!je&&T.endEditing(),T.redraw&&T.redraw(),T.invalidate&&T.invalidate(),T.onLayouted&&T.onLayouted(n,g,e,w),T.fireViewEvent&&T.fireViewEvent("layout")}},hc=function(S){if(!S.touches)return S;var p=S.touches[0];return p?p:S.changedTouches[0]},ye=function(k){return je?hc(k).target:k.target},Ok=function(I){U.popup&&U.popup.close(),U.popup=I},eg=u,mq=function(H){eg.handleWindowTouchMove(H)},om=function(z){eg.handleWindowTouchEnd(z),M.removeEventListener(_i,mq,V),M.removeEventListener(uo,om,V),eg=u},Nd=function(P){eg.handleWindowMouseMove(P)},Qg=function(n){eg.handleWindowMouseUp(n),M.removeEventListener(No,Nd,V),M.removeEventListener(Xe,Qg,V),eg=u},dc=function(y){return 1===Wg(y)},Kr=function($,Z){return Z?Z.keyCode===$:Fg[$]},Zf=function(V){return Be(V)&&Kr(65,V)},ws=function(j){return Kr(46,j)||Kr(8,j)},Ro=function(B){return function(N){return N?N.keyCode===B:Fg[B]}},cg=573,Sl=[65,83,68,87,37,38,39,40,32,13,27],tn=Ro(Sl[0]),qh=Ro(Sl[1]),od=Ro(Sl[2]),Gc=Ro(Sl[3]),el=Ro(Sl[4]),ek=Ro(Sl[5]),bs=Ro(Sl[6]),Sh=Ro(Sl[7]),Db=Ro(Sl[8]),Wp=Ro(Sl[9]),hj=Ro(Sl[10]),ad={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},tb=[2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,5,5,5,5,5,7,7,41],vh=u,Oc=u,Jc=function(n,r){vh||(vh=ib()),Up(vh,n,r,1);var I=Cp(vh);return I.clearRect(0,0,n,r),I},$j=function(){var Z,P={};for(var r in M){var F=Bq.length;if(r.length==F&&r[0]===Bq[2]&&r[1]===mg[1]&&r[4]===Bq[3]&&r[5]===Bq[4]&&r.substr(F-2)===mg[1]+mg[2]){var S=M[r];for(var p in S)p.length===F&&p.substr(0,3)===yq[3]+tp[3]+of[0]&&p.substr(F-2)===Bq[0]+cf[3]&&(Zc=S[p])}}return function(i){var s,Q=P[i];return Q||(Z||(Z=ib(),Up(Z,1,1,1)),s=Z.getContext("2d"),s.clearRect(0,0,1,1),On(s,0,0,1,1,i),Q=s.getImageData(0,0,1,1).data,Q=P[i]=[Q[0],Q[1],Q[2],Q[3]]),Q}}(),Ke=function(i){if(!Bs(i))return i;var B=$j(i);return B.CA||(B.CA=[B[0]/255,B[1]/255,B[2]/255,B[3]/255]),B.CA},kq=function(m,O,N,q,d){var f=ib();f.width=N,f.height=q;var w=f.getContext("2d");w.drawImage(m,0,0,N,q);try{for(var Y=w.getImageData(0,0,N,q),I=Y.data,s=0,U=I.length;U>s;s+=4){var j=I[s+0],k=I[s+1],G=I[s+2],F=I[s+3];"override_a"===d?I[s+3]=255*O[3]:"override_rgb"===d?(I[s+0]=255*O[0],I[s+1]=255*O[1],I[s+2]=255*O[2]):"override"===d?(I[s+0]=255*O[0],I[s+1]=255*O[1],I[s+2]=255*O[2],I[s+3]=255*O[3]):(I[s+0]=O[0]*j,I[s+1]=O[1]*k,I[s+2]=O[2]*G,I[s+3]=O[3]*F)}w.putImageData(Y,0,0)}catch(C){return m}return f},Fe=function(J,Q,g){return Q&&(Q="miter"===g?8*Q+20:Q+1,J&&ce(J,Q)),Q},yl=function(F,f){if(f){var T=new Cg(f),W=F.width/2,z=F.height/2,P=ys([T.tf(-W,-z),T.tf(W,-z),T.tf(W,z),T.tf(-W,z)]);return P.x+=F.x+W,P.y+=F.y+z,P}return F},Mr=function(u,c,d,E,p,W,X,T){E*=Math.PI/180;var g={x:Math.cos(E)*(u.x-X.x)/2+Math.sin(E)*(u.y-X.y)/2,y:-Math.sin(E)*(u.x-X.x)/2+Math.cos(E)*(u.y-X.y)/2},t=Math.pow(g.x,2)/Math.pow(c,2)+Math.pow(g.y,2)/Math.pow(d,2);t>1&&(c*=Math.sqrt(t),d*=Math.sqrt(t));var r=(p==W?-1:1)*Math.sqrt((Math.pow(c,2)*Math.pow(d,2)-Math.pow(c,2)*Math.pow(g.y,2)-Math.pow(d,2)*Math.pow(g.x,2))/(Math.pow(c,2)*Math.pow(g.y,2)+Math.pow(d,2)*Math.pow(g.x,2)));isNaN(r)&&(r=0);var F={x:r*c*g.y/d,y:r*-d*g.x/c},D={x:(u.x+X.x)/2+Math.cos(E)*F.x-Math.sin(E)*F.y,y:(u.y+X.y)/2+Math.sin(E)*F.x+Math.cos(E)*F.y},R=function($){return Math.sqrt(Math.pow($[0],2)+Math.pow($[1],2))},n=function(f,s){return(f[0]*s[0]+f[1]*s[1])/(R(f)*R(s))},v=function(p,W){return(p[0]*W[1]<p[1]*W[0]?-1:1)*Math.acos(n(p,W))},y=v([1,0],[(g.x-F.x)/c,(g.y-F.y)/d]),A=[(g.x-F.x)/c,(g.y-F.y)/d],w=[(-g.x-F.x)/c,(-g.y-F.y)/d],Z=v(A,w);n(A,w)<=-1&&(Z=Math.PI),n(A,w)>=1&&(Z=0);var n=c>d?c:d,e=c>d?1:c/d,M=c>d?d/c:1;if(null==T){var l={x:0,y:0,width:0,height:0};ce(l,n),l.x*=e,l.width*=e,l.y*=M,l.height*=M;var k=new Cg(E);return l=ys([k.tf(l.x,l.y),k.tf(l.x+l.width,l.y),k.tf(l.x+l.width,l.y+l.height),k.tf(l.x,l.y+l.height)]),l.x+=D.x,l.y+=D.y,[{x:l.x,y:l.y},{x:l.x+l.width,y:l.y},{x:l.x+l.width,y:l.y+l.height},{x:l.x,y:l.y+l.height}]}T.translate(D.x,D.y),T.rotate(E),T.scale(e,M),T.arc(0,0,n,y,y+Z,1-W),T.scale(1/e,1/M),T.rotate(-E),T.translate(-D.x,-D.y)},Nc=function(d,R){d&&d.beginPath();for(var X,M,T,Z=[],g=function(F){for(var h,D=/(\-{0,1}[\d\.]+)/gi,H=[];h=D.exec(F);)H.push(parseFloat(h[0]));return H},y=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,S={x:0,y:0};X=y.exec(R);){var c=X[0],K=c.substr(0,1);if("M"===K||"m"===K){for(var i=g(c),P=0;P<i.length;P+=2){var W=i[P],$=i[P+1];"m"===K&&(W+=S.x,$+=S.y),d&&d.moveTo(W,$),Z.push({x:W,y:$}),S.x=W,S.y=$}M=T=null}else if("H"===K||"h"===K){for(var i=g(c),P=0;P<i.length;P+=1){var W=i[P];"h"===K&&(W+=S.x),d&&d.lineTo(W,S.y),Z.push({x:W,y:S.y}),S.x=W}M=T=null}else if("C"===K||"c"===K){for(var i=g(c),P=0;P<i.length;P+=6){var b=i[P],I=i[P+1],U=i[P+2],w=i[P+3],W=i[P+4],$=i[P+5];"c"===K&&(b+=S.x,I+=S.y,U+=S.x,w+=S.y,W+=S.x,$+=S.y),d&&d.bezierCurveTo(b,I,U,w,W,$),Z.push({x:b,y:I}),Z.push({x:U,y:w}),Z.push({x:W,y:$}),S.x=W,S.y=$}M=[b,I,U,w,W,$],T=null}else if("S"===K||"s"===K){for(var i=g(c),P=0;P<i.length;P+=4){var b,I;M?(b=2*M[4]-M[2],I=2*M[5]-M[3]):(b=S.x,I=S.y);var U=i[P],w=i[P+1],W=i[P+2],$=i[P+3];"s"===K&&(U+=S.x,w+=S.y,W+=S.x,$+=S.y),d&&d.bezierCurveTo(b,I,U,w,W,$),Z.push({x:b,y:I}),Z.push({x:U,y:w}),Z.push({x:W,y:$}),S.x=W,S.y=$}M=[b,I,U,w,W,$],T=null}else if("Q"===K||"q"===K){for(var i=g(c),P=0;P<i.length;P+=4){var b=i[P],I=i[P+1],W=i[P+2],$=i[P+3];"q"===K&&(b+=S.x,I+=S.y,W+=S.x,$+=S.y),d&&d.quadraticCurveTo(b,I,W,$),Z.push({x:b,y:I}),Z.push({x:W,y:$}),S.x=W,S.y=$}M=null,T=[b,I,W,$]}else if("T"===K||"t"===K){for(var i=g(c),P=0;P<i.length;P+=2){var b,I;T?(b=2*T[2]-T[0],I=2*T[3]-T[1]):(b=S.x,I=S.y);var W=i[P],$=i[P+1];"t"===K&&(W+=S.x,$+=S.y),d&&d.quadraticCurveTo(b,I,W,$),Z.push({x:b,y:I}),Z.push({x:W,y:$}),S.x=W,S.y=$}M=null,T=[b,I,W,$]}else if("V"===K||"v"===K){for(var i=g(c),P=0;P<i.length;P+=1){var $=i[P];"v"===K&&($+=S.y),d&&d.lineTo(S.x,$),Z.push({x:S.x,y:$}),S.y=$}M=T=null}else if("L"===K||"l"===K){for(var i=g(c),P=0;P<i.length;P+=2){var W=i[P],$=i[P+1];"l"===K&&(W+=S.x,$+=S.y),d&&d.lineTo(W,$),Z.push({x:W,y:$}),S.x=W,S.y=$}M=T=null}else if("A"===K||"a"===K){for(var i=g(c),P=0;P<i.length;P+=7){var e=i[P],x=i[P+1],F=i[P+2],H=i[P+3],L=i[P+4],W=i[P+5],$=i[P+6];"a"===K&&(W+=S.x,$+=S.y);var V=Mr(S,e,x,F,H,L,{x:W,y:$},d);V&&(Z=Z.concat(V)),S.x=W,S.y=$}M=T=null}var t=c.substr(c.length-1);("z"===t||"Z"===t)&&d&&d.closePath()}return Z},Af=function(R,d){var N,g,x="L"===d[0],J=d.length;R.save(),x?(R.transform(d[5],d[6],d[7],d[8],d[9],d[10]),N=R.createLinearGradient(d[1],d[2],d[3],d[4]),g=11):(R.transform(d[7],d[8],d[9],d[10],d[11],d[12]),N=R.createRadialGradient(d[1],d[2],d[3],d[4],d[5],d[6]),g=13);for(var u=R.compGray;J>g;)N.addColorStop(d[g],u?U.toGrayColor(d[g+1]):d[g+1]),g+=2;R.fillStyle=N},mn=function(N,t){var f=N.s("shape.gradient.pack");if(f){for(var T=f.length,l=new Array(T),F=0;T>F;F++)l[F]=f[F];var J,q,k,g,x,B,e,v,z,r,Y,j,S,y="L"===l[0];J=y?5:7,q=l[J],k=l[J+1],g=l[J+2],x=l[J+3],B=l[J+4],e=l[J+5],v=t[0],z=t[1],r=t[2],Y=t[3],j=t[4],S=t[5],l[J]=v*q+r*k,l[J+1]=z*q+Y*k,l[J+2]=v*g+r*x,l[J+3]=z*g+Y*x,l[J+4]=v*B+r*e+j,l[J+5]=z*B+Y*e+S,N.s("shape.gradient.pack",l)}},mm=function(m,e,f,q){var H=!1;if(m.beginPath?m.beginPath():H=!0,hq(e)&&(e=e._as),hq(f)&&(f=f._as),f&&f.length){for(var R,x,T,l,U=0,h=0,W=f.length;W>h;h++)R=f[h],1===R?(x=e[U++],m.moveTo(x.x,H?-x.y:x.y)):2===R?(x=e[U++],m.lineTo(x.x,H?-x.y:x.y)):3===R?(x=e[U++],T=e[U++],m.quadraticCurveTo(x.x,H?-x.y:x.y,T.x,H?-T.y:T.y)):4===R?(x=e[U++],T=e[U++],l=e[U++],m.bezierCurveTo(x.x,H?-x.y:x.y,T.x,H?-T.y:T.y,l.x,H?-l.y:l.y)):5===R&&m.closePath();q&&5!==R&&m.closePath()}else{var d,B,C,w=e.length;if(w>0){for(d=e[0],m.moveTo(d.x,H?-d.y:d.y),B=1;w>B;B++)C=e[B],m.lineTo(C.x,H?-C.y:C.y);q&&m.closePath()}}},Lm=function(x,K,D,F){if(hq(x)&&(x=x._as),hq(K)&&(K=K._as),K&&K.length){D=D||ur;for(var w,c,Q,d,v,q,Y,r,O=[],I=u,l=0,H=0,V=K.length;V>H;H++)if(w=K[H],1===w)O.push(I=[]),I.push(x[l++]);else if(2===w)I.push(x[l++]);else if(3===w){for(c=I[I.length-1],Q=x[l++],d=x[l++],q=1;D>q;q++)Y=Xo(q/D,c.x,Q.x,d.x),r=Xo(q/D,c.y,Q.y,d.y),I.push({x:Y,y:r,b:!0});I.push(d)}else if(4===w){for(c=I[I.length-1],Q=x[l++],d=x[l++],v=x[l++],q=1;D>q;q++)Y=eh(q/D,c.x,Q.x,d.x,v.x),r=eh(q/D,c.y,Q.y,d.y,v.y),I.push({x:Y,y:r,b:!0});I.push(v)}else 5===w&&I.push(I[0]);return F&&5!==w&&I&&I.length>2&&I.push(I[0]),O}return F&&x.length>2&&(x=x.slice(),x.push(x[0])),x?[x]:[]},Zn=function(Y,e,J,$,y,b){var a,l,P,T=$j(e),d=$,s=T[0],k=T[1],U=T[2];if(J){var z=$j(J);a=z[0]-s,l=z[1]-k,P=z[2]-U}else a=255-s,l=255-k,P=255-U;for(b||(b=$>10?1:.5,b=1>y?I(b/y,2):b),Y.save(),Y.shadowOffsetX=0,Y.shadowOffsetY=0,Y.shadowBlur=0,Y.shadowColor=0;($-=b)>0;){var Q=1-$/d,o=s+a*Q,q=k+l*Q,L=U+P*Q;o=I(n(o),255),q=I(n(q),255),L=I(n(L),255),Y.strokeStyle="rgb("+o+","+q+","+L+")",Y.lineWidth=$,Y.stroke()}Y.restore()},xb=function(){var f={};return function(U,k){var _=U+"-"+k,a=f[_];if(a)return a;var B,e,p,K=$j(U);return 0>k?(k=(100+k)/100,B=n(K[0]*k),e=n(K[1]*k),p=n(K[2]*k)):(k/=100,B=K[0],e=K[1],p=K[2],B+=(255-B)*k,e+=(255-e)*k,p+=(255-p)*k,B=I(n(B),255),e=I(n(e),255),p=I(n(p),255)),f[_]="rgb("+B+","+e+","+p+")"}}(),On=function(h,l,t,A,Q,H){H&&(h.fillStyle=H),h.beginPath(),h.rect(l,t,A,Q),h.fill()},gn=function(V,w,W,Z,q,t,d){V.beginPath(),ln[w](V,W.x,W.y,W.width,W.height,Z,q,t,d)},Dl=function(C,D,k,t,K){var r=ln[k];C.fillStyle=r?r(C,D,t?t:Wb,K.x,K.y,K.width,K.height):D},Un=function(N,h,b,D,S,g){try{if(!h.tagName&&h.comps){h._cacheImage_||(h._cacheImage_={});var r;r="override"===D?"colors_override":"override_rgb"===D?"colors_override_rgb":"override_a"===D?"colors_override_a":"colors",h._cacheImage_[r]||(h._cacheImage_[r]={__count__:0});var i=h._cacheImage_[r][b];i||(h._cacheImage_[r].__count__>U.imageCacheThreshold&&(h._cacheImage_[r]={__count__:0}),i=X.Default.toCanvas(h,Bp(h),Fd(h),null,S,g,b,null,D),h._cacheImage_[r][b]=i,h._cacheImage_[r].__count__++),h=i}N.fillStyle=N.createPattern(h,"repeat")}catch(s){N.fillStyle="black"}},Ti=function(E,K,X,M,B,Q,m){E.save(),E.translate(K,X),E.scale(1,m/Q),E.arc(0,0,Q,M,B),E.restore()},ke=function(W,a,B,r,E,l,Q,Y){var L,$,o,O,J,I,V,m,w,v,h;if(k(E)>2*y&&(E=2*y),J=n(k(E)/(y/4)),L=E/J,$=-L,o=-r,J>0){I=a+p(r)*l,V=B+x(-r)*Q,Y?W.lineTo(I,V):W.moveTo(I,V);for(var Z=0;J>Z;Z++)o+=$,O=o-$/2,m=a+p(o)*l,w=B+x(o)*Q,v=a+p(O)*(l/p($/2)),h=B+x(O)*(Q/p($/2)),W.quadraticCurveTo(v,h,m,w)}},ff=function(s,W,O,j,i,R,G,M,c){6===arguments.length&&(G=R,M=R,c=R);var m=W+j,x=O+i,P=i>j?2*j:2*i;R=P>R?R:P,G=P>G?G:P,M=P>M?M:P,c=P>c?c:P;var v=.29*c,a=.58*c;s.moveTo(m,x-c),s.quadraticCurveTo(m,x-a,m-v,x-v),s.quadraticCurveTo(m-a,x,m-c,x),v=.29*M,a=.58*M,s.lineTo(W+M,x),s.quadraticCurveTo(W+a,x,W+v,x-v),s.quadraticCurveTo(W,x-a,W,x-M),v=.29*R,a=.58*R,s.lineTo(W,O+R),s.quadraticCurveTo(W,O+a,W+v,O+v),s.quadraticCurveTo(W+a,O,W+R,O),v=.29*G,a=.58*G,s.lineTo(m-G,O),s.quadraticCurveTo(m-a,O,m-v,O+v),s.quadraticCurveTo(m,O+a,m,O+G),s.lineTo(m,x-c)},ti=function(L,M,o,F,r,K,z){M&&(o=w(o),F=w(F),z||(z=1),L.fillStyle=M,L.beginPath(),L.rect(o,F,z,K),L.rect(o,F,r,z),K-z>0&&L.rect(o,F+K-z,r,z),r-z>0&&L.rect(o+r-z,F,z,K),L.fill())},hg=function(j,o,r,A){var v=A.x,B=A.y,g=A.width,m=A.height;if(!(!o||!r||0>=g||0>=m)){var K,G=Xm(o),Q=zm(o),C=r>0;1===r||-1===r?(j.fillStyle=C?G:Q,j.beginPath(),j.rect(v,B,1,m),j.rect(v,B,g,1),j.fill(),j.fillStyle=C?Q:G,j.beginPath(),j.rect(v,B+m-1,g,1),j.rect(v+g-1,B,1,m),j.fill()):(r=I(k(r),I(g/2,m/2)),K=j.createLinearGradient(v,B,v+r,B),K.addColorStop(0,C?G:Q),K.addColorStop(1,o),j.fillStyle=K,j.beginPath(),j.moveTo(v,B),j.lineTo(v+r,B+r),j.lineTo(v+r,B+m-r),j.lineTo(v,B+m),j.lineTo(v,B),j.fill(),K=j.createLinearGradient(v,B,v,B+r),K.addColorStop(0,C?G:Q),K.addColorStop(1,o),j.fillStyle=K,j.beginPath(),j.moveTo(v,B),j.lineTo(v+r,B+r),j.lineTo(v+g-r,B+r),j.lineTo(v+g,B),j.lineTo(v,B),j.fill(),K=j.createLinearGradient(v,B+m,v,B+m-r),K.addColorStop(0,C?Q:G),K.addColorStop(1,o),j.fillStyle=K,j.beginPath(),j.moveTo(v,B+m),j.lineTo(v+r,B+m-r),j.lineTo(v+g-r,B+m-r),j.lineTo(v+g,B+m),j.lineTo(v,B+m),j.fill(),K=j.createLinearGradient(v+g,B,v+g-r,B),K.addColorStop(0,C?Q:G),K.addColorStop(1,o),j.fillStyle=K,j.beginPath(),j.moveTo(v+g,B),j.lineTo(v+g-r,B+r),j.lineTo(v+g-r,B+m-r),j.lineTo(v+g,B+m),j.lineTo(v+g,B),j.fill())}},am=function(a,i,Z,x,o,S,E){var t=a.createLinearGradient(x,o,S,E);return t.addColorStop(0,Z),t.addColorStop(1,i),t},Ph=function(u,d,B,M,G,N,Y){var S=u.createLinearGradient(M,G,N,Y);return S.addColorStop(0,d),S.addColorStop(.5,B),S.addColorStop(1,d),S},sb=function(R,K,B,o,T,X,b){var V=R.createLinearGradient(o,T,X,b);return V.addColorStop(0,K),V.addColorStop(1/3,B),V.addColorStop(2/3,K),V.addColorStop(1,B),V},se=function(T,C,X,k,u,w,y,f,Y){var V=T.createRadialGradient(k+w*f,u+y*Y,I(w,y)/24,k+w/2,u+y/2,l(w,y)/2);return V.addColorStop(0,X),V.addColorStop(1,C),V},lg=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],ln={polygon:function(h,$,W,M,Q,c){(c==u||3>c)&&(c=6);for(var k,S,D=I(M,Q)/2,t=$+M/2,_=W+Q/2,A=0,N=2*y/c,O=0;c>O;O++)k=t+p(A)*D,S=_+x(A)*D,0===O?h.moveTo(k,S):h.lineTo(k,S),A+=N;h.closePath()},arc:function(i,j,s,$,D,C,J,Z,R){C==u&&(C=y),J==u&&(J=e),Z==u&&(Z=!0);var X=j+$/2,w=s+D/2;Z&&i.moveTo(X,w),R?Ti(i,X,w,C,J,$/2,D/2):i.arc(X,w,I($,D)/2,C,J),Z&&i.closePath()},rect:function(d,S,r,N,j){d.rect(S,r,N,j)},circle:function($,h,S,n,P){$.arc(h+n/2,S+P/2,I(n,P)/2,0,e,!0)},oval:function(z,U,I,H,c){Ti(z,U+H/2,I+c/2,0,e,H/2,c/2)},roundRect:function(w,B,j,o,$,x){x==u&&(x=I(I(o,$)/4,8)),ff(w,B,j,o,$,x)},star:function(x,q,z,R,K){var u=2*R,P=2*K,I=q+R/2,M=z+K/2;x.moveTo(I-u/4,M-P/12),x.lineTo(q+.306*R,z+.579*K),x.lineTo(I-u/6,M+P/4),x.lineTo(q+R/2,z+.733*K),x.lineTo(I+u/6,M+P/4),x.lineTo(q+.693*R,z+.579*K),x.lineTo(I+u/4,M-P/12),x.lineTo(q+.611*R,z+.332*K),x.lineTo(I+0,M-P/4),x.lineTo(q+.388*R,z+.332*K),x.closePath()},pentagram:function(D,N,z,x,i){var h=.5*i,A=N+.5*x,q=z+h,f=.5257311121191336*x;f>h&&(f=h);var J=lg,y=0;for(D.moveTo(A+f*J[y++],q+f*J[y++]);20>y;)D.lineTo(A+f*J[y++],q+f*J[y++]);D.closePath()},triangle:function(h,O,o,j,t){h.moveTo(O+j/2,o),h.lineTo(O+j,o+t),h.lineTo(O,o+t),h.closePath()},hexagon:function(b,m,k,T,g){b.moveTo(m,k+g/2),b.lineTo(m+T/4,k+g),b.lineTo(m+3*T/4,+k+g),b.lineTo(m+T,k+g/2),b.lineTo(m+3*T/4,k),b.lineTo(m+T/4,k),b.closePath()},pentagon:function(F,s,A,k,x){var o=2*k,Y=2*x,C=s+k/2,L=A+x/2;F.moveTo(C-o/4,L-Y/12),F.lineTo(C-o/6,L+Y/4),F.lineTo(C+o/6,L+Y/4),F.lineTo(C+o/4,L-Y/12),F.lineTo(C+0,L-Y/4),F.closePath()},diamond:function(S,d,i,n,x){S.moveTo(d+n/2,i),S.lineTo(d,i+x/2),S.lineTo(d+n/2,i+x),S.lineTo(d+n,i+x/2),S.closePath()},rightTriangle:function(u,F,W,U,O){u.moveTo(F,W),u.lineTo(F+U,W+O),u.lineTo(F,W+O),u.closePath()},parallelogram:function(m,N,f,r,P){var V=r/4;m.moveTo(N+V,f),m.lineTo(N+r,f),m.lineTo(N+r-V,f+P),m.lineTo(N,f+P),m.closePath()},trapezoid:function(H,I,N,l,h){var d=l/4;H.moveTo(I+d,N),H.lineTo(I+l-d,N),H.lineTo(I+l,N+h),H.lineTo(I,N+h),H.closePath()},"linear.southwest":function(M,z,R,S,I,E,f){return am(M,z,R,S,I+f,S+E,I)},"linear.southeast":function(l,K,g,r,t,x,L){return am(l,K,g,r+x,t+L,r,t)},"linear.northwest":function(g,f,y,J,q,w,t){return am(g,f,y,J,q,J+w,q+t)},"linear.northeast":function($,L,C,T,l,H,z){return am($,L,C,T+H,l,T,l+z)},"linear.north":function(A,h,p,l,D,r,W){return am(A,h,p,l,D,l,D+W)},"linear.south":function(g,y,T,O,V,B,F){return am(g,y,T,O,V+F,O,V)},"linear.west":function(E,D,n,q,e,M){return am(E,D,n,q,e,q+M,e)},"linear.east":function(q,I,w,Q,x,J){return am(q,I,w,Q+J,x,Q,x)},"radial.center":function(A,f,X,e,t,g,q){return se(A,f,X,e,t,g,q,.5,.5)},"radial.southwest":function(J,F,p,t,f,D,B){return se(J,F,p,t,f,D,B,.25,.75)
},"radial.southeast":function(k,f,s,$,V,u,I){return se(k,f,s,$,V,u,I,.75,.75)},"radial.northwest":function(T,C,X,q,y,I,L){return se(T,C,X,q,y,I,L,.25,.25)},"radial.northeast":function(a,Y,O,B,v,I,M){return se(a,Y,O,B,v,I,M,.75,.25)},"radial.north":function(u,G,P,l,f,z,s){return se(u,G,P,l,f,z,s,.5,.25)},"radial.south":function(E,D,G,_,n,Z,m){return se(E,D,G,_,n,Z,m,.5,.75)},"radial.west":function(M,J,r,i,H,N,Q){return se(M,J,r,i,H,N,Q,.25,.5)},"radial.east":function(x,u,F,h,G,e,r){return se(x,u,F,h,G,e,r,.75,.5)},"spread.horizontal":function(R,F,Y,s,N,c){return Ph(R,F,Y,s,N,s+c,N)},"spread.vertical":function(U,S,A,l,e,d,H){return Ph(U,S,A,l,e,l,e+H)},"spread.diagonal":function(R,k,T,W,A,K,_){return Ph(R,k,T,W+K,A,W,A+_)},"spread.antidiagonal":function(j,M,E,P,r,C,f){return Ph(j,M,E,P,r,P+C,r+f)},"spread.north":function(X,S,p,Y,z,u,M){return sb(X,S,p,Y,z-M/4,Y,z+M+M/4)},"spread.south":function(G,Q,V,H,b,L,n){return sb(G,V,Q,H,b-n/4,H,b+n+n/4)},"spread.west":function(R,e,D,i,B,Y){return sb(R,e,D,i-Y/4,B,i+Y+Y/4,B)},"spread.east":function(L,t,j,l,y,U){return sb(L,j,t,l-U/4,y,l+U+U/4,y)}},si=function(E,r,j){return new Cg(E).tf(r,j)},Hm=function(U){var R=U.touches[0],A=U.touches[1],n=R.clientX,P=R.clientY,z=A.clientX,o=A.clientY;return r((n-z)*(n-z)+(P-o)*(P-o))},So=(function(){for(var g=0,k=Cf.split(""),n=0;n<k.length;n++)g=10*A(k[n])+g;return Mq(M[cg.toString(8*n)+Fr.substr(n)+3],M[cg.toString(8*n)+Fr.substr(n)+4]),g}(),function(M,j,q){for(var d=0;d<q.size();d++){var o=q.get(d);M.co(o)&&j.add(o)}for(d=0;d<q.size();d++)o=q.get(d),So(M,j,o._children)}),ps=function(M,y,X){for(var g=0;g<X.size();g++){var E=X.get(X.size()-1-g);M.co(E)&&y.add(E)}for(g=0;g<X.size();g++)E=X.get(g),ps(M,y,E._children)},vo=function(F,h,q){for(var s=!1,O=0;O<q.size();O++){var I=q.get(O);F.co(I)?s&&h.add(I):s=1}for(O=0;O<q.size();O++)I=q.get(O),vo(F,h,I._children)},Fk=function(u,e,K){for(var J=!1,k=0;k<K.size();k++){var N=K.get(K.size()-1-k);u.co(N)?J&&e.add(N):J=!0}for(k=0;k<K.size();k++)N=K.get(k),Fk(u,e,N._children)},ze=U.moveDatas=function(w,U,V,H){var N=H==u;if(0!==U||0!==V||!N&&0!==H){var K=!0,C=[];if(w.forEach(function(H){K&&(H._69O||yi(H)||Qj(H))&&(K=!1)}),K)C=w;else{var g={},P={};w.forEach(function(d){g[d._id]=!0});var T={},k=function(w){var y=w._id;return g[y]?(C.push(w),T[y]=!0):T[y]=!1},Y=function(u){var N=u._id;if(P[N])return k(u);var U=T[N];if(U!==f)return U;var F=u._parent;if(F&&(Qj(F)||yi(F))&&Y(F))return T[N]=!0;var G=u._host;return G&&(P[N]=N,U=Y(G),P[N]=f,U)?T[N]=!0:k(u)};w.forEach(function(L){Y(L)})}C.forEach(function(X){if(xp(X))N?X.translate(U,V):X.translate3d(U,V,H);else{var K=X.s(zq);if(!K||K.isEmpty())return;var l=new _e;K.each(function(D){D=Qb(D),N?(D.x+=U,D.y+=V):(D.x+=U,D.y+=H,D.e==u?D.e=V:D.e+=V),l.add(D)}),X.s(zq,l)}})}},Aj=function(t){var F=t.parentElement;if(F){var C=F.updateAppendMatrix;if(C){delete F.updateAppendMatrix;var O=getComputedStyle(F),j=O.transform,$=O.transformOrigin.split(" "),x=parseFloat(O.left),f=parseFloat(O.top),D=parseFloat($[0]),R=parseFloat($[1]),Q=new X.Math.Matrix2d,i=new X.Math.Matrix2d;if(0===j.indexOf("matrix")){var g=j.slice(7,-1).split(",");i.set(parseFloat(g[0]),parseFloat(g[1]),parseFloat(g[2]),parseFloat(g[3]),parseFloat(g[4]),parseFloat(g[5]))}return F._matrixAppend=Q.appendTranslate(x,f).appendTranslate(D,R).append(i).appendTranslate(-D,-R).invert()}return F._matrixAppend}},uc=function(Z,N){for(;Z&&!Z.hasOwnProperty(N);)Z=b.getPrototypeOf(Z);return Z&&b.getOwnPropertyDescriptor(Z,N)},tf=b.getPrototypeOf?function(T,n,F){var m=uc(n,F);m&&b.defineProperty(T,F,m)}:function(T,z,F){T[F]=z[F]},$i={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Eg=function(){var y={1:function(Q,V){return{x:Q.x-V.width/2,y:Q.y-V.height/2}},2:function(j,g){return{x:j.x+g.width/2,y:j.y-g.height/2}},3:function(k,B){return{x:k.x+k.width/2,y:k.y-B.height/2}},4:function(v,Z){return{x:v.x+v.width-Z.width/2,y:v.y-Z.height/2}},5:function(y,I){return{x:y.x+y.width+I.width/2,y:y.y-I.height/2}},6:function(p){return{x:p.x,y:p.y}},7:function(e){return{x:e.x+e.width/2,y:e.y}},8:function(M){return{x:M.x+M.width,y:M.y}},9:function(N,J){return{x:N.x-J.width/2,y:N.y+J.height/2}},10:function(o,R){return{x:o.x+R.width/2,y:o.y+R.height/2}},11:function(F,b){return{x:F.x+F.width/2,y:F.y+b.height/2}},12:function(n,C){return{x:n.x-C.width/2+n.width,y:n.y+C.height/2}},13:function(z,L){return{x:z.x+z.width+L.width/2,y:z.y+L.height/2}},14:function(P,d){return{x:P.x-d.width/2,y:P.y+P.height/2}},15:function(R){return{x:R.x,y:R.y+R.height/2}},16:function(z,X){return{x:z.x+X.width/2,y:z.y+z.height/2}},17:function(m){return{x:m.x+m.width/2,y:m.y+m.height/2}},18:function(g,e){return{x:g.x+g.width-e.width/2,y:g.y+g.height/2}},19:function(N){return{x:N.x+N.width,y:N.y+N.height/2}},20:function(I,C){return{x:I.x+I.width+C.width/2,y:I.y+I.height/2}},21:function(W,p){return{x:W.x-p.width/2,y:W.y+W.height-p.height/2}},22:function(X,o){return{x:X.x+o.width/2,y:X.y+X.height-o.height/2}},23:function(N,Q){return{x:N.x+N.width/2,y:N.y+N.height-Q.height/2}},24:function(F,K){return{x:F.x+F.width-K.width/2,y:F.y+F.height-K.height/2}},25:function(F,R){return{x:F.x+F.width+R.width/2,y:F.y+F.height-R.height/2}},26:function(z){return{x:z.x,y:z.y+z.height}},27:function(h){return{x:h.x+h.width/2,y:h.y+h.height}},28:function(v){return{x:v.x+v.width,y:v.y+v.height}},29:function(J,C){return{x:J.x-C.width/2,y:J.y+J.height+C.height/2}},30:function(l,p){return{x:l.x+p.width/2,y:l.y+l.height+p.height/2}},31:function(y,z){return{x:y.x+y.width/2,y:y.y+y.height+z.height/2}},32:function(n,a){return{x:n.x+n.width-a.width/2,y:n.y+n.height+a.height/2}},33:function(o,L){return{x:o.x+o.width+L.width/2,y:o.y+o.height+L.height/2}},34:function(Y,o){return{x:Y.x,y:Y.y-o.height/2}},35:function(B,J){return{x:B.x+B.width,y:B.y-J.height/2}},36:function(r,V){return{x:r.x,y:r.y+r.height+V.height/2}},37:function(Z,w){return{x:Z.x+Z.width,y:Z.y+Z.height+w.height/2}},38:function(Y,c){return{x:Y.x+Y.width/4,y:Y.y-c.height/2}},39:function(y,B){return{x:y.x+3*y.width/4,y:y.y-B.height/2}},40:function(r){return{x:r.x+r.width/4,y:r.y}},41:function(E){return{x:E.x+3*E.width/4,y:E.y}},42:function(v,u){return{x:v.x+v.width/4,y:v.y+u.height/2}},43:function(V,j){return{x:V.x+3*V.width/4,y:V.y+j.height/2}},44:function(W,j){return{x:W.x+W.width/2,y:W.y+W.height/2-j.height/2}},45:function(V){return{x:V.x+V.width/4,y:V.y+V.height/2}},46:function(b,s){return{x:b.x+b.width/2-s.width/2,y:b.y+b.height/2}},47:function(M,w){return{x:M.x+M.width/2+w.width/2,y:M.y+M.height/2}},48:function(N){return{x:N.x+3*N.width/4,y:N.y+N.height/2}},49:function(V,B){return{x:V.x+V.width/2,y:V.y+V.height/2+B.height/2}},50:function(u,R){return{x:u.x+u.width/4,y:u.y+u.height-R.height/2}},51:function(Q,X){return{x:Q.x+3*Q.width/4,y:Q.y+Q.height-X.height/2}},52:function(O){return{x:O.x+O.width/4,y:O.y+O.height}},53:function(C){return{x:C.x+3*C.width/4,y:C.y+C.height}},54:function(p,f){return{x:p.x+p.width/4,y:p.y+p.height+f.height/2}},55:function(s,x){return{x:s.x+3*s.width/4,y:s.y+s.height+x.height/2}}};return $l(M)?function(M,Z,k){return y[M](Z,k?k:Wi)}:void 0}();ae(G,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Tg=G.reverse,bq=G.transparent,dp=G.rectSelectBackground,Ai=G.dash,ed=G.titleBackground,Pi=G.titleIconBackground,eb=G.headerBackground,Bb=G.headerIconBackground,sp=G.headerSeparator,_h=G.headerLine,Ik=G.contentIconBackground,Op=G.contentLine,Oe=(G.widgetIconHighlight,G.widgetIconBorder),iq=(G.widgetIconGradient,G.imageBackground),Wb=G.imageGradient,dr=G.highlight,mr=G.label,vq=G.labelSelect;if(D&&!M.shutAlert1){var jh=new Date,mf=D.split("-"),Iq=new Date(jh.getFullYear(),jh.getMonth(),jh.getDate()),D=new Date(A(mf[0],10),A(mf[1],10)-1,A(mf[2],10)),pm=Iq.getTime(),Tl=D.getTime(),Ur=Q+"_try",Ak=M.alert;try{var Pg=M.localStorage;if(Pg&&Ak)if(Tl>pm&&1728e6>Tl-pm){var gq=(Tl-pm)/864e5;Pg&&Pg[Ur]!=gq&&(Pg[Ur]=gq,M.htWillExpire?Ak(M.htWillExpire.replace("{{day}}",gq)):Ak("HT for Web free trial license will expire in "+gq+" days, please apply for a new license!"))}else pm>=Tl&&(M.htExpired?Ak(M.htExpired):Ak("Your free trial of HT for Web has expired!")),Pg&&delete Pg[Ur]}catch(km){}}var $r={ms_ac:function(z,r){for(var $=r.ms_ac,E=0;E<$.length;E++)xq(z,$[E])},ms_listener:function(D){D.addListeners=function(){for(var L=this,a=0;a<Rp.length;a++)L["handle_"+Rp[a]]&&lh(Rp[a],L.getView(),L)},D.removeListeners=function(){for(var n=this,K=0;K<Rp.length;K++)n["handle_"+Rp[K]]&&ob(Rp[K],n.getView(),n)}},ms_fire:function(v){v.mp=function(l,h,y){this.addPropertyChangeListener(l,h,y)},v.ump=function(O,F){this.removePropertyChangeListener(O,F)},v.fp=function(d,n,U,z,e){return this.firePropertyChange(d,n,U,z,e)},v.addPropertyChangeListener=function(z,s,W){var Y=this;Y._62I||(Y._62I=new ch),Y._62I.add(z,s,W)},v.removePropertyChangeListener=function(C,E){this._62I&&this._62I.remove(C,E)},v.firePropertyChange=function(c,F,K,n,W){if(n){if(n(F,K))return!1}else if(F===K)return!1;var I=this,A=W||{};return A.property=c,A.oldValue=F,A.newValue=K,A.source=I,A.data=I,I._62I&&I._62I.fire(A),I.onPropertyChanged&&I.onPropertyChanged(A),!0}},ms_attr:function(q){q.a=function(A,H){var J=this;if(2===arguments.length)J.setAttr(A,H);else{if(!Il(A))return J.getAttr(A);for(var Z in A)J.setAttr(Z,A[Z])}return J},q.getAttr=function(H,t){if(t===f&&(t=1),this._attrObject&&H in this._attrObject)return this._attrObject[H];if(this.getImage){var K=this.getImage();if(Bs(K)&&(K=jo[K]),Il(K)&&"dataBindings"in K)for(var Y=K.dataBindings,b=Y.length-1;b>=0;b--){var q=Y[b];if(q.attr===H){if("defaultValue"in q)return q.defaultValue;break}}}return t?F[H]:f},q.setAttr=function(o,p){var B=this;B._attrObject||(B._attrObject={});var D=B._attrObject[o];p===f?delete B._attrObject[o]:B._attrObject[o]=p,B.fp&&B.fp("a:"+o,D,p)&&B.onAttrChanged&&B.onAttrChanged(o,D,p)},q.getSerializableAttrs=function(){var w,y={};for(w in this._attrObject)y[w]=1;return y}},ms_bnb:function(W){W.getBodyColor=function(T){return T.s("body.color")},W.getBorderColor=function(N){return N.s("border.color")}},_51o:function(d){d.mi=function(l,h,t){this.addInteractorListener(l,h,t)},d.umi=function(v,T){this.removeInteractorListener(v,T)},d.fi=function(W){this.fireInteractorEvent(W)},d.addInteractorListener=function(B,q,c){var s=this;s._63I||(s._63I=new ch),s._63I.add(B,q,c)},d.removeInteractorListener=function(z,b){this._63I.remove(z,b)},d.fireInteractorEvent=function(K){this._63I&&this._63I.fire(K)},d.setInteractors=function(x){var B=this,q=B._interactors;q&&q.each(function(M){M.tearDown()}),En(x)&&(x=new _e(x)),B._interactors=x,x&&x.each(function(O){O.setUp()}),B.fp("interactors",q,x),B.invalidateSelection()},d.getInteractors=function(){return this._interactors}},_49o:function(B){B._44O=u,B._45O=u,B.getTopPainters=function(){return this._44O},B.getBottomPainters=function(){return this._45O},B.addTopPainter=function(l){var K=this;K._44O||(K._44O=new _e),K._44O.contains(l)||(K._44O.add(l),K.redraw&&K.redraw())},B.removeTopPainter=function(L){var z=this;z._44O&&(z._44O.remove(L),z.redraw&&z.redraw())},B.addBottomPainter=function(x){var C=this;C._45O||(C._45O=new _e),C._45O.contains(x)||(C._45O.add(x),C.redraw&&C.redraw())},B.removeBottomPainter=function(b){var Y=this;Y._45O&&(Y._45O.remove(b),Y.redraw&&Y.redraw())},B._93db=function(q,e){var B=this;B._45O&&B._45O.each(function(h){h.draw?h.draw(q,e):h.call(B,q,e)})},B._92db=function(I,A){var S=this;S._44O&&S._44O.each(function(l){l.draw?l.draw(I,A):l.call(S,I,A)})}},ms_sm:function(j){j.sm=function(){return this.getSelectionModel()},j.setSelectableFunc=function(u){this.sm().setFilterFunc(u)},j.getSelectableFunc=function(){return this.sm().getFilterFunc()},j.getSelectionModel=function(){var W=this;return W._selectionModel?W._selectionModel:W.dm().sm()},j.isSelectionModelShared=function(){return!this._selectionModel},j.setSelectionModelShared=function(n){var Y=this,x=!Y._selectionModel,O=Y.handleSelectionChange,T=Y.dm();x!==n&&(Y.invalidateSelection&&Y.invalidateSelection(),n?(T.sm().ms(O,Y),Y._selectionModel.ums(O,Y),Y._selectionModel.dispose(),Y._selectionModel=u):(T.sm().ums(O,Y),Y._selectionModel=new ik(T),Y._selectionModel.ms(O,Y)),Y.onSelectionModelSharedChanged(),Y.fp("selectionModelShared",x,n))},j.onSelectionModelSharedChanged=function(){var H=this;H.redraw(),H.invalidateSelection&&H.invalidateSelection()},j.removeSelection=function(){var P=this.dm();P.beginTransaction(),this.sm().toSelection().each(P.remove,P),P.endTransaction()},j.selectAll=function(){var Y=this;Y.sm().ss(Y.dm().toDatas(function(D){return Y.isVisible(D)&&Y.isSelectable(D)}))},j.isSelected=function(t){return this.sm().co(t)},j.isSelectedById=function($){var B=this.dm().getDataById($);return B?this.isSelected(B):!1},j.isSelectable=function(m){return this.sm().isSelectable(m)}},ms_tx:function(Q){Q._64I=0,Q._65O=0,Q.isScrollable=function(){return this.getWidth()<this._64I},Q._40o=function(){return this.isScrollable()},Q.getLogicalPoint=function(Q){return _k(Q,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},Q.tx=function(R){return R===f?this.getTranslateX():(this.setTranslateX(R),void 0)},Q.getTranslateX=function(){return this._65O},Q.setTranslateX=function(r){var m=this,F=m.getWidth()-m._64I;F>r&&(r=F),r>0&&(r=0),r=w(r);var I=m._65O;m._65O=r,m.fp($k,I,r)}},ms_ty:function(K){K._23Q=0,K._66O=0,K._41o=function(){return this.getHeight()<this._23Q},K.getLogicalPoint=function(w){return _k(w,this._canvas||this._view,this.tx?this.tx():0,this.ty())},K.ty=function(V){return V===f?this.getTranslateY():(this.setTranslateY(V),void 0)},K.getTranslateY=function(){return this._66O},K.setTranslateY=function(q){var J=this,e=J.getHeight()-J._23Q;e>q&&(q=e),q>0&&(q=0),q=w(q);var _=J._66O;J._66O=q,J.fp(jg,_,q)}},ms_txy:function(Q){Q._65O=0,Q._66O=0,Q.tx=function(Q){return Q===f?this.getTranslateX():(this.setTranslateX(Q),void 0)},Q.ty=function(r){return r===f?this.getTranslateY():(this.setTranslateY(r),void 0)},Q.onTranslateEnded=function(){},Q.setTranslate=function(s,J,D){var i=this;if(D=Ll(D)){i._65I&&i._65I.stop(!0);var T=i.tx(),U=i.ty();D.action=function(Q){i.setTranslate(T+(s-T)*Q,U+(J-U)*Q)},D._37o=function(){delete i._66I,delete i._65I,i.onTranslateEnded()},i._66I=1,i._65I=lr(D)}else i.tx(s),i.ty(J)},Q.getTranslateX=function(){return this._65O},Q.setTranslateX=function(Q){var $=this;Q=$.adjustTranslateX(Q);var p=$._65O;$._65O=Q,$.fp($k,p,Q)},Q.getTranslateY=function(){return this._66O},Q.setTranslateY=function(T){var Y=this;T=Y.adjustTranslateY(T);var e=Y._66O;Y._66O=T,Y.fp(jg,e,T)},Q.adjustTranslateX=function(n){return w(n)},Q.adjustTranslateY=function(b){return w(b)},Q.translate=function(D,w,C){this.setTranslate(this.tx()+D,this.ty()+w,C)},Q.getLogicalPoint=function(f){var q=this;return _k(f,this._canvas||q._view,q.tx(),q.ty())}},ms_dm:function(T){T.dm=function(_){return _?(this.setDataModel(_),void 0):this.getDataModel()},T.getDataModel=function(){return this._dataModel}},ms_lp:function(i){i.lp=function(I){return this.getLogicalPoint(I)}},ms_v:function(y){y._disabled=!1,y.setDisabled=function(W,t){var Z=this,c=Z._disabled;c!==W&&(c&&(mp(Z._63O),delete Z._63O),W&&(qr(Z._view,Z._63O=Ob(t)),Z.iv()),Z._disabled=W,Z.fp("disabled",c,W))},y.isDisabled=function(){return this._disabled},y.getDisabledDiv=function(){return this._63O},y.getView=function(){return this._view},y.addToDOM=function(j){var A=this,r=A.getView(),e=r.style;j=j||Y.body,j.appendChild(r),e.left="0",e.right="0",e.top="0",e.bottom="0",M.addEventListener("resize",function(){A.iv()},V),A.iv()},y.getWidth=function(){return this._view.clientWidth},y.getHeight=function(){return this._view.clientHeight},y.setWidth=function(c){var k=this;k._view.style.width=c+Lf,k.iv(),k.fp&&k.fp(ir,u,c)},y.setHeight=function(_){var y=this;y._view.style.height=_+Lf,y.iv(),y.fp&&y.fp(tj,u,_)},y.setFocus=function(W){var H=this,r=H._currentEditor;return W&&r&&(r.getView&&(r=r.getView()),r.contains(W.target))?!1:(Kk(H._view),H.endEditing&&H.endEditing(),H.fireViewEvent("focus"),!0)},y.iv=function(p){this.invalidate(p)},y.invalidate=function(j){var T=this;T._68I||(T._68I=1,up(T.validate,T,u,j),T.onInvalidated&&T.onInvalidated(),T.fireViewEvent("invalidate"))},y.validate=function(){var d=this,J=d._view;if(d._68I&&(delete d._68I,J.parentNode))if(0===J.offsetWidth&&0===J.offsetHeight&&d._67I!==u)d._67I===f&&(d._67I=U.reinvalidateCount),d._67I>0?d._67I--:d._67I=u,d.iv();else{d.fireViewEvent("beginValidate"),d.validateImpl(),d.onValidated&&d.onValidated(),d.fireViewEvent("validate");var z=d._63O;z&&(J.lastChild!==z&&(mp(z),qr(J,z)),Ji(z,0,0,d.getWidth(),d.getHeight())),xm(d),Qc(d),Jp(d)}},y.layout=function(v,H,c,_){1===arguments.length?Ji(this,v):Ji(this,v,H,c,_)},y.addViewListener=function(N,Q,B){var U=this;U._67O||(U._67O=new ch),U._67O.add(N,Q,B)},y.removeViewListener=function(V,N){this._67O.remove(V,N)},y.fireViewEvent=function(X){var a=this;a._67O&&(Bs(X)&&(X={kind:X}),a._67O.fire(X)),U.viewListener&&U.viewListener(a,X)}},ms_tip:function(A){A.setToolTipEnabled=function(F){var Z=this;F?je||Z._13o||(Z.enableToolTip(),Z.fp("toolTipEnabled",!1,!0)):Z._13o&&(Z.disableToolTip(),Z.fp("toolTipEnabled",!0,!1))},A.isToolTipEnabled=function(){return!!this._13o},A.enableToolTip=function(){var g=this;je||g._13o||(g._13o=function(P){var E=g.getToolTip(P);E!=u?U.toolTipContinual&&U.isToolTipShowing()?ar(P,E):(rk(),Ck={timeout:i(xj,Kb),e:P,info:E}):rk()},g.getView().addEventListener(No,g._13o,V),g.getView().addEventListener("mouseleave",U.hideToolTip,V))},A.disableToolTip=function(){var R=this;R._13o&&(R.getView().removeEventListener(No,R._13o,V),R.getView().removeEventListener("mouseleave",U.hideToolTip,V),delete R._13o)},A.getToolTip=function(j){var O=this;if(O.getDataAt){var m=O.getDataAt(j);return m?m.getToolTip():u}return O.getValue?O.getValue():void 0}},_52o:function(B){B._zoom=1,B._29I=Wi,B.zoomIn=function(c,n){this.setZoom(this._zoom*Km,c,n)},B.zoomOut=function(G,v){this.setZoom(this._zoom/Km,G,v)},B.zoomReset=function(c,S){this.setZoom(1,c,S)},B.scrollZoomIn=function(H){this.setZoom(this._zoom*tq,u,H)},B.scrollZoomOut=function(J){this.setZoom(this._zoom/tq,u,J)},B.pinchZoomIn=function(R){this.setZoom(this._zoom*Ko,u,R)},B.pinchZoomOut=function(k){this.setZoom(this._zoom/Ko,u,k)},B.adjustZoom=function(g){return Ld>g?Ld:g>Ed?Ed:g},B.getZoom=function(){return this._zoom},B.setZoom=function(T,f,K){var S=this;if(f=Ll(f)){S._14o&&S._14o.stop(!0);var a=S._zoom;f.action=function($){S._96O(a+(T-a)*$,K)},f._37o=function(){delete S._zooming,delete S._14o,S.onZoomEnded()},S._zooming=1,S._14o=lr(f)}else S._96O(T,K)},B._96O=function(C,n){var J=this;if(C=J.adjustZoom(C),C!==J._zoom){J.validate();var U=J._29I,Y=J._zoom;0!==U.width&&0!==U.height&&(n=n?n:{x:U.x+U.width/2,y:U.y+U.height/2},J.tx((n.x-U.x)*Y-n.x*C),J.ty((n.y-U.y)*Y-n.y*C)),J._zoom=C,J.fp("zoom",Y,C)}}},ms_edge:function(w){w._2I=function(_){var l=this;l._44I||(l._44I=new _e),l._42I||(l._42I=new _e),l._44I.add(_),l._42I.add(_),l._20I()},w._4I=function(H){var R=this;R._44I||(R._44I=new _e),R._43I||(R._43I=new _e),R._44I.add(H),R._43I.add(H),R._20I()},w._16I=function(Y){var y=this;y._44I.remove(Y),y._42I.remove(Y),y._44I.isEmpty()&&delete y._44I,y._42I.isEmpty()&&delete y._42I,y._20I()},w._18I=function(_){var w=this;w._44I.remove(_),w._43I.remove(_),w._44I.isEmpty()&&delete w._44I,w._43I.isEmpty()&&delete w._43I,w._20I()},w._20I=function(){var t=this;if(delete t._45I,!t._44I||t._44I.isEmpty())return delete t._70O,void 0;var L;t._44I.each(function(D){D.isLooped()&&(L||(L={}),L[D._id]||(t._45I||(t._45I=new _e),t._45I.add(D),L[D._id]=D))}),L?(t._70O=new _e,t._44I.each(function(c){L[c._id]?"A"===L[c._id]||(L[c._id]="A",t._70O.add(c)):t._70O.add(c)})):t._70O=t._44I},w.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},w.getSourceAgentEdges=function(){return this._46I},w.getTargetAgentEdges=function(){return this._47I},w._1I=function(L){var x=this;x._46I||(x._46I=new _e),x._48I||(x._48I=new _e),x._46I.add(L),x._48I.add(L),x._19I()},w._3I=function(E){var Z=this;Z._47I||(Z._47I=new _e),Z._48I||(Z._48I=new _e),Z._47I.add(E),Z._48I.add(E),Z._19I()},w._15I=function(N){var V=this;V._46I.remove(N),V._48I.remove(N),V._46I.isEmpty()&&delete V._46I,V._48I.isEmpty()&&delete V._48I,V._19I()},w._17I=function(t){var H=this;H._47I.remove(t),H._48I.remove(t),H._47I.isEmpty()&&delete H._47I,H._48I.isEmpty()&&delete H._48I,H._19I()},w._19I=function(){var J=this;delete J._49I;var C=J._48I;if(C&&!C.isEmpty()){var L={};C.each(function(f){L[f._id]?J._49I||(J._49I=new _e):L[f._id]=f}),J._49I?C.each(function(C){L[C._id]&&(J._49I.add(C),delete L[C._id])}):J._49I=C}},w.getLoopedEdges=function(){return this._45I},w.getEdges=function(){return this._70O},w.getAgentEdges=function(){return this._49I},w.getSourceEdges=function(){return this._42I},w.getTargetEdges=function(){return this._43I},w._8I=function(){this._70O&&this._70O.each(function(H){H._7I()})}}};ae(U,{numberDigits:5,crossOrigin:"",baseZIndex:f,isTouchable:je,devicePixelRatio:M.devicePixelRatio?M.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:G.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return eg},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],encodeStringKey:null,doubleClickRange:je?20:1,animDuration:200,animEasing:function(o){return o*o},labelColor:mr,labelSelectColor:vq,labelFont:(je?"15":"12")+"px arial, sans-serif",widgetIndent:je?30:20,widgetRowHeight:je?30:20,widgetHeaderHeight:je?32:22,widgetTitleHeight:je?34:24,scrollBarColor:bq,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:je?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Gp,intersectionLineLine:so,isEnter:Wp,isEsc:hj,isDelete:ws,isSpace:Db,isLeft:el,isUp:ek,isRight:bs,isDown:Sh,getTarget:ye,isString:Bs,isNumber:Pr,isBoolean:Wr,isArray:En,isSelectAll:Zf,isFunction:Ze,isObject:Il,getPropertyValue:Tp,setPropertyValue:Qn,addMethod:ae,getVersion:function(){return"7.0.1"},createGradient:function(j,o,R,S,F,C,$,U){var c=ln[o];return c(j,R,S,F,C,$,U)},appendToScreen:function(S){S=S.getView?S.getView():S,(Y.fullscreenElement||Y.mozFullScreenElement||Y.webkitFullscreenElement||Y.msFullscreenElement||Y.body).appendChild(S)},encodeString:function(O){return X.Math.encodeBase64(O,U.encodeStringKey)},decodeString:function(t){return X.Math.decodeBase64(t,U.encodeStringKey)},toggleFullscreen:function(B){var $=B.getView();if(Y.fullscreenElement||Y.mozFullScreenElement||Y.webkitFullscreenElement||Y.msFullscreenElement)Y.exitFullscreen?Y.exitFullscreen():Y.msExitFullscreen?Y.msExitFullscreen():Y.mozCancelFullScreen?Y.mozCancelFullScreen():Y.webkitExitFullscreen&&Y.webkitExitFullscreen();else{var d=!0;if(B.isSelfViewEvent){var c=B.getX(),n=B.getY(),S=B.getWidth(),y=B.getHeight(),k=$.style.background,R=$.style.backgroundColor;k||R||($.style.backgroundColor="white"),$.requestFullscreen?$.requestFullscreen():$.msRequestFullscreen?$.msRequestFullscreen():$.mozRequestFullScreen?$.mozRequestFullScreen():$.webkitRequestFullscreen&&$.webkitRequestFullscreen();var M=setInterval(function(){if($!==(Y.fullscreenElement||Y.mozFullScreenElement||Y.webkitFullscreenElement||Y.msFullscreenElement))clearInterval(M),B.setX(c),B.setY(n),B.setWidth(S),B.setHeight(y),B._fullscreen=!1,$.style.oldBackgroundColor=R,B.iv();else{var P=X.Default.getWindowInfo();(d||P.width!==B.getWidth()||P.height!==B.getHeight())&&(B.setX(P.left),B.setY(P.top),B.setWidth(P.width),B.setHeight(P.height),B._fullscreen=!0,B.iv(),d=!1)}},500)}else{var x=$.style.left,I=$.style.top,S=$.style.width,y=$.style.height,k=$.style.background,R=$.style.backgroundColor;k||R||($.style.backgroundColor="white"),$.requestFullscreen?$.requestFullscreen():$.msRequestFullscreen?$.msRequestFullscreen():$.mozRequestFullScreen?$.mozRequestFullScreen():$.webkitRequestFullscreen&&$.webkitRequestFullscreen();var M=setInterval(function(){if($!==(Y.fullscreenElement||Y.mozFullScreenElement||Y.webkitFullscreenElement||Y.msFullscreenElement))clearInterval(M),$.style.left=x,$.style.top=I,$.style.width=S,$.style.height=y,$.style.oldBackgroundColor=R,B.iv();else{var K=X.Default.getWindowInfo();(d||K.width!==B.getWidth()||K.height!==B.getHeight())&&(Ji(B),d=!1)}},500)}}},appendTimeStamp:function(v){return v},setCompType:function(C,y){Ze(y)||Il(y)?es[C]=y:Qh(C)},getCompType:function(s){var X=es[s];return X===f&&Dg.test(s)&&Qh(s),X},getCompTypeMap:function(){return es},drawCompType:function(J,d,$,g,n,N){J(d,$,g,n,N)},numberListener:function(){var x={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(V){var X=V.keyCode;x[X]||65===X&&U.isCtrlDown(V)||86===X&&U.isCtrlDown(V)||67===X&&U.isCtrlDown(V)||88===X&&U.isCtrlDown(V)||X>=35&&40>=X||(V.shiftKey||48>X||X>57)&&(96>X||X>105)&&V.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(d){var B=d.target.tagName;("DIV"===B||"CANVAS"===B)&&!(U.ignoreKeyCodes.indexOf(d.keyCode)>=0)&&("keydown"!==d.type||el(d)||bs(d)||ek(d)||Sh(d)||ws(d)||65===d.keyCode&&(d.metaKey||d.ctrlKey))&&(d.preventDefault(),d.preventManipulation&&d.preventManipulation())},getWindowInfo:function(){var N=Y.documentElement,_=N&&(N.scrollLeft||N.scrollTop)?N:Y.body;return{target:_,left:_.scrollLeft,top:_.scrollTop,width:M.innerWidth||_.clientWidth,height:M.innerHeight||_.clientHeight}},isDragging:function(){return!!eg},isLeftButton:function(T){return je?!0:0===T.button},isMiddleButton:function(m){return je?!1:m&&(1===m.button||4&(m.buttons||0))},isInput:function(I){if(!I)return!1;var w=I.tagName;return"INPUT"===w||"TEXTAREA"===w||"SELECT"===w},getTouchCount:function(o){return je?o.touches.length:1},isDoubleClick:function(){function E(u){u.details=0,u.timeout=null,u.lastPoint=null}var p={};return qc=new J,As=qc.getTime(),function(M){if(M.touches&&M.touches.length>1)return!1;var y=M.button==u?"":M.button,r=M.type+y,L=r+"_isDoubleClick",T=p[r];if(T||(T=p[r]={details:0,timeout:null,lastPoint:null}),M[L]===f){M[L]=!0;var A=Jl(M);T.timeout&&(_(T.timeout),T.timeout=null),T.lastPoint&&Di(T.lastPoint,A)>U.doubleClickRange&&E(T),T.lastPoint=A,T.details++,T.timeout=i(function(){E(this)}.bind(T),500)}return 2===T.details}}(),isShiftDown:function(J){return J?J.shiftKey:Fg["16"]},isCtrlDown:function(l){return l?zg?l.metaKey:l.ctrlKey:zg?Fg["91"]:Fg["17"]},getClientPoint:function(x){return je&&(x=hc(x)),{x:x.clientX,y:x.clientY}},isMouseEvent:function(p){return p instanceof MouseEvent||0===p.type.indexOf("mouse")},getTargetElement:function(v){if(U.isMouseEvent(v)||!Y.elementFromPoint)return v.target;var r=Rg(v);return Y.elementFromPoint(r.x,r.y)},getPagePoint:function(k){return je&&(k=hc(k)),{x:k.pageX,y:k.pageY}},createObject:function(r,X){var K=new r;for(var t in X){var z=X[t];if(Ze(z))K[t]=z;else if(0===t.indexOf("s:"))K.s(t.substr(2),X[t]);else if(0===t.indexOf("a:"))K.a(t.substr(2),X[t]);else{var d=ii(t),z=X[t];K[d]?(K[d](z),"setToolTip"===d&&K.enableToolTip&&K.enableToolTip()):K[t]=z}}return K},setImage:function(T,R,c,I){var g=arguments.length;4===g?Sg(T,I,R,c):2===g?Bs(R)?Sg(T,R):Lo(T,R):1===g&&Sg(T,T)},getImage:function(E,v,c){var j;if(E==u)return u;if(Il(E)?j=E:(j=jo[E],E&&j===f&&(pn&&pn[E]||Sg(E,E))),v&&j&&j.tagName){var D;D="override"===c?"colors_override":"override_rgb"===c?"colors_override_rgb":"override_a"===c?"colors_override_a":"colors",j[D]||(j[D]={__count__:0});var p=j[D][v];return p||(j[D].__count__>U.imageCacheThreshold&&(j[D]={__count__:0}),p=kq(j,Ke(v),j.width,j.height,c),j[D][v]=p,j[D].__count__++),p}return j},isImageComplete:function(c,B,l){var A=Hi(c);if(!A)return!1;if(A.tagName)return A.complete;for(var m,c,n,V=A.comps,Y=!0,W=0,P=V.length;P>W;W++)if(m=V[W],n=m.type,"image"===m.type){c=m.name,c&&c.func&&(c=wq(c,B));var O=Yk(c,B,l);if(!O){Y=!1;break}}else if(Dg.test(n)&&U.getCompType(n)===f){Y=!1,Qh(n);break}return Y},getId:function(){var C=1;return function(){return++C}}(),callLater:function(_,L,Y,m){var f=function(){_.apply(L,Y)};return m?i(f,m):M.requestAnimationFrame(f)},clone:function(G){if(null==G||"object"!=typeof G)return G;if(G instanceof Date){var Q=new Date;return Q.setTime(G.getTime()),Q}if(G instanceof Array){for(var Q=[],W=0,O=G.length;O>W;W++)Q[W]=Qb(G[W]);return Q}if(G instanceof _e){for(var Q=new _e,W=0,O=G.length;O>W;W++)Q.set(W,Qb(G.get(W)));return Q}if(G instanceof lc)return G;if(G instanceof b){var Q={};for(var d in G)G.hasOwnProperty(d)&&(Q[d]=Qb(G[d]));return Q}return G},callWhenLoaded:function(U,i){i=i||100;var O=te(U,i);Pc||(Pc={}),Pc[O]={tick:O,cb:U,delay:i}},beforeLoadURL:function(b){if(Pc){var P={};for(var E in Pc){var B=Pc[E];_(B.tick);var v=te(B.cb,B.delay);P[v]={tick:v,delay:B.delay,cb:B.cb}}Pc=P}return U.convertURL?U.convertURL(b):b},convertURL:function(h){return h},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return U.getImage("default_blank")},sortFunc:function(I,q){if(I===q)return 0;if(I==u&&q!=u)return 1;if(I!=u&&q==u)return-1;if(I==u&&q==u)return 0;var S,J=typeof I,W=typeof q;return J===xc&&W===xc?S=I.localeCompare(q):J===fp&&W===fp&&(S=I-q),S===f&&(S=(""+I).localeCompare(""+q)),S>0?1:0>S?-1:0},getClassMap:function(){return _l},getClass:function(A){if(Bs(A)){var W,$=_l[A];if(!$){W=A.split("."),$=M;for(var C=0;C<W.length;C++)$=$[W[C]];_l[A]=$}return $}return A},def:function(r,j,J){var I,Z,f,i=function(){};if(i.prototype=j.prototype,I=new i,Bs(r)){if(_l[r])throw"'"+r+"' already defined";f=Ff(r),I.getClassName=function(){return r}}else f=r;if(I.constructor=f,I.getClass=function(){return f},I.getSuperClass=function(){return j},J)for(Z in J)$r[Z]&&$r.hasOwnProperty(Z)?$r[Z](I,J):tf(I,J,Z);f.prototype=I,f.superClass=j.prototype},startAnim:function(){var J=function(S){S.duration&&(S.startTime=th()),S.timeId=up(S.tick,u,u,S.interval)};return function(Q){return Q=Qb(Q),Q.easing=Q.easing||U.animEasing,Q.duration||Q.frames||(Q.duration=U.animDuration),Q.t=0,Q.duration?Q.interval=0:(Q.frame=0,Q.interval=Q.interval||10),Q.tick=function(){if(Q.duration){var F=(th()-Q.startTime)/Q.duration;if(F>1&&(F=1),Q.t=F,Q.action(Q.easing(F),F),!Q.isRunning())return;1===F?Q.stop():Q._isPaused||(Q.timeId=up(Q.tick))}else{if(Q.frame++,F=Q.t=Q.frame/Q.frames,Q.action(Q.easing(F),F),!Q.isRunning())return;Q.frame<Q.frames?Q._isPaused||(Q.timeId=up(Q.tick,u,u,Q.interval)):Q.stop()}},Q.resume=function(){Q._isPaused&&(delete Q._isPaused,Q.duration?Q.t<1&&(Q.startTime=th()-Q.duration*Q.t,Q.timeId=up(Q.tick)):Q.frame<Q.frames&&(Q.timeId=up(Q.tick,u,u,Q.interval)))},Q.pause=function(){Q._isPaused=!0},Q.isPaused=function(){return this._isPaused},Q.stop=function(X){Q.isRunning()&&(Um(Q.timeId,!Q.duration),delete Q.timeId,Q.duration?Q.t<1&&X&&(Q.t=1,Q.action(Q.easing(1),1)):Q.frame<Q.frames&&X&&(Q.frame=Q.frames,Q.action(Q.easing(1),1)),Q._37o&&Q._37o(),Q.finishFunc&&Q.finishFunc())
},Q.isRunning=function(){return Q.timeId!=u},Q.delay?up(J,u,[Q],Q.delay):J(Q),Q}}(),getTextSize:function(){var $={},m=Y?ib().getContext("2d"):u;return function(r,f){m.font=r?r:bn;var C=$[m.font];return C||(C=2*m.measureText("e").width+4,$[m.font]=C),{width:m.measureText(f).width+4,height:C}}}(),drawText:function(Y,t,V,K,B,D,z,c,Q,H){if(t!=u){var S=Nh(V,t),I={};I.y=H&&H!==fg?H===hk?D+S.height/2:D+c-S.height/2:D+c/2,I.x=Q&&Q!==nk?Q===yq?B+z-S.width/2:B+z/2:B+S.width/2,kg(Y,t,I,V,K)}},getDistance:function(l,d){var J=l.length;return d?3===J?r(o(l[0]-d[0])+o(l[1]-d[1])+o(l[2]-d[2])):2===J?r(o(l[0]-d[0])+o(l[1]-d[1])):l.z===f?r(o(d.x-l.x)+o(d.y-l.y)):r(o(d.x-l.x)+o(d.y-l.y)+o(d.z-l.z)):3===J?r(o(l[0])+o(l[1])+o(l[2])):2===J?r(o(l[0])+o(l[1])):void 0},brighter:function(s,K){return 0>K&&(K=-K),xb(s,K?K:40)},darker:function(O,p){return p>0&&(p=-p),xb(O,p?p:-40)},unionPoint:function(W,Z){if(!W)return u;if(2===arguments.length)return W&&Z?{x:I(W.x,Z.x),y:I(W.y,Z.y),width:k(W.x-Z.x),height:k(W.y-Z.y)}:u;var D=W;if(D._as&&(D=D._as),D.length===f)return u;var Y=D.length;if(0>=Y)return u;for(var H=1,q=D[0],x={x:q.x,y:q.y,width:0,height:0};Y>H;H++){q=D[H];var U=I(x.x,q.x),$=l(x.x+x.width,q.x),J=I(x.y,q.y),F=l(x.y+x.height,q.y);x.x=U,x.y=J,x.width=$-U,x.height=F-J}return x},unionRect:function(P,q){if(P&&!q)return Qb(P);if(!P&&q)return Qb(q);if(P&&q){var m={x:I(P.x,q.x),y:I(P.y,q.y)};return m.width=l(P.x+P.width,q.x+q.width)-m.x,m.height=l(P.y+P.height,q.y+q.height)-m.y,m}return u},containsPoint:function(j,s,M,C){if(C!=u&&1!==C){var B=j.x+j.width/2,f=j.y+j.height/2;j={x:B-j.width/2*C,y:f-j.height/2*C,width:j.width*C,height:j.height*C}}if(M){var X=j.width/2,w=j.height/2,k=x(-M),E=p(-M),n=s.x-j.x-X,o=s.y-j.y-w;return s={x:E*n-k*o,y:k*n+E*o},oj({x:-X,y:-w,width:j.width,height:j.height},s)}return!(!j||s.x<j.x||s.y<j.y||s.x>j.x+j.width||s.y>j.y+j.height)},containsRect:function(t,P){if(!t||!P)return!1;var j=P.x,N=P.y,M=P.width,q=P.height,I=t.width,G=t.height;if(0>(I|G|M|q))return!1;var e=t.x,V=t.y;if(e>j||V>N)return!1;if(I+=e,M+=j,j>=M){if(I>=e||M>I)return!1}else if(I>=e&&M>I)return!1;if(G+=V,q+=N,N>=q){if(G>=V||q>G)return!1}else if(G>=V&&q>G)return!1;return!0},intersectsRect:function(X,Y){if(!X||!Y)return!1;var e=Y.width,l=Y.height,E=X.width,p=X.height;if(0>=E||0>=p||0>=e||0>=l)return!1;var T=Y.x,z=Y.y,R=X.x,d=X.y;return E+=R,p+=d,e+=T,l+=z,E>T&&p>z&&e>R&&l>d},intersection:function(c,H){if(!c||!H)return u;var i=H.x,D=H.y,y=c.x,l=c.y,E=i,v=D,z=y,J=l;return E+=H.width,v+=H.height,z+=c.width,J+=c.height,y>i&&(i=y),l>D&&(D=l),E>z&&(E=z),v>J&&(v=J),E-=i,v-=D,0>=E||0>=v?u:{x:i,y:D,width:E,height:v}},grow:function(x,U,b){b===f&&(b=U),x.x-=U,x.y-=b,x.width=x.width+2*U,x.height=x.height+2*b},getScreenPoint:function(o,l,k,N,B,X,I){var f=k.getBoundingClientRect(),W=o*(X||1)+f.left-k.scrollLeft+(N||0),q=l*(I||1)+f.top-k.scrollTop+(B||0),u={x:W,y:q},G=Aj(k.parentElement);return G?G.applyInverse(u,{}):u},getLogicalPoint:function(N,m,w,d,l,F){var X,j,o=m.getBoundingClientRect();N.target?(Be(N)?zg?Fg["91"]=!0:Fg["17"]=!0:zg?Fg["91"]=!1:Fg["17"]=!1,Fg["16"]=xd(N)?!0:!1,N=je?hc(N):N,X=N.clientX,j=N.clientY):(X=N.x,j=N.y);var h=Aj(m);if(h){var P=h.apply({x:X,y:j},{});return P.x=(P.x+m.scrollLeft-(w||0))/(l||1),P.y=(P.y+m.scrollTop-(d||0))/(F||1),P}return{x:(X-o.left+m.scrollLeft-(w||0))/(l||1),y:(j-o.top+m.scrollTop-(d||0))/(F||1)}},removeHTML:function(){var e;return function(s){return s&&s.getView&&(s=s.getView()),s&&s.parentNode?e===s?!0:(e=s,s.parentNode.removeChild(s),e=u,!0):!1}}(),getToolTipDiv:function(){if(!wj){wj=rp(),Jh=rp();var m=wj.style;U.baseZIndex!=u&&(m.zIndex=A(U.baseZIndex)+3+""),m.whiteSpace="nowrap",m.color=U.toolTipLabelColor,m.background=U.toolTipBackground,m.font=U.toolTipLabelFont,m.padding="5px",m.boxShadow="0px 0px 3px "+U.toolTipShadowColor}return wj},isToolTipShowing:function(){return wj&&wj.parentNode?!0:Jh&&Jh.parentNode?!0:!1},hideToolTip:function(){mp(wj),mp(Jh),vr()},showToolTip:function(j,g){if(!j||g==u)return rk(),void 0;U.getToolTipDiv();var R,z;if(g.html?(g=g.html,R=Jh,mp(wj)):(R=wj,mp(Jh)),z=R.style,R.innerHTML=g,R.parentNode||X.Default.appendToScreen(R),j.target){j=Rg(j);var V=ih(),D=j.x,Y=j.y,S=je?60:12;if(je){var O=R.getBoundingClientRect();z.left=D-O.width/2+Lf,z.top=Y-O.height-S<V.top?Y+S+Lf:Y-O.height-S+Lf}else{z.left=D+S+Lf,z.top=Y+S+Lf;var O=R.getBoundingClientRect();O.left+O.width>V.width&&(z.left=D-S-O.width+Lf),O.top+O.height>V.height&&(z.top=Y-S-O.height+Lf),O.left<0&&(z.left=D+S+Lf),O.top<0&&(z.top=Y+S+Lf)}}else z.left=j.x+Lf,z.top=j.y+Lf;vr()},startDragging:function(p,o,A){A==f&&(A=!0),p!==eg&&(eg?A&&(je?eg.handleWindowTouchEnd(o):eg.handleWindowMouseUp(o)):je?(M.addEventListener(_i,mq,V),M.addEventListener(uo,om,V)):(M.addEventListener(No,Nd,V),M.addEventListener(Xe,Qg,V)),eg=p)},getImageMap:function(){return jo},toBoundaries:function(D,h,A,W){var C=[];return Lm(D,h,A,W).forEach(function(F){var M=[];F.forEach(function(F){M.push(F.x,F.y)}),C.push(M)}),C},getCurrentKeyCodeMap:function(){return Fg},drawCenterImage:function(Q,a,e,A,g,V,J,S){var K=Bp(a,g,V),O=Fd(a,g,V);Fp(Q,a,w(e-K/2),w(A-O/2),K,O,g,V,J,S)},drawStretchImage:function(p,o,s,Z,a,X,n,D,e,B,K,l){var G,y=Bp(o,D,e,X),$=Fd(o,D,e,n);"uniform"===s?(G=I(X/y,n/$),y*=G,$*=G,Z+=w((X-y)/2),a+=w((n-$)/2),X=y,n=$):"centerUniform"===s&&((y>X||$>n)&&(G=I(X/y,n/$),y*=G,$*=G),Z+=w((X-y)/2),a+=w((n-$)/2),X=y,n=$);var E=p.interactiveInfo;if(E){var q;if(q="center"===s?{x:Z+X/2-y/2,y:a+n/2-$/2,width:y,height:$}:{x:Z,y:a,width:X,height:n},E.rect){var u=E.compInfos,d=u.length;d&&(u[d-1].rect.image=o)}else E.rect=q}if("center"===s){var z=K!==!1&&(y>X||$>n);z&&(p.save(),p.beginPath(),p.rect(Z,a,X,n),p.clip()),Fp(p,o,Z+X/2-y/2,a+n/2-$/2,y,$,D,e,B,l),z&&p.restore()}else Fp(p,o,Z,a,X,n,D,e,B,l)},toCanvas:function(H,s,T,l,I,$,r,K,L){H=Hi(H,r),s=s||Bp(H,I),T=T||Fd(H,I);var O=ib(),S=Cp(O);return K?(Up(O,s,T,K),S.scale(K,K)):Up(O,s,T,1),fh(S,H,l,0,0,s,T,I,$,r,L),H&&H.clampToEdge&&(O.clampToEdge=H.clampToEdge),S.restore(),O},toGrayColor:function(w){if(!w)return w;var q=$j(w),t=.299*q[0]+.587*q[1]+.114*q[2];return"rgba("+t+","+t+","+t+","+q[3]/255+")"},createGradientImage:function(M,H,$,Z){for(var Q=["L",0,0,M,0,1,0,0,1,0,0],b=0,f=Math.min(H.length,$.length);f>b;b++)Q.push($[b],H[b]);var c=X.Default.toCanvas({width:M,height:M,clampToEdge:!0,comps:[{type:"shape",rotation:Z||0,points:[0,0,M,0,M,M,0,M],background:"#ffffff",gradientPack:Q}]});return c},createElement:function(b,R,l,F){var z=Y.createElement(b);return al(z,R||G.widgetBorder,2),z.style.font=l?l:bn,F!=u&&(z.value=F),U.onElementCreated&&U.onElementCreated(z),z},containedInView:function(n,s){var E=uf(s).getBoundingClientRect();return oj({x:E.left,y:E.top,width:E.width,height:E.height},Jl(n))},isIsolating:function(){return Gg>0},setIsolating:function(J){J?Gg++:Gg--},getMSMap:function(){return $r},stringify:function(T,i,G){var C=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var c=JSON.stringify(T,function(T,F){return"function"==typeof F?"__ht__"+(F.__ht__||F.toString()):Pr(F)?db(F):F instanceof X.List?"__ht__list"+(F.__ht__list||U.stringify(F._as)):F},i==u?2:i);return Date.prototype.toJSON=C,G&&(c="__ht__encode"+U.encodeString(c)),c},parse:function(g){return Bs(g)?"__ht__encode"!=g.substr(0,12)||(g=U.decodeString(g.substr(12)),Bs(g))?JSON.parse(g,function(l,X){if(Bs(X))if("__ht__function"==X.substr(0,14)){var L=X.indexOf("{")+1,f=X.lastIndexOf("}"),R=X.indexOf("(")+1,M=X.indexOf(")");if(L&&f&&R&&M){var n=new Function(X.substring(R,M),X.substring(L,f));return n.__ht__=X.substr(6),n}}else{if("__ht__date"==X.substr(0,10))return new Date(A(X.substr(10)));if("__ht__list"===X.substr(0,10))return new _e(U.parse(X.substr(10)))}return X}):g:g},loadJS:function(G,k){k&&G.push(k);var T=G.shift();if(En(T))G=T.contact(G),U.loadJS(G);else if(Ze(T))T(),U.loadJS(G);else if(Bs(T)){var F=Y.createElement("script");F.onload=function(){U.loadJS(G)},F.setAttribute("src",T),Y.getElementsByTagName("head")[0].appendChild(F)}else G.length&&U.loadJS(G)},toRoundedCorner:function(Q,b){var k=Q.size();if(0>=b)return{points:Q};var N,D=new _e,M=new _e,h=Q.get(0);D.add(h),M.add(1);for(var A=1;k>A;A++)if(k>A+1){var K=Q.get(A),r=Q.get(A+1),V=h.x,w=h.y,T=K.x,j=K.y,X=j-w,q=T-V,U=$(X,q);N=I(.99*Di(h,K),b),D.add({x:T-N*p(U),y:j-N*x(U)}),D.add(K),V=K.x,w=K.y,T=r.x,j=r.y,X=j-w,q=T-V,U=$(X,q),N=I(.99*Di(K,r),b),h={x:V+N*p(U),y:w+N*x(U)},D.add(h),M.addAll([2,3])}else D.add(Q.get(A)),M.add(2);return{points:D,segments:M}},toColorData:$j,setCanvas:Up,createDiv:rp,createDisabledDiv:Ob,createView:sm,createCanvas:ib,appendChild:qr,initContext:Cp,checkLoadingImage:xm,translateAndScale:er,layout:Ji,getPosition:Eg,drawPoints:mm,drawRoundRect:ff,drawBorder:ti,setFocus:Kk,getter:Xf,setter:ii,isEmptyObject:Dh},!0),ae(H,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var id=U.disabledOpacity,Kb=U.toolTipDelay,Ee=U.devicePixelRatio,We=U.autoMakeVisible,ag=U.autoHideScrollBar,Nl=U.imageGradient,ar=U.showToolTip,rk=U.hideToolTip,rn=U.dashPattern,Cq=U.lineCap,Lp=U.lineJoin,ie=U.labelColor,pp=U.labelSelectColor,bn=U.labelFont,Bo=U.widgetIndent,Ir=U.widgetRowHeight,bg=U.widgetHeaderHeight,zl=U.widgetTitleHeight,Yb=U.scrollBarColor,ck=U.scrollBarSize,uk=U.scrollBarTimeout,qn=U.scrollBarMinLength,zi=U.scrollBarInteractiveSize,Km=U.zoomIncrement,tq=U.scrollZoomIncrement,Ko=U.pinchZoomIncrement,Ed=U.zoomMax,Ld=U.zoomMin,xo=U.createObject,wb=U.preventDefault,bh=U.setImage,Hi=U.getImage,Yk=U.isImageComplete,Xh=U.drawCenterImage,fh=U.drawStretchImage,Pk=U.getId,up=U.callLater,hi=U.sortFunc,Qb=U.clone,Ff=U.getClass,lr=U.startAnim,Xm=U.brighter,zm=U.darker,gi=U.drawText,Nh=U.getTextSize,js=U.isLeftButton,Gh=U.isMiddleButton,Wg=U.getTouchCount,Ar=U.isDoubleClick,xd=U.isShiftDown,Be=U.isCtrlDown,Jl=U.getClientPoint,Rg=U.getPagePoint,Di=U.getDistance,ys=U.unionPoint,Lj=U.unionRect,oj=U.containsPoint,Rn=U.containsRect,Pq=U.intersectsRect,un=U.intersection,ih=U.getWindowInfo,ce=U.grow,_k=U.getLogicalPoint,dd=U.getScreenPoint,Te=U.startDragging,mp=U.removeHTML,hh=U.createElement,ur=U.segmentResolution,Th=U.shapeResolution,Of=U.shapeSide,xk=U.def,lp=function(B,x,e){xk(Q+"."+B,x,e)},Kl=function(W,l){W.childNodes.forEach(function(A){l(A),Kl(A,l)})};ae(U,{toolTipLabelColor:ie,toolTipLabelFont:bn,toolTipBackground:G.toolTipBackground,toolTipShadowColor:bq,drawBreakableText:Jd,setDevicePixelRatio:function(E){Ee=U.devicePixelRatio="number"==typeof E?E:M.devicePixelRatio,Kl(Y.body,function(X){var p=X._ht;p&&p._canvas&&(Up(p._canvas,p.getWidth(),p.getHeight()),p.redraw?p.redraw():p.iv())})}},!0);var mo=1e-6,Gk="undefined"!=typeof Uint16Array?Uint16Array:Array,Jk="undefined"!=typeof Float32Array?Float32Array:Array,Zq=function(J,T,t){var E=[J[0]-T[0],J[1]-T[1],J[2]-T[2]];if(t){var b=Di(E);b>0&&(E[0]/=b,E[1]/=b,E[2]/=b)}return E},vi=function(){var Z="charCodeAt",q=2*(2*sk.length+1);for(var L in M)if(L===Q+nk[0]+(Lf.length+2)){var D=M[L];if(!D)break;for(var p=D.length,i=0;p>i;i++)if(D[i][Z](0)===q&&D[i+1]!=u&&D[i+1]===Lf[0]&&D[i+2]!=u&&D[i+2][Z](0)===q){for(var W=i+3;p>W;W++)if(D[W][Z](0)===q){if(0==D[W+1])for(var V,Y=W+2;p>Y;Y++){if(D[Y][Z](0)===q){0==D[Y-1]&&V&&(S=V.substr(0,V.length-1));break}V==u?V=D[Y]:V+=D[Y]}break}break}break}return function(i){return[-i[0],-i[1],-i[2]]}}(),yk=function(f,V){return 3===f.length?f[0]*V[0]+f[1]*V[1]+f[2]*V[2]:f[0]*V[0]+f[1]*V[1]},sh=function(){var p=new Jk(16);return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},kl=sh(),Or=function(z){var G=new Jk(16);return G[0]=z[0],G[1]=z[1],G[2]=z[2],G[3]=z[3],G[4]=z[4],G[5]=z[5],G[6]=z[6],G[7]=z[7],G[8]=z[8],G[9]=z[9],G[10]=z[10],G[11]=z[11],G[12]=z[12],G[13]=z[13],G[14]=z[14],G[15]=z[15],G},xg=function(a,m){return a[0]=m[0],a[1]=m[1],a[2]=m[2],a[3]=m[3],a[4]=m[4],a[5]=m[5],a[6]=m[6],a[7]=m[7],a[8]=m[8],a[9]=m[9],a[10]=m[10],a[11]=m[11],a[12]=m[12],a[13]=m[13],a[14]=m[14],a[15]=m[15],a},Mo=function(G){return G[0]=1,G[1]=0,G[2]=0,G[3]=0,G[4]=0,G[5]=1,G[6]=0,G[7]=0,G[8]=0,G[9]=0,G[10]=1,G[11]=0,G[12]=0,G[13]=0,G[14]=0,G[15]=1,G},Jo=function(q,X){var d=q[0],z=q[1],L=q[2];return q[0]=X[0]*d+X[4]*z+X[8]*L+X[12],q[1]=X[1]*d+X[5]*z+X[9]*L+X[13],q[2]=X[2]*d+X[6]*z+X[10]*L+X[14],q},ho=function(S,L){var f=S[0],I=S[1],q=S[2],K=S[3];return S[0]=L[0]*f+L[4]*I+L[8]*q+L[12]*K,S[1]=L[1]*f+L[5]*I+L[9]*q+L[13]*K,S[2]=L[2]*f+L[6]*I+L[10]*q+L[14]*K,S[3]=L[3]*f+L[7]*I+L[11]*q+L[15]*K,S},oe=function(){var p,F,J,e,_=kn(Sl[1]+Sl[7]),f=kn(Sl[0]+Sl[3]-Sl[10]),u=kn(Sl[8]+2),z=function(){return F=J.charAt(p),p+=1,F},N=function(){var M="";if(F===u)for(;z();){if(F===u)return z(),M;M+=F}else z()},j=function(){for(;F&&" ">=F;)z()},g=function(){var l,r={};if(F===_){if(z(),j(),F===f)return z(),r;for(;F;){if(l=N(),j(),z(),r[l]=e(),j(),F===f)return z(),r;z(),j()}}};return e=function(){switch(j(),F){case _:return g();default:return N()}},function(c){if(B={},c){var Z;if(J=c,p=0,F=" ",Z=e(),j(),!F)return Z}}}(),Fb=function(l,g){if(g){var O=x(g),Q=p(g),K=l[4],c=l[5],r=l[6],M=l[7],i=l[8],C=l[9],m=l[10],h=l[11];l[4]=K*Q+i*O,l[5]=c*Q+C*O,l[6]=r*Q+m*O,l[7]=M*Q+h*O,l[8]=i*Q-K*O,l[9]=C*Q-c*O,l[10]=m*Q-r*O,l[11]=h*Q-M*O}},Uo=function(e,d){if(d){var Q=x(d),Y=p(d),c=e[0],O=e[1],J=e[2],F=e[3],w=e[8],W=e[9],C=e[10],m=e[11];e[0]=c*Y-w*Q,e[1]=O*Y-W*Q,e[2]=J*Y-C*Q,e[3]=F*Y-m*Q,e[8]=c*Q+w*Y,e[9]=O*Q+W*Y,e[10]=J*Q+C*Y,e[11]=F*Q+m*Y}},eq=function(Q,g){if(g){var X=x(g),c=p(g),s=Q[0],$=Q[1],B=Q[2],M=Q[3],t=Q[4],w=Q[5],j=Q[6],i=Q[7];Q[0]=s*c+t*X,Q[1]=$*c+w*X,Q[2]=B*c+j*X,Q[3]=M*c+i*X,Q[4]=t*c-s*X,Q[5]=w*c-$*X,Q[6]=j*c-B*X,Q[7]=i*c-M*X}},Ge=function(y,$,i){return Cm(u,i===!1?u:y.getFinalScale3d(),y.getFinalRotation3d(),y.getRotationMode(),y.p3(),u,$)},Cm=function(U,u,y,X,a,Y,k){return Y||(Y=sh()),a&&Ah(Y,a),Ug(Y,y,X),k&&Nj(Y,Y,k),u&&_d(Y,u),U&&Nj(Y,Y,U),Y},sn=function(v,w,n){w=A(w),n=A(n);var Q=this;Q.g=v,Q._84O=w,Q._85O=n,Q._70I=!0,Q.F=0,Q._83O=w+n,Q.pen={x:0,y:0}},Zb="lineDashOffset",ee="setLineDash",_n=function(N){for(var Y in N)1===Y.length&&(Zb=N[Y]);return Y?1:0},Pp=function(o,t,N){return oo(t)?o:o[ee]?(o[ee](t),N&&(o.lineDashOffset=N),o):new sn(o,t[0],t.length>1?t[1]:t[0])},Ve=function(X,C){!oo(C)&&X[ee]&&(X[ee](kf),X.lineDashOffset=0)};if(xk(sn,b,{_69I:6,moveTo:function(c,h){var r=this,e=r.pen;e.x=c,e.y=h,r.g.moveTo(c,h),r.start||(r.start={x:c,y:h})},lineTo:function(Z,B){var d=this,P=d.pen,M=Z-P.x,l=B-P.y,r=$(l,M),V=p(r),N=x(r),L=d._23O(P.x,P.y,Z,B),C=d._85O,z=d._84O,S=d._83O;if(d.F){if(d.F>L)return d._70I?d._72I(Z,B):d.moveTo(Z,B),d.F-=L,void 0;if(d._70I?d._72I(P.x+V*d.F,P.y+N*d.F):d.moveTo(P.x+V*d.F,P.y+N*d.F),L-=d.F,d.F=0,d._70I=!d._70I,!L)return}var O=R(L/S);if(O){for(var b=V*z,o=N*z,W=V*C,e=N*C,s=0;O>s;s++)d._70I?(d._72I(P.x+b,P.y+o),d.moveTo(P.x+W,P.y+e)):(d.moveTo(P.x+W,P.y+e),d._72I(P.x+b,P.y+o));L-=S*O}d._70I?L>z?(d._72I(P.x+V*z,P.y+N*z),d.moveTo(Z,B),d.F=C-(L-z),d._70I=!1):(d._72I(Z,B),L===z?(d.F=0,d._70I=!d._70I):(d.F=z-L,d.moveTo(Z,B))):L>C?(d.moveTo(P.x+V*C,P.y+N*C),d._72I(Z,B),d.F=z-(L-C),d._70I=!0):(d.moveTo(Z,B),L===C?(d.F=0,d._70I=!d._70I):d.F=C-L)},quadraticCurveTo:function(d,x,Q,k){var m,A=this,b=A.pen,P=b.x,t=b.y,$=A._22O(P,t,d,x,Q,k),U=0,c=0,J=A._85O,L=A._84O;if(A.F){if(A.F>$)return A._70I?A._71I(d,x,Q,k):A.moveTo(Q,k),A.F-=$,void 0;if(U=A.F/$,m=A._20O(P,t,d,x,Q,k,U),A._70I?A._71I(m[2],m[3],m[4],m[5]):A.moveTo(m[4],m[5]),A.F=0,A._70I=!A._70I,!$)return}var F=$-$*U,O=R(F/A._83O),G=L/$,K=J/$;if(O)for(var w=0;O>w;w++)A._70I?(c=U+G,m=A._21O(P,t,d,x,Q,k,U,c),A._71I(m[2],m[3],m[4],m[5]),U=c,c=U+K,m=A._21O(P,t,d,x,Q,k,U,c),A.moveTo(m[4],m[5])):(c=U+K,m=A._21O(P,t,d,x,Q,k,U,c),A.moveTo(m[4],m[5]),U=c,c=U+G,m=A._21O(P,t,d,x,Q,k,U,c),A._71I(m[2],m[3],m[4],m[5])),U=c;F=$-$*U,A._70I?F>L?(c=U+G,m=A._21O(P,t,d,x,Q,k,U,c),A._71I(m[2],m[3],m[4],m[5]),A.moveTo(Q,k),A.F=J-(F-L),A._70I=!1):(m=A._19O(P,t,d,x,Q,k,U),A._71I(m[2],m[3],m[4],m[5]),$===L?(A.F=0,A._70I=!A._70I):(A.F=L-F,A.moveTo(Q,k))):F>J?(c=U+K,m=A._21O(P,t,d,x,Q,k,U,c),A.moveTo(m[4],m[5]),m=A._19O(P,t,d,x,Q,k,c),A._71I(m[2],m[3],m[4],m[5]),A.F=L-(F-J),A._70I=!0):(A.moveTo(Q,k),F===J?(A.F=0,A._70I=!A._70I):A.F=J-F)},bezierCurveTo:function(){var u=arguments;this.pen={x:u[4],y:u[5]},this.g.bezierCurveTo(u[0],u[1],u[2],u[3],u[4],u[5])},arc:function(l,L,V,A,E,v){v||(A=-A,E=-E),ke(this,l,L,A,E-A,V,V,!1)},rect:function(g,T,$,n){var R=this;R.pen={x:g,y:T},R.moveTo(g,T),R.lineTo(g,T+n),R.lineTo(g+$,T+n),R.lineTo(g+$,T),R.lineTo(g,T)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(J,Q,H,B){var W=H-J,p=B-Q;return r(W*W+p*p)},_22O:function(D,L,c,k,J,Y,F){for(var s,I,e,X,m,P,Z,U=0,o=D,x=L,T=F>0?F:this._69I,g=1;T>=g;g++)e=g/T,X=1-e,m=X*X,P=2*e*X,Z=e*e,s=m*D+P*c+Z*J,I=m*L+P*k+Z*Y,U+=this._23O(o,x,s,I),o=s,x=I;return U},_21O:function(X,$,n,B,R,Y,T,h){var t=this;if(0===T)return t._20O(X,$,n,B,R,Y,h);if(1===h)return t._19O(X,$,n,B,R,Y,T);var C=t._20O(X,$,n,B,R,Y,h);return C.push(T/h),t._19O.apply(t,C)},_20O:function(W,B,L,K,z,G,$){if(1!==$){var s=L+(z-L)*$,o=K+(G-K)*$;L=W+(L-W)*$,K=B+(K-B)*$,z=L+(s-L)*$,G=K+(o-K)*$}return[W,B,L,K,z,G]},_19O:function(e,c,y,H,F,n,f){if(1!==f){var J=e+(y-e)*f,Z=c+(H-c)*f;y+=(F-y)*f,H+=(n-H)*f,e=J+(y-J)*f,c=Z+(H-Z)*f}return[e,c,y,H,F,n]},_72I:function(c,b){var u=this.pen;(c!==u.x||b!==u.y)&&(u.x=c,u.y=b,this.g.lineTo(c,b))},_71I:function(O,S,F,j){var t=this.pen;(O!==F||S!==j||F!==t.x||j!==t.y)&&(t.x=F,t.y=j,this.g.quadraticCurveTo(O,S,F,j))}}),O&&K){var di=K.toString();P=di.indexOf(Ie.substr(0,2))>0&&di.indexOf(hk+hk.substr(1,1))>1||di.indexOf(Ol.substr(0,2)+Ie.substr(2,2)+nk[0]+Ie[4])>1?!0:!1}var Vb=u,wm=u,Qc=function($){Vb&&!$._72O&&(wm||(wm={}),wm[$._72O=Pk()]=$)},Qh=function(v,A){if(A||(A=v),A&&(Vb||(Vb={}),!Vb[v])){var x=new Yq;if(Vb[A]={request:x,url:A},A=U.beforeLoadURL(A),A.data){var l=U.parse(A.data);nn(v,l),U.handleCompTypeLoaded(v,l)}else{x.onload=function(){if(200===this.status||0===this.status){var M=U.parse(x.getResponseText());nn(v,M),U.handleCompTypeLoaded(v,M)}else nn(v,u)},x.onerror=function(){nn(v,u)};var L={};L.url=encodeURI(A),L.sync=!1,x.send(L)}}},nn=function(G,k){if(es[G]=k,delete Vb[G],Dh(Vb)&&(Vb=u,wm)){for(var W in wm){var K=wm[W];K.invalidateAll&&K.invalidateAll(f,"compTypeLoaded",G),K.redraw&&K.redraw(),K.iv(),delete K._72O}wm=u}if(k&&wm)for(var W in wm){var K=wm[W];K.invalidateAll&&K.invalidateAll(f,"compTypeLoading",G),K.redraw&&K.redraw(),K.iv()}},Ne=G.chart,qo="",vj=U.compStack=[],Lq=/^style@/,hl=/^attr@/,bd=/^field@/,Bi={x:.5,y:.5},Bp=function(B,c,$,E){if(!B)return 0;if(wq(B.fitSize,c,$)&&E)return E;var s=wq(B.width,c,$);return null==s?20:s},Fd=function(I,h,z,D){if(!I)return 0;if(wq(I.fitSize,h,z)&&D)return D;var n=wq(I.height,h,z);return null==n?20:n},wq=function(E,b,q){if(!E||!E.func)return E;var Q,g=E.func,e=E.value;return Q=Ze(g)?q&&q.vectorDataBindingDisabled&&!E.isSafeFunc?e:g(b,q):b instanceof lc?hl.test(g)?b.a(qo+g.slice(5)):Lq.test(g)?b.s(qo+g.slice(6)):bd.test(g)?b[g.slice(6)]:b[g]?b[g](q):e:e,e!==f&&Q==u?e:Q},Fp=U.drawImage=function(){var s,C,Y,v,d,k,g=function(A,E){A.getValue&&A.getValue.compType===E||(A.getValue=function(p){var O=B(A,p);if(O===f&&E.properties){var S=E.properties[p];S&&(O=S.defaultValue)}return O},A.getColor=function(u){return X(A.getValue(u))},A.getValue.compType=E)},B=function(b,F,a){var u,P=!1;if(b.prefix&&C instanceof lc){var y=C.a(qo+F);y!==f&&(P=!0,u=y)}return u===f&&(u=b[F]),u&&u.func&&(P=!0,u=wq(u,C,Y)),a&&(u=a(u),P||(b[F]=u)),u},X=function(H,p){var f;if(f=p?B(H,p):H,s&&s.compGray&&f)return U.toGrayColor(f);if(d&&f){if("override"===k)return d;if("override_rgb"===k){var j=Ke(d);return f=$j(f),"rgba("+R(255*j[0])+","+R(255*j[1])+","+R(255*j[2])+","+f[3]/255+")"}if("override_a"===k){var j=Ke(d);return f=$j(f),"rgba("+f[0]+","+f[1]+","+f[2]+","+j[3]+")"}var j=Ke(d);return f=$j(f),"rgba("+R(f[0]*j[0])+","+R(f[1]*j[1])+","+R(f[2]*j[2])+","+f[3]/255*j[3]+")"}return f},$=function(Z){if(En(Z)){for(var y=new _e,p=Z.length,d=0;p>d;d+=2)y.add({x:Z[d],y:Z[d+1]});Z=y}return Z},t=function(H){var $=B(H,"anchorX"),D=B(H,"anchorY");if($!==f||D!==f)return{x:$===f?Bi.x:$,y:D===f?Bi.y:D};var Y=B(H,"type"),E=B(H,"name");if("image"!==Y||!E)return Bi;var p=Hi(E);return p&&p.anchorX!==f&&p.anchorY!==f?{x:p.anchorX,y:p.anchorY}:Bi},K=function(S,O){var L=B(S,Ej),R=t(S);if(En(L)){var s=L.length,U=B(S,"relative"),_=O.width,a=O.height;if(4===s)L={x:L[0],y:L[1],width:L[2],height:L[3]},U&&(L.x*=_,L.y*=a,L.width*=_,L.height*=a);else if(3===s){var u=L[0];L={width:L[1],height:L[2]},U&&(L.width*=_,L.height*=a),"object"==typeof u?u.length&&(u={x:u[0],y:u[1]}):u=Eg(u,O,L),L.x=u.x-L.width*R.x,L.y=u.y-L.height*R.y}L.x+=B(S,"offsetX")||0,L.y+=B(S,"offsetY")||0,!U&&O.fitSize&&(L=m(S,L,O))}return L},m=function(l,p,z){if(p){var J,Y,e,w={x:p.x,y:p.y,width:p.width,height:p.height},E=t(l),m=B(l,"layoutH"),d=B(l,"layoutV"),T=1,G=1,r=0,D=0,h=1,v=1;switch(m){case"left":break;case"right":w.x+=z.width-z.rw;break;case"center":w.x+=.5*(z.width-z.rw);break;case"scale":case"leftright":default:J=B(l,le)||0,J&&(r=Math.abs(D=Math.sin(J)),h=Math.abs(v=Math.cos(J))),"leftright"!==m?(T+=h*(z.widthScale-1),G+=r*(z.widthScale-1)):(T+=w.width?h*(z.width-z.rw)/w.width:0,G+=w.height?r*(z.width-z.rw)/w.height:0,Y=-Math.min(-E.x*v+E.y*D,-E.x*v-(1-E.y)*D,(1-E.x)*v+E.y*D,(1-E.x)*v-(1-E.y)*D))}switch(d){case"top":break;case"bottom":w.y+=z.height-z.rh;break;case"center":w.y+=.5*(z.height-z.rh);break;case"scale":case"topbottom":default:J==u&&(J=B(l,le),J&&(r=Math.abs(D=Math.sin(J)),h=Math.abs(v=Math.cos(J)))),"topbottom"!==d?(T+=r*(z.heightScale-1),G+=h*(z.heightScale-1)):(T+=w.width?r*(z.height-z.rh)/w.width:0,G+=w.height?h*(z.height-z.rh)/w.height:0,e=-Math.min(-E.x*D-E.y*v,-E.x*D+(1-E.y)*v,(1-E.x)*D-E.y*v,(1-E.x)*D+(1-E.y)*v))}return(1!==T||1!==G)&&("scale"!==m&&m?"leftright"===m&&(w.x+=w.width*(1-T)*E.x+Y*(z.width-z.rw)):w.x+=w.x*(z.widthScale-1)+E.x*w.width*(z.widthScale-T),"scale"!==d&&d?"topbottom"===d&&(w.y+=w.height*(1-G)*E.y+e*(z.height-z.rh)):w.y+=w.y*(z.heightScale-1)+E.y*w.height*(z.heightScale-G),w.width*=T,w.height*=G),w.width<0&&(w.width=0),w.height<0&&(w.height=0),w}},b=function(z){return En(z)?new _e(z):z},F=function(n,z,_,A,Z,c,d){var Y=s.interactiveInfo,k=n.transform;if(k)return s.save(),s.setTransform(k.a,k.b,k.c,k.d,k.tx,k.ty),Y&&Y.compInfos.push({comp:n,rect:z,matrix:k.clone()}),!0;Z===f&&(Z=1),c===f&&(c=1);var S=B(n,"clipPercentage"),U=Me(_,z);if(U&&!A&&1===Z&&1===c&&!(1>S))return Y&&Y.compInfos.push({comp:n,rect:z,matrix:Y.matrix.clone()}),!1;d=d||Bi;var V=z.x+z.width*d.x,D=z.y+z.height*d.y,w=_.x+_.width*d.x,o=_.y+_.height*d.y,u=_.width?Z*(z.width/_.width):1,H=_.height?c*(z.height/_.height):1;if(s.save(),Y&&(Y.matrix.appendTranslate(V,D).appendRotate(A).appendScale(u,H).appendTranslate(-w,-o),Y.compInfos.push({comp:n,rect:z,matrix:Y.matrix.clone()})),vk(s,V,D),ts(s,A||0),Zo(s,u,H),vk(s,-w,-o),1>S){0>S&&(S=0);var m=zp(_,B(n,"clipDirection"),S);s.beginPath(),s.rect(m.x,m.y,m.width,m.height),s.clip()}return!0},O=function(){s.restore()},J=function(Z,g,i){var $=B(Z,"path"),k=B(Z,le),M=B(Z,"scaleX"),D=B(Z,"scaleY"),_=t(Z),Q=u,z=Nc(null,$);if(i||(i=Z.unionRect,i||(i=ys(z),Z.path.func||(Z.unionRect=i)),Q=i),i){Q||(Q=Z.unionRect,Q||(Q=ys(z),Z.path.func||(Z.unionRect=Q)));var q=F(Z,i,Q,k,M,D,_),I=B(Z,"borderPattern"),S=Pp(s,I),o=X(Z,"background"),y=X(Z,"borderColor"),U=B(Z,"borderWidth"),c=B(Z,"gradient"),p=X(Z,"gradientColor"),P=B(Z,"border3d"),H=X(Z,"border3dColor"),L=B(Z,"border3dAccuracy"),N=s.lineJoin,A=s.lineCap;if(s.lineJoin=B(Z,"borderJoin")||Lp,s.lineCap=B(Z,"borderCap")||Cq,o?(Dl(s,o,c,p,Q),Nc(s,$),s.fill(),S!==s&&Nc(s,$)):Nc(s,$),U&&y){var f=B(Z,"borderWidthAbsolute");f&&(s.save(),s.setTransform(1,0,0,1,0,0)),s.lineWidth=U,s.strokeStyle=y,s.stroke(),f&&s.restore(),P&&Zn(s,y,H,U,v,L)}if(Ve(s,I),B(Z,"dash")){var r=B(Z,"dashWidth")||U;if(r>0){I=B(Z,"dashPattern")||rn;var S=Pp(s,I,B(Z,"dashOffset")),C=X(Z,"dashColor")||X(Ai);S!==s&&Nc(s,$),s.strokeStyle=C,s.lineWidth=r,s.stroke(),B(Z,"dash3d")&&Zn(s,C,X(Z,"dash3dColor"),r,v,B(Z,"dash3dAccuracy")),Ve(s,I)}}g===Ej&&hg(s,o,B(Z,"depth"),Q),s.lineJoin=N,s.lineCap=A,q&&O()}},G=function(P,z,c,x){var T=B(P,kp,$),U=B(P,le),y=t(P);if(T&&x.fitSize){var p=new _e,A=ys(T),n=m(P,A,x),o=A.x+y.x*A.width,G=A.y+y.y*A.height,H=n.x+y.x*n.width,R=n.y+y.y*n.height,_=A.width?n.width/A.width:1,f=A.height?n.height/A.height:1;T.each(function(V){p.add({x:H+(V.x-o)*_,y:R+(V.y-G)*f})}),T=p,P.unionRect=null}var E=B(P,"scaleX"),g=B(P,"scaleY"),M=z===Kn,w=u;if(!c&&M&&(c=P.unionRect,c||(c=ys(T),P.points.func||(P.unionRect=c)),w=c),c){M?w||(w=P.unionRect,w||(w=ys(T),P.points.func||(P.unionRect=w))):w=c;var V,D,r,Z,j=F(P,c,w,U,E,g,y),l=B(P,"borderPattern"),N=Pp(s,l),q=X(P,"background"),K=Hi(B(P,"repeatImage"),d,k),I=B(P,"gradientPack"),S=X(P,"borderColor"),h=B(P,"borderWidth"),W=B(P,"segments",b),e=B(P,"gradient"),Q=X(P,"gradientColor"),L=B(P,"border3d"),a=X(P,"border3dColor"),i=B(P,"border3dAccuracy"),J=B(P,"closePath"),Zg=B(P,"fillRule")||"nonzero",cj=s.lineJoin,_j=s.lineCap;if(s.lineJoin=B(P,"borderJoin")||Lp,s.lineCap=B(P,"borderCap")||Cq,M)if(q||K||I){var ls=B(P,"fillClipPercentage");if(1>ls){0>ls&&(ls=0);var pe=zp(w,B(P,"fillClipDirection"),ls);s.save(),s.beginPath(),s.rect(pe.x,pe.y,pe.width,pe.height),s.clip()}if(mm(s,T,W,J),I)Af(s,I);else if(K){var un=s,Nf=d,pg=k;Un(s,K,d,k,C,Y),s=un,d=Nf,k=pg}else{var un=s;Dl(s,q,e,Q,w),s=un}s.fill(Zg),1>ls&&s.restore(),I&&s.restore(),N!==s&&mm(N,T,W,J)}else mm(N,T,W,J);else if("roundRect"===z?V=B(P,"cornerRadius"):"polygon"===z?V=B(P,"polygonSide"):"arc"===z&&(V=B(P,"arcFrom"),D=B(P,"arcTo"),r=B(P,"arcClose"),Z=B(P,"arcOval")),q||K||I){var ls=B(P,"fillClipPercentage");if(1>ls){0>ls&&(ls=0);var pe=zp(w,B(P,"fillClipDirection"),ls);s.save(),s.beginPath(),s.rect(pe.x,pe.y,pe.width,pe.height),s.clip()}if(gn(s,z,w,V,D,r,Z),I)Af(s,I);else if(K){var un=s,Nf=d,pg=k;Un(s,K,d,k,C,Y),s=un,d=Nf,k=pg}else Dl(s,q,e,Q,w);s.fill(Zg),1>ls&&s.restore(),I&&s.restore(),s!==N&&gn(N,z,w,V,D,r,Z)}else gn(N,z,w,V,D,r,Z);if(h&&S){var sk=B(P,"borderWidthAbsolute");sk&&(s.save(),s.setTransform(1,0,0,1,0,0)),s.lineWidth=h,s.strokeStyle=S,s.stroke(),sk&&s.restore(),L&&Zn(s,S,a,h,v,i)}if(Ve(s,l),B(P,"dash")){var yp=B(P,"dashWidth")||h;if(yp>0){l=B(P,"dashPattern")||rn;var N=Pp(s,l,B(P,"dashOffset")),Go=X(P,"dashColor")||X(Ai);N!==s&&(M?mm(N,T,W,J):gn(N,z,w,V,D,r,Z)),s.strokeStyle=Go,s.lineWidth=yp,s.stroke(),B(P,"dash3d")&&Zn(s,Go,X(P,"dash3dColor"),yp,v,B(P,"dash3dAccuracy")),Ve(s,l)}}z===Ej&&hg(s,q,B(P,"depth"),w),s.lineJoin=cj,s.lineCap=_j,j&&O()}},n=function(F,O){var i=d,K=k,c=d||B(F,El),l=k||B(F,"blendMode"),p=Hi(B(F,"name"),c,l);p&&(fh(s,p,B(F,"stretch"),O.x,O.y,O.width,O.height,C,Y,c,null,l),d=i,k=K)},j=function(V,P){var S=B(V,"text");S!=u&&gi(s,S,B(V,"font"),X(V,El),P.x,P.y,P.width,P.height,B(V,"align"),B(V,"vAlign"))},N=function(Y,H){ti(s,X(Y,El),H.x,H.y,H.width,H.height,B(Y,"width"))},W=function(V,Y){var j=B(V,Mc),f=0;if(j&&(j.forEach(function(G){f+=G}),f>0)){for(var W=B(V,"colors")||Ne,H=B(V,"startAngle")||0,E=B(V,"hollow"),X=B(V,Fr),v=B(V,nj),w=B(V,fd),c=X?new _e:u,t=Y.x,h=Y.y,N=Y.width,G=Y.height,J=t+N/2,l=h+G/2,L=I(N,G)/2,q=0,D=0;D<j.length;D++){var K=j[D],g=e*K/f,O=H+g;if(s.fillStyle=W[q++],q===W.length&&(q=0),s.beginPath(),E){var T=J+p(H)*L/2,k=l+x(H)*L/2,A=J+p(O)*L,U=l+x(O)*L;s.moveTo(T,k),s.arc(J,l,L/2,H,O,!1),s.lineTo(A,U),s.arc(J,l,L,O,H,!0)}else s.moveTo(J,l),s.arc(J,l,L,O,H,!0);c&&(g=(H+O)/2,c.add({text:Ze(X)?X(K,D,f,C):K,x:J+.75*p(g)*L,y:l+.75*x(g)*L})),s.closePath(),s.fill(),H=O}c&&c.each(function(_){gi(s,_.text,v,w,_.x,_.y,0,0,Md)})}},Z=function(t,j){var f=B(t,Ae);if(f&&f.length>0){var E=f.length,o=B(t,Fr),R=B(t,nj),h=B(t,fd),q=o?new _e:u,V=B(t,"minValue")||0,I=B(t,"maxValue");if(I==u&&(I=0,f.forEach(function(o){B(o,Mc).forEach(function(J){I=l(I,J)})})),V===I)return;for(var k=j.height/(I-V),_=j.y+I*k,m=B(f[0],Mc).length,b=j.width/(3*m+1),n=2*b/E,J=0,M=0;E>M;M++)for(var O=f[M],S=B(O,El),X=B(O,"colors"),W=B(O,Mc),x=0;m>x;x++){X?s.fillStyle=X[x]:S?s.fillStyle=S:(s.fillStyle=Ne[J++],J===Ne.length&&(J=0));var N=W[x],Z=N*k,v=j.x+(1+3*x)*b+M*n;if(On(s,v,_-Z,n,Z),q){var F=Ze(o)?o(N,x,O,C):N,d=Nh(R,F).height;q.add({x:v,y:_-Z-d,width:n,height:d,text:F})}}q&&q.each(function(G){gi(s,G.text,R,h,G.x,G.y,G.width,G.height,Md)})}},H=function(n,N){var y=B(n,Ae);if(y&&y.length>0){var I=y.length,p=B(y[0],Mc).length,r=N.width/(3*p+1),X=0,_=B(n,"maxValue"),Q=B(n,Fr),V=B(n,nj),x=B(n,fd),v=Q?new _e:u;if(_==u){_=0;for(var j=0;p>j;j++){for(var Y=0,T=0;I>T;T++)Y+=B(y[T],Mc)[j];_=l(_,Y)}}if(_>0){for(var j=0;p>j;j++)for(var M=N.y+N.height,T=0;I>T;T++){var E=y[T],O=B(E,El),i=B(E,Mc)[j],h=i/_*N.height;O?s.fillStyle=O:(s.fillStyle=Ne[X++],X===Ne.length&&(X=0)),M-=h;var o={x:N.x+(1+3*j)*r,y:M,width:2*r,height:h};On(s,o.x,o.y,o.width,o.height),v&&(o.text=Ze(Q)?Q(i,j,E,C):i,v.add(o))}v&&v.each(function(R){gi(s,R.text,V,x,R.x,R.y,R.width,R.height,Md)})}}},E=function(n,r){var H=B(n,Ae);if(H&&H.length>0){for(var e=H.length,Q=B(H[0],Mc).length,$=r.width/(3*Q+1),_=0,p=B(n,Fr),G=B(n,nj),g=B(n,fd),x=p?new _e:u,E=0;Q>E;E++){for(var A=0,L=0;e>L;L++)A+=B(H[L],Mc)[E];if(A>0){var K=r.y+r.height;for(L=0;e>L;L++){var l=H[L],M=B(l,El),f=B(l,Mc)[E],U=f/A*r.height;M?s.fillStyle=M:(s.fillStyle=Ne[_++],_===Ne.length&&(_=0)),K-=U;var Z={x:r.x+(1+3*E)*$,y:K,width:2*$,height:U};On(s,Z.x,Z.y,Z.width,Z.height),x&&(Z.text=Ze(p)?p(f,E,l,C):f,x.add(Z))}}}x&&x.each(function(d){gi(s,d.text,G,g,d.x,d.y,d.width,d.height,Md)})}},y=function(A,D){var O=B(A,Ae);if(O&&O.length>0){var L=O.length,$=B(A,"minValue")||0,U=B(A,"maxValue");if(U==u&&(U=0,O.forEach(function(r){B(r,Mc).forEach(function(v){U=l(U,v)})})),$===U)return;for(var w=D.height/(U-$),y=D.y+U*w,X=B(O[0],Mc).length,m=D.width/(3*X+1),z=0,r=B(A,"lineWidth")||2,E=B(A,"line3d"),I=B(A,"linePoint"),Y=B(A,Fr),k=B(A,nj),c=B(A,fd),f=0;L>f;f++){var W=O[f],Z=B(W,El),N=B(W,Mc);Z?s.strokeStyle=Z:(Z=s.strokeStyle=Ne[z++],z===Ne.length&&(z=0)),s.beginPath();for(var d=0;X>d;d++){var H=D.x+(2+3*d)*m,Q=y-N[d]*w;0===d?s.moveTo(H,Q):s.lineTo(H,Q)}if(s.lineWidth=r,s.stroke(),E&&Zn(s,Z,u,r,v),I||Y){var G,T=r/2+2;for(d=0;X>d;d++){var J=N[d];if(H=D.x+(2+3*d)*m,Q=y-J*w,Ze(I)?I(s,H,Q,Z,d,W,C):I&&(s.fillStyle=Z,s.beginPath(),s.arc(H,Q,T,0,e,!0),s.fill()),Ze(Y)?G=Y(J,d,W,C):Y&&(G=J),G){var K=Nh(k,G).height,i=s.shadowBlur;if(i){var M=s.shadowOffsetX,x=s.shadowOffsetY,q=s.shadowColor;s.shadowOffsetX=0,s.shadowOffsetY=0,s.shadowBlur=0,s.shadowColor=u}gi(s,G,k,c,H,Q-K-T+2,0,K,Md),i&&(s.shadowOffsetX=M,s.shadowOffsetY=x,s.shadowBlur=i,s.shadowColor=q)}}}}}},o=function(){s=null,C=null,Y=null},Q=function(i,X){var o;Y&&Y.getState?o=Y.getState(C):(o=C instanceof lc?C.s(Cj):null,(o===f||null===o)&&(o=B(i,Cj)));var d=B(X,Cj);return d!==f&&null!==d&&d!==o?!1:B(X,pl)},V={border:N,image:n,text:j,pieChart:W,columnChart:Z,stackedColumnChart:H,percentageColumnChart:E,lineChart:y};return function(R,_,m,I,N,i,E,c,W,n){if(_&&N&&i){var H=s?!1:!0;s=R,C=E,Y=c,v=Y?Y._zoom?Y._zoom:1:1,d=W,k=n;var j=N,r=i;if($m()){var L,T,l;0===s[Wd]?$m[0]&&(L=!0):L=!0,s.texureImage2D?$m[1]&&(T=!0):T=!0,s.texureImage3D?$m[2]&&(l=!0):l=!0,L&&T&&l&&(j=m,r=I)}if(_.tagName)return Bs(S)&&!M[S]||s.drawImage(_,j,r,N,i),H&&o(),void 0;if(B(_,"visible")===!1)return H&&o(),void 0;d||(d=wq(_.color,C,Y)),n||(k=wq(_.blendMode,C,Y)),Bs(S)&&!M[S]&&(N=j,i=r);var x=Bp(_,C,Y,N),D=Fd(_,C,Y,i),w={x:0,y:0,width:x,height:D,fitSize:B(_,"fitSize")},h=B(_,"clip"),y=B(_,"opacity");if(w.fitSize){var p=w.rw=wq(_.width,C,Y)||20;w.widthScale=x/p;var P=w.rh=wq(_.height,C,Y)||20;w.heightScale=D/P}if(s.save(),s.interactiveInfo){var q=s.interactiveInfo.matrix,z=q.clone();q.appendTranslate(j,r).appendScale(N/x,i/D)}vk(s,j,r),(x!==N||D!==i)&&s.scale(N/x,i/D),h&&(Ze(h)?h(s,x,D,C,Y,_):(s.beginPath(),s.rect(0,0,x,D),s.clip())),y!=u&&(s.globalAlpha*=y),B(_,"comps").forEach(function(l){if(Q(_,l)!==!1){if(vj.splice(0,0,l),l.prefix){var r=qo,o=wq(l.prefix,C,Y);o&&(qo=qo+o+".")}if(s.interactiveInfo)var c=s.interactiveInfo.matrix.clone();var D=B(l,"opacity"),d=B(l,"shadow"),q=B(l,"type"),x=K(l,w);
if(D!=u){var p=s.globalAlpha;s.globalAlpha*=D}if(d){var m=s.shadowOffsetX,R=s.shadowOffsetY,z=s.shadowBlur,N=s.shadowColor,T=B(l,"shadowOffsetX"),Z=B(l,"shadowOffsetY"),L=B(l,"shadowBlur"),W=X(l,"shadowColor");s.shadowOffsetX=(T==u?3:T)*v,s.shadowOffsetY=(Z==u?3:Z)*v,s.shadowBlur=(L==u?6:L)*v,s.shadowColor=W||X(dr)}if("save"===q)s.save();else if("endClip"===q||"restore"===q)s.restore();else if("clip"===q)s.save(),mm(s,B(l,"points",$),B(l,"segments",b),!0),s.clip();else if(ln[q])x=x||{x:0,y:0,width:w.width,height:w.height},G(l,q,x,w);else if(q===Kn)G(l,q,x,w);else if("SVGPath"===q)J(l,q,x);else{x=x||{x:0,y:0,width:w.width,height:w.height};var j=B(l,le),E=B(l,"scaleX"),h=B(l,"scaleY"),P=t(l),e=F(l,x,x,j,E,h,P);if(Ze(q))g(l,q),U.drawCompType(q,s,x,l,C,Y);else if(U.getCompType(q)){var I=U.getCompType(q),A=I.func||I;g(l,I),U.drawCompType(A,s,x,l,C,Y)}else V[q]?V[q](l,x):U.getCompType(q)===f&&Dg.test(q)&&Qh(q);e&&O()}d&&(s.shadowOffsetX=m,s.shadowOffsetY=R,s.shadowBlur=z,s.shadowColor=N),D!=u&&(s.globalAlpha=p),s.interactiveInfo&&(s.interactiveInfo.matrix=c),l.prefix&&(qo=r),vj.splice(0,1)}}),s.interactiveInfo&&(s.interactiveInfo.matrix=z),s.restore(),H&&o()}}}();U.getCurrentComp=function(){return vj[0]},U.getParentComp=function(){return vj[1]},U.getInternal=function(){return{isEnter:Wp,isEsc:hj,isSpace:Db,isLeft:el,isUp:ek,isRight:bs,isDown:Sh,addMethod:ae,superCall:ef,toPointsArray:Lm,translateAndScale:er,appendArray:Ab,createWorldMatrix:Cm,vec3TransformMat4:Jo,setCanvas:Up,createDiv:rp,createView:sm,createCanvas:ib,createImage:$q,initContext:Cp,layout:Ji,fillRect:On,Mat:Cg,drawBorder:ti,isString:Bs,setBorder:al,getPropertyValue:Tp,setPropertyValue:Qn,drawVerticalLine:Eo,draw3DRect:hg,getPinchDist:Hm,isSameRect:Me,getPosition:Eg,intersectionLineRect:Gp,getNodeRect:wo,getEdgeAgentPosition:ql,getImageWidth:Bp,getImageHeight:Fd,initItemElement:Io,drawPoints:mm,createG2:Pp,closePopup:Ok,isH:lo,createAnim:Ll,createNormalMatrix:Jb,createNormals:uh,toFloatArray:Zj,glMV:Sb,batchShape:wk,createNodeMatrix:Ge,getFaceInfo:as,transformAppend:Po,drawFaceInfo:Vp,to3dPointsArray:Lb,setGLDebugMode:function(w){cd=w},cube:function(){return{vs:Zp,is:Rr,uv:md}},ui:function(){return{DataUI:io,NodeUI:Lr,EdgeUI:gh,GroupUI:rc,ShapeUI:jq,GridUI:Le,Data3dUI:Oi,Node3dUI:jc,Shape3dUI:vl}},getInternalVersion:function(){return"U2FsdGVkX19QrkKNn2GHTDAal+UWLTQqW12JoCcSsMc="},getDragger:function(){return eg},addMSMap:function(c){ae($r,c)},k:s}},function(S){function O(k,L){k!=u&&(L==u&&xc!=typeof k?this._54O(k,256):this._54O(k,L))}function B(){return new O(u)}function H(w,l,z,c,$,H){for(;--H>=0;){var E=l*this[w++]+z[c]+$;$=R(E/67108864),z[c++]=67108863&E}return $}function t(P,Z,E,O,C,w){for(var j=32767&Z,V=Z>>15;--w>=0;){var f=32767&this[P],X=this[P++]>>15,n=V*f+X*j;f=j*f+((32767&n)<<15)+E[O]+(1073741823&C),C=(f>>>30)+(n>>>15)+V*X+(C>>>30),E[O++]=1073741823&f}return C}function $(Z,j,B,d,A,p){for(var s=16383&j,y=j>>14;--p>=0;){var e=16383&this[Z],_=this[Z++]>>14,C=y*e+_*s;e=s*e+((16383&C)<<14)+B[d]+A,A=(e>>28)+(C>>14)+y*_,B[d++]=268435455&e}return A}function b(l){return dh.charAt(l)}function T(F,o){var B=xh[F.charCodeAt(o)];return B==u?-1:B}function Z(R){for(var a=this.t-1;a>=0;--a)R[a]=this[a];R.t=this.t,R.s=this.s}function v(A){this.t=1,this.s=0>A?-1:0,A>0?this[0]=A:-1>A?this[0]=A+this.DV:this.t=0}function W(n){var D=B();return D._58O(n),D}function m(u,K){var k,D=this;if(16==K)k=4;else if(8==K)k=3;else if(256==K)k=8;else if(2==K)k=1;else if(32==K)k=5;else{if(4!=K)return D.fromRadix(u,K),void 0;k=2}D.t=0,D.s=0;for(var p=u.length,U=!1,B=0;--p>=0;){var j=8==k?255&u[p]:T(u,p);0>j?"-"==u.charAt(p)&&(U=!0):(U=!1,0==B?D[D.t++]=j:B+k>D.DB?(D[D.t-1]|=(j&(1<<D.DB-B)-1)<<B,D[D.t++]=j>>D.DB-B):D[D.t-1]|=j<<B,B+=k,B>=D.DB&&(B-=D.DB))}8==k&&0!=(128&u[0])&&(D.s=-1,B>0&&(D[D.t-1]|=(1<<D.DB-B)-1<<B)),D._57O(),U&&O.ZERO._78O(D,D)}function j(){for(var q=this,S=q.s&q.DM;q.t>0&&q[q.t-1]==S;)--q.t}function a(w){var L=this;if(L.s<0)return"-"+L._85O()[Hr](w);var O;if(16==w)O=4;else if(8==w)O=3;else if(2==w)O=1;else if(32==w)O=5;else{if(4!=w)return L.toRadix(w);O=2}var R,Y=(1<<O)-1,W=!1,A="",j=L.t,g=L.DB-j*L.DB%O;if(j-->0)for(g<L.DB&&(R=L[j]>>g)>0&&(W=!0,A=b(R));j>=0;)O>g?(R=(L[j]&(1<<g)-1)<<O-g,R|=L[--j]>>(g+=L.DB-O)):(R=L[j]>>(g-=O)&Y,0>=g&&(g+=L.DB,--j)),R>0&&(W=!0),W&&(A+=b(R));return W?A:"0"}function h(){var W=B();return O.ZERO._78O(this,W),W}function f(){return this.s<0?this._85O():this}function z(k){var O=this,J=O.s-k.s;if(0!=J)return J;var f=O.t;if(J=f-k.t,0!=J)return O.s<0?-J:J;for(;--f>=0;)if(0!=(J=O[f]-k[f]))return J;return 0}function F(h){var T,Y=1;return 0!=(T=h>>>16)&&(h=T,Y+=16),0!=(T=h>>8)&&(h=T,Y+=8),0!=(T=h>>4)&&(h=T,Y+=4),0!=(T=h>>2)&&(h=T,Y+=2),0!=(T=h>>1)&&(h=T,Y+=1),Y}function U(){var z=this;return z.t<=0?0:z.DB*(z.t-1)+F(z[z.t-1]^z.s&z.DM)}function q(n,_){var N;for(N=this.t-1;N>=0;--N)_[N+n]=this[N];for(N=n-1;N>=0;--N)_[N]=0;_.t=this.t+n,_.s=this.s}function X(q,j){for(var C=q;C<this.t;++C)j[C-q]=this[C];j.t=l(this.t-q,0),j.s=this.s}function g(B,H){var C,y=this,J=B%y.DB,O=y.DB-J,v=(1<<O)-1,Q=R(B/y.DB),q=y.s<<J&y.DM;for(C=y.t-1;C>=0;--C)H[C+Q+1]=y[C]>>O|q,q=(y[C]&v)<<J;for(C=Q-1;C>=0;--C)H[C]=0;H[Q]=q,H.t=y.t+Q+1,H.s=y.s,H._57O()}function Y(P,w){var q=this;w.s=q.s;var V=R(P/q.DB);if(V>=q.t)return w.t=0,void 0;var m=P%q.DB,n=q.DB-m,h=(1<<m)-1;w[0]=q[V]>>m;for(var z=V+1;z<q.t;++z)w[z-V-1]|=(q[z]&h)<<n,w[z-V]=q[z]>>m;m>0&&(w[q.t-V-1]|=(q.s&h)<<n),w.t=q.t-V,w._57O()}function M(r,Q){for(var a=this,P=0,d=0,z=I(r.t,a.t);z>P;)d+=a[P]-r[P],Q[P++]=d&a.DM,d>>=a.DB;if(r.t<a.t){for(d-=r.s;P<a.t;)d+=a[P],Q[P++]=d&a.DM,d>>=a.DB;d+=a.s}else{for(d+=a.s;P<r.t;)d-=r[P],Q[P++]=d&a.DM,d>>=a.DB;d-=r.s}Q.s=0>d?-1:0,-1>d?Q[P++]=a.DV+d:d>0&&(Q[P++]=d),Q.t=P,Q._57O()}function D(p,Y){var k=this.abs(),b=p.abs(),v=k.t;for(Y.t=v+b.t;--v>=0;)Y[v]=0;for(v=0;v<b.t;++v)Y[v+k.t]=k.am(0,b[v],Y,v,0,k.t);Y.s=0,Y._57O(),this.s!=p.s&&O.ZERO._78O(Y,Y)}function J(L){for(var l=this.abs(),D=L.t=2*l.t;--D>=0;)L[D]=0;for(D=0;D<l.t-1;++D){var n=l.am(D,l[D],L,2*D,0,1);(L[D+l.t]+=l.am(D+1,2*l[D],L,2*D+1,n,l.t-D-1))>=l.DV&&(L[D+l.t]-=l.DV,L[D+l.t+1]=1)}L.t>0&&(L[L.t-1]+=l.am(D,l[D],L,2*D,0,1)),L.s=0,L._57O()}function i(G,_,o){var f=G.abs(),V=this;if(!(f.t<=0)){var Y=V.abs();if(Y.t<f.t)return _!=u&&_._58O(0),o!=u&&V._77O(o),void 0;o==u&&(o=B());var e=B(),L=V.s,i=G.s,K=V.DB-F(f[f.t-1]);K>0?(f._44O(K,e),Y._44O(K,o)):(f._77O(e),Y._77O(o));var r=e.t,c=e[r-1];if(0!=c){var j=c*(1<<V.F1)+(r>1?e[r-2]>>V.F2:0),q=V.FV/j,A=(1<<V.F1)/j,y=1<<V.F2,H=o.t,D=H-r,Q=_==u?B():_;for(e._59O(D,Q),o._52O(Q)>=0&&(o[o.t++]=1,o._78O(Q,o)),O.ONE._59O(r,Q),Q._78O(e,e);e.t<r;)e[e.t++]=0;for(;--D>=0;){var X=o[--H]==c?V.DM:R(o[H]*q+(o[H-1]+y)*A);if((o[H]+=e.am(0,X,o,D,0,r))<X)for(e._59O(D,Q),o._78O(Q,o);o[H]<--X;)o._78O(Q,o)}_!=u&&(o._45O(r,_),L!=i&&O.ZERO._78O(_,_)),o.t=r,o._57O(),K>0&&o._46O(K,o),0>L&&O.ZERO._78O(o,o)}}}function P(m){var J=B();return this.abs()._49O(m,u,J),this.s<0&&J._52O(O.ZERO)>0&&m._78O(J,J),J}function _(Q){this.m=Q}function N(F){return F.s<0||F._52O(this.m)>=0?F.mod(this.m):F}function V(a){return a}function y(M){M._49O(this.m,u,M)}function k(F,x,k){F._47O(x,k),this._74O(k)}function c(y,I){y._48O(I),this._74O(I)}function o(){if(this.t<1)return 0;var N=this[0];if(0==(1&N))return 0;var V=3&N;return V=15&V*(2-(15&N)*V),V=255&V*(2-(255&N)*V),V=65535&V*(2-(65535&(65535&N)*V)),V=V*(2-N*V%this.DV)%this.DV,V>0?this.DV-V:-V}function G(Y){var W=this;W.m=Y,W.mp=Y._50O(),W.mpl=32767&W.mp,W.mph=W.mp>>15,W.um=(1<<Y.DB-15)-1,W.mt2=2*Y.t}function C(w){var v=B();return w.abs()._59O(this.m.t,v),v._49O(this.m,u,v),w.s<0&&v._52O(O.ZERO)>0&&this.m._78O(v,v),v}function K(_){var R=B();return _._77O(R),this._74O(R),R}function w($){for(var L=this;$.t<=L.mt2;)$[$.t++]=0;for(var j=0;j<L.m.t;++j){var n=32767&$[j],U=n*L.mpl+((n*L.mph+($[j]>>15)*L.mpl&L.um)<<15)&$.DM;for(n=j+L.m.t,$[n]+=L.m.am(0,U,$,j,0,L.m.t);$[n]>=$.DV;)$[n]-=$.DV,$[++n]++}$._57O(),$._45O(L.m.t,$),$._52O(L.m)>=0&&$._78O(L.m,$)}function Eq(U,P){U._48O(P),this._74O(P)}function jr(X,k,m){X._47O(k,m),this._74O(m)}function Cm(){return 0==(this.t>0?1&this[0]:this.s)}function Qg(T,H){if(T>4294967295||1>T)return O.ONE;var l=B(),Q=B(),U=H._73O(this),X=F(T)-1;for(U._77O(l);--X>=0;)if(H._76O(l,Q),(T&1<<X)>0)H._75O(Q,U,l);else{var J=l;l=Q,Q=J}return H.revert(l)}function mi(x,S){var l;return l=256>x||S._51O()?new _(S):new G(S),this.exp(x,l)}function Qi(){var C=this;if(C.s<0){if(1==C.t)return C[0]-C.DV;if(0==C.t)return-1}else{if(1==C.t)return C[0];if(0==C.t)return 0}return(C[1]&(1<<32-C.DB)-1)<<C.DB|C[0]}function Yn(e,d){return new O(e,d)}function xe(){var k=this;k.n=u,k.e=0,k.d=u,k.p=u,k.q=u,k.dmp1=u,k.dmq1=u,k._10A=u}function zp(j){return j._53O(this.e,this.n)}function Jd(t){var Z,l,H,q="",S=0;for(Z=0;Z<t.length&&t.charAt(Z)!=Kp;++Z)H=_b.indexOf(t.charAt(Z)),0>H||(0==S?(q+=b(H>>2),l=3&H,S=1):1==S?(q+=b(l<<2|H>>4),l=15&H,S=2):2==S?(q+=b(l),q+=b(H>>2),l=3&H,S=3):(q+=b(l<<2|H>>4),q+=b(15&H),S=0));return 1==S&&(q+=b(l<<2)),q}function xp(E){var d=E.split(""),p=Jd(E);return d.forEach(function(B){var W=B.length;W>0&&p&&(Vm+=A(B))}),p}function wp(d,S){var T=zk._4O.Util._56O(d,"ss"),w={},E=0;return w.v=T==S,w.t=1,w.s=0>E?-1:0,_c=w.v,E>0?w[0]=E:-1>E?w[0]=E+w.DV:w.t=0,[T,w]}function Sk(c){var $=38,K=c.substring(0,$);if(K&&30==K.indexOf("05000420")){var m=["ss",c.substring($)];return m}return[]}function Ie(F,M){M=M.replace(Xi,""),M=M.replace(/[ \n]+/g,"");var f=Yn(M,16);if(f._55O()>this.n._55O())return 0;var a=this._37O(f),l=a[Hr](16).replace(/^1f+00/,""),Z=Sk(l);if(0==Z.length)return!1;for(var $,t,y,R=.5,z=Of,D=[0,.5,.75,.875,.9375],b=[],E=[],J=[],V=e/z,q=Z[1],H=wp(F,q)[0],j=0,g=0;j<D.length;j++){var L=0===j%2?0:.5;for($=0;z>=$;$++)t=($+L)*V,y=1-D[j],b.push(p(t)*R*y,-R+2*D[j]*R,-x(t)*R*y),E.push(($+L)/z,y)}for(j=0;j<D.length-1;j++){var i=j*(z+1),m=(j+1)*(z+1);for($=0;z>$;$++)J.push(i+$,m+$+1,m+$,i+$,i+$+1,m+$+1)}return J.forEach(function(M){g+=M}),q==H&&g>10}var mf,yn=0xdeadbeefcafe,km=15715070==(16777215&yn),Hr="toString",ps="",Le="nat",rc=function(){};E=S["D"+11182[Hr](L(2,5))];var eo=O.prototype;$p+=hd.substr(0,1);var Ch=S.navigator?S.navigator.appName:"";km&&"Microsoft Internet Explorer"==Ch?(eo.am=t,mf=30):km&&"Netscape"!=Ch?(eo.am=H,mf=26):(eo.am=$,mf=28),eo.DB=mf,eo.DM=(1<<mf)-1,eo.DV=1<<mf;var Sl=52;eo.FV=L(2,Sl),eo.F1=Sl-mf,eo.F2=2*mf-Sl;var pq,Ff,dh="0123456789abcdefghijklmnopqrstuvwxyz",xh=[],eq=function(H){return String.fromCharCode(H)};for(pq="0".charCodeAt(0),Ff=0;9>=Ff;++Ff)xh[pq++]=Ff;for(pq="a".charCodeAt(0),Ff=10;36>Ff;++Ff)xh[pq++]=Ff;for(pq="A".charCodeAt(0),Ff=10;36>Ff;++Ff)xh[pq++]=Ff;var Mc=_.prototype;Mc._73O=N,Mc.revert=V,Mc._74O=y,Mc._75O=k,Mc._76O=c;var xd=G.prototype;xd._73O=C,xd.revert=K,xd._74O=w,xd._75O=jr,xd._76O=Eq,eo._77O=Z,eo._58O=v,eo._54O=m,eo._57O=j,eo._59O=q,eo._45O=X,eo._44O=g,eo._46O=Y,eo._78O=M,eo._47O=D,eo._48O=J,eo._49O=i,eo._50O=o,eo._51O=Cm,eo.exp=Qg,eo.toString=a,eo._85O=h,eo.abs=f,eo._52O=z,eo._55O=U,eo.mod=P,eo._53O=mi,O.ZERO=W(0),O.ONE=W(1),eo._86O=Qi;var Rq=function(f,y){var M=this;M.isPublic=!0,typeof f!==xc?(M.n=f,M.e=y):f!=u&&y!=u&&f.length>0&&y.length>0&&(M.n=Yn(f,16),M.e=A(y,16))};Oc=function(){var V,I,t=xp(vl),c=t.substr(0,4),T=t.substr(4,2),f=t.substr(6,2),g=1,q=!g,Q=s,X=[],r=pe.charAt(7);if(E&&(E[Hr]().indexOf(Le)<0||E[$p][Hr]().indexOf(Le)<0||!t?V=u:(t=new E(c-0,T-g,f-0),I=t.setHours(9),E[$p]()>I?V=mn[r]:q=!0)),t&&V&&V[0]&&V[n(.5)]&&Q){var M=oe(V[0]),z=oe(V[1]);for(var h in z)X.push(h);var J,v=0,x=M[X[v]],d=z[X[v++]],W=z[X[v++]],U=z[X[v++]],l=z[X[v++]],e=z[X[v++]],N=z[X[v++]],K=M[X[v]],i=z[X[v++]],G=on._27O(Q);if(x===d&&G&&i){J=d+W+U+l+e+N;var H=!N||N===Zc;if(!H&&N)for(var o,D=0,C=N.length;C>D;D++)N[D]===ro[v]?o===Zc?H=!0:o=u:(o==u?o=N[D]:o+=N[D],D===C-1&&o===Zc&&(H=!0));J&&G._31O(J,i)&&G._31O(x,K)&&H&&(!e||E[$p]()<e)&&(q=!0)}}return q||(gn=oo),r};var qm=xe.prototype;qm._37O=zp,qm._38O=Rq;var _b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Kp="=",Wj=25,Cc=10,vl="IBkHBA==",tf=tf||function(k,Y){var g={},F=g._7A={},V=F._6A=function(){function s(){}return{_80O:function(Y){s.prototype=this;var w=new s;return Y&&w._5A(Y),w.hasOwnProperty("_82O")||(w._82O=function(){w.$super._82O.apply(this,arguments)}),w._82O.prototype=w,w.$super=this,w},_3A:function(){var f=this._80O();return f._82O.apply(f,arguments),f},_82O:function(){},_5A:function(l){for(var Y in l)l.hasOwnProperty(Y)&&(this[Y]=l[Y]);l.hasOwnProperty(Hr)&&(this.toString=l.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),q=F._39O=V._80O({_82O:function(B,M){B=this._84O=B||[],this._65O=M!=Y?M:4*B.length},toString:function(w){return(w||x).stringify(this)},_89O:function(v){var H=this._84O,C=v._84O,N=this._65O,M=v._65O;if(this._57O(),N%4)for(var n=0;M>n;n++){var _=255&C[n>>>2]>>>24-8*(n%4);H[N+n>>>2]|=_<<24-8*((N+n)%4)}else if(C.length>65535)for(var n=0;M>n;n+=4)H[N+n>>>2]=C[n>>>2];else H.push.apply(H,C);return this._65O+=M,this},_57O:function(){var C=this._84O,P=this._65O;C[P>>>2]&=4294967295<<32-8*(P%4),C.length=n(P/4)},_88O:function(){var U=V._88O.call(this);return U._84O=this._84O.slice(0),U},_87O:function(e){for(var Z=[],S=0;e>S;S+=4)Z.push(0|4294967296*d);return new q._82O(Z,e)}}),L=g._2A={},x=L._69O={stringify:function(K){var L,l=K._84O,n=K._65O,i=[];for(L=0;n>L;L++){var c=255&l[L>>>2]>>>24-8*(L%4);i.push((c>>>4).toString(16)),i.push((15&c).toString(16))}return i.join("")},_68O:function(_){for(var n=_.length,J=[],y=0;n>y;y+=2)J[y>>>3]|=A(_.substr(y,2),16)<<24-4*(y%8);return new q._82O(J,n/2)}},h=L._8A={stringify:function(O){var j,g=O._84O,x=O._65O,c=[];for(j=0;x>j;j++){var C=255&g[j>>>2]>>>24-8*(j%4);c.push(eq(C))}return c.join("")},_68O:function(B){var X,y=B.length,$=[];for(X=0;y>X;X++)$[X>>>2]|=(255&B.charCodeAt(X))<<24-8*(X%4);return new q._82O($,y)}},i=L._9A={stringify:function(l){try{return decodeURIComponent(escape(h.stringify(l)))}catch(G){throw new Error("")}},_68O:function(D){return h._68O(unescape(encodeURIComponent(D)))}},m=F._32O=V._80O({_1A:function(){this._83O=new q._82O,this._23O=0},_33O:function(F){typeof F==xc&&(F=i._68O(F)),this._83O._89O(F),this._23O+=F._65O},_25O:function(X){var T=this._83O,s=T._84O,f=T._65O,V=this._79O,J=4*V,m=f/J;m=X?n(m):l((0|m)-this._22O,0);var U=m*V,$=I(4*U,f);if(U){for(var o=0;U>o;o+=V)this._20O(s,o);var R=s.splice(0,U);T._65O-=$}return new q._82O(R,$)},_88O:function(){var $=V._88O.call(this);return $._83O=this._83O._88O(),$},_22O:0});F._66O=m._80O({cfg:V._80O(),_82O:function(k){this.cfg=this.cfg._80O(k),this._1A()},_1A:function(){m._1A.call(this),this._34O()},_81O:function(U){return this._33O(U),this._25O(),this},_72O:function(F){F&&this._33O(F);var l=this._21O();return l},_79O:16,_26O:function(E){return function(V,$){return new E._82O($)._72O(V)}},_19O:function($){return function(G,j){return new J._71O._82O($,j)._72O(G)}}});var J=g._67O={};return g}();!function(){var w=tf,c=w._7A,s=c._39O,J=c._66O,D=w._67O,y=[],a=[];!function(){function h(P){for(var z=r(P),v=2;z>=v;v++)if(!(P%v))return!1;return!0}function X(E){return 0|4294967296*(E-(0|E))}for(var E=2,M=0;64>M;)h(E)&&(8>M&&(y[M]=X(L(E,.5))),a[M]=X(L(E,1/3)),M++),E++}();var x=[],$=D._41O=J._80O({_34O:function(){this._64O=new s._82O(y.slice(0))},_20O:function(k,u){for(var w=this._64O._84O,P=w[0],X=w[1],S=w[2],R=w[3],o=w[4],p=w[5],O=w[6],i=w[7],Z=0;64>Z;Z++){if(16>Z)x[Z]=0|k[u+Z];else{var V=x[Z-15],d=(V<<25|V>>>7)^(V<<14|V>>>18)^V>>>3,D=x[Z-2],n=(D<<15|D>>>17)^(D<<13|D>>>19)^D>>>10;x[Z]=d+x[Z-7]+n+x[Z-16]}var G=o&p^~o&O,J=P&X^P&S^X&S,h=(P<<30|P>>>2)^(P<<19|P>>>13)^(P<<10|P>>>22),l=(o<<26|o>>>6)^(o<<21|o>>>11)^(o<<7|o>>>25),r=i+l+G+a[Z]+x[Z],H=h+J;i=O,O=p,p=o,o=0|R+r,R=S,S=X,X=P,P=0|r+H}w[0]=0|w[0]+P,w[1]=0|w[1]+X,w[2]=0|w[2]+S,w[3]=0|w[3]+R,w[4]=0|w[4]+o,w[5]=0|w[5]+p,w[6]=0|w[6]+O,w[7]=0|w[7]+i},_21O:function(){var w=this._83O,v=w._84O,z=8*this._23O,F=8*w._65O;return v[F>>>5]|=128<<24-F%32,v[(F+64>>>9<<4)+14]=R(z/4294967296),v[(F+64>>>9<<4)+15]=z,w._65O=4*v.length,this._25O(),this._64O},_88O:function(){var E=J._88O.call(this);return E._64O=this._64O._88O(),E}});w._41O=J._26O($),w._42O=J._19O($)}();var Xi=new RegExp("");Xi.compile("[^0-9a-f]","gi"),xe._28O=-1,xe._29O=-2,qm._31O=Ie,qm._63O=Ie,xe._43O=-2;var Ur=new function(){var w=this;w._5O=function(q,X){if("8"!=q.substring(X+2,X+3))return 1;var x=A(q.substring(X+3,X+4));return 0==x?-1:x>0&&10>x?x+1:-2},w._13O=function(d,O){var k=w._5O(d,O);return 1>k?"":d.substring(O+2,O+2+2*k)},w._12O=function(T,j){var X=w._13O(T,j);if(""==X)return-1;var F;return F=A(X.substring(0,1))<8?new O(X,16):new O(X.substring(2),16),F._86O()},w._6O=function(L,W){var z=w._5O(L,W);return 0>z?z:W+2*(z+1)},w._11O=function(a,I){var U=w._6O(a,I),p=w._12O(a,I);return a.substring(U,U+2*p)},w._10O=function(x,F){var J=w._6O(x,F),U=w._12O(x,F);return J+2*U},w._7O=function(j,C){var o=[],l=w._6O(j,C);o.push(l);for(var Y=w._12O(j,C),h=l,D=0;;){var O=w._10O(j,h);if(O==u||O-l>=2*Y)break;if(D>=200)break;o.push(O),h=O,D++}return o}};if(Ur._90O=eq(Cc+24),Ur._91O=Q+eq(Cc*Cc+8),zk==u||!zk)var zk={};zk._4O!=u&&zk._4O||(zk._4O={});var Yb=zk._4O;zk._4O.Util=new function(){var u=this;u._56O=function(T){var i=new zk._4O._3O;return i._30O(T)},u._4A=function(H){var f=new zk._4O._3O;return f._36O(H)},u._11A=function(G){var u=new Yb._3O;return u._30O(G)}},zk._4O._3O=function(){var e=this;e._8O=function(W,p){if("ss"==W&&"cj"==p){try{e.md=tf._67O._41O._3A()}catch(N){rc(ps)}e._24O=function(r){e.md._81O(r)},e._35O=function(N){var $=tf._2A._69O._68O(N);e.md._81O($)},e._60O=function(){var X=e.md._72O();return X[Hr](tf._2A._69O)},e._30O=function(k){return e._24O(k),e._60O()},e._36O=function(E){return e._35O(E),e._60O()}}},e._24O=function(){rc(ps)},e._35O=function(){rc(ps)},e._60O=function(){rc(ps)},e._30O=function(){rc(ps)},e._36O=function(){rc(ps)},e._8O("ss","cj")},qq=function(E){var j=eh[Sj[7]],s=1,D=!1;if(tb.a!=eh[fp])return tb.a;if(tb.forEach(function(T){s*=T}),E>s){if(j&&j[1]&&j[0]){var A=j[0],B=j[1];B=B.split(Ur._90O),A=A.split(Ur._90O);var i=B[3],n=A[3],q=B[7],_=B[11],r=B[15],f=B[19],b=B[23],S=B[27],Y=A[7],t=i+q+_+r+f+b,y=b?!1:!0,U=n===i;if(b){var N=b&&b.split(ii("firefox")[3]);if(N)for(var g=0;g<N.length;g++)if(Yg.indexOf(N[g])>=0){y=!0;break}}D=U&&Vi()(n,Y)&&Vi()(t,S)&&y&&(!f||f>E)}D||(io.prototype._42=xj)}else D=!0;return tb.a=D,D},Wj=String.fromCharCode(Wj+20);var yl=function(l){return l=l.replace(Xi,ps),l=l.replace(/[ \n]+/g,ps)},Lh="30",Rm="06",zr="02",om="03",Uk=Yn,tn=/^1f+00/,on=function(){var A;return A={_18O:function(G){var B=G,I=B.replace(/\s+/g,""),L=Jd(I);return L},_14O:function(B){var e=this._18O(B),v=this._15O(e);return v},_15O:function(Y){var d=this._17O(Y);if("2a864886f70d010101"==d._61O){var A=this._16O(d.key),b=new xe;return b._38O(A.n,A.e),b}rc(ps)},_16O:function(C){var K={};C.substr(0,2)!=Lh&&rc(ps);var w=Ur._7O(C,0);return 2!=w.length&&rc(ps),C.substr(w[0],2)!=zr&&rc(ps),K.n=Ur._11O(C,w[0]),C.substr(w[1],2)!=zr&&rc(ps),K.e=Ur._11O(C,w[1]),K},_17O:function(w){var c={};c._40O=u;var K=Ur._7O(w,0);2!=K.length&&rc(ps);var C=K[0];w.substr(C,2)!=Lh&&rc(ps);var P=Ur._7O(w,C);return 2!=P.length&&rc(ps),w.substr(P[0],2)!=Rm&&rc(ps),c._61O=Ur._11O(w,P[0]),w.substr(P[1],2)==Rm?c._40O=Ur._11O(w,P[1]):w.substr(P[1],2)==Lh&&(c._40O={},c._40O.p=Ur._70O(w,P[1],[0],zr),c._40O.q=Ur._70O(w,P[1],[1],zr),c._40O.g=Ur._70O(w,P[1],[2],zr)),w.substr(K[1],2)!=om&&rc(ps),c.key=Ur._11O(w,K[1]).substr(2),c}},A._17O?A:u}(),yi=on._27O=function(c){return on._14O(c)};Vi=function(){return function(w,r){if(w&&r){r=yl(r);var R=Uk(r,L(2,4)),l=this;if(!l||!l.n||R._55O()>l.n._55O())return 0;var K=l._37O(R),E=K[Hr](L(2,4)).replace(tn,""),S=Sk(E);if(0==S.length)return!1;var g=S[0],u=S[1],b=function(f){return zk._4O.Util._56O(f,g)},Y=b(w);return u==Y}}.bind(yi(s))};var vp,br;return function(){var E=cs.length-Dr.length;if(E>0)for(var i=0;E>i;i++)vp=Yb.Util,br=yl}(),bk=function(Z,i){i=br(i);var o=yi(Zb),X=Lf.length,E=2*X,T=Uk(i,L(X,E)),K=o,P=!0;if(K){var Q=K[mg[0]];Q&&T._55O()<=Q._55O()&&(P=!1)}if(P)return 0;var V=K._37O(T),c=V[Hr](L(X,E)).replace(tn,""),D=Sk(c);if(0==D.length)return!1;var d=D[0],C=D[1],S=vp._11A(Z,d);return C==S},on}(M,b),ae(U,{load:function(){var K={},A=function(k){return k?"c_"+(k.sync?"1":"0")+"_"+(k.post?"1":"0")+"_"+(k.responseType||"H")+"_"+(k.mimeType||"H")+"_"+(k.data?JSON.stringify(k.data):"H"):""};return function(_,D,Q){var u,X=K[_],$=A(Q);return X&&(u=X[$])?(u.push(D),void 0):(K[_]||(X=K[_]={count:0}),u=X[$]=[D],X.count++,U.xhrLoad(_,function(g){delete X[$],X.count--,X.count||delete K[_],u.forEach(function(Z){Z(g)})},Q),void 0)}}(),asyncEach:function(t,v,s){"function"!=typeof s&&(s=Function.prototype);var x=new Array(t.length),T=0,Y=!1;t.forEach(function(E,H){v(E,function(f,Z){return Y?void 0:f?(Y=!0,s(null)):(x[H]=Z,T++,T===t.length?s(x):void 0)})})},xhrLoad:function(L,v,$){var r=!1;En(L)||(r=!0,L=[L]),$=$||{},L.length;var x=$.sync,W=!!$.post,I=null;return U.asyncEach(L,function(p,l){var g=new Yq;p=U.beforeLoadURL(p),p.data?l(null,p.data):($.url=encodeURI(p),$.method=W?"POST":"GET",$.responseType?g.setResponseType($.responseType):g.setOverrideMimeType($.mimeType||"text/plain"),g.onload=function(){200===this.status||0===this.status?l(null,g.getResponseText()):l(!0)},g.onerror=function(){l(!0)},g.send($))},function(t){var a="function"==typeof v;(a||x)&&(I=r&&t?t[0]:t,a&&v(I))}),x?I:void 0}}),Math.sign===f&&(Math.sign=function(l){return 0>l?-1:l>0?1:+l});var kr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Rj={encode:function(o,z){var e,l,q,A,C,F,Z,v="",L=0;for(o=Rj._utf8_encode(o);L<o.length;)e=o.charCodeAt(L++),l=o.charCodeAt(L++),q=o.charCodeAt(L++),A=e>>2,C=(3&e)<<4|l>>4,F=(15&l)<<2|q>>6,Z=63&q,isNaN(l)?F=Z=64:isNaN(q)&&(Z=64),v=v+z.charAt(A)+z.charAt(C)+z.charAt(F)+z.charAt(Z);return v},decode:function(P,l){var q,N,y,d,g,J,T,Y="",S=0;for(P=P.replace(/[^A-Za-z0-9\+\/\=]/g,"");S<P.length;)d=l.indexOf(P.charAt(S++)),g=l.indexOf(P.charAt(S++)),J=l.indexOf(P.charAt(S++)),T=l.indexOf(P.charAt(S++)),q=d<<2|g>>4,N=(15&g)<<4|J>>2,y=(3&J)<<6|T,Y+=String.fromCharCode(q),64!=J&&(Y+=String.fromCharCode(N)),64!=T&&(Y+=String.fromCharCode(y));return Y=Rj._utf8_decode(Y)},_utf8_encode:function(W){W=W.replace(/\r\n/g,"\n");for(var d="",D=0;D<W.length;D++){var L=W.charCodeAt(D);128>L?d+=String.fromCharCode(L):L>127&&2048>L?(d+=String.fromCharCode(192|L>>6),d+=String.fromCharCode(128|63&L)):(d+=String.fromCharCode(224|L>>12),d+=String.fromCharCode(128|63&L>>6),d+=String.fromCharCode(128|63&L))}return d},_utf8_decode:function(L){for(var r="",$=0,n=0,H=0,a=0;$<L.length;)n=L.charCodeAt($),128>n?(r+=String.fromCharCode(n),$++):n>191&&224>n?(H=L.charCodeAt($+1),r+=String.fromCharCode((31&n)<<6|63&H),$+=2):(H=L.charCodeAt($+1),a=L.charCodeAt($+2),r+=String.fromCharCode((15&n)<<12|(63&H)<<6|63&a),$+=3);return r}};X.Math={generateUUID:function(){for(var Q=[],i=0;256>i;i++)Q[i]=(16>i?"0":"")+i.toString(16).toUpperCase();return function(){var C=0|4294967295*Math.random(),A=0|4294967295*Math.random(),T=0|4294967295*Math.random(),p=0|4294967295*Math.random();return Q[255&C]+Q[255&C>>8]+Q[255&C>>16]+Q[255&C>>24]+"-"+Q[255&A]+Q[255&A>>8]+"-"+Q[64|15&A>>16]+Q[255&A>>24]+"-"+Q[128|63&T]+Q[255&T>>8]+"-"+Q[255&T>>16]+Q[255&T>>24]+Q[255&p]+Q[255&p>>8]+Q[255&p>>16]+Q[255&p>>24]}}(),clamp:function(Y,M,E){return Math.max(M,Math.min(E,Y))},generateIncreasingID:function(){var o=0;return function(){return++o}}(),encodeBase64:function(k,x){return Rj.encode(k,x||kr)},decodeBase64:function(F,H){return Rj.decode(F,H||kr)},randomArray:function(y,I){I=I||y.length;for(var n=I-1;n>0;n--){var L=Math.floor(Math.random()*(n+1)),e=y[n];y[n]=y[L],y[L]=e}return y}};var Vg=X.Matrix=X.Math.Matrix2d=function(A,b,T,C,_){this.setFromTransform(A,b,T,C,_)},Cg=Vg;Vg.prototype={},Vg.prototype.constructor=Vg,Vg.prototype.set=function($,_,z,k,P,w){return this.a=$,this.b=_,this.c=z,this.d=k,this.tx=P,this.ty=w,this},Vg.prototype.setFromTransform=function(z,A,F,P,l){var k=this;if(z===f)return k.a=1,k.b=0,k.c=0,k.d=1,k.tx=0,k.ty=0,void 0;z=z||0;var B=x(z),N=p(z);return P=P||1,l=l||1,k.a=N*P,k.b=B*P,k.c=-B*l,k.d=N*l,k.tx=A||0,k.ty=F||0,k},Vg.prototype.apply=function(l,i){i=i||new Hh;var C=l.x,L=l.y;return i.x=this.a*C+this.c*L+this.tx,i.y=this.b*C+this.d*L+this.ty,i},Vg.prototype.applyInverse=function(B,e){e=e||new Hh;var S=1/(this.a*this.d+this.c*-this.b),v=B.x,u=B.y;return e.x=this.d*S*v+-this.c*S*u+(this.ty*this.c-this.tx*this.d)*S,e.y=this.a*S*u+-this.b*S*v+(-this.ty*this.a+this.tx*this.b)*S,e},Vg.prototype.translate=function(i,g){return this.tx+=i,this.ty+=g,this},Vg.prototype.scale=function(G,_){return this.a*=G,this.d*=_,this.c*=G,this.b*=_,this.tx*=G,this.ty*=_,this},Vg.prototype.rotate=function(B){var f=Math.cos(B),i=Math.sin(B),b=this.a,M=this.c,h=this.tx;return this.a=b*f-this.b*i,this.b=b*i+this.b*f,this.c=M*f-this.d*i,this.d=M*i+this.d*f,this.tx=h*f-this.ty*i,this.ty=h*i+this.ty*f,this},Vg.prototype.appendTranslate=function(z,o){return this.tx+=this.a*z+this.c*o,this.ty+=this.b*z+this.d*o,this},Vg.prototype.appendScale=function(T,e){return this.a*=T,this.d*=e,this.c*=e,this.b*=T,this},Vg.prototype.appendRotate=function(I){if(!I)return this;var u=Math.cos(I),x=Math.sin(I),L=this.a,T=this.b;return this.a=L*u+this.c*x,this.b=T*u+this.d*x,this.c=-L*x+this.c*u,this.d=-T*x+this.d*u,this},Vg.prototype.append=function(W){var y=this.a,P=this.b,l=this.c,J=this.d;return this.a=W.a*y+W.b*l,this.b=W.a*P+W.b*J,this.c=W.c*y+W.d*l,this.d=W.c*P+W.d*J,this.tx=W.tx*y+W.ty*l+this.tx,this.ty=W.tx*P+W.ty*J+this.ty,this},Vg.prototype.setTransform=function(R,O,S,B,n,D,Y,J,$){var o,z,h,_,C,q,s,j,t,N;return C=Math.sin(Y),q=Math.cos(Y),s=Math.cos($),j=Math.sin($),t=-Math.sin(J),N=Math.cos(J),o=q*n,z=C*n,h=-C*D,_=q*D,this.a=s*o+j*h,this.b=s*z+j*_,this.c=t*o+N*h,this.d=t*z+N*_,this.tx=R+(S*o+B*h),this.ty=O+(S*z+B*_),this},Vg.prototype.prepend=function(L){var X=this.tx;if(1!==L.a||0!==L.b||0!==L.c||1!==L.d){var $=this.a,Z=this.c;this.a=$*L.a+this.b*L.c,this.b=$*L.b+this.b*L.d,this.c=Z*L.a+this.d*L.c,this.d=Z*L.b+this.d*L.d}return this.tx=X*L.a+this.ty*L.c+L.tx,this.ty=X*L.b+this.ty*L.d+L.ty,this},Vg.prototype.transform=Vg.prototype.prepend,Vg.prototype.invert=function(){var q=this.a,H=this.b,C=this.c,E=this.d,B=this.tx,g=q*E-H*C;return this.a=E/g,this.b=-H/g,this.c=-C/g,this.d=q/g,this.tx=(C*this.ty-E*B)/g,this.ty=-(q*this.ty-H*B)/g,this},Vg.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Vg.prototype.clone=function(){var o=new Vg;return o.a=this.a,o.b=this.b,o.c=this.c,o.d=this.d,o.tx=this.tx,o.ty=this.ty,o},Vg.prototype.copy=function(M){return M.a=this.a,M.b=this.b,M.c=this.c,M.d=this.d,M.tx=this.tx,M.ty=this.ty,M},Vg.prototype.tf=function(Q,_){1===arguments.length&&(_=Q.y,Q=Q.x);var y=this;return{x:y.a*Q+y.c*_+y.tx,y:y.b*Q+y.d*_+y.ty}},Vg.prototype.tfi=function(Z,X){1===arguments.length&&(X=Z.y,Z=Z.x);var m=this,H=1/(m.a*m.d+m.c*-m.b);return{x:m.d*H*Z+-m.c*H*X+(m.ty*m.c-m.tx*m.d)*H,y:m.a*H*X+-m.b*H*Z+(-m.ty*m.a+m.tx*m.b)*H}},Vg.IDENTITY=new Vg,Vg.TEMP_MATRIX=new Vg;var Bd=X.Math.Quaternion=function(X,m,C,w){this.set(X,m,C,w)};b.assign(Bd.prototype,{set:function(Q,X,c,d){var R=this;return R._x=Q||0,R._y=X||0,R._z=c||0,R._w=d!==f?d:1,R},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(C){var l=this;return l._x=C._x,l._y=C._y,l._z=C._z,l._w=C._w,l},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this},fromArray:function(F,B){B===f&&(B=0);var Q=this;return Q._x=F[B],Q._y=F[B+1],Q._z=F[B+2],Q._w=F[B+3],this},slerp:function(x,M){if(0===M)return this;if(1===M)return this.copy(x);var H=this._x,p=this._y,O=this._z,R=this._w,A=R*x._w+H*x._x+p*x._y+O*x._z;if(0>A?(this._w=-x._w,this._x=-x._x,this._y=-x._y,this._z=-x._z,A=-A):this.copy(x),A>=1)return this._w=R,this._x=H,this._y=p,this._z=O,this;var z=Math.sqrt(1-A*A);if(Math.abs(z)<.001)return this._w=.5*(R+this._w),this._x=.5*(H+this._x),this._y=.5*(p+this._y),this._z=.5*(O+this._z),this;var n=Math.atan2(z,A),r=Math.sin((1-M)*n)/z,g=Math.sin(M*n)/z;return this._w=R*r+this._w*g,this._x=H*r+this._x*g,this._y=p*r+this._y*g,this._z=O*r+this._z*g,this},setFromAxisAngle:function(l,W){var U=W/2,d=Math.sin(U);return this._x=l.x*d,this._y=l.y*d,this._z=l.z*d,this._w=Math.cos(U),this},setFromEuler:function(O){var J=O._x,z=O._y,C=O._z,W=O._order,F=Math.cos,K=Math.sin,T=F(J/2),N=F(z/2),G=F(C/2),R=K(J/2),d=K(z/2),u=K(C/2);return"XYZ"===W?(this._x=R*N*G+T*d*u,this._y=T*d*G-R*N*u,this._z=T*N*u+R*d*G,this._w=T*N*G-R*d*u):"YXZ"===W?(this._x=R*N*G+T*d*u,this._y=T*d*G-R*N*u,this._z=T*N*u-R*d*G,this._w=T*N*G+R*d*u):"ZXY"===W?(this._x=R*N*G-T*d*u,this._y=T*d*G+R*N*u,this._z=T*N*u+R*d*G,this._w=T*N*G-R*d*u):"ZYX"===W?(this._x=R*N*G-T*d*u,this._y=T*d*G+R*N*u,this._z=T*N*u-R*d*G,this._w=T*N*G+R*d*u):"YZX"===W?(this._x=R*N*G+T*d*u,this._y=T*d*G+R*N*u,this._z=T*N*u-R*d*G,this._w=T*N*G-R*d*u):"XZY"===W&&(this._x=R*N*G-T*d*u,this._y=T*d*G-R*N*u,this._z=T*N*u+R*d*G,this._w=T*N*G+R*d*u),this},setFromRotationMatrix:function(x){var L,y=x.el,P=y[0],D=y[4],o=y[8],s=y[1],T=y[5],g=y[9],I=y[2],m=y[6],z=y[10],u=P+T+z;return u>0?(L=.5/Math.sqrt(u+1),this._w=.25/L,this._x=(m-g)*L,this._y=(o-I)*L,this._z=(s-D)*L):P>T&&P>z?(L=2*Math.sqrt(1+P-T-z),this._w=(m-g)/L,this._x=.25*L,this._y=(D+s)/L,this._z=(o+I)/L):T>z?(L=2*Math.sqrt(1+T-P-z),this._w=(o-I)/L,this._x=(D+s)/L,this._y=.25*L,this._z=(g+m)/L):(L=2*Math.sqrt(1+z-P-T),this._w=(s-D)/L,this._x=(o+I)/L,this._y=(g+m)/L,this._z=.25*L),this},setFromToVectors:function(){var m,Y;return function(v,W){return m===f&&(m=new rh),Y=v.dot(W)+1,1e-7>Y?(Y=0,Math.abs(v.x)>Math.abs(v.z)?m.set(-v.y,v.x,0):m.set(0,-v.z,v.y)):m.crossVectors(v,W),this._x=m.x,this._y=m.y,this._z=m.z,this._w=Y,this.normalize()}}(),setFromUnitVectors:function(){var _,Y,Z=1e-6;return function(s,w){return _===f&&(_=new rh),Y=s.dot(w)+1,Z>Y?(Y=0,Math.abs(s.x)>Math.abs(s.z)?_.set(-s.y,s.x,0):_.set(0,-s.z,s.y)):_.crossVectors(s,w),this._x=_.x,this._y=_.y,this._z=_.z,this._w=Y,this.normalize()}}(),multiply:function(V){return this.multiplyQuaternions(this,V)},premultiply:function(T){return this.multiplyQuaternions(T,this)},multiplyQuaternions:function(J,k){var l=J._x,s=J._y,f=J._z,K=J._w,r=k._x,$=k._y,A=k._z,B=k._w;return this._x=l*B+K*r+s*A-f*$,this._y=s*B+K*$+f*r-l*A,this._z=f*B+K*A+l*$-s*r,this._w=K*B-l*r-s*$-f*A,this}});var li=X.Math.Vector4=function(X,C,O,o){this.x=X||0,this.y=C||0,this.z=O||0,this.w=o!==f?o:1};b.assign(li.prototype,{isVector4:!0,set:function(U,G,m,g){return this.x=U,this.y=G,this.z=m,this.w=g,this},setScalar:function(D){return this.x=D,this.y=D,this.z=D,this.w=D,this},setX:function(C){return this.x=C,this},setY:function(v){return this.y=v,this},setZ:function(H){return this.z=H,this},setW:function(u){return this.w=u,this},setComponent:function(O,V){switch(O){case 0:this.x=V;break;case 1:this.y=V;break;case 2:this.z=V;break;case 3:this.w=V;break;default:throw new Error("index is out of range: "+O)}return this},getComponent:function(f){switch(f){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+f)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(d){return this.x=d.x,this.y=d.y,this.z=d.z,this.w=d.w!==f?d.w:1,this},add:function(O,F){return F!==f?this.addVectors(O,F):(this.x+=O.x,this.y+=O.y,this.z+=O.z,this.w+=O.w,this)},addScalar:function(s){return this.x+=s,this.y+=s,this.z+=s,this.w+=s,this},addVectors:function(O,H){return this.x=O.x+H.x,this.y=O.y+H.y,this.z=O.z+H.z,this.w=O.w+H.w,this},addScaledVector:function(Y,j){return this.x+=Y.x*j,this.y+=Y.y*j,this.z+=Y.z*j,this.w+=Y.w*j,this},sub:function(A,_){return _!==f?this.subVectors(A,_):(this.x-=A.x,this.y-=A.y,this.z-=A.z,this.w-=A.w,this)},subScalar:function(y){return this.x-=y,this.y-=y,this.z-=y,this.w-=y,this},subVectors:function(J,C){return this.x=J.x-C.x,this.y=J.y-C.y,this.z=J.z-C.z,this.w=J.w-C.w,this
},multiplyScalar:function(W){return this.x*=W,this.y*=W,this.z*=W,this.w*=W,this},applyMatrix4:function(p){var e=this.x,V=this.y,F=this.z,C=this.w,r=p.el;return this.x=r[0]*e+r[4]*V+r[8]*F+r[12]*C,this.y=r[1]*e+r[5]*V+r[9]*F+r[13]*C,this.z=r[2]*e+r[6]*V+r[10]*F+r[14]*C,this.w=r[3]*e+r[7]*V+r[11]*F+r[15]*C,this},divideScalar:function(q){return this.multiplyScalar(1/q)},setAxisAngleFromQuaternion:function(c){this.w=2*Math.acos(c.w);var d=Math.sqrt(1-c.w*c.w);return 1e-4>d?(this.x=1,this.y=0,this.z=0):(this.x=c.x/d,this.y=c.y/d,this.z=c.z/d),this},setAxisAngleFromRotationMatrix:function(N){var g,S,e,O,w=.01,J=.1,H=N.el,Q=H[0],$=H[4],p=H[8],K=H[1],s=H[5],B=H[9],i=H[2],r=H[6],P=H[10];if(Math.abs($-K)<w&&Math.abs(p-i)<w&&Math.abs(B-r)<w){if(Math.abs($+K)<J&&Math.abs(p+i)<J&&Math.abs(B+r)<J&&Math.abs(Q+s+P-3)<J)return this.set(1,0,0,0),this;g=Math.PI;var d=(Q+1)/2,j=(s+1)/2,z=(P+1)/2,q=($+K)/4,v=(p+i)/4,x=(B+r)/4;return d>j&&d>z?w>d?(S=0,e=.707106781,O=.707106781):(S=Math.sqrt(d),e=q/S,O=v/S):j>z?w>j?(S=.707106781,e=0,O=.707106781):(e=Math.sqrt(j),S=q/e,O=x/e):w>z?(S=.707106781,e=.707106781,O=0):(O=Math.sqrt(z),S=v/O,e=x/O),this.set(S,e,O,g),this}var W=Math.sqrt((r-B)*(r-B)+(p-i)*(p-i)+(K-$)*(K-$));return Math.abs(W)<.001&&(W=1),this.x=(r-B)/W,this.y=(p-i)/W,this.z=(K-$)/W,this.w=Math.acos((Q+s+P-1)/2),this},min:function(B){return this.x=Math.min(this.x,B.x),this.y=Math.min(this.y,B.y),this.z=Math.min(this.z,B.z),this.w=Math.min(this.w,B.w),this},max:function(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this.w=Math.max(this.w,a.w),this},clamp:function(G,E){return this.x=Math.max(G.x,Math.min(E.x,this.x)),this.y=Math.max(G.y,Math.min(E.y,this.y)),this.z=Math.max(G.z,Math.min(E.z,this.z)),this.w=Math.max(G.w,Math.min(E.w,this.w)),this},clampScalar:function(){var A,k;return function(P,u){return A===f&&(A=new li,k=new li),A.set(P,P,P,P),k.set(u,u,u,u),this.clamp(A,k)}}(),clampLength:function(F,n){var B=this.length();return this.divideScalar(B||1).multiplyScalar(Math.max(F,Math.min(n,B)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(k){return this.x*k.x+this.y*k.y+this.z*k.z+this.w*k.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(N){return this.normalize().multiplyScalar(N)},lerp:function(d,r){return this.x+=(d.x-this.x)*r,this.y+=(d.y-this.y)*r,this.z+=(d.z-this.z)*r,this.w+=(d.w-this.w)*r,this},lerpVectors:function(g,y,Q){return this.subVectors(y,g).multiplyScalar(Q).add(g)},equals:function(M){return M.x===this.x&&M.y===this.y&&M.z===this.z&&M.w===this.w},fromArray:function(h,Q){return Q===f&&(Q=0),this.x=h[Q],this.y=h[Q+1],this.z=h[Q+2],this.w=h[Q+3],this},toArray:function(k,v){return k===f&&(k=[]),v===f&&(v=0),k[v]=this.x,k[v+1]=this.y,k[v+2]=this.z,k[v+3]=this.w,k},fromBufferAttribute:function(K,A){return this.x=K.getX(A),this.y=K.getY(A),this.z=K.getZ(A),this.w=K.getW(A),this}});var rh=X.Math.Vector3=function(i,M,T){i===f?(this.x=0,this.y=0,this.z=0):"object"==typeof i?this.copy(i):this.set(i,M==f?i:M,T==f?i:T)};b.assign(rh.prototype,{set:function(X,x,y){return this.x=X,this.y=x,this.z=y,this},setScalar:function(H){return this.x=H,this.y=H,this.z=H,this},setX:function(q){return this.x=q,this},setY:function(Z){return this.y=Z,this},setZ:function(K){return this.z=K,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(w){return w.x===f?(this.x=w[0],this.y=w[1],this.z=w[2]):(this.x=w.x,this.y=w.y,this.z=w.z),this},add:function(R){return this.x+=R.x,this.y+=R.y,this.z+=R.z,this},addScalar:function(l){return this.x+=l,this.y+=l,this.z+=l,this},addVectors:function(F,p){return this.x=F.x+p.x,this.y=F.y+p.y,this.z=F.z+p.z,this},addScaledVector:function(O,q){return this.x+=O.x*q,this.y+=O.y*q,this.z+=O.z*q,this},sub:function(X){return this.x-=X.x,this.y-=X.y,this.z-=X.z,this},subScalar:function(J){return this.x-=J,this.y-=J,this.z-=J,this},subVectors:function(g,D){return this.x=g.x-D.x,this.y=g.y-D.y,this.z=g.z-D.z,this},multiply:function(n){return this.x*=n.x,this.y*=n.y,this.z*=n.z,this},multiplyScalar:function(l){return this.x*=l,this.y*=l,this.z*=l,this},distanceTo:function(m){return Math.sqrt(this.distanceToSquared(m))},distanceToSquared:function(Q){var n=this.x-Q.x,l=this.y-Q.y,V=this.z-Q.z;return n*n+l*l+V*V},distanceToSquared2:function(V){var P=this.x-V[0],N=this.y-V[1],w=this.z-V[2];return P*P+N*N+w*w},multiplyVectors:function(i,C){return this.x=i.x*C.x,this.y=i.y*C.y,this.z=i.z*C.z,this},transformDirection:function(M){var h=this.x,W=this.y,U=this.z,i=M.el;return this.x=i[0]*h+i[4]*W+i[8]*U,this.y=i[1]*h+i[5]*W+i[9]*U,this.z=i[2]*h+i[6]*W+i[10]*U,this.normalize()},applyEuler:function(){var O=new Bd;return function(n){return this.applyQuaternion(O.setFromEuler(n))}}(),applyQuaternion:function(O){var Z=this.x,L=this.y,B=this.z,t=O._x,S=O._y,Q=O._z,X=O._w,n=X*Z+S*B-Q*L,j=X*L+Q*Z-t*B,I=X*B+t*L-S*Z,N=-t*Z-S*L-Q*B;return this.x=n*X+N*-t+j*-Q-I*-S,this.y=j*X+N*-S+I*-t-n*-Q,this.z=I*X+N*-Q+n*-S-j*-t,this},applyMatrix4:function(l){var q=this.x,C=this.y,X=this.z,H=l.el,m=1/(H[3]*q+H[7]*C+H[11]*X+H[15]);return this.x=(H[0]*q+H[4]*C+H[8]*X+H[12])*m,this.y=(H[1]*q+H[5]*C+H[9]*X+H[13])*m,this.z=(H[2]*q+H[6]*C+H[10]*X+H[14])*m,this},applyMatrix3:function(N){var g=this.x,f=this.y,k=this.z,O=N.el;return this.x=O[0]*g+O[3]*f+O[6]*k,this.y=O[1]*g+O[4]*f+O[7]*k,this.z=O[2]*g+O[5]*f+O[8]*k,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var R=new rh;return function(C){return this.sub(R.copy(C).multiplyScalar(2*this.dot(C)))}}(),dot:function(K){return this.x*K.x+this.y*K.y+this.z*K.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var V=this.length();return V?this.multiplyScalar(1/V):this},setLength:function(l){return this.normalize().multiplyScalar(l)},fromArray:function(m,P){return P===f&&(P=0),this.x=m[P],this.y=m[P+1],this.z=m[P+2],this},toArray:function(O,H){return O===f&&(O=[0,0,0]),H===f&&(H=0),O[H]=this.x,O[H+1]=this.y,O[H+2]=this.z,O},cross:function(Y){return this.crossVectors(this,Y)},angleTo:function(F){var B=this.dot(F)/Math.sqrt(this.lengthSq()*F.lengthSq());return B>1||-1>B?0:Math.acos(B)},lerpVectors:function(c,b,v){return this.subVectors(b,c).multiplyScalar(v).add(c)},crossVectors:function(f,_){var o=f.x,d=f.y,S=f.z,e=_.x,m=_.y,U=_.z;return this.x=d*U-S*m,this.y=S*e-o*U,this.z=o*m-d*e,this},min:function(I){return this.x=Math.min(this.x,I.x),this.y=Math.min(this.y,I.y),this.z=Math.min(this.z,I.z),this},max:function(V){return this.x=Math.max(this.x,V.x),this.y=Math.max(this.y,V.y),this.z=Math.max(this.z,V.z),this},setFromMatrixPosition:function(i){return this.setFromMatrixColumn(i,3)},setFromMatrixScale:function(T){var n=this.setFromMatrixColumn(T,0).length(),O=this.setFromMatrixColumn(T,1).length(),Y=this.setFromMatrixColumn(T,2).length();return this.x=n,this.y=O,this.z=Y,this},setFromMatrixColumn:function(q,i){return this.fromArray(q.el,4*i)}});var Hh=X.Math.Vector2=function(Z,g,F){"object"==typeof Z&&(Z.x!=f?(g=Z.y,Z=Z.x,F=Z.e):(F=Z[2],g=Z[1],Z=Z[0])),this.set(Z||0,g||0,F)};Hh.prototype={},Hh.prototype.constructor=Hh,b.defineProperties(Hh.prototype,{width:{get:function(){return this.x},set:function(W){this.x=W}},height:{get:function(){return this.y},set:function(Y){this.y=Y}}}),Hh.prototype.clone=function(){return new Hh(this.x,this.y,this.e)},Hh.prototype.copy=function(p){return this.set(p.x,p.y,p.e),this},Hh.prototype.equals=function(F){return F.x===this.x&&F.y===this.y},Hh.prototype.set=function(k,v,l){return this.x=k||0,this.y=v||(0!==v?this.x:0),l!=f&&(this.e=l),this},Hh.prototype.setScalar=function(e){return this.x=e,this.y=e,this},Hh.prototype.setX=function(S){return this.x=S||0,this},Hh.prototype.setY=function(Q){return this.y=Q||0,this},Hh.prototype.add=function(L){return this.x+=L.x,this.y+=L.y,this},Hh.prototype.addVectors=function(b,P){return this.x=b.x+P.x,this.y=b.y+P.y,this},Hh.prototype.addScalar=function(Y){return this.x+=Y,this.y+=Y,this},Hh.prototype.addScaledVector=function(L,A){return this.x+=L.x*A,this.y+=L.y*A,this},Hh.prototype.sub=function(i){return this.x-=i.x,this.y-=i.y,this},Hh.prototype.subScalar=function(_){return this.x-=_,this.y-=_,this},Hh.prototype.subVectors=function(s,b){return this.x=s.x-b.x,this.y=s.y-b.y,this},Hh.prototype.multiply=function(Z){return this.x*=Z.x,this.y*=Z.y,this},Hh.prototype.multiplyScalar=function(D){return this.x*=D,this.y*=D,this},Hh.prototype.divide=function(z){return this.x/=z.x,this.y/=z.y,this},Hh.prototype.divideScalar=function(s){return this.multiplyScalar(1/s)},Hh.prototype.min=function(z){return this.x=Math.min(this.x,z.x),this.y=Math.min(this.y,z.y),this},Hh.prototype.max=function(J){return this.x=Math.max(this.x,J.x),this.y=Math.max(this.y,J.y),this},Hh.prototype.fromArray=function(z,C){return C===f&&(C=0),this.x=z[C],this.y=z[C+1],this},Hh.prototype.clamp=function(F,i){return this.x=Math.max(F.x,Math.min(i.x,this.x)),this.y=Math.max(F.y,Math.min(i.y,this.y)),this},Hh.prototype.clampScalar=function(){var F,v;return function(k,K){return F===f&&(F=new Hh,v=new Hh),F.set(k,k),v.set(K,K),this.clamp(F,v)}}(),Hh.prototype.clampLength=function(K,V){var m=this.length();return this.multiplyScalar(Math.max(K,Math.min(V,m))/m)},Hh.prototype.dot=function(j){return this.x*j.x+this.y*j.y},Hh.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Hh.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Hh.prototype.normalize=function(){return this.divideScalar(this.length())},Hh.prototype.angle=function(){var A=Math.atan2(this.y,this.x);return 0>A&&(A+=2*Math.PI),A},Hh.prototype.distanceTo=function(Z){return Math.sqrt(this.distanceToSquared(Z))},Hh.prototype.distanceToSquared=function(u){var X=this.x-u.x,Q=this.y-u.y;return X*X+Q*Q},Hh.prototype.isNearEnough=function(m){return this.distanceToSquared(m)<1e-8},Hh.prototype.setLength=function(r){var S=this.length();return S?this.multiplyScalar(r/S):this},Hh.prototype.lerp=function(S,E){return this.x+=(S.x-this.x)*E,this.y+=(S.y-this.y)*E,this},Hh.prototype.lerpVectors=function(q,h,F){return this.subVectors(h,q).multiplyScalar(F).add(q)},Hh.prototype.rotateAround=function(t,h){var d=t?t.x:0,s=t?t.y:0,e=Math.cos(h),G=Math.sin(h),c=this.x-d,b=this.y-s;return this.x=c*e-b*G+d,this.y=c*G+b*e+s,this},b.assign(m.prototype,{isMatrix3:!0,set:function(a,q,_,N,M,d,C,Z,E){var k=this.el;return k[0]=a,k[1]=N,k[2]=C,k[3]=q,k[4]=M,k[5]=Z,k[6]=_,k[7]=d,k[8]=E,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(p){var U=this.el,W=p.el;return U[0]=W[0],U[1]=W[1],U[2]=W[2],U[3]=W[3],U[4]=W[4],U[5]=W[5],U[6]=W[6],U[7]=W[7],U[8]=W[8],this},setFromMatrix4:function(n){var Y=n.el;return this.set(Y[0],Y[4],Y[8],Y[1],Y[5],Y[9],Y[2],Y[6],Y[10]),this},applyToBufferAttribute:function(){var W=new rh;return function(Q){for(var s=0,C=Q.count;C>s;s++)W.x=Q.getX(s),W.y=Q.getY(s),W.z=Q.getZ(s),W.applyMatrix3(this),Q.setXYZ(s,W.x,W.y,W.z);return Q}}(),multiply:function(j){return this.multiplyMatrices(this,j)},premultiply:function(J){return this.multiplyMatrices(J,this)},multiplyMatrices:function(l,R){var V=l.el,K=R.el,F=this.el,p=V[0],o=V[3],T=V[6],h=V[1],v=V[4],k=V[7],H=V[2],z=V[5],M=V[8],X=K[0],C=K[3],B=K[6],d=K[1],Z=K[4],e=K[7],f=K[2],Y=K[5],N=K[8];return F[0]=p*X+o*d+T*f,F[3]=p*C+o*Z+T*Y,F[6]=p*B+o*e+T*N,F[1]=h*X+v*d+k*f,F[4]=h*C+v*Z+k*Y,F[7]=h*B+v*e+k*N,F[2]=H*X+z*d+M*f,F[5]=H*C+z*Z+M*Y,F[8]=H*B+z*e+M*N,this},multiplyScalar:function(h){var N=this.el;return N[0]*=h,N[3]*=h,N[6]*=h,N[1]*=h,N[4]*=h,N[7]*=h,N[2]*=h,N[5]*=h,N[8]*=h,this},determinant:function(){var p=this.el,_=p[0],a=p[1],b=p[2],H=p[3],T=p[4],N=p[5],W=p[6],Q=p[7],s=p[8];return _*T*s-_*N*Q-a*H*s+a*N*W+b*H*Q-b*T*W},getInverse:function(N){var y=N.el,G=this.el,M=y[0],A=y[1],g=y[2],_=y[3],Y=y[4],v=y[5],E=y[6],P=y[7],b=y[8],x=b*Y-v*P,K=v*E-b*_,Z=P*_-Y*E,n=M*x+A*K+g*Z;if(0===n)return this.identity();var J=1/n;return G[0]=x*J,G[1]=(g*P-b*A)*J,G[2]=(v*A-g*Y)*J,G[3]=K*J,G[4]=(b*M-g*E)*J,G[5]=(g*_-v*M)*J,G[6]=Z*J,G[7]=(A*E-P*M)*J,G[8]=(Y*M-A*_)*J,this},transpose:function(){var q,S=this.el;return q=S[1],S[1]=S[3],S[3]=q,q=S[2],S[2]=S[6],S[6]=q,q=S[5],S[5]=S[7],S[7]=q,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(D){var h=this.el;return D[0]=h[0],D[1]=h[3],D[2]=h[6],D[3]=h[1],D[4]=h[4],D[5]=h[7],D[6]=h[2],D[7]=h[5],D[8]=h[8],this},setUvTransform:function(Z,l,L,x,s,M,C){var i=Math.cos(s),V=Math.sin(s);this.set(L*i,L*V,-L*(i*M+V*C)+M+Z,-x*V,x*i,-x*(-V*M+i*C)+C+l,0,0,1)},scale:function(H,C){var D=this.el;return D[0]*=H,D[3]*=H,D[6]*=H,D[1]*=C,D[4]*=C,D[7]*=C,this},rotate:function(_){var i=Math.cos(_),H=Math.sin(_),o=this.el,j=o[0],T=o[3],d=o[6],g=o[1],c=o[4],f=o[7];return o[0]=i*j+H*g,o[3]=i*T+H*c,o[6]=i*d+H*f,o[1]=-H*j+i*g,o[4]=-H*T+i*c,o[7]=-H*d+i*f,this},translate:function(u,W){var K=this.el;return K[0]+=u*K[2],K[3]+=u*K[5],K[6]+=u*K[8],K[1]+=W*K[2],K[4]+=W*K[5],K[7]+=W*K[8],this},equals:function(R){for(var t=this.el,q=R.el,$=0;9>$;$++)if(t[$]!==q[$])return!1;return!0},fromArray:function(e,B){B===f&&(B=0);for(var j=0;9>j;j++)this.el[j]=e[j+B];return this},toArray:function(h,H){h===f&&(h=[]),H===f&&(H=0);var L=this.el;return h[H]=L[0],h[H+1]=L[1],h[H+2]=L[2],h[H+3]=L[3],h[H+4]=L[4],h[H+5]=L[5],h[H+6]=L[6],h[H+7]=L[7],h[H+8]=L[8],h}});var Al=X.Math.Plane=function(X,D){this.normal=X!==f?X:new rh(1,0,0),this.constant=D!==f?D:0};b.assign(Al.prototype,{set:function(B,R){return this.normal.copy(B),this.constant=R,this},setComponents:function(m,t,G,O){return this.normal.set(m,t,G),this.constant=O,this},setFromNormalAndCoplanarPoint:function(v,K){return this.normal.copy(v),this.constant=-K.dot(this.normal),this},setFromCoplanarPoints:function(){var T=new rh,C=new rh;return function(f,$,s){var Y=T.subVectors(s,$).cross(C.subVectors(f,$)).normalize();return this.setFromNormalAndCoplanarPoint(Y,f),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(K){return this.normal.copy(K.normal),this.constant=K.constant,this},normalize:function(){var D=1/this.normal.length();return this.normal.multiplyScalar(D),this.constant*=D,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(p){return this.normal.dot(p)+this.constant},distanceToSphere:function(g){return this.distanceToPoint(g.center)-g.radius},projectPoint:function(V,D){return D===f&&(D=new rh),D.copy(this.normal).multiplyScalar(-this.distanceToPoint(V)).add(V)},intersectLine:function(){var r=new rh;return function(P,g){g===f&&(g=new rh);var k=P.delta(r),G=this.normal.dot(k);if(0===G)return 0===this.distanceToPoint(P.start)?g.copy(P.start):f;var e=-(P.start.dot(this.normal)+this.constant)/G;return 0>e||e>1?f:g.copy(k).multiplyScalar(e).add(P.start)}}(),intersectsLine:function(s){var L=this.distanceToPoint(s.start),W=this.distanceToPoint(s.end);return 0>L&&W>0||0>W&&L>0},intersectsBox:function(y){return y.intersectsPlane(this)},intersectsSphere:function(D){return D.intersectsPlane(this)},coplanarPoint:function(H){return H===f&&(H=new rh),H.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var g=new rh,B=new m;return function(k,T){var w=T||B.getNormalMatrix(k),G=this.coplanarPoint(g).applyMatrix4(k),F=this.normal.applyMatrix3(w).normalize();return this.constant=-G.dot(F),this}}(),translate:function(P){return this.constant-=P.dot(this.normal),this},equals:function(H){return H.normal.equals(this.normal)&&H.constant===this.constant}});var Do=X.Math.Ray=function(T,I){this.origin=T!==f?T.clone():new rh,this.direction=I!==f?I.clone():new rh};b.assign(Do.prototype,{set:function(i,r){return this.origin.copy(i),this.direction.copy(r),this},clone:function(){return(new this.constructor).copy(this)},copy:function(w){return this.origin.copy(w.origin),this.direction.copy(w.direction),this.maxHitLen=w.maxHitLen,this},at:function($,m){var X=m||new rh;return X.copy(this.direction).multiplyScalar($).add(this.origin)},setMaxHitLength:function(U){this.maxHitLen=U},lookAt:function(X){return this.direction.copy(X).sub(this.origin).normalize(),this},applyMatrix4:function(r){var z=this.maxHitLen;if(z){var H=this.direction.clone().multiplyScalar(z).add(this.origin);H.applyMatrix4(r)}return this.origin.applyMatrix4(r),this.direction.transformDirection(r),z&&(this.maxHitLen=this.origin.distanceTo(H)),this},intersectBox:function(i,K){var w,b,W,a,R,M,g=1/this.direction.x,J=1/this.direction.y,u=1/this.direction.z,e=this.origin;if(g>=0?(w=(i.min.x-e.x)*g,b=(i.max.x-e.x)*g):(w=(i.max.x-e.x)*g,b=(i.min.x-e.x)*g),J>=0?(W=(i.min.y-e.y)*J,a=(i.max.y-e.y)*J):(W=(i.max.y-e.y)*J,a=(i.min.y-e.y)*J),w>a||W>b)return null;if((W>w||w!==w)&&(w=W),(b>a||b!==b)&&(b=a),u>=0?(R=(i.min.z-e.z)*u,M=(i.max.z-e.z)*u):(R=(i.max.z-e.z)*u,M=(i.min.z-e.z)*u),w>M||R>b)return null;if((R>w||w!==w)&&(w=R),(b>M||b!==b)&&(b=M),0>b)return null;var H=w>=0?w:b,h=this.maxHitLen;return h&&H>h?null:this.at(H,K)},intersectTriangle:function(){var j=new rh,K=new rh,s=new rh,I=new rh;return function(C,d,N,Y,G){K.subVectors(d,C),s.subVectors(N,C),I.crossVectors(K,s);var R,q=this.direction.dot(I);if(q>0){if(Y)return null;R=1}else{if(!(0>q))return null;R=-1,q=-q}j.subVectors(this.origin,C);var D=R*this.direction.dot(s.crossVectors(j,s));if(0>D)return null;var c=R*this.direction.dot(K.cross(j));if(0>c||D+c>q)return null;var z=-R*j.dot(I);if(0>z)return null;var L=z/q,$=this.maxHitLen;return $&&L>$?null:this.at(L,G)}}()});var Cb=X.Math.Box3=function(x,g){this.min=x!==f?x:new rh(1/0,1/0,1/0),this.max=g!==f?g:new rh(-1/0,-1/0,-1/0)};b.assign(Cb.prototype,{set:function(O,w){return this.min.copy(O),this.max.copy(w),this},setFromArray:function(k){for(var R=1/0,w=1/0,X=1/0,L=-1/0,B=-1/0,i=-1/0,j=0,U=k.length;U>j;j+=3){var c=k[j],Y=k[j+1],C=k[j+2];R>c&&(R=c),w>Y&&(w=Y),X>C&&(X=C),c>L&&(L=c),Y>B&&(B=Y),C>i&&(i=C)}return this.min.set(R,w,X),this.max.set(L,B,i),this},setFromPoints:function(f){this.makeEmpty();for(var C=0,D=f.length;D>C;C++)this.expandByPoint(f[C]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(I){return I.max.x<this.min.x||I.min.x>this.max.x||I.max.y<this.min.y||I.min.y>this.max.y||I.max.z<this.min.z||I.min.z>this.max.z?!1:!0},copy:function(K){return this.min.copy(K.min),this.max.copy(K.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(I){return this.min.min(I),this.max.max(I),this}});var Nf=X.Math.Sphere=function(N,u){this.center=N!==f?N:new rh,this.radius=u!==f?u:0};b.assign(Nf.prototype,{set:function(Z,a){return this.center.copy(Z),this.radius=a,this},setFromPoints:function(){var b=new Cb;return function(W,L){var p=this.center;L!==f?p.copy(L):b.setFromPoints(W).getCenter(p);for(var i=0,G=0,U=W.length;U>G;G++)i=Math.max(i,p.distanceToSquared(W[G]));return this.radius=Math.sqrt(i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(y){return this.center.copy(y.center),this.radius=y.radius,this},empty:function(){return this.radius<=0},containsPoint:function(q){return q.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(y){return y.distanceTo(this.center)-this.radius},intersectsSphere:function(z){var y=this.radius+z.radius;return z.center.distanceToSquared(this.center)<=y*y},intersectsBox:function(h){return h.intersectsSphere(this)},intersectsPlane:function(p){return Math.abs(p.distanceToPoint(this.center))<=this.radius},clampPoint:function(G,y){var Z=this.center.distanceToSquared(G);return y===f&&(y=new rh),y.copy(G),Z>this.radius*this.radius&&(y.sub(this.center).normalize(),y.multiplyScalar(this.radius).add(this.center)),y},getBoundingBox:function(F){return F===f&&(F=new Cb),F.set(this.center,this.center),F.expandByScalar(this.radius),F},applyMatrix4:function(q){return this.center.applyMatrix4(q),this.radius=this.radius*q.getMaxScaleOnAxis(),this},translate:function(S){return this.center.add(S),this},equals:function(Q){return Q.center.equals(this.center)&&Q.radius===this.radius}});var Ri=X.Math.Frustum=function(W,v,S,c,Y,d){this.planes=[W!==f?W:new Al,v!==f?v:new Al,S!==f?S:new Al,c!==f?c:new Al,Y!==f?Y:new Al,d!==f?d:new Al]};b.assign(Ri.prototype,{set:function(x,K,q,Z,u,T){var M=this.planes;return M[0].copy(x),M[1].copy(K),M[2].copy(q),M[3].copy(Z),M[4].copy(u),M[5].copy(T),this},clone:function(){return(new this.constructor).copy(this)},copy:function(r){for(var i=this.planes,x=0;6>x;x++)i[x].copy(r.planes[x]);return this},setFromMatrix:function(h){var I=this.planes,W=h.el,G=W[0],s=W[1],p=W[2],D=W[3],H=W[4],P=W[5],x=W[6],R=W[7],J=W[8],e=W[9],c=W[10],C=W[11],d=W[12],v=W[13],w=W[14],T=W[15];return I[0].setComponents(D-G,R-H,C-J,T-d).normalize(),I[1].setComponents(D+G,R+H,C+J,T+d).normalize(),I[2].setComponents(D+s,R+P,C+e,T+v).normalize(),I[3].setComponents(D-s,R-P,C-e,T-v).normalize(),I[4].setComponents(D-p,R-x,C-c,T-w).normalize(),I[5].setComponents(D+p,R+x,C+c,T+w).normalize(),this},intersectsObject:function(){var v=new Nf;return function(Y){var J=Y.geometry;return null===J.boundingSphere&&J.computeBoundingSphere(),v.copy(J.boundingSphere).applyMatrix4(Y.matrixWorld),this.intersectsSphere(v)}}(),intersectsSprite:function(){var D=new Nf;return function(i){return D.center.set(0,0,0),D.radius=.7071067811865476,D.applyMatrix4(i.matrixWorld),this.intersectsSphere(D)}}(),intersectsSphere:function(J){for(var t=this.planes,A=J.center,z=-J.radius,Z=0;6>Z;Z++){var g=t[Z].distanceToPoint(A);if(z>g)return!1}return!0},intersectsBox:function(){var A=new rh;return function(z){for(var W=this.planes,m=0;6>m;m++){var r=W[m];if(A.x=r.normal.x>0?z.max.x:z.min.x,A.y=r.normal.y>0?z.max.y:z.min.y,A.z=r.normal.z>0?z.max.z:z.min.z,r.distanceToPoint(A)<0)return!1}return!0}}(),containsPoint:function(z){for(var G=this.planes,H=0;6>H;H++)if(G[H].distanceToPoint(z)<0)return!1;return!0}});var $h=X.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};b.assign($h.prototype,{set:function(j,a,x,H,R,T,D,N,w,r,y,A,h,m,L,I){var i=this.el;return i[0]=j,i[4]=a,i[8]=x,i[12]=H,i[1]=R,i[5]=T,i[9]=D,i[13]=N,i[2]=w,i[6]=r,i[10]=y,i[14]=A,i[3]=h,i[7]=m,i[11]=L,i[15]=I,this},clone:function(){return(new $h).fromArray(this.el)},fromArray:function(S,K){K===f&&(K=0);for(var c=this.el,A=0;16>A;A++)c[A]=S[A+K];return this},scale:function(j){var v=this.el,m=j.x,T=j.y,D=j.z;return v[0]*=m,v[4]*=T,v[8]*=D,v[1]*=m,v[5]*=T,v[9]*=D,v[2]*=m,v[6]*=T,v[10]*=D,v[3]*=m,v[7]*=T,v[11]*=D,this},makeRotationFromEuler:function(c){var i=this.el,f=c._x,e=c._y,X=c._z,W=c._order,D=Math.cos(f),S=Math.sin(f),O=Math.cos(e),b=Math.sin(e),Z=Math.cos(X),p=Math.sin(X);if("XYZ"===W){var U=D*Z,V=D*p,j=S*Z,M=S*p;i[0]=O*Z,i[4]=-O*p,i[8]=b,i[1]=V+j*b,i[5]=U-M*b,i[9]=-S*O,i[2]=M-U*b,i[6]=j+V*b,i[10]=D*O}else if("YXZ"===W){var s=O*Z,y=O*p,u=b*Z,N=b*p;i[0]=s+N*S,i[4]=u*S-y,i[8]=D*b,i[1]=D*p,i[5]=D*Z,i[9]=-S,i[2]=y*S-u,i[6]=N+s*S,i[10]=D*O}else if("ZXY"===W){var s=O*Z,y=O*p,u=b*Z,N=b*p;i[0]=s-N*S,i[4]=-D*p,i[8]=u+y*S,i[1]=y+u*S,i[5]=D*Z,i[9]=N-s*S,i[2]=-D*b,i[6]=S,i[10]=D*O}else if("ZYX"===W){var U=D*Z,V=D*p,j=S*Z,M=S*p;i[0]=O*Z,i[4]=j*b-V,i[8]=U*b+M,i[1]=O*p,i[5]=M*b+U,i[9]=V*b-j,i[2]=-b,i[6]=S*O,i[10]=D*O}else if("YZX"===W){var d=D*O,C=D*b,I=S*O,k=S*b;i[0]=O*Z,i[4]=k-d*p,i[8]=I*p+C,i[1]=p,i[5]=D*Z,i[9]=-S*Z,i[2]=-b*Z,i[6]=C*p+I,i[10]=d-k*p}else if("XZY"===W){var d=D*O,C=D*b,I=S*O,k=S*b;i[0]=O*Z,i[4]=-p,i[8]=b*Z,i[1]=d*p+k,i[5]=D*Z,i[9]=C*p-I,i[2]=I*p-C,i[6]=S*Z,i[10]=k*p+d}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},makeRotationFromQuaternion:function(x){var $=this.el,r=x._x,D=x._y,H=x._z,p=x._w,U=r+r,w=D+D,c=H+H,N=r*U,P=r*w,_=r*c,k=D*w,Z=D*c,e=H*c,o=p*U,S=p*w,E=p*c;return $[0]=1-(k+e),$[4]=P-E,$[8]=_+S,$[1]=P+E,$[5]=1-(N+e),$[9]=Z-o,$[2]=_-S,$[6]=Z+o,$[10]=1-(N+k),$[3]=0,$[7]=0,$[11]=0,$[12]=0,$[13]=0,$[14]=0,$[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(M){var l=this.el,T=M.el,o=T[0],m=T[1],a=T[2],q=T[3],L=T[4],s=T[5],N=T[6],_=T[7],f=T[8],D=T[9],G=T[10],Z=T[11],V=T[12],C=T[13],E=T[14],W=T[15],S=D*E*_-C*G*_+C*N*Z-s*E*Z-D*N*W+s*G*W,F=V*G*_-f*E*_-V*N*Z+L*E*Z+f*N*W-L*G*W,d=f*C*_-V*D*_+V*s*Z-L*C*Z-f*s*W+L*D*W,p=V*D*N-f*C*N-V*s*G+L*C*G+f*s*E-L*D*E,r=o*S+m*F+a*d+q*p;if(0===r)return this.identity();var B=1/r;return l[0]=S*B,l[1]=(C*G*q-D*E*q-C*a*Z+m*E*Z+D*a*W-m*G*W)*B,l[2]=(s*E*q-C*N*q+C*a*_-m*E*_-s*a*W+m*N*W)*B,l[3]=(D*N*q-s*G*q-D*a*_+m*G*_+s*a*Z-m*N*Z)*B,l[4]=F*B,l[5]=(f*E*q-V*G*q+V*a*Z-o*E*Z-f*a*W+o*G*W)*B,l[6]=(V*N*q-L*E*q-V*a*_+o*E*_+L*a*W-o*N*W)*B,l[7]=(L*G*q-f*N*q+f*a*_-o*G*_-L*a*Z+o*N*Z)*B,l[8]=d*B,l[9]=(V*D*q-f*C*q-V*m*Z+o*C*Z+f*m*W-o*D*W)*B,l[10]=(L*C*q-V*s*q+V*m*_-o*C*_-L*m*W+o*s*W)*B,l[11]=(f*s*q-L*D*q-f*m*_+o*D*_+L*m*Z-o*s*Z)*B,l[12]=p*B,l[13]=(f*C*a-V*D*a+V*m*G-o*C*G-f*m*E+o*D*E)*B,l[14]=(V*s*a-L*C*a-V*m*N+o*C*N+L*m*E-o*s*E)*B,l[15]=(L*D*a-f*s*a+f*m*N-o*D*N-L*m*G+o*s*G)*B,this},makeRotationAxis:function(K,N){var D=Math.cos(N),j=Math.sin(N),L=1-D,e=K.x,l=K.y,s=K.z,n=L*e,V=L*l;return this.set(n*e+D,n*l-j*s,n*s+j*l,0,n*l+j*s,V*l+D,V*s-j*e,0,n*s-j*l,V*s+j*e,L*s*s+D,0,0,0,0,1),this},multiply:function(L){return this.multiplyMatrices(this,L)},premultiply:function($){return this.multiplyMatrices($,this)},multiplyMatrices:function(D,I){var s=D.el,o=I.el,y=this.el,q=s[0],Q=s[4],J=s[8],t=s[12],Z=s[1],f=s[5],a=s[9],n=s[13],h=s[2],u=s[6],M=s[10],K=s[14],k=s[3],H=s[7],C=s[11],E=s[15],A=o[0],T=o[4],W=o[8],Y=o[12],x=o[1],i=o[5],l=o[9],d=o[13],b=o[2],G=o[6],g=o[10],N=o[14],R=o[3],m=o[7],B=o[11],v=o[15];return y[0]=q*A+Q*x+J*b+t*R,y[4]=q*T+Q*i+J*G+t*m,y[8]=q*W+Q*l+J*g+t*B,y[12]=q*Y+Q*d+J*N+t*v,y[1]=Z*A+f*x+a*b+n*R,y[5]=Z*T+f*i+a*G+n*m,y[9]=Z*W+f*l+a*g+n*B,y[13]=Z*Y+f*d+a*N+n*v,y[2]=h*A+u*x+M*b+K*R,y[6]=h*T+u*i+M*G+K*m,y[10]=h*W+u*l+M*g+K*B,y[14]=h*Y+u*d+M*N+K*v,y[3]=k*A+H*x+C*b+E*R,y[7]=k*T+H*i+C*G+E*m,y[11]=k*W+H*l+C*g+E*B,y[15]=k*Y+H*d+C*N+E*v,this},lookAt:function(){var l=new rh,o=new rh,P=new rh;return function(m,h,r){var t=this.el;return P.subVectors(m,h),0===P.lengthSq()&&(P.z=1),P.normalize(),l.crossVectors(r,P),0===l.lengthSq()&&(1===Math.abs(r.z)?P.x+=1e-4:P.z+=1e-4,P.normalize(),l.crossVectors(r,P)),l.normalize(),o.crossVectors(P,l),t[0]=l.x,t[4]=o.x,t[8]=P.x,t[1]=l.y,t[5]=o.y,t[9]=P.y,t[2]=l.z,t[6]=o.z,t[10]=P.z,this}}(),extractScale:function(){var r;return function(q){r===f&&(r=new rh),q===f&&(q=new rh);var e=r.setFromMatrixColumn(this,0).length(),P=r.setFromMatrixColumn(this,1).length(),i=r.setFromMatrixColumn(this,2).length();return q.set(e,P,i),q}}(),extractRotation:function(){var j;return function(D){j===f&&(j=new rh),D===f&&(D=new $h);var h=this.el,i=D.el,w=1/j.setFromMatrixColumn(D,0).length(),e=1/j.setFromMatrixColumn(D,1).length(),U=1/j.setFromMatrixColumn(D,2).length();return h[0]=i[0]*w,h[1]=i[1]*w,h[2]=i[2]*w,h[4]=i[4]*e,h[5]=i[5]*e,h[6]=i[6]*e,h[8]=i[8]*U,h[9]=i[9]*U,h[10]=i[10]*U,this}}(),multiplyScalar:function(A){var S=this.el;return S[0]*=A,S[4]*=A,S[8]*=A,S[12]*=A,S[1]*=A,S[5]*=A,S[9]*=A,S[13]*=A,S[2]*=A,S[6]*=A,S[10]*=A,S[14]*=A,S[3]*=A,S[7]*=A,S[11]*=A,S[15]*=A,this},getPosition:function(U){return U===f&&(U=new rh),U.setFromMatrixColumn(this,3)},setPosition:function(I){var O=this.el;return O[12]=I.x,O[13]=I.y,O[14]=I.z,this},toArray:function(D,C){D===f&&(D=[]),C===f&&(C=0);var h=this.el;return D[C]=h[0],D[C+1]=h[1],D[C+2]=h[2],D[C+3]=h[3],D[C+4]=h[4],D[C+5]=h[5],D[C+6]=h[6],D[C+7]=h[7],D[C+8]=h[8],D[C+9]=h[9],D[C+10]=h[10],D[C+11]=h[11],D[C+12]=h[12],D[C+13]=h[13],D[C+14]=h[14],D[C+15]=h[15],D}});var Ql=X.Math.Triangle=function(W,g,D){this.a=W!==f?W:new rh,this.b=g!==f?g:new rh,this.c=D!==f?D:new rh};b.assign(Ql,{barycoordFromPoint:function(){var R=new rh,k=new rh,g=new rh;return function(l,L,b,A,V){R.subVectors(A,L),k.subVectors(b,L),g.subVectors(l,L);var K=R.dot(R),X=R.dot(k),I=R.dot(g),q=k.dot(k),n=k.dot(g),B=K*q-X*X,f=V||new rh;if(0===B)return f.set(-2,-1,-1);var U=1/B,N=(q*I-X*n)*U,T=(K*n-X*I)*U;return f.set(1-N-T,T,N)}}()});var lb=X.Math.Euler=function(w,v,e,K,h){this.set(w,v,e,K,h)};lb.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],lb.DefaultOrder="XYZ",lb.ReverseOrder=function(I){return I=I[2]+I[1]+I[0],I.toUpperCase()},b.defineProperties(lb.prototype,{x:{get:function(){return this._x},set:function(g){this._x=g,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(R){this._y=R,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(I){this._z=I,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(C){this._order=C,this.onChangeCallback()}}}),b.assign(lb.prototype,{set:function(r,s,Y,M,c){return En(r)&&(c=Y,M=s,Y=r[2],s=r[1],r=r[0]),M?c&&(M=lb.ReverseOrder(M)):M="ZYX",this._x=r||0,this._y=s||0,this._z=Y||0,this._order=M||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(_){return this._x=_._x,this._y=_._y,this._z=_._z,this._order=_._order,this.onChangeCallback(),this},setFromRotationMatrix:function(z,b,j){var r=X.Math.clamp,Y=z.el||z,s=Y[0],M=Y[4],q=Y[8],x=Y[1],n=Y[5],v=Y[9],O=Y[2],C=Y[6],c=Y[10];return b=b||this._order,"XYZ"===b?(this._y=Math.asin(r(q,-1,1)),Math.abs(q)<.99999?(this._x=Math.atan2(-v,c),this._z=Math.atan2(-M,s)):(this._x=Math.atan2(C,n),this._z=0)):"YXZ"===b?(this._x=Math.asin(-r(v,-1,1)),Math.abs(v)<.99999?(this._y=Math.atan2(q,c),this._z=Math.atan2(x,n)):(this._y=Math.atan2(-O,s),this._z=0)):"ZXY"===b?(this._x=Math.asin(r(C,-1,1)),Math.abs(C)<.99999?(this._y=Math.atan2(-O,c),this._z=Math.atan2(-M,n)):(this._y=0,this._z=Math.atan2(x,s))):"ZYX"===b?(this._y=Math.asin(-r(O,-1,1)),Math.abs(O)<.99999?(this._x=Math.atan2(C,c),this._z=Math.atan2(x,s)):(this._x=0,this._z=Math.atan2(-M,n))):"YZX"===b?(this._z=Math.asin(r(x,-1,1)),Math.abs(x)<.99999?(this._x=Math.atan2(-v,n),this._y=Math.atan2(-O,s)):(this._x=0,this._y=Math.atan2(q,c))):"XZY"===b?(this._z=Math.asin(-r(M,-1,1)),Math.abs(M)<.99999?(this._x=Math.atan2(C,n),this._y=Math.atan2(q,s)):(this._x=Math.atan2(-v,c),this._y=0)):console.warn("unsupported order: "+b),this._order=b,j!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var R=new $h;return function(l,f,w){return R.makeRotationFromQuaternion(l),this.setFromRotationMatrix(R,f,w)}}(),setFromVector3:function(f,U){return this.set(f.x,f.y,f.z,U||this._order)},reorder:function(){var m=new Bd;return function(R){return m.setFromEuler(this),this.setFromQuaternion(m,R)}}(),equals:function(i){return i._x===this._x&&i._y===this._y&&i._z===this._z&&i._order===this._order},fromArray:function(H){return this._x=H[0],this._y=H[1],this._z=H[2],H[3]!==f&&(this._order=H[3]),this.onChangeCallback(),this},toArray:function(l,T){return l===f&&(l=[]),T===f&&(T=0),l[T]=this._x,l[T+1]=this._y,l[T+2]=this._z,l[T+3]=this._order,l
},toVector3:function(u){return u?u.set(this._x,this._y,this._z):new rh(this._x,this._y,this._z)},onChange:function(f){return this.onChangeCallback=f,this},onChangeCallback:function(){}});var _e=X.List=function(){this._as=[];var j,o,J=arguments.length;if(1===J){var v=arguments[0];if(hq(v)&&(v=v._as),En(v))for(o=v.length,j=0;o>j;j++)this._as.push(v[j]);else v!=u&&this._as.push(v)}else if(J>1)for(j=0;J>j;j++)this._as.push(arguments[j])};lp("List",b,{forEach:function(S,w){this.each(S,w)},push:function(){for(var W=0;W<arguments.length;W++)this.add(arguments[W])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(P,V){return V===f?this._as.push(P):this._as.splice(V,0,P)},addAll:function(Y){hq(Y)&&(Y=Y._as),En(Y)?Ab(this._as,Y):this._as.push(Y)},get:function(T){return this._as[T]},slice:function(U,M){return new _e(this._as.slice(U,M))},remove:function(f){var W=this._as.indexOf(f);return W>=0&&W<this._as.length&&this.removeAt(W),W},removeAt:function(X){return this._as.splice(X,1)[0]},set:function(q,v){return this._as[q]=v},clear:function(){return this._as.splice(0,this._as.length)},contains:function(N){return this._as.indexOf(N)>=0},indexOf:function(u){return this._as.indexOf(u)},each:function(Z,B){for(var m=0,_=this._as.length;_>m;m++){var e=this._as[m];B?Z.call(B,e,m,this):Z(e,m,this)}},reverseEach:function(e,Y){for(var d=this._as.length-1;d>=0;d--){var V=this._as[d];Y?e.call(Y,V):e(V)}},getArray:function(){return this._as},toArray:function(w,_){if(w){for(var P,W=[],x=0,I=this._as.length;I>x;x++)P=this._as[x],_?w.call(_,P)&&W.push(P):w(P)&&W.push(P);return W}return this._as.concat()},toList:function(m,K){if(m){for(var R,z=new _e,N=0,k=this._as.length;k>N;N++)R=this._as[N],K?m.call(K,R)&&z.add(R):m(R)&&z.add(R);return z}return new _e(this)},reverse:function(){this._as.reverse()},sort:function(j){return this._as.sort(j?j:hi),this},toString:function(){return this._as.toString()}}),b.defineProperties(_e.prototype,{length:{get:function(){return this._as.length},set:function(J){this._as.length=J}}});var Ii=new _e;ae(Ii,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:td,each:td,reverseEach:td,toArray:function(){return[]},toList:function(){return new _e},add:Dq,addAll:Dq,set:Dq,remove:Dq,removeAt:Dq,clear:Dq});var ch=X.Notifier=function(){this._f=0};lp("Notifier",b,{contains:function(U,A){if(this._ls)for(var V,b=0,X=this._ls.size();X>b;b++)if(V=this._ls.get(b),U===V.l&&A===V.s)return!0;return!1},add:function(V,Z,P){var L=this,Q={l:V,s:Z,a:P};L._ls||(L._ls=new _e),L._f?(L._as||(L._as=new _e),L._as.add(Q)):Q.a?L._ls.add(Q,0):L._ls.add(Q)},remove:function(d,v){var E=this;E._ls&&(E._f?(E._rs||(E._rs=new _e),E._rs.add({l:d,s:v})):E._remove(d,v))},_remove:function(r,i){for(var j,G=this._ls,X=0,e=G.size();e>X;X++)if(j=G.get(X),j.l===r&&j.s===i)return G.removeAt(X),void 0},fire:function(m){var j=this,V=j._ls;if(j._b=1e4,V){++j._f;try{for(var w,e=0,L=V.size();L>e;e++)w=V.get(e),w.s?w.l.call(w.s,m):w.l(m)}catch(m){i(function(){throw m})}finally{if(--j._f)return;if(j._rs){for(L=j._rs.size(),e=0;L>e;e++)w=j._rs.get(e),j._remove(w.l,w.s);delete j._rs}if(j._as){for(L=j._as.size(),e=0;L>e;e++)w=j._as.get(e),w.a?V.add(w,0):V.add(w);delete j._as}}}}});var lc=X.Data=function(){this._id=Pk()};lp("Data",b,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:u,_parent:u,_children:Ii,_childMap:u,_styleMap:u,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return u},_22Q:function(){return u},s:function(m,X){var o=this;if(2===arguments.length)o.setStyle(m,X);else{if(!Il(m))return o.getStyle(m);for(var H in m)o.setStyle(H,m[H])}return o},fp:function(K,x,M,Y,W){return this.firePropertyChange(K,x,M,Y,W)},firePropertyChange:function(w,I,C,j,n){if(j){if(j(I,C))return!1}else if(I===C)return!1;var L=this,M=n||{};return M.property=w,M.oldValue=I,M.newValue=C,M.data=L,L._dataModel&&L._dataModel.handleDataPropertyChange(M),L.onPropertyChanged(M),!0},onPropertyChanged:function(y){var X=this,Y=X._parent,a=y.property;if(yi(Y)){var N=X.s(dk),R="s:ingroup"===a;(N&&em[a]||a===R)&&Y._81I(),(N||R)&&Y.fp("childChange",!0,!1)}Qj(Y)&&em[a]&&Y.updateFromChildren()},_21I:function(j){var x=this;if(j&&x._dataModel)throw"Remove data from dataModel before adding";x._dataModel=j},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var D=0,x=this._children.toArray(),e=x.length;e>D;D++)x[D].removeFromDataModel()},getId:function(){return this._id},setId:function(a){this._id=a},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(q,Q){return this._children.toList(q,Q)},eachChild:function(u,R){this._children.each(u,R)},addChild:function(I,E){var G=this;I!==G&&(G._children===Ii&&(G._children=new _e,G._childMap={}),E>=0||(E=G._children.size()),G._childMap[I._id]||G.isDescendantOf(I)||(I._parent&&I._parent.removeChild(I),(0>E||E>G._children.size())&&(E=G._children.size()),G._children.add(I,E),G._childMap[I._id]=I,I.setParent(G),G.onChildAdded(I,E),G.fp(vc,u,I)))},onChildAdded:function(){},removeChild:function(p){var T=this;if(T._childMap&&T._childMap[p._id]){var _=T._children.remove(p);delete T._childMap[p._id],T.fp(vc,p,u),p.setParent(u,_),T.onChildRemoved(p,_)}},onChildRemoved:function(){},getChildAt:function(d){return this._children.get(d)},clearChildren:function(){var Q=this;if(!Q._children.isEmpty())for(var U=0,G=Q._children.toArray(),Z=G.length;Z>U;U++)Q.removeChild(G[U])},getParent:function(){return this._parent},setParent:function(w,b){var q=this;if(!(q._73I||q._parent===w||q===w||w&&w.isDescendantOf(q))){var W,i=q._parent;q._parent=w,q._73I=1,i?(b==u&&(b=i.getChildren().indexOf(q)),i.removeChild(q)):q._dataModel&&b==u&&(b=q._dataModel.getRoots().indexOf(q)),w&&(w.addChild(q),W=w.getChildren().indexOf(q)),delete q._73I,q.fp("parent",i,w,f,{oldIndex:b,newIndex:W}),q.onParentChanged(i,w)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(K){return K?this.isDescendantOf(K)||K.isDescendantOf(this):!1},isParentOf:function(L){return L&&this._childMap?!!this._childMap[L._id]:!1},isDescendantOf:function(C){if(!C||C.isEmpty())return!1;for(var S=this._parent;S;){if(C===S)return!0;S=S._parent}return!1},getStyle:function(m,T){T===f&&(T=1);var O=this._styleMap?this._styleMap[m]:f;return O===f&&T?W[m]:O},setStyle:function(l,$){var C=this;C._styleMap||(C._styleMap={});var v=C._styleMap[l];$===f?delete C._styleMap[l]:C._styleMap[l]=$,C.fp("s:"+l,v,$)&&C.onStyleChanged(l,v,$)},onStyleChanged:function(){},iv:function(h){this.invalidate(h)},invalidate:function(g){this.fp(g||"*",!1,!0)},toString:function(){var Y=this;return Y._displayName||Y._name||Y._tag||Y._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(n,o){var d=this,k=d.s(dj);k||d.s(dj,k={}),o?k[n]=o:delete k[n],d.fp(dj,u,k)},removeStyleIcon:function(H){var T=this.s(dj);if(T){var m=T[H];delete T[H],this.fp(dj,u,T)}return m},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var l,z={};for(l in this._styleMap)z[l]=1;return z},ca:function(R,u){return R=qo+R,2===arguments.length?this.a(R,u):this.a(R)}});var ss=X.DataModel=function(){var A=this;A._datas=new _e,A._dataMap={},A._roots=new _e,A._rootMap={},A._fsDataMap={},A._78O={},A._36I=new ch,A._35I=new ch,A._serializeNotifier=new ch,A._selectionModel=new ik(A);var Q=A._29Q=[],m=A._scheduleCallback=function(){for(var Y=Date.now(),e=0;e<Q.length;e++){var x=Q[e];x.enabled&&Y-x.lastTime>x.interval&&(x.beforeAction&&x.beforeAction(),A.each(function(s){x.action(s)}),x.afterAction&&x.afterAction(),x.lastTime=Y)}Q.length&&(A._30Q=M.requestAnimationFrame(m))}};lp("DataModel",b,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:f,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:f,_init:f,_envmap:f,_postProcessingData:f,sm:function(){return this.getSelectionModel()},mm:function(M,K,u){this.addDataModelChangeListener(M,K,u)},umm:function(T,R){this.removeDataModelChangeListener(T,R)},md:function(u,L,Q){this.addDataPropertyChangeListener(u,L,Q)},umd:function(w,V){this.removeDataPropertyChangeListener(w,V)},mh:function(L,r,F){this.addHierarchyChangeListener(L,r,F)},umh:function(t,I){this.removeHierarchyChangeListener(t,I)},getAttrObject:function(){return this._attrObject},setAttrObject:function(f){return this._attrObject=f},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getDataById:function(n){return this._dataMap[n]},removeDataById:function(E){this.remove(this.getDataById(E))},toDatas:function(x,f){return this._datas.toList(x,f)},each:function(S,M){this._datas.each(S,M)},getDataByTag:function(t){return this._78O[t]},getTagMap:function(){return this._78O},removeDataByTag:function(g){this.remove(this.getDataByTag(g))},add:function(m,C,E){var s=this,o=m._id,Z=m._tag,z=s._roots;if(s._dataMap[o])throw"'"+o+"' already exists";Z!=u&&(s._78O[Z]=m),s._dataMap[o]=m,E>=0?s._datas.add(m,E):s._datas.add(m),m._parent||(s._rootMap[o]=m,C>=0?z.add(m,C):z.add(m)),m.s("fullscreen")!==f&&(s._fsDataMap[o]=m),m._21I(s),s.onAdded(m),s._36I.fire({kind:"add",data:m,rootsIndex:C,datasIndex:E})},onAdded:function(){},remove:function(j,Z){if(j){var R=this,E=j._id,w=Z&&Z.keepStructure,$=Z&&Z.keepChildren,h=j.getTag();if(j._dataModel===R){this.beginTransaction(),w?R._removingData||(R._removingData=j):R.prepareRemove(j),$||j.toChildren().each(function(L){R.remove(L,Z)},R),w?R._removingData===j&&(j._parent&&j._parent.removeChild(j),delete R._removingData):j._parent&&j._parent.removeChild(j);var x=R._datas.remove(j);delete R._dataMap[E],h!=u&&delete R._78O[h];var e;R._rootMap[E]&&(delete R._rootMap[E],e=R._roots.remove(j)),R._fsDataMap[E]&&delete R._fsDataMap[E],j._21I(u),R.onRemoved(j),R._36I.fire({kind:tp,data:j,rootsIndex:e,datasIndex:x}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var C=this;if(C._datas.size()){var W=C._historyManager?this.toJSON():f;C._datas.toArray().forEach(function(T){T._21I(u)}),C._datas.clear(),C._dataMap={},C._roots.clear(),C._rootMap={},C._fsDataMap={},C._78O={},C._36I.fire({kind:Ch,json:W})}},contains:function(W){return W&&W._dataModel===this},handleDataPropertyChange:function(f){var L=this,Y=f.data,h=f.property;if("parent"===h){var N=Y._id,U=L._rootMap,j=L._roots;Y._parent?U[N]&&(delete U[N],j.remove(Y)):U[N]||(U[N]=Y,j.add(Y))}else if("tag"===h){var p=f.oldValue,c=f.newValue,K=L._78O;p!=u&&delete K[p],c!=u&&(K[c]=Y)}else if("s:fullscreen"===h){var N=Y._id,D=L._fsDataMap;f.oldValue!=u&&delete D[N],f.newValue!=u&&(D[N]=Y)}this.onDataPropertyChanged(Y,f),this._35I.fire(f)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(Q,r,s){this._36I.add(Q,r,s)},removeDataModelChangeListener:function(B,h){this._36I.remove(B,h)},addSerializeListener:function(J,w,Y){this._serializeNotifier.add(J,w,Y)},removeSerializeListener:function(l,x){this._serializeNotifier.remove(l,x)},fireSerializeEvent:function(w){this._serializeNotifier.fire(w)},addDataPropertyChangeListener:function(k,E,K){this._35I.add(k,E,K)},removeDataPropertyChangeListener:function(l,o){this._35I.remove(l,o)},_38I:function(S,l,c){this._37I&&this._37I.fire({data:S,oldIndex:l,newIndex:c})},addHierarchyChangeListener:function(o,N,K){this._37I||(this._37I=new ch),this._37I.add(o,N,K)},removeHierarchyChangeListener:function(W,S){this._37I.remove(W,S)},getSiblings:function(r){var U=r._parent;return U?U._children:this._roots},eachByHierarchical:function($,B,r){if(B)return this._eachByHierarchical($,B,r);for(var e=0,T=this._roots,v=T.size();v>e;e++)if(this._eachByHierarchical($,T.get(e),r)===!1)return!1;return!0},_eachByHierarchical:function(f,z,$){if($){if(f.call($,z)===!1)return!1}else if(f(z)===!1)return!1;for(var t=z.size(),v=0;t>v;v++)if(this._eachByHierarchical(f,z.getChildAt(v),$)===!1)return!1;return!0},reverseEachByHierarchical:function(H,Q,Y){if(Q)return this._reverseEachByHierarchical(H,Q,Y);for(var U=this._roots,s=U.size(),u=s-1;u>=0;u--)if(this._reverseEachByHierarchical(H,U.get(u),Y)===!1)return!1;return!0},_reverseEachByHierarchical:function(_,L,a){for(var m=L.size(),Z=m-1;Z>=0;Z--)if(this._reverseEachByHierarchical(_,L.getChildAt(Z),a)===!1)return!1;if(a){if(_.call(a,L)===!1)return!1}else if(_(L)===!1)return!1;return!0},eachByDepthFirst:function(J,W,r){if(W)return this._11I(J,W,r);for(var R=0,u=this._roots,z=u.size();z>R;R++)if(this._11I(J,u.get(R),r)===!1)return!1;return!0},_11I:function(b,j,s){for(var n=j.size(),r=0;n>r;r++)if(this._11I(b,j.getChildAt(r),s)===!1)return!1;if(s){if(b.call(s,j)===!1)return!1}else if(b(j)===!1)return!1;return!0},eachByBreadthFirst:function(Q,B,S){var H=new _e;for(B?H.add(B):this._roots.each(H.add,H);H.size()>0;)if(B=H.removeAt(0),B.eachChild(H.add,H),S){if(Q.call(S,B)===!1)return!1}else if(Q(B)===!1)return!1;return!0},moveTo:function(Y,h){var n=this.getSiblings(Y),V=n.indexOf(Y);V===h||0>V||h>=0&&h<=n.size()&&(n.remove(Y),h>n.size()&&h--,n.add(Y,h),this._38I(Y,V,h))},moveUp:function(q){this.moveTo(q,this.getSiblings(q).indexOf(q)-1)},moveDown:function(C){this.moveTo(C,this.getSiblings(C).indexOf(C)+1)},moveToTop:function(B){this.moveTo(B,0)},moveToBottom:function(N){this.moveTo(N,this.getSiblings(N).size())},moveSelectionUp:function(Q){this.beginTransaction(),Q||(Q=this.sm());var j=new _e;vo(Q,j,this._roots),j.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(n){this.beginTransaction(),n||(n=this.sm());var D=new _e;Fk(n,D,this._roots),D.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(R){this.beginTransaction(),R||(R=this.sm());var w=new _e;ps(R,w,this._roots),w.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(V){this.beginTransaction(),V||(V=this.sm());var h=new _e;So(V,h,this._roots),h.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(Z,$,N){var g=this.getDatas();null==N&&(N=g.indexOf(Z)),N===$||0>N||$>=0&&$<=g.size()&&(g.remove(Z),$>g.size()&&$--,g.add(Z,$),this._76I(Z,N,$))},bringForward:function(y){this.moveToIndex(y,this.getDatas().indexOf(y)+1)},bringToFront:function(F){this.moveToIndex(F,this.size())},sendBackward:function(b){this.moveToIndex(b,this.getDatas().indexOf(b)-1)},sendToBack:function(E){this.moveToIndex(E,0)},bringSelectionForward:function(r){this.beginTransaction(),r||(r=this.sm());for(var f=new _e,A=this.getDatas(),q=!1,J=0;J<A.size();J++){var g=A.get(A.size()-1-J);r.contains(g)?q&&f.add(g):q=!0}f.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(C){this.beginTransaction(),C||(C=this.sm());for(var i=new _e,O=this.getDatas(),A=0;A<O.size();A++){var u=O.get(A);C.contains(u)&&i.add(u)}i.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(O){this.beginTransaction(),O||(O=this.sm());for(var W=new _e,w=this.getDatas(),G=!1,u=0;u<w.size();u++){var z=w.get(u);O.contains(z)?G&&W.add(z):G=!0}W.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(o){this.beginTransaction(),o||(o=this.sm());for(var c=new _e,g=this.getDatas(),W=0;W<g.size();W++){var R=g.get(g.size()-1-W);o.contains(R)&&c.add(R)}c.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(h){var R=this;R.removeScheduleTask(h),h.enabled==u&&(h.enabled=!0),h.interval==u&&(h.interval=10),h.action==u&&(h.action=td),h.lastTime=Date.now(),R._29Q.push(h),R._30Q==u&&(R._30Q=M.requestAnimationFrame(R._scheduleCallback))},removeScheduleTask:function(B){var x=this,w=x._29Q,b=w.indexOf(B);b>=0&&w.splice(b,1),w.length||x._30Q==u||(M.cancelAnimationFrame(x._30Q),delete x._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(Q){this._historyManager||new X.HistoryManager(this),null!=Q&&this._historyManager.setMaxHistoryCount(Q),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(q){this._historyManager&&this._historyManager.undo(q)},redo:function(a){this._historyManager&&this._historyManager.redo(a)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(m){this._historyManager&&this._historyManager.addHistory(m)},onHistoryManagerChanged:function(){}});var ik=X.SelectionModel=function(G){var E=this;E._68O=Bq,E._map={},E._73O=new _e,E._74I=new ch,E._21I(G)};lp("SelectionModel",b,{ms_fire:1,ms_dm:1,ms:function(R,s,h){this.addSelectionChangeListener(R,s,h)},ums:function(Z,E){this.removeSelectionChangeListener(Z,E)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===sr},co:function(I){return this._map[I._id]!=u},ss:function(R){this.setSelection(R)},as:function(s){this.appendSelection(s)},rs:function(r){this.removeSelection(r)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(c){var l=this;if(l._68O!==c&&(c===mg||c===sr||c===Bq)){l.cs();var A=l._68O;l._68O=c,l.fp("selectionMode",A,c)}},_21I:function(I){var p=this,C=p._dataModel;C!==I&&(C&&(p.cs(),C.umm(p.handleDataModelChange,p)),p._dataModel=I,I.mm(p.handleDataModelChange,p,!0),p.fp(Vq,C,I))},dispose:function(){var F=this;F.cs(),F._dataModel.umm(F.handleDataModelChange,F)},handleDataModelChange:function(s){var G=this;if(s.kind===tp){var I=s.data;G.co(I)&&(G._73O.remove(I),delete G._map[I._id],G._75I(tp,new _e(I)))}else s.kind===Ch&&G.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(I){var u=this;if(u._filterFunc!==I){u.cs();var $=u._filterFunc;u._filterFunc=I,u.fp("filterFunc",$,u._filterFunc)}},_75I:function(K,z,y,Y){y&&(this._73O.each(function(H){Y[H._id]?y.remove(H):y.add(H)}),z=y.toList()),this._74I.fire({kind:K,datas:new _e(z)})},addSelectionChangeListener:function(N,B,m){this._74I.add(N,B,m)},removeSelectionChangeListener:function(D,t){this._74I.remove(D,t)},_97O:function(m,_){for(var d,q=this,I=0,$=new _e(m);I<$.size();I++)d=$.get(I),(q._filterFunc&&!q._filterFunc(d)||_&&q.co(d)||!_&&!q.co(d)||!q._dataModel.contains(d))&&($.removeAt(I),I--);return $},appendSelection:function(I){var p=this;if(p._68O!==mg){var X,N,U=p._73O,b=p._97O(I,!0);b.isEmpty()||(p.sg()&&(X=new _e(U),N=p._map,U.clear(),p._map={},b=new _e(b.get(b.size()-1))),b.each(function(k){U.add(k),p._map[k._id]=k}),p._75I("append",b,X,N))}},removeSelection:function(w){var L=this,p=L._97O(w),c=0,_=p.size();if(0!==_){for(;_>c;c++){var X=p.get(c);L._73O.remove(X),delete L._map[X._id]}L._75I(tp,p)}},toSelection:function(C,j){return this._73O.toList(C,j)},getSelection:function(){return this._73O},each:function(d,c){this._73O.each(d,c)},setSelection:function(v){var R=this,g=R._73O;if(R._68O!==mg&&!(g.isEmpty()&&!v||1===g.size()&&R.ld()===v)){var E=new _e(g),N=R._map;g.clear(),R._map={};var h=R._97O(v,!0);R.sg()&&h.size()>1&&(h=new _e(h.get(h.size()-1))),h.each(function(v){g.add(v),R._map[v._id]=v}),R._75I("set",u,E,N)}},clearSelection:function(){var n=this,e=n._73O;if(e.size()>0){var w=e.toList();e.clear(),n._map={},n._75I(Ch,w)}},selectAll:function(){var C=this;if(C._68O!==mg){var j,n,L=C._dataModel.toDatas();if(C._filterFunc)for(j=0;j<L.size();j++)n=L.get(j),C._filterFunc(n)||(L.removeAt(j),j--);var F=C._73O,r=new _e(F),o=C._map;F.clear(),C._map={},C.sg()&&L.size()>1&&(L=new _e(L.get(L.size()-1)));var W=L.size();for(j=0;W>j;j++)n=L.get(j),F.add(n),C._map[n._id]=n;C._75I("all",u,r,o)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(p){return this._map[p._id]!=u},getLastData:function(){var Y=this._73O;return Y.size()>0?Y.get(Y.size()-1):u},getFirstData:function(){var s=this._73O;return s.size()>0?s.get(0):u},isSelectable:function(Q){var v=this;return Q&&v._68O!==mg?v._filterFunc?v._filterFunc(Q):!0:!1},getTopSelection:function(){var g=this,o=new _e;return g._73O.each(function(i){for(var D=i.getParent();D;){if(g.contains(D)){i=u;break}D=D.parent}i&&o.add(i)}),o}});var wo=function(){return ah(0),function(J,l){var w;if(Dk(l)){var x=J.getDataUI(l);x&&x._88I&&(w=x._88I.rect)}return w?w:l.getRect()}}();ae(U,{edgeGroupAgentFunc:u,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:G.rectSelectBorder,graphViewRectSelectBackground:dp,graphViewEditPointSize:je?17:7,graphViewEditPointBorderColor:G.editPointBorder,graphViewEditPointBackground:G.editPointBackground,setEdgeType:function(f,j,$){Ul[f]=j,ok[f]=$},getEdgeType:function(Z){return Ul[Z]},getEdgeTypeMap:function(){return Ul},getNodeRect:wo},!0),ae(W,{"layout.h":f,"layout.v":f,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":f,interactive:!1,"image.stretch":"fill",icons:f,ingroup:!0,"body.color":f,"2d.gray":!1,fullscreen:f,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:f,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":dr,"select.width":1,"select.padding":2,"select.type":Ej,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":f,"border.width":2,"border.padding":2,"border.type":Ej,label:f,"label.font":f,"label.color":ie,"label.background":f,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":f,"label.max":f,"label.opacity":f,"label.scale":1,"label.align":f,"label.selectable":!0,label2:f,"label2.font":f,"label2.color":ie,"label2.background":f,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":f,"label2.max":f,"label2.opacity":f,"label2.scale":1,"label2.align":f,"label2.selectable":!0,note:f,"note.expanded":!0,"note.font":f,"note.color":pp,"note.background":dr,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":f,"note.toggleable":!0,"note.border.width":1,"note.border.color":f,"note.opacity":f,"note.scale":1,"note.align":f,note2:f,"note2.expanded":!0,"note2.font":f,"note2.color":pp,"note2.background":dr,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":f,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":f,"note2.opacity":f,"note2.scale":1,"note2.align":f,"group.type":f,"group.image":f,"group.image.stretch":"fill","group.repeat.image":f,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":f,"group.title.color":pp,"group.title.background":G.groupTitleBackground,"group.title.align":nk,"group.title.orientation":hk,"group.background":G.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":f,"group.border.color":iq,"group.border.radius":0,"group.border.cap":Cq,"group.border.join":Lp,"group.splitLine":!1,"group.gradient":u,"group.gradient.color":"#FFF",shape:f,"shape.background":iq,"shape.repeat.image":f,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":iq,"shape.border.3d":!1,"shape.border.3d.color":f,"shape.border.3d.accuracy":f,"shape.border.cap":Cq,"shape.border.join":Lp,"shape.border.pattern":f,"shape.gradient":u,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":rn,"shape.dash.offset":0,"shape.dash.color":Ai,"shape.dash.width":f,"shape.dash.3d":!1,"shape.dash.3d.color":f,"shape.dash.3d.accuracy":f,"shape.polygon.side":6,"shape.arc.from":y,"shape.arc.to":e,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":f,"shape.gradient.pack":f,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":f,"shape.foreground.gradient":u,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":f,"autolayout.hgap":f,"autolayout.vgap":f,"edge.type":f,"edge.points":f,"edge.segments":f,"edge.color":iq,"edge.width":2,"edge.width.absolute":!1,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":f,"edge.3d.accuracy":f,"edge.cap":Cq,"edge.join":Lp,"edge.source.position":17,"edge.source.anchor.x":f,"edge.source.anchor.y":f,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":f,"edge.target.anchor.y":f,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":f,"edge.dash":!1,"edge.dash.pattern":rn,"edge.dash.offset":0,"edge.dash.color":Ai,"edge.dash.width":f,"edge.dash.3d":!1,"edge.dash.3d.color":f,"edge.dash.3d.accuracy":f,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":f,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":f,"grid.column.percents":f,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":G.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":G.gridCellBorderColor,"grid.block":f,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":G.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":ie,"text.font":bn,"text.shadow":!1,"text.shadow.color":dr,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,_62O:f},!0),ae(ss,{_76I:function(m,V,R){this._39I&&this._39I.fire({data:m,oldIndex:V,newIndex:R})},addIndexChangeListener:function(f,a,A){var q=this;q._39I||(q._39I=new ch),q._39I.add(f,a,A)},removeIndexChangeListener:function(M,a){this._39I.remove(M,a)},prepareRemove:function(J){ej(J)&&(J.setSource(u),J.setTarget(u)),J._70O&&J._70O.toList().each(this.remove,this),J._69O&&J._69O.toList().each(function(N){N.setHost(u)}),J._host&&J.setHost(u)},onAdded:function(m){this.isAutoAdjustIndex()&&this.adjustIndex(m)},onDataPropertyChanged:function(l,W){yo[W.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(l)},isAdjustable:function(E){return xp(E)||ej(E)},isAdjustedToBottom:function(p){return yi(p)?p.isExpanded()&&_f(p):!1},adjustIndex:function(G){var $=this;this.isHierarchicalRendering()||($.isAdjustedToBottom(G)?($.sendToBottom(G),G.eachChild($.adjustIndex,$)):$.sendToTop(G))},sendToTop:function(G){var t=this;if(t.contains(G)&&t.isAdjustable(G)){var o=t._datas;if(G!==o.get(t.size()-1)){var p=o.indexOf(G);o.removeAt(p),o.add(G),t._76I(G,p,t.size()-1)}if(ej(G)){var X=G._40I;X&&!t.isAdjustedToBottom(X)&&t.sendToTop(X),X=G._41I,X&&!t.isAdjustedToBottom(X)&&t.sendToTop(X)}G._69O&&G._69O.each(function(n){n.isRelatedTo(G)||xp(G)&&n.isLoopedHostOn(G)||t.sendToTop(n)}),G.ISubGraph||(!yi(G)||G.isExpanded())&&G._adjustChildrenToTop&&G.eachChild(function(r){ej(r)||t.sendToTop(r)})}},sendToBottom:function(v,n){var x=this;if(v!==n&&x.contains(v)&&x.isAdjustable(v)&&(!n||x.contains(n))){var s=x._datas,G=s.remove(v),e=n?x._datas.indexOf(n):0;if(s.add(v,e),G!==e){x._76I(v,G,e);var p=v._parent;!p||p.ISubGraph||ej(p)||x.sendToBottom(v._parent,v)}}}}),ae($r,{ms_edit:function(O){O._46O=function(O){var G=this,f=G.gv.dm(),P=G._index,s=G._89I,q=G._node,z=G._shape,c=G._edge,u=G._77I;q&&s?(this.fi({kind:"endEditRect",event:O,data:q,direction:s}),f.endTransaction()):z&&P>=0?(G.fi({kind:"endEditPoint",event:O,data:z,index:P}),f.endTransaction()):c&&P>=0?(G.fi({kind:"endEditPoint",event:O,data:c,index:P}),f.endTransaction()):u&&(G.fi({kind:"endEditRotation",event:O,data:u}),f.endTransaction())},O._78I=function(L){var K=this;K.autoScroll(L);var D=K.gv.lp(L),z=K._index,p=K._89I,r=K._node,Q=K._shape,J=K._edge,m=K._77I;if(r&&p)K._80O(D),K.fi({kind:"betweenEditRect",event:L,data:r,direction:p});else if(Q&&z>=0)D.e=Q.getPoints().get(z).e,Q.setPoint(z,D),K.fi({kind:"betweenEditPoint",event:L,data:Q,index:z});else if(J&&z>=0){var v=J.s(zq);D.e=v.get(z).e,v.set(z,D),J.fp(zq,u,v),K.fi({kind:"betweenEditPoint",event:L,data:J,index:z})}else if(m){var _=m.p(),q=m.getScale(),A=N+$(D.y-_.y,D.x-_.x);q.y<0&&(A+=y),k(A)<.04&&(A=0),m.setRotation(A),K.fi({kind:"betweenEditRotation",event:L,data:m})}},O._80O=function(m){var c=this,Y=c._node,F=c._rect,I=F.x,G=F.y,R=F.width,K=F.height,u=c._89I,D=c._anchor,j=c._matrix,m=j.tfi(m);"northwest"===u?F=ys(m,{x:I+R,y:G+K}):u===ul?F=ys({x:I,y:m.y},{x:I+R,y:G+K}):"northeast"===u?F=ys({x:I,y:m.y},{x:m.x,y:G+K}):u===hd?F=ys({x:m.x,y:G},{x:I+R,y:G+K}):u===qb?F=ys({x:I,y:G},{x:m.x,y:G+K}):"southwest"===u?F=ys({x:m.x,y:G},{x:I+R,y:m.y}):"south"===u?F=ys({x:I,y:G},{x:I+R,y:m.y}):"southeast"===u&&(F=ys({x:I,y:G},m)),Y.setPosition(j.tf(F.x+F.width*D.x,F.y+F.height*D.y)),Y.setWidth(F.width),Y.setHeight(F.height)},O._80I=function(i,L,y,n){var Z=this,D=Z.gv._zoom,W=(Z.gv.getEditPointSize()+2)/D;return oj({x:L-W/2,y:y-W/2,width:W,height:W},i)?(Z._89I!==n&&(Z._89I=n),!0):!1},O._79I=function(M,d,G){var g=this,l=g.gv,j=d?l.getDataUI(d):u,s=j?j._55O:u;if(s){var q,U,V,n,I=l._zoom,h=(l.getEditPointSize()+2)/I,L=l.lp(M);if(xp(d)){if(s._56O&&xp(d)&&(U=s._98o,oj({x:U.x-h/2,y:U.y-h/2,width:h,height:h},L)))return g._77I=d,G&&g.fi({kind:"beginEditRotation",event:M,data:d}),g.setCursor("crosshair"),!0;if(s._43O&&d instanceof vm)for(V=d.getPoints(),q=V.size()-1;q>=0;q--)if(U=V.get(q),oj({x:U.x-h/2,y:U.y-h/2,width:h,height:h},L))return g._index=q,g._shape=d,G&&g.fi({kind:"beginEditPoint",event:M,data:d,index:q}),g.setCursor("crosshair"),!0;if(s._42O)for(var H=d.getEditControlPoints(),o=["northwest",-1,-1,hd,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,qb,1,0,"northeast",1,-1,ul,0,-1],q=0,n=H.length;n>q;q++){var A=o[3*q],Q=H[q];if(g._80I(L,Q.x,Q.y,A)){g._node=d;var $=d.getWidth(),J=d.getHeight(),P=d.getAnchor();g._rect={x:-$*P.x,y:-J*P.y,width:$,height:J},g._anchor=P,g._matrix=d.getMatrix();var K=d.getRotation(),i=p(K),r=x(K),z=o[3*q+1]*Zm(d.getScale().x),e=o[3*q+2]*Zm(d.getScale().y),T=Math.atan2(-r*z-i*e,i*z-r*e),k=(Math.round(T/(Math.PI/4))+8)%8,X=[Bn,"nesw-resize",pe,"nwse-resize",Bn,"nesw-resize",pe,"nwse-resize"][k];return g.setCursor(X),G&&g.fi({kind:"beginEditRect",event:M,data:d,direction:g._89I}),!0}}}if(s._43O&&ej(d)&&d.s(_j)===kp&&(V=d.s(zq)))for(q=V.size()-1;q>=0;q--)if(U=V.get(q),oj({x:U.x-h/2,y:U.y-h/2,width:h,height:h},L))return g._index=q,g._edge=d,G&&g.fi({kind:"beginEditPoint",event:M,data:d,index:q}),g.setCursor("crosshair"),!0}return!1}},ms_gv:function(c){c._currentSubGraph=u,c._fpsInfo={time:0,fps:0,frames:0},c.upSubGraph=function(){this.setCurrentSubGraph(Dc(this._currentSubGraph))},c.isVisible=function(V){var x=this;if(Dc(V)!==x._currentSubGraph)return!1;if(ej(V)){var R=V._40I,X=V._41I;if(!R||!X)return!1;if(!(V.s("edge.independent")||x.isVisible(R)&&x.isVisible(X)))return!1;if(V.isEdgeGroupHidden())return!1}else for(var q=V._parent;q&&!q.ISubGraph;){if(yi(q)&&(!q.isExpanded()||!x.isVisible(q)))return!1;
q=q._parent}if(V._parent instanceof ls&&!x.isVisible(V._parent))return!1;if(V._refGraph instanceof wh&&!x.isVisible(V._refGraph))return!1;if(x instanceof Kf){if(!V.s("3d.visible"))return!1}else{var S=x.getLayersInfo();if(S){var t=S[V._layer];if(t&&t.visible===!1)return!1}if(!V.s("2d.visible"))return!1}return x._visibleFunc?x._visibleFunc(V):!0},c.handleSelectionChange=function(E){var k=this;E.datas.each(function(f){k.invalidateData(f);var p=f._parent;yi(p)&&xp(f)&&f.s(dk)&&(k.invalidateData(p),p._49I&&p._49I.each(function(F){k.invalidateData(F)}))}),k.onSelectionChanged(E)},c.onSelectionChanged=function(f){var Z=this,B=Z.sm();if(1===B.size()&&("set"===f.kind||"append"===f.kind)){var U=B.ld();Z.isAutoMakeVisible()&&Z.makeVisible(U),Z.adjustIndex&&Z._dataModel.isAutoAdjustIndex()&&Z.adjustIndex(U)}},c.makeVisible=function(F){if(F){var I=this,k=I.getDataUI?I.getDataUI(F):I.getData3dUI(F);if(k){var A=F,y=Dc(F);for(y!==I._currentSubGraph&&I.setCurrentSubGraph(y);(A=A._parent)&&A!==y;)yi(A)&&A.setExpanded(!0);I._23I=F,I.iv()}}},c.getLabel=function(p){var P=p.getStyle(Fr);return P===f?p.getName():P},c.getLabelBackground=function(z){return z.getStyle("label.background")},c.getLabelColor=function(F){return F.getStyle("label.color")},c.getLabel2=function($){return $.getStyle("label2")},c.getLabel2Background=function(t){return t.getStyle("label2.background")},c.getLabel2Color=function(c){return c.getStyle("label2.color")},c.getNote=function(m){return m.getStyle(cf)},c.getNoteBackground=function(W){return W.getStyle("note.background")},c.getNote2=function(U){return U.getStyle(ic)},c.getNote2Background=function(m){return m.getStyle("note2.background")},c.handleClick=function(I,Q,M){var y=this;Q?(y.fi({kind:"clickData",event:I,data:Q,part:M}),y.onDataClicked(Q,I)):(y.fi({kind:"clickBackground",event:I}),y.onBackgroundClicked(I))},c.handleDoubleClick=function(n,t,W){var h=this;js(n)&&(t?(h.fi({kind:"doubleClickData",event:n,data:t,part:W}),h.onDataDoubleClicked(t,n,W),h.checkDoubleClickOnNote(n,t,W)||h.checkDoubleClickOnRotation&&h.checkDoubleClickOnRotation(n,t,W)||(ej(t)?h.onEdgeDoubleClicked(t,n,W):t.ISubGraph?h.onSubGraphDoubleClicked(t,n,W):yi(t)?h.onGroupDoubleClicked(t,n,W):t.IDoorWindow?h.onDoorWindowDoubleClicked(t,n,W):t.ICSGBox&&h.onCSGBoxDoubleClicked(t,n,W))):(h.fi({kind:"doubleClickBackground",event:n}),h.onBackgroundDoubleClicked(n)))},c.onSubGraphDoubleClicked=function(U){this.setCurrentSubGraph(U)},c.onEdgeDoubleClicked=function(e,w){e.ISubGraph&&!Be(w)?this.setCurrentSubGraph(e):e.s("edge.toggleable")&&e.toggle()},c.onGroupDoubleClicked=function(o){o.s("group.toggleable")&&o.toggle()},c.onDoorWindowDoubleClicked=function(I){I.s("dw.toggleable")&&I.toggle(!0)},c.onCSGBoxDoubleClicked=function($,R){var I=this;if(I instanceof Kf){var r=I.getHitFaceInfo(R);r&&r.face&&$.s(r.face+".toggleable")&&$.toggleFace(r.face,!0)}},c.onBackgroundClicked=function(){},c.onBackgroundDoubleClicked=function(){this.upSubGraph()},c.onDataClicked=function(){},c.onDataDoubleClicked=function(){},c.onAutoLayoutEnded=function(){},c.onMoveEnded=function(){},c.onPanEnded=function(){},c.onPinchEnded=function(){},c.onRectSelectEnded=function(){},c.onZoomEnded=function(){},c.serialize=function(z){return this.dm().serialize(z)},c.toJSON=function(){return this.dm().toJSON()},c.deserialize=function(l,B){var D=this;B=B instanceof lc?{rootParent:B}:Wr(B)?{setId:B}:Ze(B)?{finishFunc:B}:B||{},B.view=D;var K=D.dm(),z=B.finishFunc;return B.finishFunc=function(){z&&z.apply(B,arguments),Wr(K.a("zoomable"))&&D.setZoomable&&D.setZoomable(K.a("zoomable")),Wr(K.a("pannable"))&&D.setPannable&&D.setPannable(K.a("pannable")),Wr(K.a("rectSelectable"))&&D.setRectSelectable&&D.setRectSelectable(K.a("rectSelectable")),K.a("fitContent")===!0&&D.fitContent&&D.fitContent(!0,0)},K.deserialize(l,B.rootParent,B)},c.showDebugTip=function(){var v=this,k=v._debugDiv;if(!k){k=v._debugDiv=Y.createElement("div"),k.style.position="absolute",k.style.overflow="hidden",k.style.backgroundColor="white",k.style.color="black";var A=v.getView();v._79O?A.insertBefore(k,v._79O):A.appendChild(k);var d=function(){v.redraw();var g="FPS : "+v._fpsInfo.fps+"<br/>"+"Datas : "+v.dm().getDatas().length,W=v.getDebugTip();W&&(g+="<br/>------<br/>"+W),k.innerHTML=g,v._isDebugging&&requestAnimationFrame(d)};requestAnimationFrame(d),v._isDebugging=!0}},c.hideDebugTip=function(){var D=this,q=D._debugDiv;q&&(delete D._debugDiv,D.getView().removeChild(q),D._isDebugging=!1)},c.countFrame=function(){if(this._isDebugging){var Y=Date.now(),R=this._fpsInfo;Y-R.time>1e3?(R.fps=Math.round(1e5*(R.frames+1)/(Y-R.time))/100,R.time=Y,R.frames=0):R.frames++}}},ms_icons:function(o){o.getRotation=function(p){return p==u?0:p},o._15O=function(){var L=this,w=L.s(dj);if(w){var p=L,t=L.data||L._data,E=L._38o={icons:w,rects:{}};for(var g in w){var x=w[g],q=wq(x.shape3d,t,p);if(!(wq(x.visible,t,p)===!1||wq(x.for3d,t,p)&&!L.I3d||q&&!L.I3d)){var K=q?[q]:wq(x.names,t,p),A=K?K.length:0,B=wq(x.position,t,p)||3,h=wq(x.offsetX,t,p)||0,M=wq(x.offsetY,t,p)||0,o=wq(x.direction,t,p)||qb,C=wq(x.gap,t,p),s=C!=u?C:1,T=wq(x.rotation,t,p),O=wq(x.keepOrien,t,p),$=wq(x.rotationFixed,t,p)?T:L.getRotation(T,O,B),N=u,j=E.rects[g]=new Array(A);j.rotation=$;for(var k=0;A>k;k++){var i,y,V,H,_=K[k];if(q)V=0,H=0;else{var r=Hi(_);V=wq(x.width,t,p),H=wq(x.height,t,p),V==u&&(V=Bp(r,t)),H==u&&(H=Fd(r,t))}if(N?o===qb?h+=V/2:o===hd?h-=V/2:o===ul?M-=H/2:M+=H/2:N={width:V,height:H},L.I3d){var R=-V/2,c=-H/2;y={width:V,height:H,mat:L._16O(wq(x.autorotate,t,p),B,N,wq(x.face,t,p)||gr,wq(x.t3,t,p),wq(x.r3,t,p),wq(x.rotationMode,t,p),h,M),vs:new Jk([R,-c,0,R,-c-H,0,R+V,-c-H,0,R+V,-c,0])}}else i=L.getPosition(B,h,M,N,wq(x.positionFixed,t,p)),y={x:i.x-V/2,y:i.y-H/2,width:V,height:H},L._68o(y,$);j[k]=y,o===qb?h+=V/2+s:o===hd?h-=V/2+s:o===ul?M-=H/2+s:M+=H/2+s}}}}}}});var rf={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},gc={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Qr={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},yo={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},em={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Ud={"edge.type":1,"edge.group":1},nr={rotation:1,rotationX:1,rotationZ:1},bl={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Lk={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},ko={shape:1,thickness:1,position:1,anchor:1,scale:1},Dc=function(c){if(!c)return u;if(ej(c)){var k=c._40I,r=c._41I;if(!k||!r)return u;var V=Dc(k),W=Dc(r);return V===W?V:u}for(var w=c._parent;ej(w)&&!w.ISubGraph;)w=w._parent;return w?w.ISubGraph?w:Dc(w):u},Sf=function(G,w,x,m){var p=w.getStyle(x)*m;p&&ce(G,p),p=w.getStyle(x+".left")*m,p&&(G.x-=p,G.width+=p),p=w.getStyle(x+".right")*m,p&&(G.width+=p),p=w.getStyle(x+".top")*m,p&&(G.y-=p,G.height+=p),p=w.getStyle(x+".bottom")*m,p&&(G.height+=p),G.width<0&&(G.width=-G.width,G.x-=G.width),G.height<0&&(G.height=-G.height,G.y-=G.height)},_f=function(I){for(var h,n=0,c=I.size();c>n;n++)if(h=I.getChildAt(n),xp(h)&&_f(h))return!0;return I.hasAgentEdges()},kh=function(y){if(!y)return u;for(var w=y._parent;yi(w);){if(!yi(w._parent))return w.isExpanded()?y:w;w.isExpanded()||(y=w),w=w._parent}return y},Bc=function(K,s){if(!K||!s)return u;var O,x,L,G=Dc(K),e=Dc(s);if(G!==e){for(;e&&G!==e;)e=Dc(e);if(G===e)return K;O=new _e,O.add(K,0);for(var T=K._parent;xp(T)&&!s.isDescendantOf(T);)O.add(T,0),T=T._parent;for(L=O.size(),x=0;L>x;x++){var M=O.get(x);if(yi(M)&&!M.isExpanded())return M;if(M.ISubGraph)return M}return K}return K},jf=function(Y){if(Y.isLooped())return Y._source;var V=kh(Y._source),n=kh(Y._target);return V===n?Y._source:Bc(V,n)},Qk=function(i){if(i.isLooped())return i._target;var u=kh(i._source),g=kh(i._target);return u===g?i._target:Bc(g,u)},ug=function(d,X,s){"target"!==s&&(s="source");var C="target"===s?X.getTargetAgent():X.getSourceAgent(),i="edge."+s+".";if(ej(C)){var W=d.getDataUI(C);W._79o();var G=X.s(i+"index");if(G!==f){var _=eo(W);return _[Math.max(0,Math.min(G,_.length-1))]}var y=X.s(i+"percent")||0;y=Math.max(0,Math.min(y,1));var M=uj(W);return Ln(M,100*y)}return ql(d,C,X.s(i+"position"),X.s(i+"offset.x"),X.s(i+"offset.y"),X.s(i+"anchor.x"),X.s(i+"anchor.y"))},ql=function(R,z,$,C,q,c,b){if(!z)return u;var d,n=z.getRotation?z.getRotation():0;if(c!==f||b!==f)if(c=c===f?.5:c,b=b===f?.5:b,n&&!Dk(z,R)){var i=z.getPosition(),B=z.getWidth(),y=z.getHeight(),o=z.getAnchor(),e=z.getScale(),Z=new Cg(n,i.x,i.y,e.x,e.y);$=Z.tf((c-o.x)*B,(b-o.y)*y)}else d=wo(R,z),$={x:d.x+c*d.width,y:d.y+b*d.height};else $=Eg($,wo(R,z));if(n){var j=p(n),F=x(n),V=C*j-q*F;q=C*F+q*j,C=V}return $.x+=C,$.y+=q,$},Xd=function(Y,S){if(!Y||!S)return u;var k,P,J,U,Z,r;if(Y===S){if(U=Y.getLoopedEdges(),!U)return u;U=new _e(U)}else{if(Z=Y.getAgentEdges(),r=S.getAgentEdges(),!Z||!r)return u;for(P=Z.size(),k=0;P>k;k++)J=Z.get(k),r.contains(J)&&(U||(U=new _e),U.add(J))}if(U)for(k=0;k<U.size();k++)J=U.get(k),J.getStyle(_j)===kp&&(J._22I(u),U.removeAt(k),k--);return U},Rl=function(i,v){var U=Xd(i,v);if(U&&!U.isEmpty()){if(1===U.size())return U.get(0)._22I(u),void 0;var f=new _e,P=new _e;U.each(function(N){var R=N.s("edge.group");f.contains(R)||f.add(R)}),f.sort(),f.each(function(m){P.add(new X.EdgeGroup(U.toList(function(V){return m===V.s("edge.group")}),P))}),P.each(function(I){I.each(function(G){G._22I(I)})})}},fo=function(O,x,f){var q=O._canvas;O._zoom;var a=_k(x,q),w=_k(f,q);return{x:a.x-w.x,y:a.y-w.y}},Ic=function(C,f){if(f){var Y=f.rect,j=f.color,p=f.rotation,c=f.labelWidth,e=f.background,Z=f.opacity,w=f.scale,s=w!=u&&1!==w;if(Z!=u){var l=C.globalAlpha;C.globalAlpha*=Z}if(p||s){C.save();var B=Y.x+Y.width/2,D=Y.y+Y.height/2;vk(C,B,D),p&&ts(C,p),s&&C.scale(w,w),vk(C,-B,-D)}if(e&&On(C,Y.x,Y.y,Y.width,Y.height,e),c){var i=Y.width,m=C.createLinearGradient(Y.x,Y.y,Y.x+i,Y.y);m.addColorStop(0,j),m.addColorStop(.9,j),m.addColorStop(1,Go),j=m,Y.width=c}Jd(C,f.ss,Y,f.font,j,f.align),c&&(Y.width=i),(p||s)&&C.restore(),Z!=u&&(C.globalAlpha=l)}},wg=function(B,r){if(r){var n=r.rect,j=n.x,h=n.y,k=n.width,q=n.height,J=r.background,E=r.backgroundImage,M=r.borderWidth,f=r.borderColor,X=r.labelWidth,P=r.opacity,l=r.scale,s=l!=u&&1!==l;if(P!=u){var p=B.globalAlpha;B.globalAlpha*=P}if(s){B.save();var T=n.x+n.width/2,b=n.y+n.height/2;vk(B,T,b),B.scale(l,l),vk(B,-T,-b)}if(r.expanded){var D=I(8,k/4),S=h+q-8;if(B.fillStyle=J,B.beginPath(),B.moveTo(j,h),B.lineTo(j,S),B.lineTo(j+k/2,S),B.lineTo(j+k/2,h+q),B.lineTo(j+k/2+D,S),B.lineTo(j+k,S),B.lineTo(j+k,h),B.closePath(),B.fill(),M&&(B.lineWidth=M,B.lineJoin="round",B.lineCap="round",f?(B.strokeStyle=f,B.stroke()):(B.strokeStyle=zm(J),B.beginPath(),B.moveTo(j+k,h),B.lineTo(j+k,S),B.lineTo(j+k/2+D,S),B.lineTo(j+k/2,h+q),B.stroke(),B.strokeStyle=Xm(J),B.beginPath(),B.moveTo(j+k,h),B.lineTo(j,h),B.lineTo(j,S),B.lineTo(j+k/2,S),B.lineTo(j+k/2,h+q),B.stroke())),E)fh(B,Hi(E),zs,n.x,n.y,n.width,n.height-8,r.data,r.view);else{if(n.height-=8,J=r.color,X){var o=k,Y=B.createLinearGradient(j,h,j+o,h);Y.addColorStop(0,J),Y.addColorStop(.9,J),Y.addColorStop(1,Go),J=Y,n.width=X}Jd(B,r.ss,n,r.font,J,r.align),X&&(n.width=o),n.height+=8}}else if(r.icon)Fp(B,Hi(r.icon),j,h,k,q,r.data,r.view);else{var t=k/2;M&&(B.lineWidth=M,B.lineJoin="round",B.lineCap="round",B.strokeStyle=f?f:zm(J),B.beginPath(),B.arc(j+t,h+t,t,N,1.6*y,!0),B.moveTo(j+t,h+q),B.lineTo(j+k-t/5,h+t),B.stroke(),B.strokeStyle=f?f:Xm(J),B.beginPath(),B.arc(j+t,h+t,t,1.6*y,N,!0),B.moveTo(j+t,h+q),B.lineTo(j+t/5,h+t),B.stroke()),B.fillStyle=J,B.beginPath(),B.arc(j+t,h+t,t,0,e,!0),B.moveTo(j+t,h+q),B.lineTo(j+k-t/5,h+t),B.lineTo(j+t/5,h+t),B.closePath(),B.fill(),B.fillStyle=r.color,B.beginPath(),B.arc(j+t,h+t,t/3,0,e,!0),B.fill()}s&&B.restore(),P!=u&&(B.globalAlpha=p)}},An=function(W,y){return y>2*W?W:y/2},Hk=function(W,Z,s,v){if(!W||!Z)return 0;var o=$(Z.y-W.y,Z.x-W.x);return s||(o=Z.x<W.x?o+y:o),o+v},Vo=function(V,x,m,I,B,Y,t){t&&(V.x>x.x||V.x===x.x&&V.y>x.y)&&(m=$i[m],B=-B);var R=Eg(m,{x:0,y:0,width:Di(V,x),height:0},Y);return R.x+=I,R.y+=B,R=new Cg($(x.y-V.y,x.x-V.x)).tf(R),R.x+=V.x,R.y+=V.y,R},Gr=function(g,x,P,U,O){if(g._19Q=!0,!P.getEdgeGroup())return U?P.s("edge.gap"):0;if(ej(P.getSourceAgent())||ej(P.getTargetAgent()))return 0;var I,k=0,w=0,N=0;if(P.getEdgeGroup().getSiblings().each(function(Y){Y.each(function(R){if(x.isVisible(R)&&R.s(_j)==O){var b=R.s("edge.gap");I?(w+=N/2+b/2,N=b):(I=R,N=b),R===P&&(k=w)}})}),U)return w-k+N;var v=k-w/2;return I&&P._40I!==I._40I&&(g._19Q=!1),v},Nn=function(){var A=function(C){var g=[];return C.forEach(function(v){g.push({x:v.x,y:v.y}),g.push({x:v.x+v.width,y:v.y+v.height}),g.push({x:v.x+v.width,y:v.y}),g.push({x:v.x,y:v.y+v.height})}),g};return function(v,C,W){if("oval"===v){var c=0,s=W.height/W.width,u=s*s,q=W.x+W.width/2,f=W.y+W.height/2,N=A(C);N.forEach(function(p){var T=p.x-q,r=p.y-f,$=T*T+r*r/u;$>c&&(c=$)}),c=r(c);var P=s*c;return{x:q-c,y:f-P,width:2*c,height:2*P}}if("circle"===v){var Q=0,q=W.x+W.width/2,f=W.y+W.height/2,N=A(C);return N.forEach(function(A){var e=A.x-q,t=A.y-f,E=e*e+t*t;E>Q&&(Q=E)}),Q=r(Q),{x:q-Q,y:f-Q,width:2*Q,height:2*Q}}return"roundRect"===v?(ce(W,I(W.width,W.height)/16),W):W}}(),cm=X.graph={},nq=function(j,D,V){xk(Q+".graph."+j,D,V)};X.layout={};var qk={},Jj=function(r,q,C,i,U,f,Y,c){var b=[q.uuid,Math.round(i),Math.round(U),C].join("_");q.cacheRule&&(b+=wq(q.cacheRule,f,Y));var W=Y._zoom;W!==Y._cacheZoom&&(Y._cacheZoom=W,Y._cacheImage={});var a=Y._cacheImage[b];return a||(a=Y._cacheImage[b]=X.Default.toCanvas(q,Math.ceil(i*W),Math.ceil(U*W),C,f,Y,c)),a};ae(U,{setImageCacheRule:function(X,z){var u;u=z||"object"!=typeof X?{_image:z}:X;for(var L in u){var S=u[L];Bs(L)?(xk=Hi(L),xk?xk.cacheRule=S:qk[L]=S):L.cacheRule=S}}});var Co={comps:[{type:Kn,points:[85,50,70,115,100,71,86,107,88,49,57,76,112,75,43,50,55,117,78,90,51,73,85,74,68,118,48,79,57,103,67,97,52,66,112,108,89,43,80,54,110,98,107,61],borderWidth:1,borderColor:u}]};if(Co[ir]=Co[tj]=160,M.Image){var Ag=new M.Image;Ag.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",bh("default_blank",Ag)}bh("node_image",$q(30,30,[{type:Ej,rect:[4,5,22,16],gradient:Nl,gradientColor:Wb,background:iq},{type:Ej,rect:[2,3,26,20],borderWidth:1,borderColor:iq},{type:Ej,rect:[11,23,8,4],background:iq},{type:Ej,rect:[6,27,18,2],background:iq}])),bh("node_icon",$q(16,16,[{type:Ej,rect:[2,2,12,10],gradient:Nl,gradientColor:Wb,background:iq},{type:Vd,rect:[2,2,12,10],width:1,color:iq},{type:Ej,rect:[6,12,4,2],background:iq},{type:Ej,rect:[4,14,8,1],background:iq}])),bh("block_icon",$q(16,16,[{type:Vd,rect:[1,1,14,14],width:1,color:iq}])),bh("group_image",$q(66,39,[{type:Ej,rect:[44.3,18,18.1,12.8],gradient:Nl,gradientColor:Wb,background:iq},{type:Ej,rect:[3.3,17.8,18.1,12.8],gradient:Nl,gradientColor:Wb,background:iq},{type:Ej,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:iq,gradient:Nl,gradientColor:Wb,background:iq},{type:Ej,rect:[26.2,29.4,12.8,4.2],background:iq},{type:Ej,rect:[21.3,33.5,22.5,2.3],background:iq},{type:Ej,rect:[5.3,32.7,14.1,2.1],background:iq},{type:Ej,rect:[9,30.4,6.7,2.4],background:iq},{type:Ej,rect:[50,30.7,6.7,2.4],background:iq},{type:Ej,rect:[46.3,33,14.1,2.1],background:iq}])),bh("group_icon",$q(16,16,[{type:Ej,rect:[4,12,4,2],background:iq},{type:Ej,rect:[2,13,8,1],background:iq},{type:Ej,rect:[12,12,2,1],background:iq},{type:Ej,rect:[11,13,4,1],background:iq},{type:Ej,rect:[10,7,6,5],gradient:Nl,gradientColor:Wb,background:iq},{type:Ej,rect:[1,2,10,10],gradient:Nl,gradientColor:Wb,background:iq},{type:Vd,rect:[1,2,10,10],width:1,color:iq}])),bh("refGraph_icon",$q(16,16,[{type:"shape",borderWidth:1,borderColor:iq,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:iq,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),bh("edge_icon",$q(16,16,[{type:Ej,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:Nl,gradientColor:Wb,background:iq},{type:Ej,rect:[10.8,1,4,4],background:iq},{type:Ej,rect:[1,11,4,4],background:iq}])),bh("subGraph_image",$q(72,45,[{type:Kn,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:Nl,gradientColor:Wb,background:iq},{type:Ej,rect:[29.6,30.7,3.6,1.8],background:iq},{type:Ej,rect:[28.4,32.3,6,1.2],background:iq},{type:Ej,rect:[37.3,32,10.8,1.8],background:iq},{type:Ej,rect:[39.1,29.9,7.2,2.3],background:iq},{type:Ej,rect:[26.6,23.7,9.6,7.2],gradient:Nl,gradientColor:Wb,background:iq},{type:Ej,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:iq,gradient:Nl,gradientColor:Wb,background:iq}])),bh("subGraph_icon",$q(17,17,[{type:Kn,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:Nl,gradientColor:Wb,background:iq}])),bh("shape_icon",$q(16,16,[{type:Kn,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:iq}])),bh("polyline_icon",$q(16,16,[{type:Kn,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:iq},ip(7.5,.4),ip(7.5,6.3),ip(13.6,6.3),ip(13.6,14),ip(.7,13.9),ip(.7,.3)])),bh("grid_icon",$q(16,16,[{type:Ej,rect:[1,1,4,4],background:iq,gradient:Nl,gradientColor:Wb},{type:Ej,rect:[6,1,4,4],background:iq,gradient:Nl,gradientColor:Wb},{type:Ej,rect:[11,1,4,4],background:iq,gradient:Nl,gradientColor:Wb},{type:Ej,rect:[11,6,4,4],background:iq,gradient:Nl,gradientColor:Wb},{type:Ej,rect:[6,6,4,4],background:iq,gradient:Nl,gradientColor:Wb},{type:Ej,rect:[1,6,4,4],background:iq,gradient:Nl,gradientColor:Wb},{type:Ej,rect:[11,11,4,4],background:iq,gradient:Nl,gradientColor:Wb},{type:Ej,rect:[6,11,4,4],background:iq,gradient:Nl,gradientColor:Wb},{type:Ej,rect:[1,11,4,4],background:iq,gradient:Nl,gradientColor:Wb}])),bh("light_icon",$q(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:iq},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:iq,gradient:Nl,gradientColor:Wb,background:{func:function(e){var y=e?e.s(vn):u;return En(y)?"rgb("+A(255*y[0])+","+A(255*y[1])+","+A(255*y[2])+")":y||iq}}}])),bh("text_icon",$q(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:iq}])),bh("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),bh("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),bh("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),bh("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var Fq=function(l,p,n,C,o,D){var u,j,s,T,O,a,q,z,Z,A,B,v=[];if(Math.abs(C)>2*Math.PI&&(C=2*Math.PI),O=Math.ceil(Math.abs(C)/(Math.PI/4)),u=C/O,j=-u,s=-n,O>0){a=l+Math.cos(n)*o,q=p+Math.sin(-n)*D,v.push({x:a,y:q});for(var E=0;O>E;E++)s+=j,T=s-j/2,z=l+Math.cos(s)*o,Z=p+Math.sin(s)*D,A=l+Math.cos(T)*(o/Math.cos(j/2)),B=p+Math.sin(T)*(D/Math.cos(j/2)),v.push({x:A,y:B}),v.push({x:z,y:Z})}return v},rr=function(D){if(D){var w=D._data;if(w instanceof X.Shape)return{points:w.getPoints(),segments:w.getSegments()};var r;if(w instanceof X.Edge&&(r=D._78o)){var b,W,M=r.type,Z=r.points,_=r.segments,I=r.edgeTypeInfo;if(!M||Z){var x=r.sourcePoint,k=x.x,m=x.y,$=r.targetPoint,Q=$.x,u=$.y;if(M)_?(b=new _e({x:k,y:m}),b.addAll(Z),b.add({x:Q,y:u}),W=new _e(_._as)):(b=new _e({x:k,y:m}),Z.each(function(N){b.add(N)}),b.add({x:Q,y:u}));else if(r.looped){b=new _e(Fq(k,m,0,2*Math.PI,r.radius,r.radius)),W=new _e([1]);for(var t=0;t<(b.size()-1)/2;t++)W.add(3)}else b=new _e,r.center?(b.add({x:r.c1.x,y:r.c1.y}),b.add({x:k,y:m}),b.add({x:Q,y:u}),b.add({x:r.c2.x,y:r.c2.y})):(b.add({x:k,y:m}),b.add({x:Q,y:u}))}else I&&(b=new _e(I.points._as),I.segments&&(W=new _e(I.segments._as)));return{points:b,segments:W}}}},uj=function(U,T,I){if(null==T){var a=rr(U);if(!a)return;T=a.points,I=a.segments}if(T){if(Array.isArray(T)&&(T=new _e(T)),"number"==typeof T.get(0)){for(var Q=new X.List,j=0;j<T.size();j+=2)Q.add({x:T.get(j),y:T.get(j+1)});T=Q}if(!I){I=[1];for(var V=T.length-1;V>0;V--)I.push(2)}Array.isArray(I)&&(I=new _e(I));for(var d=Lm(T._as,I._as,50),u=d.length,W=[],j=0;u>j;j++){var f=d[j];f.length>1&&W.push(f)}return W}},To=function(O){for(var h=0,m=O.length-1,V=0;m>V;V++){var f=O[V],t=O[V+1],k=t.x-f.x,R=t.y-f.y;h+=Math.sqrt(k*k+R*R)}return h},nl=function(J,C){for(var I=0,O=C.length,F=0;O>F;F++){var V=C[F];if(I+=V,I>J)return F}return Math.min(F,O-1)},um=function($,c){for(var q=0,K=0,H=0,i=$.length-1,F=0;i>F;F++){var j=$[F],Q=$[F+1],b=Q.x-j.x,J=Q.y-j.y;if(H=Math.sqrt(b*b+J*J),q+=H,q>c){q-=H,K=F;break}}var S=$[K],x=$[K+1],v=Math.atan2(x.y-S.y,x.x-S.x),V=c-q,J=Math.sin(v)*V,b=Math.cos(v)*V;return{x:S.x+b,y:S.y+J}},Ln=function(s,v){if(s){var T;if(0===v)T=s[0][0];else if(100===v)s=s[s.length-1],T=s[s.length-1];else{for(var u=0,M=[],k=s.length,p=0;k>p;p++){var P=s[p],q=To(P);u+=q,M.push(q)}for(var $=u*v/100,g=nl($,M),J=0,l=0;g>l;l++)J+=M[l];$-=J,T=um(s[g],$)}return T}},eo=function(L){var C,t,$,d,a=rr(L),g=[],j=a.points,V=a.segments,f=-1;for(t=0,$=V?V.length:j.length;$>t;t++){if(C=V?V.get(t):1,3===C)d=2;else if(4===C)d=3;else{if(5===C)continue;d=1}f+=d,g.push(j.get(f))}return g},sf=function(v,$,V,b){function C(K){if(K>=0&&1>=K){z=$(K);var E=(v.x-z.x)*(v.x-z.x)+(v.y-z.y)*(v.y-z.y);return m>E?(m=E,g=K,!0):!1}}V=V||100,b=b||1e-5;for(var m=1/0,g=0,z=new Hh,J=0;V>J;++J)C(J/V);for(var l=1/(2*V);l>b;)C(g-l)||C(g+l)||(l/=2);return g};ae(U,{_edgeProtectMethod:{getStraightLinePoints:uj,calculateLineLength:To,calcSegmentIndexByDistance:nl,calculatePointAlongLine:um,getPercentPosition:Ln}});var Rb=function(_,L){for(var W=_.vertices,k=0;k<W.length;k++){var v=W[k],U=v.y;v.y=v.z,v.z=-U,L&&(v.y+=L)}},gf=function(q){for(var o,h,Q,k,g,Z,M=[],J=[],H=[],R=q.faces,i=0,X=0,A=0,W=R.length;W>i;i++,X+=6,A+=9){var b=R[i];1===b.i?(o||(o=[],h=[],Q=[]),Yh(b,i,X,A,q,o,Q,h)):2===b.i?(k||(k=[],g=[],Z=[]),Yh(b,i,X,A,q,k,Z,g)):Yh(b,i,X,A,q,M,H,J)}return{vs:M,uv:J,ns:H,top_vs:o,top_uv:h,top_ns:Q,bottom_vs:k,bottom_uv:g,bottom_ns:Z}},Yh=function(g,l,O,Y,u,f,z,m){var v=u.vertices,c=u.faceVertexUvs,X=v[g.a],V=v[g.b],U=v[g.c];f[Y]=X.x,f[Y+1]=X.y,f[Y+2]=X.z,f[Y+3]=V.x,f[Y+4]=V.y,f[Y+5]=V.z,f[Y+6]=U.x,f[Y+7]=U.y,f[Y+8]=U.z;var L=g.vertexNormals;if(3===L.length){var Z=L[0],s=L[1],B=L[2];z[Y]=Z.x,z[Y+1]=Z.y,z[Y+2]=Z.z,z[Y+3]=s.x,z[Y+4]=s.y,z[Y+5]=s.z,z[Y+6]=B.x,z[Y+7]=B.y,z[Y+8]=B.z}else{var b=g.normal;z[Y]=b.x,z[Y+1]=b.y,z[Y+2]=b.z,z[Y+3]=b.x,z[Y+4]=b.y,z[Y+5]=b.z,z[Y+6]=b.x,z[Y+7]=b.y,z[Y+8]=b.z}var n=c[0][l][0],A=c[0][l][1],r=c[0][l][2];m[O]=n.x,m[O+1]=n.y,m[O+2]=A.x,m[O+3]=A.y,m[O+4]=r.x,m[O+5]=r.y},Tj=function(C){var r=C._lineModel;if(r)return r;var i;i=En(C)?C:[C];var m,y,T,E,A,W,M,G,J,p,g,c,_=["","top","bottom"];for(r=[],m=0,y=i.length;y>m;m++)for(J=i[m],T=0,E=_.length;E>T;T++)if(M=J[_[T]+"vs"]){G=J[_[T]+"is"],W=G?G.length:M.length/3;for(var A=0;W>A;A+=3)G?(p=G[A],g=G[A+1],c=G[A+2]):(p=A,g=A+1,c=A+2),p*=3,g*=3,c*=3,r.push(M[p],M[p+1],M[p+2],M[g],M[g+1],M[g+2],M[g],M[g+1],M[g+2],M[c],M[c+1],M[c+2],M[c],M[c+1],M[c+2],M[p],M[p+1],M[p+2])}return C._lineModel=r,r},cj=function(m,d,i,b,g,l,P,$,Q){i==u&&(i=!0),b==u&&(b=!0),P==u&&(P=1),$==u&&($=0);var W=new rg;return mm(W,m,d,Q),W=W.toShapes(),gf(new dm(W,{top:i,bottom:b,curveSegments:g,amount:P,repeatUVLength:l},-P/2+$))},tg=function(a,x){this.x=a||0,this.y=x||0};tg.prototype={constructor:tg,add:function(x){return this.x+=x.x,this.y+=x.y,this},sub:function(I){return this.x-=I.x,this.y-=I.y,this},equals:function(A){return A.x===this.x&&A.y===this.y},multiplyScalar:function(D){return this.x*=D,this.y*=D,this},distanceTo:function(u){return r(this.distanceToSquared(u))},distanceToSquared:function(g){var O=this.x-g.x,q=this.y-g.y;return O*O+q*q},clone:function(){return new tg(this.x,this.y)}};var Fh=function(P,s,U){this.x=P||0,this.y=s||0,this.z=U||0};Fh.prototype={constructor:Fh,set:function(s,h,T){return this.x=s,this.y=h,this.z=T,this},setY:function(w){return this.y=w,this},copy:function(G){return this.x=G.x,this.y=G.y,this.z=G.z,this},add:function(d){return this.x+=d.x,this.y+=d.y,this.z+=d.z,this},addVectors:function(k,B){return this.x=k.x+B.x,this.y=k.y+B.y,this.z=k.z+B.z,this},sub:function(v){return this.x-=v.x,this.y-=v.y,this.z-=v.z,this},subVectors:function(H,Z){return this.x=H.x-Z.x,this.y=H.y-Z.y,this.z=H.z-Z.z,this},multiplyScalar:function(F){return this.x*=F,this.y*=F,this.z*=F,this},applyMatrix4:function(N){var H=this.x,F=this.y,d=this.z,D=N.elements;return this.x=D[0]*H+D[4]*F+D[8]*d+D[12],this.y=D[1]*H+D[5]*F+D[9]*d+D[13],this.z=D[2]*H+D[6]*F+D[10]*d+D[14],this},divideScalar:function(l){if(0!==l){var F=1/l;this.x*=F,this.y*=F,this.z*=F}else this.x=0,this.y=0,this.z=0;return this},dot:function(f){return this.x*f.x+this.y*f.y+this.z*f.z},length:function(){return r(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(i){var U=this.x,b=this.y,Y=this.z;return this.x=b*i.z-Y*i.y,this.y=Y*i.x-U*i.z,this.z=U*i.y-b*i.x,this},crossVectors:function(h,k){var Y=h.x,j=h.y,G=h.z,s=k.x,V=k.y,c=k.z;return this.x=j*c-G*V,this.y=G*s-Y*c,this.z=Y*V-j*s,this},distanceTo:function(L){return r(this.distanceToSquared(L))},distanceToSquared:function(W){var v=this.x-W.x,S=this.y-W.y,E=this.z-W.z;return v*v+S*S+E*E},clone:function(){return new Fh(this.x,this.y,this.z)}};var me=function(){this.elements=new Float32Array(16)};me.prototype={constructor:me,set:function(H,_,z,v,B,g,j,F,f,M,Z,V,T,n,Y,G){var O=this.elements;return O[0]=H,O[4]=_,O[8]=z,O[12]=v,O[1]=B,O[5]=g,O[9]=j,O[13]=F,O[2]=f,O[6]=M,O[10]=Z,O[14]=V,O[3]=T,O[7]=n,O[11]=Y,O[15]=G,this},makeRotationAxis:function(J,u){var w=p(u),H=x(u),o=1-w,I=J.x,E=J.y,n=J.z,X=o*I,y=o*E;return this.set(X*I+w,X*E-H*n,X*n+H*E,0,X*E+H*n,y*E+w,y*n-H*I,0,X*n-H*E,y*n+H*I,o*n*n+w,0,0,0,0,1),this}};var dn=function(Z){this.repeatUVLength=Z};dn.prototype={generateTopUV:function(K,Z,z,a,y,O,G){var A,p,g,R,V=K.vertices,T=V[a].x,e=V[a].y,C=V[y].x,m=V[y].y,c=V[O].x,N=V[O].y,Y=this.repeatUVLength;if(Y)A=0,p=0,g=Y,R=Y;else{this._bb||(this._bb=Z.getBoundingBox());var s=this._bb;A=s.minX,p=s.minY,g=s.maxX-A,R=s.maxY-p}return G?[new tg((T-A)/g,(e-p)/R),new tg((C-A)/g,(m-p)/R),new tg((c-A)/g,(N-p)/R)]:[new tg((T-A)/g,1-(e-p)/R),new tg((C-A)/g,1-(m-p)/R),new tg((c-A)/g,1-(N-p)/R)]},generateBottomUV:function(H,R,W,g,B,w){return this.generateTopUV(H,R,W,g,B,w,!0)},generateSideWallUV:function(Y,w,y,l,O,H,K,g,v,m,U,B){if(!this._cl){for(var I,P,i=[],F=0,$=y.length,J=0;$>J;J++){I=y[J],P=y[(J+1)%$];var Q=I.x-P.x,h=I.y-P.y,C=r(Q*Q+h*h);i.push(F),F+=C}for(var J=0;$>J;J++)i[J]/=F;this._cl=i}var i=this._cl,R=1-v/m,A=1-(v+1)/m,S=i[U],s=i[B];return s>S&&(S+=1),[new tg(S,R),new tg(s,R),new tg(s,A),new tg(S,A)]}};var tc=function(k,M,y,u,B,w){this.a=k,this.b=M,this.c=y,this.i=w,this.normal=u instanceof Fh?u:new Fh,this.vertexNormals=u instanceof Array?u:[]};tc.prototype={constructor:tc};var gp=[-8,13,-1,8,-4,13,5,6,-1],$m=function(){if($m[Hj]!=u)return $m[Hj];for(var E=Fe[Hj],l=gp,V=lc.prototype.getClassName(),d='"',H=0,z="",y=!1,N=+new(M[V.substr(3,3)+Bn[H]]),T=H;T<l.length;T++){var w=l.length-T;z+=T%2===H?l[T]+w+"":l[T]-w+""}for(var T=H;4>T;T++)z+=H;if(z=z*z.length/z.length,N>z){if(E&&E[H]&&E[4/Ej.length]){for(var n,G,k,Y,Q,K,r,R,c=E[0],b=E[1],I="",P=0,T=0;T<b.length;T++)b[T]===d?R?(R=!1,0!==P%2&&(n==u?n=I:G==u?G=I:k==u?k=I:Y==u?Y=I:Q==u?Q=I:K==u?K=I:r==u&&(r=I)),P++,I=""):R=!0:R&&(I+=b[T]);for(var J,B,_,a="",q=0,T=0;T<c.length;T++)c[T]===d?J?(J=!1,0!==q%2&&(B==u?B=a:_==u&&(_=a)),q++,a=""):J=!0:J&&(a+=c[T]);var v=n+G+k+Y+Q+K;(y=bk(v,r)&&bk(B,_)&&B===n&&(!K||K.indexOf(Zc)>=0)&&(!Q||Q>N))&&k.indexOf(Ue[0])>=0&&($m[Ue[0]]=1),y&&k.indexOf(1)>=0&&($m[1]=1),y&&k.indexOf(2)>=0&&($m[2]=1)}}else y=!0,$m[Ue[0]]=$m[1]=$m[2]=1;return $m[Hj]=y,y},Fm=function(){},Kg=Fm.prototype;Kg.getPointAt=function(r){var c=this.getUtoTmapping(r);return this.getPoint(c)},Kg.getPoints=function(M){M||(M=5);var V,E=[];for(V=0;M>=V;V++)E.push(this.getPoint(V/M));return E},Kg.getSpacedPoints=function(l){l||(l=5);var e,P=[];for(e=0;l>=e;e++)P.push(this.getPointAt(e/l));return P},Kg.getLength=function(){var v=this.getLengths();return v[v.length-1]},Kg.getLengths=function(c){if(c||(c=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==c+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var C,o,D=[],N=this.getPoint(0),V=0;for(D.push(0),o=1;c>=o;o++)C=this.getPoint(o/c),V+=C.distanceTo(N),D.push(V),N=C;return this.cacheArcLengths=D,D},Kg.getUtoTmapping=function(v,h){var W,Z=this.getLengths(),k=0,U=Z.length;W=h?h:v*Z[U-1];for(var P,s=0,K=U-1;K>=s;)if(k=R(s+(K-s)/2),P=Z[k]-W,0>P)s=k+1;else{if(!(P>0)){K=k;break}K=k-1}if(k=K,Z[k]==W){var X=k/(U-1);return X}var f=Z[k],E=Z[k+1],C=E-f,$=(W-f)/C,X=(k+$)/(U-1);return X},Kg.getTangent=function(B){var n=1e-4,u=B-n,K=B+n;0>u&&(u=0),K>1&&(K=1);var N=this.getPoint(u),o=this.getPoint(K),x=o.clone().sub(N);return x.normalize()},Kg.getTangentAt=function(S){var z=this.getUtoTmapping(S);return this.getTangent(z)},Fm.create=function(w,k){return w.prototype=rd(Fm.prototype),w.prototype.getPoint=k,w};var Ij=function(){this.curves=[],this.autoClose=!1},Gf=Ij.prototype=rd(Kg);Gf.add=function(y){this.curves.push(y)},Gf.closePath=function(){var r=this.curves[0].getPoint(0),H=this.curves[this.curves.length-1].getPoint(1);r.equals(H)||this.curves.push(new Qi(H,r))},Gf.getPoint=function(u){for(var T,J,i=u*this.getLength(),M=this.getCurveLengths(),e=0;e<M.length;){if(M[e]>=i){T=M[e]-i,J=this.curves[e];var U=1-T/J.getLength();return J.getPointAt(U)}e++}return null},Gf.getLength=function(){var r=this.getCurveLengths();return r[r.length-1]},Gf.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var j,d=[],p=0,m=this.curves.length;for(j=0;m>j;j++)p+=this.curves[j].getLength(),d.push(p);return this.cacheLengths=d,d},Gf.getTransformedPoints=function(q){return this.getPoints(q)},Gf.getBoundingBox=function(){var Z,J,k,B,c,x,t=this.getPoints();
Z=J=Number.NEGATIVE_INFINITY,B=c=Number.POSITIVE_INFINITY;var l,D,V,o,v=t[0]instanceof Fh;for(o=v?new Fh:new tg,D=0,V=t.length;V>D;D++)l=t[D],l.x>Z&&(Z=l.x),l.x<B&&(B=l.x),l.y>J&&(J=l.y),l.y<c&&(c=l.y),v&&(l.z>k&&(k=l.z),l.z<x&&(x=l.z)),o.add(l);var w={minX:B,minY:c,maxX:Z,maxY:J};return v&&(w.maxZ=k,w.minZ=x),w};var zk=function(z){Ij.call(this),this.actions=[],z&&this.fromPoints(z)},Zh=zk.prototype=rd(Ij.prototype),Xc="moveTo",ng="lineTo",ds="quadraticCurveTo",De="bezierCurveTo",oh="arc",nm="ellipse";Zh.fromPoints=function(J){this.moveTo(J[0].x,J[0].y);for(var c=1,w=J.length;w>c;c++)this.lineTo(J[c].x,J[c].y)},Zh.moveTo=function(){var U=Array.prototype.slice.call(arguments);this.actions.push({action:Xc,args:U})},Zh.lineTo=function(m,V){var M=Array.prototype.slice.call(arguments),y=this.actions[this.actions.length-1].args,F=y[y.length-2],g=y[y.length-1],X=new Qi(new tg(F,g),new tg(m,V));this.curves.push(X),this.actions.push({action:ng,args:M})},Zh.quadraticCurveTo=function(N,u,p,H){var G=Array.prototype.slice.call(arguments),R=this.actions[this.actions.length-1].args,j=R[R.length-2],U=R[R.length-1],I=new Pf(new tg(j,U),new tg(N,u),new tg(p,H));this.curves.push(I),this.actions.push({action:ds,args:G})},Zh.bezierCurveTo=function(s,a,r,n,M,Q){var D=Array.prototype.slice.call(arguments),E=this.actions[this.actions.length-1].args,V=E[E.length-2],_=E[E.length-1],j=new Td(new tg(V,_),new tg(s,a),new tg(r,n),new tg(M,Q));this.curves.push(j),this.actions.push({action:De,args:D})},Zh.arc=function(P,b,R,s,h,v){var L=this.actions[this.actions.length-1].args,W=L[L.length-2],d=L[L.length-1];this.absarc(P+W,b+d,R,s,h,v)},Zh.absarc=function(J,z,d,y,E,s){this.absellipse(J,z,d,d,y,E,s)},Zh.ellipse=function(Z,u,X,f,J,L,z){var V=this.actions[this.actions.length-1].args,b=V[V.length-2],H=V[V.length-1];this.absellipse(Z+b,u+H,X,f,J,L,z)},Zh.absellipse=function(U,h,s,q,M,N,p){var d=Array.prototype.slice.call(arguments),c=new Bh(U,h,s,q,M,N,p);this.curves.push(c);var x=c.getPoint(1);d.push(x.x),d.push(x.y),this.actions.push({action:nm,args:d})},Zh.getSpacedPoints=function(i){i||(i=40);for(var t=[],_=0;i>_;_++)t.push(this.getPoint(_/i));return t},Zh.getPoints=function(R,Z){R=R||12;var T,B,s,N,X,H,t,l,U,r,j,C,O,z,G,u,c,Y,K=[];for(T=0,B=this.actions.length;B>T;T++)switch(s=this.actions[T],N=s.action,X=s.args,N){case Xc:K.push(new tg(X[0],X[1]));break;case ng:K.push(new tg(X[0],X[1]));break;case ds:for(H=X[2],t=X[3],r=X[0],j=X[1],K.length>0?(z=K[K.length-1],C=z.x,O=z.y):(z=this.actions[T-1].args,C=z[z.length-2],O=z[z.length-1]),G=1;R>=G;G++)u=G/R,c=Dj.b2(u,C,r,H),Y=Dj.b2(u,O,j,t),K.push(new tg(c,Y));break;case De:for(H=X[4],t=X[5],r=X[0],j=X[1],l=X[2],U=X[3],K.length>0?(z=K[K.length-1],C=z.x,O=z.y):(z=this.actions[T-1].args,C=z[z.length-2],O=z[z.length-1]),G=1;R>=G;G++)u=G/R,c=Dj.b3(u,C,r,l,H),Y=Dj.b3(u,O,j,U,t),K.push(new tg(c,Y));break;case oh:var m,g=X[0],e=X[1],i=X[2],q=X[3],W=X[4],h=!!X[5],F=W-q,v=2*R;for(G=1;v>=G;G++)u=G/v,h||(u=1-u),m=q+u*F,c=g+i*p(m),Y=e+i*x(m),K.push(new tg(c,Y));break;case nm:var m,g=X[0],e=X[1],w=X[2],n=X[3],q=X[4],W=X[5],h=!!X[6],F=W-q,v=2*R;for(G=1;v>=G;G++)u=G/v,h||(u=1-u),m=q+u*F,c=g+w*p(m),Y=e+n*x(m),K.push(new tg(c,Y))}var V=K[K.length-1],L=1e-10;return k(V.x-K[0].x)<L&&k(V.y-K[0].y)<L&&K.splice(K.length-1,1),Z&&K.push(K[0]),K},Zh.toShapes=function(n,G){function r(D){var x,K,X,z,B,E=[],w=new zk;for(x=0,K=D.length;K>x;x++)X=D[x],B=X.args,z=X.action,z==Xc&&0!=w.actions.length&&(E.push(w),w=new zk),w[z].apply(w,B);return 0!=w.actions.length&&E.push(w),E}function q(H){for(var O=[],G=0,w=H.length;w>G;G++){var m=H[G],j=new rg;j.actions=m.actions,j.curves=m.curves,O.push(j)}return O}function S(F,M){for(var y=1e-10,V=M.length,x=!1,X=V-1,u=0;V>u;X=u++){var D=M[X],s=M[u],N=s.x-D.x,o=s.y-D.y;if(k(o)>y){if(0>o&&(D=M[u],N=-N,s=M[X],o=-o),F.y<D.y||F.y>s.y)continue;if(F.y==D.y){if(F.x==D.x)return!0}else{var Q=o*(F.x-D.x)-N*(F.y-D.y);if(0==Q)return!0;if(0>Q)continue;x=!x}}else{if(F.y!=D.y)continue;if(s.x<=F.x&&F.x<=D.x||D.x<=F.x&&F.x<=s.x)return!0}}return x}var v=r(this.actions);if(0==v.length)return[];if(G===!0)return q(v);var Y,x,t,X=[];if(1==v.length)return x=v[0],t=new rg,t.actions=x.actions,t.curves=x.curves,X.push(t),X;var l=!Dj.isClockWise(v[0].getPoints());l=n?!l:l;var y,A=[],_=[],O=[],Z=0;_[Z]=f,O[Z]=[];var I,D;for(I=0,D=v.length;D>I;I++)x=v[I],y=x.getPoints(),Y=Dj.isClockWise(y),Y=n?!Y:Y,Y?(!l&&_[Z]&&Z++,_[Z]={s:new rg,p:y},_[Z].s.actions=x.actions,_[Z].s.curves=x.curves,l&&Z++,O[Z]=[]):O[Z].push({h:x,p:y[0]});if(!_[0])return q(v);if(_.length>1){for(var F=!1,K=[],N=0,E=_.length;E>N;N++)A[N]=[];for(var N=0,E=_.length;E>N;N++){_[N];for(var L=O[N],d=0;d<L.length;d++){for(var J=L[d],s=!0,W=0;W<_.length;W++)S(J.p,_[W].p)&&(N!=W&&K.push({froms:N,tos:W,hole:d}),s?(s=!1,A[W].push(J)):F=!0);s&&A[N].push(J)}}K.length>0&&(F||(O=A))}var m,w,g;for(I=0,D=_.length;D>I;I++)for(t=_[I].s,X.push(t),m=O[I],w=0,g=m.length;g>w;w++)t.holes.push(m[w].h);return X};var rg=function(){zk.apply(this,arguments),this.holes=[]},Xp=rg.prototype=rd(Zh);Xp.getPointsHoles=function(T){var _,G=this.holes.length,y=[];for(_=0;G>_;_++)y[_]=this.holes[_].getTransformedPoints(T);return y},Xp.extractAllPoints=function(h){return{shape:this.getTransformedPoints(h),holes:this.getPointsHoles(h)}},Xp.extractPoints=function(z){return this.extractAllPoints(z)};var Dj={triangulateShape:function(E,B){function H(T,S,R){return T.x!=S.x?T.x<S.x?T.x<=R.x&&R.x<=S.x:S.x<=R.x&&R.x<=T.x:T.y<S.y?T.y<=R.y&&R.y<=S.y:S.y<=R.y&&R.y<=T.y}function N(D,t,J,Q,h){var z=1e-10,X=t.x-D.x,I=t.y-D.y,d=Q.x-J.x,P=Q.y-J.y,i=D.x-J.x,O=D.y-J.y,b=I*d-X*P,L=I*i-X*O;if(k(b)>z){var U;if(b>0){if(0>L||L>b)return[];if(U=P*i-d*O,0>U||U>b)return[]}else{if(L>0||b>L)return[];if(U=P*i-d*O,U>0||b>U)return[]}if(0==U)return!h||0!=L&&L!=b?[D]:[];if(U==b)return!h||0!=L&&L!=b?[t]:[];if(0==L)return[J];if(L==b)return[Q];var o=U/b;return[{x:D.x+o*X,y:D.y+o*I}]}if(0!=L||P*i!=d*O)return[];var M=0==X&&0==I,N=0==d&&0==P;if(M&&N)return D.x!=J.x||D.y!=J.y?[]:[D];if(M)return H(J,Q,D)?[D]:[];if(N)return H(D,t,J)?[J]:[];var B,n,C,r,m,w,l,K;return 0!=X?(D.x<t.x?(B=D,C=D.x,n=t,r=t.x):(B=t,C=t.x,n=D,r=D.x),J.x<Q.x?(m=J,l=J.x,w=Q,K=Q.x):(m=Q,l=Q.x,w=J,K=J.x)):(D.y<t.y?(B=D,C=D.y,n=t,r=t.y):(B=t,C=t.y,n=D,r=D.y),J.y<Q.y?(m=J,l=J.y,w=Q,K=Q.y):(m=Q,l=Q.y,w=J,K=J.y)),l>=C?l>r?[]:r==l?h?[]:[m]:K>=r?[m,n]:[m,w]:C>K?[]:C==K?h?[]:[B]:K>=r?[B,n]:[B,w]}function M(i,T,M,n){var $=1e-10,X=T.x-i.x,Q=T.y-i.y,K=M.x-i.x,C=M.y-i.y,Y=n.x-i.x,x=n.y-i.y,g=X*C-Q*K,o=X*x-Q*Y;if(k(g)>$){var b=Y*C-x*K;return g>0?o>=0&&b>=0:o>=0||b>=0}return o>0}function h(U,c){function A(h,n){var C=F.length-1,$=h-1;0>$&&($=C);var g=h+1;g>C&&(g=0);var B=M(F[h],F[$],F[g],r[n]);if(!B)return!1;var R=r.length-1,i=n-1;0>i&&(i=R);var A=n+1;return A>R&&(A=0),B=M(r[n],r[i],r[A],F[h]),B?!0:!1}function X(v,z){var W,m,x;for(W=0;W<F.length;W++)if(m=W+1,m%=F.length,x=N(v,z,F[W],F[m],!0),x.length>0)return!0;return!1}function E(P,D){var W,X,Z,q,n;for(W=0;W<I.length;W++)for(X=c[I[W]],Z=0;Z<X.length;Z++)if(q=Z+1,q%=X.length,n=N(P,D,X[Z],X[q],!0),n.length>0)return!0;return!1}for(var r,G,d,j,w,y,W,v,h,o,Y,F=U.concat(),I=[],V=[],T=0,s=c.length;s>T;T++)I.push(T);for(var a=0,O=2*I.length;I.length>0&&(O--,!(0>O));)for(d=a;d<F.length;d++){j=F[d],G=-1;for(var T=0;T<I.length;T++)if(y=I[T],W=j.x+":"+j.y+":"+y,V[W]===f){r=c[y];for(var p=0;p<r.length;p++)if(w=r[p],A(d,p)&&!X(j,w)&&!E(j,w)){G=p,I.splice(T,1),v=F.slice(0,d+1),h=F.slice(d),o=r.slice(G),Y=r.slice(0,G+1),F=v.concat(o).concat(Y).concat(h),a=d;break}if(G>=0)break;V[W]=!0}if(G>=0)break}return F}for(var e,j,S,V,U,v,P={},C=E.concat(),J=0,K=B.length;K>J;J++)Array.prototype.push.apply(C,B[J]);for(e=0,j=C.length;j>e;e++)U=C[e].x+":"+C[e].y,P[U]!==f,P[U]=e;var p=h(E,B),W=sg.Triangulate(p,!1);for(e=0,j=W.length;j>e;e++)for(V=W[e],S=0;3>S;S++)U=V[S].x+":"+V[S].y,v=P[U],v!==f&&(V[S]=v);return W.concat()},isClockWise:function(b){return sg.Triangulate.area(b)<0},b2p0:function(B,E){var A=1-B;return A*A*E},b2p1:function(k,n){return 2*(1-k)*k*n},b2p2:function(Z,G){return Z*Z*G},b2:function(P,o,T,W){return this.b2p0(P,o)+this.b2p1(P,T)+this.b2p2(P,W)},b3p0:function(p,W){var j=1-p;return j*j*j*W},b3p1:function(n,_){var w=1-n;return 3*w*w*n*_},b3p2:function(f,w){var T=1-f;return 3*T*f*f*w},b3p3:function(o,K){return o*o*o*K},b3:function(c,C,D,m,l){return this.b3p0(c,C)+this.b3p1(c,D)+this.b3p2(c,m)+this.b3p3(c,l)}},sg={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var v=b.keys(this.faces);return v.length?v[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(c){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(N){var g=N.familyName.toLowerCase(),Q=this;return Q.faces[g]=Q.faces[g]||{},Q.faces[g][N.cssFontWeight]=Q.faces[g][N.cssFontWeight]||{},Q.faces[g][N.cssFontWeight][N.cssFontStyle]=N,N},drawText:function(x){var H,o=this.getFace(),l=this.size/o.resolution,U=0,z=String(x).split(""),K=z.length,_=[];for(H=0;K>H;H++){var A=new zk,h=this.extractGlyphPoints(z[H],o,l,U,A);h&&(U+=h.offset*this.spacing,_.push(h.path))}var G=U/2;return{paths:_,offset:G}},extractGlyphPoints:function(Q,w,W,z,Y){var S,J,s,m,d,U,r,j,H,O,P,o,F,T,x,C,y,I,Z,L=[],V=w.glyphs[Q]||w.glyphs["?"];if(V){if(V.o)for(m=V._cachedOutline||(V._cachedOutline=V.o.split(" ")),U=m.length,r=W,j=W,S=0;U>S;)switch(d=m[S++]){case"m":H=m[S++]*r+z,O=m[S++]*j,Y.moveTo(H,O);break;case"l":H=m[S++]*r+z,O=m[S++]*j,Y.lineTo(H,O);break;case"q":if(P=m[S++]*r+z,o=m[S++]*j,x=m[S++]*r+z,C=m[S++]*j,Y.quadraticCurveTo(x,C,P,o),Z=L[L.length-1])for(F=Z.x,T=Z.y,J=1,s=this.divisions;s>=J;J++){var N=J/s;Dj.b2(N,F,x,P),Dj.b2(N,T,C,o)}break;case"b":if(P=m[S++]*r+z,o=m[S++]*j,x=m[S++]*r+z,C=m[S++]*j,y=m[S++]*r+z,I=m[S++]*j,Y.bezierCurveTo(x,C,y,I,P,o),Z=L[L.length-1])for(F=Z.x,T=Z.y,J=1,s=this.divisions;s>=J;J++){var N=J/s;Dj.b3(N,F,x,y,P),Dj.b3(N,T,C,I,o)}}return{offset:V.ha*W,path:Y}}}};sg.generateShapes=function($,U){U=U||{};var M=U.font;if(M===f&&(M=sg.getDefaultFont(),!M))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var A=U.size!==f?U.size:1,i=U.curveSegments!==f?U.curveSegments:4,F=U.spacing!==f?U.spacing:1,d=U.weight!==f?U.weight:"normal",C=U.style!==f?U.style:"normal";sg.size=A,sg.divisions=i,sg.face=M,sg.weight=d,sg.style=C,sg.spacing=F;for(var h=sg.drawText($),L=h.paths,p=[],s=0,v=L.length;v>s;s++)Array.prototype.push.apply(p,L[s].toShapes());return p},function(D){var s=1e-10,x=function(c,b){var q=c.length;if(3>q)return null;var w,e,S,T=[],D=[],Q=[];if(M(c)>0)for(e=0;q>e;e++)D[e]=e;else for(e=0;q>e;e++)D[e]=q-1-e;var x=q,K=2*x;for(e=x-1;x>2;){if(K--<=0)return b?Q:T;if(w=e,w>=x&&(w=0),e=w+1,e>=x&&(e=0),S=e+1,S>=x&&(S=0),d(c,w,e,S,x,D)){var p,F,P,U,y;for(p=D[w],F=D[e],P=D[S],T.push([c[p],c[F],c[P]]),Q.push([D[w],D[e],D[S]]),U=e,y=e+1;x>y;U++,y++)D[U]=D[y];x--,K=2*x}}return b?Q:T},M=function(X){for(var C=X.length,t=0,l=C-1,O=0;C>O;l=O++)t+=X[l].x*X[O].y-X[O].x*X[l].y;return.5*t},d=function(e,j,N,J,d,v){var o,V,D,$,M,G,X,r,i;if(V=e[v[j]].x,D=e[v[j]].y,$=e[v[N]].x,M=e[v[N]].y,G=e[v[J]].x,X=e[v[J]].y,s>($-V)*(X-D)-(M-D)*(G-V))return!1;var A,c,T,p,K,Q,y,O,U,Y,Z,k,n,L,z;for(A=G-$,c=X-M,T=V-G,p=D-X,K=$-V,Q=M-D,o=0;d>o;o++)if(r=e[v[o]].x,i=e[v[o]].y,!(r===V&&i===D||r===$&&i===M||r===G&&i===X)&&(y=r-V,O=i-D,U=r-$,Y=i-M,Z=r-G,k=i-X,z=A*Y-c*U,n=K*O-Q*y,L=T*k-p*Z,z>=-s&&L>=-s&&n>=-s))return!1;return!0};return D.Triangulate=x,D.Triangulate.area=M,D}(sg),M._typeface_js={faces:sg.faces,loadFace:sg.loadFace};var pd=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},Tc=pd.prototype={constructor:pd,computeFaceNormals:function(){for(var O=new Fh,k=new Fh,F=0,x=this.faces.length;x>F;F++){var j=this.faces[F],J=this.vertices[j.a],Y=this.vertices[j.b],f=this.vertices[j.c];O.subVectors(f,Y),k.subVectors(J,Y),O.cross(k),O.normalize(),j.normal.copy(O)}},computeVertexNormals:function(e){var q,W,o,p,f,y;for(y=new Array(this.vertices.length),q=0,W=this.vertices.length;W>q;q++)y[q]=new Fh;if(e){var $,G,g,U=new Fh,w=new Fh;for(o=0,p=this.faces.length;p>o;o++)f=this.faces[o],$=this.vertices[f.a],G=this.vertices[f.b],g=this.vertices[f.c],U.subVectors(g,G),w.subVectors($,G),U.cross(w),y[f.a].add(U),y[f.b].add(U),y[f.c].add(U)}else for(o=0,p=this.faces.length;p>o;o++)f=this.faces[o],y[f.a].add(f.normal),y[f.b].add(f.normal),y[f.c].add(f.normal);for(q=0,W=this.vertices.length;W>q;q++)y[q].normalize();for(o=0,p=this.faces.length;p>o;o++)f=this.faces[o],f.vertexNormals[0]=y[f.a].clone(),f.vertexNormals[1]=y[f.b].clone(),f.vertexNormals[2]=y[f.c].clone()},mergeVertices:function(){var c,V,B,m,o,z,F,I,U={},$=[],T=[],Q=4,M=L(10,Q);for(B=0,m=this.vertices.length;m>B;B++)c=this.vertices[B],V=w(c.x*M)+"_"+w(c.y*M)+"_"+w(c.z*M),U[V]===f?(U[V]=B,$.push(this.vertices[B]),T[B]=$.length-1):T[B]=T[U[V]];var D=[];for(B=0,m=this.faces.length;m>B;B++){o=this.faces[B],o.a=T[o.a],o.b=T[o.b],o.c=T[o.c],z=[o.a,o.b,o.c];for(var t=0;3>t;t++)if(z[t]==z[(t+1)%3]){D.push(B);break}}for(B=D.length-1;B>=0;B--){var E=D[B];for(this.faces.splice(E,1),F=0,I=this.faceVertexUvs.length;I>F;F++)this.faceVertexUvs[F].splice(E,1)}var s=this.vertices.length-$.length;return this.vertices=$,s}},Bh=function(y,A,H,l,s,I,k){this.aX=y,this.aY=A,this.xRadius=H,this.yRadius=l,this.aStartAngle=s,this.aEndAngle=I,this.aClockwise=k};Bh.prototype=rd(Kg),Bh.prototype.getPoint=function(S){var I,R=this.aEndAngle-this.aStartAngle;0>R&&(R+=e),R>e&&(R-=e),I=this.aClockwise===!0?this.aEndAngle+(1-S)*(e-R):this.aStartAngle+S*R;var T=this.aX+this.xRadius*p(I),N=this.aY+this.yRadius*x(I);return new tg(T,N)};var Qi=function(T,M){this.v1=T,this.v2=M},mi=Qi.prototype=rd(Kg);mi.getPoint=function(O){var S=this.v2.clone().sub(this.v1);return S.multiplyScalar(O).add(this.v1),S},mi.getPointAt=function(B){return this.getPoint(B)},mi.getTangent=function(){var y=this.v2.clone().sub(this.v1);return y.normalize()};var Pf=function(C,K,f){this.v0=C,this.v1=K,this.v2=f};Pf.prototype=rd(Kg),Pf.prototype.getPoint=function(W){var j,w;return j=Dj.b2(W,this.v0.x,this.v1.x,this.v2.x),w=Dj.b2(W,this.v0.y,this.v1.y,this.v2.y),new tg(j,w)};var Td=function($,j,d,b){this.v0=$,this.v1=j,this.v2=d,this.v3=b};Td.prototype=rd(Kg),Td.prototype.getPoint=function(O){var c,P;return c=Dj.b3(O,this.v0.x,this.v1.x,this.v2.x,this.v3.x),P=Dj.b3(O,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new tg(c,P)},Fm.create(function(W,b){this.v1=W,this.v2=b},function(B){var D=new Fh;return D.subVectors(this.v2,this.v1),D.multiplyScalar(B),D.add(this.v1),D});var Ki=Fm.create(function(d,n,I){this.v0=d,this.v1=n,this.v2=I},function(A){var o,V,X;return o=Dj.b2(A,this.v0.x,this.v1.x,this.v2.x),V=Dj.b2(A,this.v0.y,this.v1.y,this.v2.y),X=Dj.b2(A,this.v0.z,this.v1.z,this.v2.z),new Fh(o,V,X)}),Gm=Fm.create(function(M,$,f,v){this.v0=M,this.v1=$,this.v2=f,this.v3=v},function(W){var v,Q,N;return v=Dj.b3(W,this.v0.x,this.v1.x,this.v2.x,this.v3.x),Q=Dj.b3(W,this.v0.y,this.v1.y,this.v2.y,this.v3.y),N=Dj.b3(W,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new Fh(v,Q,N)}),Sc=function(B,P,u,v,C,L,F,l){pd.call(this),v=v!==f?v:.5,C=C!==f?C:.5,l=l!==f?l:1,B=B||8,L=L||0,F=F||e;var w,G,m=1,d=l/2,Q=[],E=[],n=this.vertices,X=this.faces,J=this.faceVertexUvs;for(G=0;m>=G;G++){var M=[],z=[],U=G/m,I=U*(C-v)+v;for(w=0;B>=w;w++){var c=w/B,j=new Fh,o=-(c*F+L);j.z=I*x(o),j.y=-U*l+d,j.x=I*p(o),n.push(j),M.push(n.length-1),z.push(new tg(c,U))}Q.push(M),E.push(z)}var k,Z,R=(C-v)/l;for(w=0;B>w;w++)for(0!==v?(k=n[Q[0][w]].clone(),Z=n[Q[0][w+1]].clone()):(k=n[Q[1][w]].clone(),Z=n[Q[1][w+1]].clone()),k.setY(r(k.x*k.x+k.z*k.z)*R).normalize(),Z.setY(r(Z.x*Z.x+Z.z*Z.z)*R).normalize(),G=0;m>G;G++){var T=Q[G][w],V=Q[G+1][w],$=Q[G+1][w+1],a=Q[G][w+1],Y=k.clone(),W=k.clone(),H=Z.clone(),K=Z.clone(),q=E[G][w].clone(),A=E[G+1][w].clone(),y=E[G+1][w+1].clone(),D=E[G][w+1].clone();X.push(new tc(T,V,a,[Y,W,K])),J[0].push([q,A,D]),X.push(new tc(V,$,a,[W.clone(),H,K.clone()])),J[0].push([A.clone(),y,D.clone()])}if(P&&v>0)for(this.vertices.push(new Fh(0,d,0)),w=0;B>w;w++){var T=Q[0][w],V=Q[0][w+1],$=this.vertices.length-1,Y=new Fh(0,1,0),W=new Fh(0,1,0),H=new Fh(0,1,0),q=E[0][w].clone(),A=E[0][w+1].clone(),y=new tg(A.x,0);X.push(new tc(T,V,$,[Y,W,H],null,1));var O=w/B*e,g=p(O),_=x(O),t=(w+1)/B*e,N=p(t),b=x(t);J[0].push([new tg(.5+.5*g,.5+.5*_),new tg(.5+.5*N,.5+.5*b),new tg(.5,.5)])}if(u&&C>0)for(this.vertices.push(new Fh(0,-d,0)),w=0;B>w;w++){var T=Q[G][w+1],V=Q[G][w],$=n.length-1,Y=new Fh(0,-1,0),W=new Fh(0,-1,0),H=new Fh(0,-1,0),q=E[G][w+1].clone(),A=E[G][w].clone();X.push(new tc(T,V,$,[Y,W,H],null,2));var O=w/B*e,g=p(O),_=x(O),t=(w+1)/B*e,N=p(t),b=x(t);J[0].push([new tg(.5+.5*N,.5-.5*b),new tg(.5+.5*g,.5-.5*_),new tg(.5,.5)])}};Sc.prototype=rd(Tc);var Kh=function(R,H,X,v,d,$,w){pd.call(this),w=w||.5,R=R||16,H=H||16,X=(X!==f?X:0)-y,v=v!==f?v:e,d=d!==f?d:0,$=$!==f?$:y;var M,a,n=[],z=[],o=this.vertices,O=this.faces,A=this.faceVertexUvs;for(a=0;H>=a;a++){var N=[],q=[];for(M=0;R>=M;M++){var Z=M/R,t=a/H,G=new Fh;G.x=-w*p(X+Z*v)*x(d+t*$),G.y=w*p(d+t*$),G.z=w*x(X+Z*v)*x(d+t*$),o.push(G),N.push(o.length-1),q.push(new tg(Z,t))}n.push(N),z.push(q)}for(a=0;H>a;a++)for(M=0;R>M;M++){var C=n[a][M+1],s=n[a][M],K=n[a+1][M],L=n[a+1][M+1],_=o[C].clone().normalize(),T=o[s].clone().normalize(),V=o[K].clone().normalize(),c=o[L].clone().normalize(),g=z[a][M+1].clone(),E=z[a][M].clone(),B=z[a+1][M].clone(),h=z[a+1][M+1].clone();k(o[C].y)===w?(g.x=(g.x+E.x)/2,O.push(new tc(C,K,L,[_,V,c])),A[0].push([g,B,h])):k(o[K].y)===w?(B.x=(B.x+h.x)/2,O.push(new tc(C,s,K,[_,T,V])),A[0].push([g,E,B])):(O.push(new tc(C,s,L,[_,T,c])),A[0].push([g,E,h]),O.push(new tc(s,K,L,[T.clone(),V,c.clone()])),A[0].push([E.clone(),B,h.clone()]))}};Kh.prototype=rd(Tc);var qg=function(X,s,Z,o,R,z){pd.call(this),X=X||.33,s=s||.17,o=o||8,Z=Z||6,R=R||0,z=z||e;for(var u=new Fh,L=[],P=[],k=0;o>=k;k++)for(var w=k/o*e+y,b=0;Z>=b;b++){var D=b/Z*z+R;u.x=X*p(D),u.z=-X*x(D);var N=new Fh,Y=X+s*p(w);N.x=Y*p(D),N.z=-Y*x(D),N.y=s*x(w),this.vertices.push(N),L.push(new tg(b/Z,1-k/o)),P.push(N.clone().sub(u).normalize())}for(var k=1;o>=k;k++)for(var b=1;Z>=b;b++){var G=(Z+1)*k+b-1,d=(Z+1)*(k-1)+b-1,O=(Z+1)*(k-1)+b,t=(Z+1)*k+b,V=new tc(G,d,t,[P[G].clone(),P[d].clone(),P[t].clone()]);this.faces.push(V),this.faceVertexUvs[0].push([L[G].clone(),L[d].clone(),L[t].clone()]),V=new tc(d,O,t,[P[d].clone(),P[O].clone(),P[t].clone()]),this.faces.push(V),this.faceVertexUvs[0].push([L[d].clone(),L[O].clone(),L[t].clone()])}this.computeFaceNormals()};qg.prototype=rd(Tc);var dm=function(J,x,b){return J?(pd.call(this),J=J instanceof Array?J:[J],this.addShapeList(J,x),x.convertYZ!==!1&&Rb(this,b),this.computeFaceNormals(),void 0):(J=[],void 0)},Ub=dm.prototype=rd(pd.prototype);Ub.addShapeList=function(z,P){for(var E=z.length,B=0;E>B;B++){var Y=z[B];this.addShape(Y,P)}},Ub.addShape=function(a,_){function k(){if(_.bottom)for(var W=0;o>W;W++)D=K[W],m(D[2],D[1],D[0],!0);if(_.top)for(W=0;o>W;W++)D=K[W],m(D[0]+A*i,D[1]+A*i,D[2]+A*i,!1)}function g(){var i=0;for(w(p,i),i+=p.length,S=0,U=c.length;U>S;S++)O=c[S],w(O,i),i+=O.length}function w(G,c){for(var X,M,P=G.length;--P>=0;){X=P,M=P-1,0>M&&(M=G.length-1);var d=0,y=i;for(d=0;y>d;d++){var h=A*d,l=A*(d+1),a=c+X+h,n=c+M+h,g=c+M+l,W=c+X+l;I(a,n,g,W,G,d,y,X,M)}}}function h(j,B,y){n.vertices.push(new Fh(j,B,y))}function m(g,s,O,Y){g+=H,s+=H,O+=H,n.faces.push(new tc(g,s,O,null,null,Y?2:1));var U=Y?L.generateBottomUV(n,a,_,g,s,O):L.generateTopUV(n,a,_,g,s,O);n.faceVertexUvs[0].push(U)}function I(G,J,Q,o,l,t,F,r,X){G+=H,J+=H,Q+=H,o+=H,n.faces.push(new tc(G,J,o)),n.faces.push(new tc(J,Q,o));var M=L.generateSideWallUV(n,a,l,_,G,J,Q,o,t,F,r,X);n.faceVertexUvs[0].push([M[0],M[1],M[3]]),n.faceVertexUvs[0].push([M[1],M[2],M[3]])}var t,T,$,V,Y,N=_.amount,e=_.curveSegments||Th,i=_.steps||1,u=_.extrudePath,j=!1,L=new dn(_.repeatUVLength);u&&(t=u.getSpacedPoints(i),j=!0,T=_.frames!==f?_.frames:new Ui.FrenetFrames(u,i,!1),$=new Fh,V=new Fh,Y=new Fh);var O,S,U,n=this,H=this.vertices.length,J=a.extractPoints(e),G=J.shape,c=J.holes,M=!Dj.isClockWise(G);if(M){for(G=G.reverse(),S=0,U=c.length;U>S;S++)O=c[S],Dj.isClockWise(O)&&(c[S]=O.reverse());M=!1}var K=Dj.triangulateShape(G,c),p=G;for(S=0,U=c.length;U>S;S++)O=c[S],G=G.concat(O);for(var E,D,A=G.length,o=K.length,q=0;A>q;q++)E=G[q],j?(V.copy(T.normals[0]).multiplyScalar(E.x),$.copy(T.binormals[0]).multiplyScalar(E.y),Y.copy(t[0]).add(V).add($),h(Y.x,Y.y,Y.z)):h(E.x,E.y,0);var B;for(B=1;i>=B;B++)for(q=0;A>q;q++)E=G[q],j?(V.copy(T.normals[B]).multiplyScalar(E.x),$.copy(T.binormals[B]).multiplyScalar(E.y),Y.copy(t[B]).add(V).add($),h(Y.x,Y.y,Y.z)):h(E.x,E.y,N/i*B);k(),g()};var Ui=function(b,m,i,U,K){function Y(B,d,N){return L.vertices.push(new Fh(B,d,N))-1}pd.call(this),m=m||64,i=i||1,U=U||8,K=K||!1;var X,Z,y,H,r,T,h,P,N,f,G,z,S,J,l,B,o,k,d,E,s=[],L=this,w=m+1,c=new Fh,_=new Ui.FrenetFrames(b,m,K),R=_.tangents,j=_.normals,g=_.binormals;for(this.tangents=R,this.normals=j,this.binormals=g,N=0;w>N;N++)for(s[N]=[],H=N/(w-1),P=b.getPointAt(H),X=R[N],Z=j[N],y=g[N],f=0;U>f;f++)r=f/U*e,T=-i*p(r),h=i*x(r),c.copy(P),c.x+=T*Z.x+h*y.x,c.y+=T*Z.y+h*y.y,c.z+=T*Z.z+h*y.z,s[N][f]=Y(c.x,c.y,c.z);for(N=0;m>N;N++)for(f=0;U>f;f++)G=K?(N+1)%m:N+1,z=(f+1)%U,S=s[N][f],J=s[G][f],l=s[G][z],B=s[N][z],o=new tg(N/m,f/U),k=new tg((N+1)/m,f/U),d=new tg((N+1)/m,(f+1)/U),E=new tg(N/m,(f+1)/U),this.faces.push(new tc(S,J,B)),this.faceVertexUvs[0].push([o,k,E]),this.faces.push(new tc(J,l,B)),this.faceVertexUvs[0].push([k.clone(),d,E.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};Ui.prototype=rd(Tc),Ui.FrenetFrames=function(v,$,u){function i(){r[0]=new Fh,t[0]=new Fh,C=Number.MAX_VALUE,A=k(w[0].x),j=k(w[0].y),z=k(w[0].z),C>=A&&(C=A,L.set(1,0,0)),C>=j&&(C=j,L.set(0,1,0)),C>=z&&L.set(0,0,1),V.crossVectors(w[0],L).normalize(),r[0].crossVectors(w[0],V),t[0].crossVectors(w[0],r[0])}var f,C,A,j,z,x,P,L=new Fh,w=[],r=[],t=[],V=new Fh,m=new me,B=$+1,Z=1e-4;for(this.tangents=w,this.normals=r,this.binormals=t,x=0;B>x;x++)P=x/(B-1),w[x]=v.getTangentAt(P),w[x].normalize();for(i(),x=1;B>x;x++)r[x]=r[x-1].clone(),t[x]=t[x-1].clone(),V.crossVectors(w[x-1],w[x]),V.length()>Z&&(V.normalize(),f=T(ml(w[x-1].dot(w[x]),-1,1)),r[x].applyMatrix4(m.makeRotationAxis(V,f))),t[x].crossVectors(w[x],r[x]);if(u)for(f=T(ml(r[0].dot(r[B-1]),-1,1)),f/=B-1,w[0].dot(V.crossVectors(r[0],r[B-1]))>0&&(f=-f),x=1;B>x;x++)r[x].applyMatrix4(m.makeRotationAxis(w[x],f*x)),t[x].crossVectors(w[x],r[x])};var us=function(Y,T,Q,V){pd.call(this),T=T||18,Q=Q||0,V=V==u?e:V;for(var Z=1/(Y.length-1),N=1/T,P=0,H=T;H>=P;P++)for(var k=Q+P*N*V,w=p(k),q=x(k),r=0,F=Y.length;F>r;r++){var D=Y[r],M=new Fh;M.x=w*D.x-q*D.y,M.y=q*D.x+w*D.y,M.z=D.z,this.vertices.push(M)}for(var X=Y.length,P=0,H=T;H>P;P++)for(var r=0,F=Y.length-1;F>r;r++){var d=r+X*P,B=d,$=d+X,w=d+1+X,J=d+1,E=P*N,l=r*Z,C=E+N,h=l+Z;this.faces.push(new tc(B,J,$)),this.faceVertexUvs[0].push([new tg(E,l),new tg(E,h),new tg(C,l)]),this.faces.push(new tc($,J,w)),this.faceVertexUvs[0].push([new tg(C,l),new tg(E,h),new tg(C,h)])}this.mergeVertices(),Rb(this),this.computeFaceNormals(),this.computeVertexNormals()};us.prototype=rd(Tc);var Tm=function(N,S){S=S||{};var Q=sg.generateShapes(N,S);S.amount=S.amount!==f?S.amount:.5,S.convertYZ=!1,S.fill!==!1&&(S.bottom=!0,S.top=!0),dm.call(this,Q,S)};Tm.prototype=rd(Ub);var Kd=X.Node=function(){ef(Kd,this)},Uc={X:Fb,Y:Uo,Z:eq},nd={X:0,Y:1,Z:2},Nm={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},Tb="xzy",Ug=function(v,y,j){if(y){var m=y[0],F=y[1],Y=y[2];"xzy"===j?(Uo(v,F),eq(v,Y),Fb(v,m)):"xyz"===j?(eq(v,Y),Uo(v,F),Fb(v,m)):"yxz"===j?(eq(v,Y),Fb(v,m),Uo(v,F)):"yzx"===j?(Fb(v,m),eq(v,Y),Uo(v,F)):"zxy"===j?(Uo(v,F),Fb(v,m),eq(v,Y)):"zyx"===j?(Fb(v,m),Uo(v,F),eq(v,Y)):(Uo(v,F),eq(v,Y),Fb(v,m))}};lp("Node",lc,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Tb,_64O:0,_rotationX:0,_53O:0,_host:u,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return Lr},_22Q:function(){return jc},getX:function(){return this.p().x},setX:function(J){this.p(J,this.p().y)},getY:function(){return this.p().y},setY:function(C){this.p(this.p().x,C)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(p){this.setAnchor(p,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function($){this.setAnchor(this.getAnchor().x,$)},getScaleX:function(){return this.getScale().x},setScaleX:function(C){this.setScale(C,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(o){this.setScale(this.getScale().x,o)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(D,p){Jo(D,Cm(u,u,this.r3(),this.getRotationMode())),this.translate3d(D[0]*p,D[1]*p,D[2]*p)},translateFront:function(j){this.translate3dBy([0,0,1],j)},translateBack:function(B){this.translate3dBy([0,0,-1],B)},translateLeft:function(V){this.translate3dBy([-1,0,0],V)},translateRight:function(Y){this.translate3dBy([1,0,0],Y)},translateTop:function(U){this.translate3dBy([0,1,0],U)},translateBottom:function(l){this.translate3dBy([0,-1,0],l)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(z,t,y){1===arguments.length&&(t=z[1],y=z[2],z=z[0]),this.p(z,y),this.setElevation(t)},translate3d:function(o,S,v){1===arguments.length&&(S=o[1],v=o[2],o=o[0]),this.translate(o,v),this.setElevation(this._54O+S)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(y,x,$){1===arguments.length&&(x=y[1],$=y[2],y=y[0]),this.setSize(y,$),this.setTall(x)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(Z,s,N){1===arguments.length&&(s=Z[1],N=Z[2],Z=Z[0]),this.setRotationX(Z),this.setRotation(-s),this.setRotationZ(N)},setRotationY:function(L){this.setRotation(-L)},getRotationY:function(){return-this._64O},lookAtDirection:function(E,A){A=A||gr;var X=this,z=Di(E);A===gr?(X.r3([-C(E[1]/z),-$(E[2],E[0])+N,0]),X.setRotationMode("xzy")):A===yq?(X.r3(0,-$(E[2],E[0]),C(E[1]/z)),X.setRotationMode("zyx")):A===nk?(X.r3(0,-$(E[2],E[0])+y,-C(E[1]/z)),X.setRotationMode("zyx")):A===hk?(X.r3([-C(E[1]/z)+N,-$(E[2],E[0])+N,0]),X.setRotationMode("xzy")):A===nh&&(X.r3([-C(E[1]/z)-N,-$(E[2],E[0])+N,0]),X.setRotationMode("xzy")),A===cl&&(X.r3([-C(E[1]/z)+y,-$(E[2],E[0])+N,y]),X.setRotationMode("zxy"))},lookAt:function(Z,Q){return this.lookAtDirection(Zq(Z,this.p3()),Q)},lookAtX:function(){var W=new rh,T=new rh,Y=new rh,C=new $h,f=new $h,K=new lb;return function(R,B){var h=Ge(this);C.fromArray(h),Y.copy(this.p3()),W.copy(R).sub(Y).normalize(),B===gr?T.set(0,0,1):B===cl?T.set(0,0,-1):B===nk?T.set(-1,0,0):B===yq?T.set(1,0,0):B===hk?T.set(0,1,0):B===nh&&T.set(0,-1,0),T.applyMatrix4(C).sub(Y).normalize();var F=Math.acos(W.dot(T));if(F){var n=W.clone().cross(T).normalize();K.set(this.r3(),this.getRotationMode(),!0),C.makeRotationFromEuler(K),f.makeRotationAxis(n,-F),K.setFromRotationMatrix(f.multiply(C)),this.r3([K.x,K.y,K.z])}}}(),getHost:function(){return this._host},setHost:function(J){var j=this;if(j!==J&&j._host!==J){var l=j._host;l&&l._removeAttach(j),j._host=J,j._host&&j._host._addAttach(j),j.fp("host",l,J),j.onHostChanged(l,J)}},getAttaches:function(){return this._69O},_addAttach:function(J){var Q=this;Q._69O||(Q._69O=new _e),Q._69O.add(J),Q.fp("attaches",u,J)},_removeAttach:function(F){var Z=this;Z._69O.remove(F),Z._69O.isEmpty()&&delete Z._69O,Z.fp("attaches",F,u)},getImage:function(){if(this._pendingCheckImageJSON){var R=U.getImage(this._image);R&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof wh&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(K){var A=this,g=A._image,Z=A.getWidth(),u=A.getHeight();A._image=K,A.fp("image",g,K)&&(null!=K&&(Il(K)||Bs(K)&&/\.json$/i.test(K))&&(this._pendingCheckImageJSON=!0),A.fp(ir,Z,A.getWidth()),A.fp(tj,u,A.getHeight()))},getElevation:function(){return this._54O},setElevation:function(j){var w=this;if(!w._50O){w._50O=1;var O=w._54O;w._54O=j,w.fp(mc,O,j),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(b){var N=this;if(!N._49O){N._49O=1;var P=N._64O;N._64O=b,N.fp(le,P,b),delete N._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(O){var S=this;if(!S._51O){S._51O=1;var v=S._rotationX;S._rotationX=O,S.fp("rotationX",v,O),delete S._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(i){var l=this;if(!l._52O){l._52O=1;var k=l._53O;l._53O=i,l.fp("rotationZ",k,i),delete l._52O}},getPosition:function(){return this._position},setPosition:function(a,R){var W=this;if(!W._50I){W._50I=1;var v;if(v=2===arguments.length?{x:a,y:R}:a,v.x!==W._position.x||v.y!==W._position.y){var G=W._position;W._position=v,W.fp(Xl,G,v)}delete W._50I}},translate:function(j,R){var L=this._position;this.p(L.x+j,L.y+R)},getWidth:function(){var s=this;if(s._width>=0)return s._width;var N=s.getStyle("shape3d");if(N){var r=jr(N);if(r&&r.rawS3)return r.rawS3[0];if("billboard"===N||"plane"===N){var z=Hi(s.getStyle("shape3d.image"));return z?Bp(z,s):20}}var z=Hi(s._image);return z?Bp(z,s):20},setWidth:function(r){var P=this,K=P._width;P._width=r,P.fp(ir,K,r)},getHeight:function(){var i=this;if(i._height>=0)return i._height;var m=i.getStyle("shape3d");if(m){var N=jr(m);if(N&&N.rawS3)return N.rawS3[2];if("plane"===m){var u=Hi(i.getStyle("shape3d.image"));return u?Fd(u,i):20}if("billboard"===m)return 2}var u=Hi(i._image);return u?Fd(u,i):20},setHeight:function(m){var B=this,s=B._height;B._height=m,B.fp(tj,s,m)},getTall:function(){var A=this;if(A._tall>=0)return A._tall;var h=A.getStyle("shape3d");if(h){var j=jr(h);if(j&&j.rawS3)return j.rawS3[1];if("billboard"===h){var u=Hi(A.getStyle("shape3d.image"));return u?Fd(u,A):20}if("plane"===h)return 2}return 20},setTall:function($){var c=this,F=c._tall;c._tall=$,c.fp("tall",F,$)},setSize:function(V,f){var z=this;2===arguments.length?(z.setWidth(V),z.setHeight(f)):(z.setWidth(V.width),z.setHeight(V.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(Y,b,C,Q,H){var X=this,e=X.getAnchor(),U=X.getScale();arguments.length<=2&&(H=b,b=Y.y,C=Y.width,Q=Y.height,Y=Y.x);var f=H&&U.x<0?1-e.x:e.x,O=H&&U.y<0?1-e.y:e.y;X.p(Y+C*f,b+Q*O),H&&(C/=Math.abs(U.x),Q/=Math.abs(U.y)),X.setWidth(C),X.setHeight(Q)},getMatrix:function(){var I=this,J=I._64O,z=I._position,d=I.getScale();return new Cg(J,z.x,z.y,d.x,d.y)},getAnchorRect:function(){var y=this,Y=y.getWidth(),W=y.getHeight(),R=y.getAnchor();return{x:-Y*R.x,y:-W*R.y,width:Y,height:W}},toLocal:function(r){return this.getMatrix().tfi(r)},toGlobal:function(U){return this.getMatrix().tf(U)},getAttachPosition:function(){var P=new Cg;return function(B,Z,N,M){N=N||0,M=M||0;var L=this,T=L.getAnchor(),D=L._64O,h=L._position,r=L.getScale();return P.setFromTransform(D,h.x,h.y).tf({x:N+r.x*L.getWidth()*(B-T.x),y:M+r.y*L.getHeight()*(Z-T.y)})}}(),isInRect:function(D){D=this.toLocal(D);var Y=this.getWidth(),L=this.getHeight();return D.x+=Y*this.getAnchorX(),D.y+=L*this.getAnchorY(),!(D.x<0||D.y<0||D.x>Y||D.y>L)},getRect:function(){var T=this,C=T.getWidth(),l=T.getHeight(),t=T.getAnchor(),V={x:-C*t.x,y:-l*t.y,width:C,height:l},N=T.getMatrix();return V=ys([N.tf(V.x,V.y),N.tf(V.x+V.width,V.y),N.tf(V.x+V.width,V.y+V.height),N.tf(V.x,V.y+V.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var O=this,D=O.getAnchor(),T=O._anchorElevation;return{x:D.x,y:T,z:D.y}},setAnchorElevation:function(E){var o=this,V=o._anchorElevation;
return V!==E?(o._anchorElevation=E,o.fp("anchorElevation",V,E),!0):!1},setAnchor3d:function(A,E,x,Q){var w,e=this;"number"==typeof A?w={x:A,y:E,z:x}:(w=A.length?{x:A[0],y:A[1],z:A[2]}:A,Q=E);var m=e.getDataModel();m&&m.beginTransaction();var c=e.getAnchor3d(),O=e.setAnchor(w.x,w.z);if(e.setAnchorElevation(w.y)&&(O=!0),O&&Q&&!Gg){e.getAnchor3d();var Z=Ge(e),l=Jo([w.x-c.x,w.y-c.y,w.z-c.z],Z);e.p3(l)}return m&&m.endTransaction(),O},getAnchor:function(){var K=this;if(K.hasOwnProperty("_anchor"))return K._anchor;var G=Hi(K._image);return G&&G.anchorX!==f?{x:G.anchorX,y:G.anchorY}:K._anchor},setAnchor:function(y,o,N){var e,P=this;"number"==typeof y?e={x:y,y:o}:(e=y.length?{x:y[0],y:y[1]}:y,N=o);var S=P.getAnchor();if(S.x!==e.x||S.y!==e.y){var Z=P.getDataModel();if(Z&&Z.beginTransaction(),P._anchor=e,P.fp("anchor",S,e),N&&!Gg){var H=P.getPosition(),B=P.getSize(),r=P.getRotation(),Y=P.getScale(),G=-B.width*(S.x-e.x)*Y.x,c=-B.height*(S.y-e.y)*Y.y,l=x(r),J=p(r);P.setPosition(H.x+J*G-l*c,H.y+l*G+J*c)}return Z&&Z.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(i,y){var w,H=this;w=2===arguments.length?{x:i,y:y}:i;var Y=H.getScale();(Y.x!==w.x||Y.y!==w.y)&&(H._scale=w,H.fp("scale",Y,w))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var m=this,U=m._scaleTall,$=m.getScale();return[$.x,U,$.y]},getFinalScale3d:function(){var I=this,w=I.s3(),j=I._dynamicScale3d,x=I.getScale3d();return w&&(x[0]*=w[0],x[1]*=w[1],x[2]*=w[2]),j&&(x[0]*=j[0],x[1]*=j[1],x[2]*=j[2]),x},getFinalRotation3d:function(){var b=this;return b._dynamicRotation||b.r3()},setScaleTall:function(d){var o=this,T=o._scaleTall;T!==d&&(o._scaleTall=d,o.fp("scaleTall",T,d))},setScale3d:function(P,z,Y){var e,t=this;e="number"==typeof P?{x:P,y:z,z:Y}:P.length?{x:P[0],y:P[1],z:P[2]}:P,t.setScaleTall(e.y),t.setScale(e.x,e.z)},getCorners:function(s,f){s==u&&(s=0),f==u&&(f=s);var L=this,I=L.getAnchor(),J=L.getWidth(),z=L.getHeight(),d=-J*I.x-s,S=-z*I.y-f,T=J+2*s,A=z+2*f,q=L.getMatrix();return[q.tf(d,S),q.tf(d,S+A),q.tf(d+T,S+A),q.tf(d+T,S)]},getEditControlPoints:function(H,l,m){l==u&&(l=0),m==u&&(m=l);var O=this,Y=O.getAnchor(),A=O.getWidth(),M=O.getHeight(),i=-A*Y.x-l,G=-M*Y.y-m,r=A+2*l,s=M+2*m;if(H)return[{x:i,y:G},{x:i,y:0},{x:i,y:G+s},{x:0,y:G+s},{x:i+r,y:G+s},{x:i+r,y:0},{x:i+r,y:G},{x:0,y:G}];var $=O.getMatrix();return[$.tf(i,G),$.tf(i,0),$.tf(i,G+s),$.tf(0,G+s),$.tf(i+r,G+s),$.tf(i+r,0),$.tf(i+r,G),$.tf(0,G)]},rotateAt:function(O,g,y){var t=this,k=t._position,W=t._64O,S=new Cg(W,k.x,k.y).tf(O,g),M=r(O*O+g*g),U=$(k.y-S.y,k.x-S.x)+y;t.setRotation(W+y),t.p(S.x+M*p(U),S.y+M*x(U))},onParentChanged:function(){Kd.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var k={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(w){k[w]=!0}),function(t){var F=this;Kd.superClass.onPropertyChanged.call(F,t),k[t.property]&&!F._layoutUpdating&&F.updateLayoutParameters(null,t.property),F._69O&&F._69O.each(function(b){b.handleHostPropertyChange(t)}),F._49I&&F._49I.each(function(E){E.fp("agentChange",!0,!1)})}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(p){this.updateAttach(p)},onStyleChanged:function(p){Kd.superClass.onStyleChanged.apply(this,arguments),Lk[p]&&this.updateAttach()},updateAttach:function(G){var l=this;return Gg?(l.updateLayoutParameters(),void 0):(l._51I||(l._51I=1,l._71O(G),delete l._51I),void 0)},_71O:function(O){var c,G,q,j,x,p,e=this,T=e._host,t=O?O.property:u,A=O?O.oldValue:u,v=O?O.newValue:u;if(T instanceof X.Grid){if(t===mc)e.setElevation(e._54O+v-A);else if(!O||bl[t]){if(c=e.s("attach.row.index"),G=e.s("attach.column.index"),q=T.getCellRect(c,G),!q)return;j=e.s("attach.row.span"),x=e.s("attach.column.span"),(1!==j||1!==x)&&(q=Lj(q,T.getCellRect(c+j-1,G+x-1))),Sf(q,e,"attach.padding",1),e.setRect(q)}}else if(T instanceof vm&&(p=e.s("attach.index"))>=0&&(!O||ko[t])){var J=e.s("attach.thickness");J!=u&&e.setHeight(T.getThickness()*J);var o=e.s("attach.offset"),Y=T.getPoints(),l=Y.size();if(l>p){var F=Y.get(p),B=l===p+1?Y.get(0):Y.get(p+1),y=[B.x-F.x,B.y-F.y],i=Di(y);if(i){e.s("attach.offset.relative")&&(o*=i),e.s("attach.offset.opposite")&&(o=i-o);var L={x:F.x+y[0]/i*o,y:F.y+y[1]/i*o},h=e.s("attach.gap");h&&(e.s("attach.gap.relative")&&(h*=T.getThickness()),L=Dd(u,L,B,h)),e.p(L),e.setRotation($(y[1],y[0]))}}}else O&&(t===Xl?e.translate(v.x-A.x,v.y-A.y):t===mc?e.setElevation(e._54O+v-A):nr[t]?e._11Q(T,t,v-A):("anchor"===t||"width"===t||"height"===t||"scale"===t)&&e.layout(T))},_11Q:function(){var Q=new X.Math.Euler,P=X.Math.Euler.ReverseOrder,H=new X.Math.Vector2,s=new X.Math.Vector2;return function(B,a,x){var Y=this,N=B.p3(),e=B.r3(),j=Y.p3(),i=Y.r3();if(a===le&&(a="rotationY",x=-x),(a===le||"rotationY"===a)&&0===i[0]&&0===i[2]&&0===e[0]&&0===e[2]&&0===j[1]&&0===N[1])return Y.setRotation(-i[1]-x),H.set(j[0],j[2]).rotateAround(s.set(N[0],N[2]),-x),Y.p(H.x,H.y),void 0;var f=Nm[B.getRotationMode()],q=f[0],X=f[1],E=f[2],n=Uc[q],y=Uc[X],t=Uc[E],S=sh();a===le+q?(t(S,e[nd[E]]),y(S,e[nd[X]]),n(S,x),y(S,-e[nd[X]]),t(S,-e[nd[E]])):a===le+X?(t(S,e[nd[E]]),y(S,x),t(S,-e[nd[E]])):a===le+E&&t(S,x);var M=Zq(j,N);Jo(M,S),Y.p3(N[0]+M[0],N[1]+M[1],N[2]+M[2]);var L=Y.getRotationMode();Ug(S,Y.r3(),L),Q.setFromRotationMatrix(S,P(L)),Y.r3([Q.x,Q.y,Q.z])}}(),isHostOn:function(E){var y=this;if(y._host&&E&&E._69O)for(var J={},q=y._host;q&&q!==y&&!J[q._id];){if(q===E)return!0;J[q._id]=q,q=q._host}return!1},isLoopedHostOn:function(d){return this.isHostOn(d)&&d.isHostOn(this)},getScaledSize:function(){var l=this.getSize(),c=this.getScale();return l.width*=Math.abs(c.x),l.height*=Math.abs(c.y),l},layout:function(h){if(h=h||this.getHost()){var O=this,Y=O.s("layout.h")||"center",g=O.s("layout.v")||"center";if("center"!==Y||"center"!==g){var A=new X.Math.Vector2,R=h.getPosition(),q=h.getAnchor(),j=h.getScaledSize();O.getPosition();var v,$,r,V,F,E=1,c=1;switch(O._layoutUpdating=!0,Y){case"left":A.setX(O._layoutHValue-q.x*j.width);break;case"right":A.setX((1-q.x)*j.width-O._layoutHValue);break;case"leftright":v=j.width-O._layoutHValue[2],r=O.getRotation()-h.getRotation(),V=Math.abs(Math.sin(r)),F=Math.abs(Math.cos(r)),E+=F*v/O._layoutHValue[3],c+=V*v/O._layoutHValue[4],A.setX(O._layoutHValue[1]+(O._layoutHValue[5]-q.x)*j.width);break;case"center":A.setX((.5-q.x)*j.width-O._layoutHValue);break;case"scale":r=O.getRotation()-h.getRotation(),V=Math.abs(Math.sin(r)),F=Math.abs(Math.cos(r)),A.setX((.5-q.x)*j.width-O._layoutHValue[1]*j.width/O._layoutHValue[0]),$=j.width/O._layoutHValue[2]-1,E+=F*$,c+=V*$}switch(g){case"top":A.setY(O._layoutVValue-q.y*j.height);break;case"bottom":A.setY((1-q.y)*j.height-O._layoutVValue);break;case"topbottom":r||(r=O.getRotation()-h.getRotation(),V=Math.abs(Math.sin(r)),F=Math.abs(Math.cos(r))),v=j.height-O._layoutVValue[2],E+=V*v/O._layoutVValue[3],c+=F*v/O._layoutVValue[4],A.setY(O._layoutVValue[1]+(O._layoutVValue[5]-q.y)*j.height);break;case"center":A.setY((.5-q.y)*j.height-O._layoutVValue);break;case"scale":r||(r=O.getRotation()-h.getRotation(),V=Math.abs(Math.sin(r)),F=Math.abs(Math.cos(r))),A.setY((.5-q.y)*j.height-O._layoutVValue[1]*j.height/O._layoutVValue[0]),$=j.height/O._layoutVValue[2]-1,E+=V*$,c+=F*$}if("leftright"===Y||"scale"===Y||"topbottom"===g||"scale"===g){var _=this.getScale(),k=Math.abs(_.x),L=Math.abs(_.y);"leftright"===Y||"scale"===Y?O.setSize(O._layoutHValue[3]*E/k,O._layoutHValue[4]*c/L):O.setSize(O._layoutVValue[3]*E/k,O._layoutVValue[4]*c/L)}A.rotateAround(null,h.getRotation()),this.setPosition(A.x+R.x,A.y+R.y),O._layoutUpdating=f}}},updateLayoutParameters:function(w,Z){if(w=w||this.getHost()){var t=this,h=t.s("layout.h"),x=t.s("layout.v");if(h||x){var d,G,B,P,R,i,N=new X.Math.Vector2,S=w.getPosition(),n=w.getAnchor(),y=w.getScaledSize(),I=t.getPosition(),Q=t.getScaledSize();switch(N.set(I.x-S.x,I.y-S.y),N.rotateAround(null,-w.getRotation()),h){case"left":t._layoutHValue=N.x+n.x*y.width;break;case"right":t._layoutHValue=-N.x+(1-n.x)*y.width;break;case"center":t._layoutHValue=-N.x+(.5-n.x)*y.width;break;case"leftright":case"scale":"scale"===h?d=-N.x+(.5-n.x)*y.width:(G=t.getAnchor(),B=t.getRotation()-w.getRotation(),P=Math.cos(B),R=Math.sin(B),i=-Math.min(-G.x*P+G.y*R,-G.x*P-(1-G.y)*R,(1-G.x)*P+G.y*R,(1-G.x)*P-(1-G.y)*R),d=N.x-(i-n.x)*y.width),"position"===Z&&"object"==typeof t._layoutHValue?(t._layoutHValue[0]=y.width,t._layoutHValue[1]=d):t._layoutHValue=[y.width,d,y.width,Q.width,Q.height,i]}switch(x){case"top":t._layoutVValue=N.y+n.y*y.height;break;case"bottom":t._layoutVValue=-N.y+(1-n.y)*y.height;break;case"center":t._layoutVValue=-N.y+(.5-n.y)*y.height;break;case"topbottom":case"scale":"scale"===x?d=-N.y+(.5-n.y)*y.height:(B||(G=t.getAnchor(),B=t.getRotation()-w.getRotation(),P=Math.cos(B),R=Math.sin(B)),i=-Math.min(-G.x*R-G.y*P,-G.x*R+(1-G.y)*P,(1-G.x)*R-G.y*P,(1-G.x)*R+(1-G.y)*P),d=N.y-(i-n.y)*y.height),"position"===Z&&"object"==typeof t._layoutVValue?(t._layoutVValue[0]=y.height,t._layoutVValue[1]=d):t._layoutVValue=[y.height,d,y.height,Q.width,Q.height,i]}}}},getSerializableProperties:function(){var X=Kd.superClass.getSerializableProperties.call(this);return ae(X,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),X}});var Uq=X.Edge=function(B,Y){var X=this;ef(Uq,X),X.setSource(B),X.setTarget(Y)};lp("Edge",lc,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return gh},_22Q:function(){return Hq},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(d){if(d===this)return!1;if(xp(d))return!0;for(var I,s,M,A,x,D=[this],P=-1,l=0;l>P;)if(P++,I=D[P],s=I._44I)for(s=s.getArray(),A=0,x=s.length;x>A;A++)if(M=s[A],ej(M)&&!(D.indexOf(M)>=0)){if(M===d)return!1;D.push(M),l++}return!0},setSource:function(g){var J=this;if(J._source!==g&&J.canSetSourceTarget(g)){var X=J._source;J._source=g,X&&X._16I(J),g&&g._2I(J),J._7I(),J.fp("source",X,g)}},setTarget:function(j){var K=this;if(K._target!==j&&K.canSetSourceTarget(j)){var h=K._target;K._target=j,h&&h._18I(K),j&&j._4I(K),K._7I(),K.fp("target",h,j)}},isLooped:function(){var k=this;return k._source===k._target&&xp(k._source)&&xp(k._target)},onPropertyChanged:function(){var j=this;j._49I&&j._49I.each(function(v){v.fp("agentChange",!0,!1)})},_7I:function(){var v,z=this,$=jf(z);z._40I!==$&&(v=this._40I,v&&v._15I(z),z._40I=$,$&&$._1I(z),z.fp("sourceAgent",v,$),Rl(v,z._41I),Rl($,z._41I));var l=Qk(z);z._41I!==l&&(v=z._41I,v&&v._17I(z),z._41I=l,l&&l._3I(z),z.fp("targetAgent",v,l),Rl(v,z._40I),Rl(l,z._40I))},_22I:function(e){this._52I=e,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var j=this;return j._52I&&j._52I.get(0)!==j&&!j.getStyle(df)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var I=this,L=I._52I;return L&&!I.getStyle(df)&&L.size()>1&&I===L.get(0)},toggle:function(){var z=this._52I,H=!this.s(df);z&&z.size()>1&&(z.each(function(I){I.s(df,H)}),z.getSiblings().each(function(E){E!==z&&E.each(function(V){V.fp("edgeGroup",u,E)})}))},setStyle:function(d,B){(d===zq||"edge.segments"===d)&&(B=pc(B)),Uq.superClass.setStyle.call(this,d,B)},onStyleChanged:function(q){Uq.superClass.onStyleChanged.apply(this,arguments),Ud[q]&&Rl(this._41I,this._40I)},getSerializableProperties:function(){var $=Uq.superClass.getSerializableProperties.call(this);return ae($,{source:1,target:1}),$}});var zf=X.Group=function(){ef(zf,this)};lp("Group",Kd,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return rc},onChildAdded:function(){zf.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){zf.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var Y=this;if(!Y._54I&&!Gg){var D=Y.getChildrenRect();D&&(Y._53I=1,Y.p(Eg(Y.s("group.position"),D,Y.getSize())),delete Y._53I)}},getChildrenRect:function(){var d,U=this;return U.eachChild(function(G){xp(G)&&(d=Lj(d,U.getChildRect(G)))}),d},getChildRect:function(T){var x;return xp(T)&&T.s(dk)&&(yi(T)&&T.isExpanded()&&T.eachChild(function(O){x=Lj(x,T.getChildRect(O))}),!x&&T.getRect&&(x=T.getRect())),x},setPosition:function(A,g){var V=this;if(!V._54I){var Z;Z=2===arguments.length?{x:A,y:g}:A,Gg||V._53I||(V._54I=1,ze(V._children,Z.x-V._position.x,Z.y-V._position.y),delete V._54I),zf.superClass.setPosition.call(this,Z)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(B){var s=this;if(s._57O!==B){var G=s._57O;s._57O=B,s.fp("expanded",G,s._57O),s._fireInvalidateDeep(),s._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(t){yi(t)?t._fireInvalidateDeep():t.iv()})},_8I:function(){zf.superClass._8I.call(this),this.eachChild(function(H){xp(H)&&H._8I()})},onStyleChanged:function(G){zf.superClass.onStyleChanged.apply(this,arguments),"group.position"===G&&this._81I()},getSerializableProperties:function(){var R=zf.superClass.getSerializableProperties.call(this);return R.expanded=1,R}});var ls=X.Block=function(){ef(ls,this)};lp("Block",Kd,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Sd},onChildAdded:function(){ls.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){ls.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var P=this;if(!Gg&&!P._updatingToChildren&&P._syncSize&&!P._freezeSyncFromChildren){var f,M,A,O,b,L=[],a=P.getRotation();if(P.eachChild(function(q){xp(q)&&L.push.apply(L,q.getCorners())}),L.length){P._updatingFromChildren=1;var B=p(-a),s=x(-a),r=1/0,y=-1/0,q=1/0,H=-1/0;for(O=0,b=L.length;b>O;O++)A=L[O],f=A.x,M=A.y,A.x=B*f-s*M,A.y=s*f+B*M,r=I(r,A.x),y=l(y,A.x),q=I(q,A.y),H=l(H,A.y);var R=P.getScale();P.setSize(k((y-r)/R.x),k((H-q)/R.y));var C;R.x<0&&(C=r,r=y,y=C),R.y<0&&(C=q,q=H,H=C),B=p(a),s=x(a);var T=P.getAnchor();f=r+(y-r)*T.x,M=q+(H-q)*T.y,P.setPosition(B*f-s*M,s*f+B*M),delete P._updatingFromChildren}}},setPosition:function(o,B){var k=this;if(!k._updatingToChildren){var M;M=2===arguments.length?{x:o,y:B}:o,Gg||k._updatingFromChildren||(k._updatingToChildren=1,ze(k._children,M.x-k._position.x,M.y-k._position.y),delete k._updatingToChildren),ls.superClass.setPosition.call(this,M)}},setWidth:function(Q){return this.setSize(Q,this.getHeight())},setHeight:function(i){return this.setSize(this.getWidth(),i)},setSize:function(C,F){1>C&&(C=1),1>F&&(F=1);var q=this;if(!q._updatingToChildren){2!==arguments.length&&(F=C.height,C=C.width);var u=q.getWidth(),c=q.getHeight();if(C!==u&&ls.superClass.setWidth.call(q,C),F!==c&&ls.superClass.setHeight.call(q,F),!Gg&&!q._updatingFromChildren){q._updatingToChildren=1;var l=C/u,k=F/c;q._adjustChildScaleOrSize(l,k,"size"),delete q._updatingToChildren,q.updateFromChildren()}}},_adjustChildScaleOrSize:function(O,S,N){var Y=this;if(Y._syncSize){var L=Y.getPosition(),j=Y.getRotation();Y.getScale(),Y.eachChild(function(Q){if(xp(Q)){var g=Q.getPosition(),A=Q.getRotation(),n=Q.getWidth(),s=Q.getHeight(),H=Q.getScale(),D=H.x*n,G=H.y*s,e=new Cg(A,g.x,g.y,D,G);e.translate(-L.x,-L.y),e.rotate(-j),A=$(e.b*Math.sign(D),e.a*Math.sign(D)),e.scale(O,S);var C,J,q,K=p(A);if(Math.abs(K)<.001?(C=x(A),J=e.b/C,q=-e.c/C):(J=e.a/K,q=e.d/K),"scale"===N)Q.setScale(J/n,q/s);else if("size"===N){var l=J/H.x,o=q/H.y;Q.setScale(Zm(J)*Math.abs(H.x),Zm(q)*Math.abs(H.y)),Q instanceof X.Shape?(Q.setWidthForce(Math.max(Math.abs(l),1e-5)),Q.setHeightForce(Math.max(Math.abs(o),1e-5))):Q.setSize(Math.max(.01,Math.abs(l)),Math.max(.01,Math.abs(o)))}e.rotate(j),e.translate(L.x,L.y),Q.setPosition(e.tx,e.ty)}})}},_calcChangeFactor:function(M,S,c,Z){var o,O,N,J;return o=k(M),O=k(c),N=o>O?o/O:O/o,o=k(S),O=k(Z),J=o>O?o/O:O/o,l(N,J)},setAnchor:function(){var v=this;if(!v._updatingToChildren){var o=v.getAnchor();if(ls.superClass.setAnchor.apply(v,arguments),!Gg&&!v._updatingFromChildren&&v._syncSize){v._updatingToChildren=1;var f=v.getAnchor();v.getPosition();var G=v.getSize(),e=v.getScale(),r=v.getRotation(),X=-G.width*e.x*(o.x-f.x),$=-G.height*e.y*(o.y-f.y),O=x(r),S=p(r),s=S*X-O*$,H=O*X+S*$;v.eachChild(function(M){if(xp(M)){var N=M.getPosition();M.setPosition(N.x-s,N.y-H)}}),delete v._updatingToChildren}}},setRotation:function(M){var b=this;if(!b._updatingToChildren){var W=b.getRotation();if(ls.superClass.setRotation.apply(b,arguments),!Gg&&!b._updatingFromChildren){b._updatingToChildren=1;var Y=b.getPosition(),n=M-W;b.eachChild(function(w){if(xp(w)){var A=w.getMatrix();A.translate(-Y.x,-Y.y),A.rotate(n),A.translate(Y.x,Y.y);var K=Math.sign(w.getScale().x);w.setRotation($(A.b*K,A.a*K)),w.setPosition(A.tx,A.ty)}}),delete b._updatingToChildren}}},setScale:function(n,P){var C=this;if(!C._updatingToChildren){null==P&&(P=n.y,n=n.x);var T=C.getScale();if(k(n)<.01&&(n=.01*(Zm(n)||Zm(T.x))),k(P)<.01&&(P=.01*(Zm(P)||Zm(T.y))),ls.superClass.setScale.call(C,n,P),!Gg&&!C._updatingFromChildren){C._updatingToChildren=1;var z=n/T.x,J=P/T.y;C._adjustChildScaleOrSize(z,J,"size"),delete C._updatingToChildren,C.updateFromChildren()}}},getSerializableProperties:function(){var g=ls.superClass.getSerializableProperties.call(this);return g.clickThroughEnabled=1,g.syncSize=1,g}});var Gq=X.Grid=function(){ef(X.Grid,this)};lp("Grid",Kd,{IRotatable:!1,_icon:"grid_icon",_image:u,getUIClass:function(){return Le},setRotation:function(){},getCellRect:function(c,e){var x=this,X=x.s("grid.row.count"),E=x.s("grid.column.count");if(0>=X||0>=E||0>c||c>=X||0>e||e>=E)return u;var N,w,T,O=x.getRect(),H=x.s("grid.row.percents"),G=x.s("grid.column.percents");if(Sf(O,x,"grid.border",-1),H&&H._as&&(H=H._as),G&&G._as&&(G=G._as),H&&H.length===X){for(T=0,N=0;c>N;N++)T+=O.height*H[N];O.y+=T,O.height=O.height*H[c]}else O.height=O.height/X,O.y+=O.height*c;if(G&&G.length===E){for(w=0,N=0;e>N;N++)w+=O.width*G[N];O.x+=w,O.width=O.width*G[e]}else O.width=O.width/E,O.x+=O.width*e;return ce(O,-x.s("grid.gap")),O}});var lq=X.Text=function(){ef(lq,this),this.setSize(100,50),this.s("text","TEXT")};lp("Text",Kd,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Em},setWidth:function(S){S||(S=.001),lq.superClass.setWidth.call(this,S)},setHeight:function(d){d||(d=.001),lq.superClass.setHeight.call(this,d)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),bh("__text__",{width:{value:100,isSafeFunc:!0,func:function(D){return D._width}},height:{value:50,isSafeFunc:!0,func:function(U){return U._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var vm=X.Shape=function(){ef(vm,this),this._59O=new _e};vm.__de__=Co,lp("Shape",Kd,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return jq},_22Q:function(){return vl},getLength:function(d){return br(Lm(this._59O,this._58O,d,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var s=this._58O;return s?new _e(s._as.slice(0)):s},setSegments:function(Y){var i=this._58O;Y=Y?En(Y)?new _e(Y.slice(0)):new _e(Y._as.slice(0)):null,(i&&Y&&i._as.join(",")!==Y._as.join(",")||i!==Y)&&(this._58O=Y,this.fp("segments",i,Y))},getPoints:function(){return this._59O},toPoints:function(){var n=this._59O;return new _e(n._as.slice(0))},setPoints:function(y,u){var W=this,I=W._59O;y=y?En(y)?new _e(y.slice(0)):new _e(y._as.slice(0)):new _e;var L,n,c,t,U,s;u&&(L=W.getPosition(),s=new Cg(W.getRotation(),0,0,W.getScale().x,W.getScale().y)),(I&&y&&I._as.join(",")!==y._as.join(",")||I!==y)&&(W._59O=y,W.fs(),W.fp("points",I,y)),u&&(n=W.getPosition(),c=n.x-L.x,t=n.y-L.y,U=s.tf(c,t),W.setPosition(n.x-c+U.x,n.y-t+U.y))},addPoint:function(p,U,r){var F=this.toPoints();F.add(p,U),this.setPoints(F,r)},setPoint:function(F,t,b){var G=this.toPoints();G.set(F,t),this.setPoints(G,b)},removePointAt:function(l){var Q=this.toPoints();Q.removeAt(l),this.setPoints(Q)},setWidthForce:function(z){var L=this;if(!L._55I&&!Gg&&L.getWidth()){L._55I=1;var F=L._position.x,d=z/L.getWidth(),v=L.toPoints(),H=new _e;v.each(function(Z){H.add({x:(Z.x-F)*d+F,y:Z.y,e:Z.e})}),L.setPoints(H),mn(L,[d,0,0,1,F*(1-d),0]),L.fs(),delete L._55I}vm.superClass.setWidth.call(L,z)},setWidth:function(A){return this.setWidthForce(1>A?1:A)},setHeightForce:function(J){var F=this;if(!F._55I&&!Gg&&F.getHeight()){F._55I=1;var U=F._position.y,X=J/F.getHeight(),j=F.toPoints(),K=new _e;j.each(function(J){K.add({x:J.x,y:(J.y-U)*X+U,e:J.e})}),F.setPoints(K),mn(F,[1,0,0,X,0,U*(1-X)]),F.fs(),delete F._55I}vm.superClass.setHeight.call(F,J)},setHeight:function(E){return this.setHeightForce(1>E?1:E)},setAnchorElevation:function(M){var V=this;V._55I=!0;var K=V._updatingAnchor3d,J=!Gg&&!K;if(J){var q,L=M,S=V.getAnchorElevation(),x=V.getTall();q=x*(S-L),V.shiftPointsElevation(q)}var X=vm.superClass.setAnchorElevation.apply(V,arguments);return K||delete V._55I,X},getShapeElevation:function(){var P=this,v=P._54O;return v-(P.getTall()||0)*(P._anchorElevation-.5)},setAnchor3d:function(J,r,V,W){var Z,S=this;"number"==typeof J?Z={x:J,y:r,z:V}:(Z=J.length?{x:J[0],y:J[1],z:J[2]}:J,W=r),S._55I=!0,S._updatingAnchor3d=!0;var Y=S.getDataModel();if(Y&&Y.beginTransaction(),!Gg){var g=S.getAnchor3d(),u=S.getSize(),Q=S.getTall(),w=u.width*(g.x-Z.x),A=u.height*(g.z-Z.z),R=Q*(g.y-Z.y);W||S.shiftPoints(w,A,R);var z=S.p3()}var T=vm.superClass.setAnchor3d.apply(S,arguments);if(!Gg&&W){var N=S.p3();S.shiftPoints(N[0]-z[0]+w,N[2]-z[2]+A,N[1]-z[1]+R)}return Y&&Y.endTransaction(),delete S._updatingAnchor3d,delete S._55I,T},setAnchor:function(r,L,S){var R=this;R._55I=!0;var U=R._updatingAnchor3d,z=!Gg&&!U;if(z){var c,g,N;"number"==typeof r?N={x:r,y:L}:(N=r.length?{x:r[0],y:r[1]}:r,S=L);var M=R.getAnchor(),s=R.getSize();c=s.width*(M.x-N.x),g=s.height*(M.y-N.y),S||R.shiftPoints(c,g);var u=R.getPosition()}var h=vm.superClass.setAnchor.apply(R,arguments);if(z){var C=R.getPosition();S&&R.shiftPoints(C.x-u.x+c,C.y-u.y+g)}return U||delete R._55I,h},shiftPoints:function(j,K,S){var $=this,q=$.getElevation()||0,l=$.toPoints(),O=new _e;l.each(function(F){var M=F.e;S&&(M=(M==u?q:M)+S),O.add({x:F.x+j,y:F.y+K,e:M})}),$.setPoints(O),$.fs()},shiftPointsElevation:function(y){return this.shiftPoints(0,0,y)},setPosition:function(Y,q){var j,c=this;if(!c._28Q){if(c._28Q=1,!c._55I&&!Gg){j=2===arguments.length?{x:Y,y:q}:Y;var Z=j.x-c._position.x,S=j.y-c._position.y;if(0===Z&&0===S)return delete c._28Q,void 0;c._55I=1,c.shiftPoints(Z,S),mn(c,[1,0,0,1,Z,S]),delete c._55I}vm.superClass.setPosition.apply(c,arguments),delete c._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var J=this;if(2!==J._59O.size())return!1;var C=J._58O;return C?2===C.size()&&1===C.get(0)&&2===C.get(1)?!0:!1:!0},fireShapeChange:function(){var w=this;if(!w._55I&&!Gg){var n=ys(w._59O);n&&(w._55I=1,w.setRect(n),delete w._55I)}w.fp(Kn,!1,!0)},getSerializableProperties:function(){var O=vm.superClass.getSerializableProperties.call(this);return O.segments=1,O.points=1,O.thickness=1,O.closePath=1,O}});var Pm=X.Polyline=function(){ef(Pm,this),this.s({"shape.background":null,"shape.border.width":2})};lp("Polyline",vm,{_icon:"polyline_icon",_22Q:function(){return Wo},getUIClass:function(){return Ye},setClosePath:function(){},setTall:function(c){var k=this;if(!k._55I&&!k._24Q&&!Gg&&k.getTall()){k._24Q=1;var D=k._54O,m=c/k.getTall();k._59O.each(function($){$.e=$.e==u?D:($.e-D)*m+D}),k.fs(),delete k._24Q}Pm.superClass.setTall.call(k,c)},setElevation:function(l){var t=this;if(!t._55I&&!t._24Q&&!Gg){t._24Q=1;var X=l-t._54O;t._59O.each(function(J){J.e==u?J.e=l:J.e+=X}),t.fs(),delete t._24Q}Pm.superClass.setElevation.apply(t,arguments)},fireShapeChange:function(){var r=this,c=r._59O;if(!r._55I&&!r._24Q&&!Gg){var A=c.size();if(A){var S=1,Y=c.get(0),B=r._54O;Y.e==u&&(Y.e=B);for(var i=Y.e,M=0;A>S;S++){Y=c.get(S),Y.e==u&&(Y.e=B);var b=I(i,Y.e),t=l(i+M,Y.e);i=b,M=t-b}r._24Q=1,r.setTall(M),r.setElevation(i+M*r._anchorElevation),delete r._24Q}}Pm.superClass.fireShapeChange.apply(r,arguments)}});var Mp=X.SubGraph=function(){ef(Mp,this)};lp("SubGraph",Kd,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){Mp.superClass._8I.call(this),this.eachChild(function(A){xp(A)&&A._8I()})}}),U.loadingRefGraph=0;var wh=X.RefGraph=function(){ef(wh,this)};lp("RefGraph",ls,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(E){var B=this._ref;this._ref=E,this.fp("ref",B,E),this.updateRef()},_21I:function(){wh.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var G=this;if(U.loadingRefGraph++,G.clearChildrenFromDataModel(),U.loadingRefGraph--,G._ref&&G._dataModel){G._xhrLoadHandler&&(G._xhrLoadHandler.cancel=!0);var t=Gg,Y=G._xhrLoadHandler=function(b){if(b&&G._dataModel){U.loadingRefGraph++;var K=G._pendingUpdateInfo={needToRestore:t};t&&(K.position=G.p(),K.width=G.getWidth(),K.height=G.getHeight(),K.rotation=G.getRotation(),K.anchor=G.getAnchor(),K.scale=G.getScale()),G.p(0,0),G.setAnchor(.5,.5),G.setRotation(0),G.setScale(1,1);var L=U.parse(b),e=G._dataModel.deserialize(L,G,{justDatas:!0});e.each(function(T){T._refGraph=G}),G.checkPendingUpdateInfo(),U.loadingRefGraph--,U.handleRefGraphLoaded(G,e,L)}};Y.xhrLoadCalled=!1,U.load(G._ref,function(k){Y.cancel||(Y.xhrLoadCalled?Y(k):up(function(){Y(k)}))}),Y.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var c=this,b=c._pendingUpdateInfo;if(!b)return c.onPendingUpdated&&(U.loadingRefGraph++,c.onPendingUpdated(),U.loadingRefGraph--),void 0;var f=!0;this.eachChild(function(R){(R._pendingCheckImageJSON||R._pendingUpdateInfo)&&(f=!1)}),f&&(U.loadingRefGraph++,c._pendingUpdateInfo=null,c.updateFromChildren(),b.needToRestore&&(c.setSize(b.width,b.height),c.setAnchor(b.anchor),c.setRotation(b.rotation),c.setScale(b.scale),c.p(b.position)),this.getParent()instanceof wh&&this.getParent().checkPendingUpdateInfo(),c.onPendingUpdated&&c.onPendingUpdated(),U.loadingRefGraph--)},getSerializableProperties:function(){var G=wh.superClass.getSerializableProperties.call(this);return G.ref=1,G}}),X.EdgeGroup=function(b,X){this._70O=b,this._siblings=X;for(var G,g,$=0,A=b.size(),c=W[df];A>$;$++)if(G=b.get($).getStyle(df,!1),G!=u){c=G;break}c==u&&(c=!0);var D=U.edgeGroupAgentFunc;for(D&&(g=D(b),g&&g!==b.get(0)&&(b.remove(g),b.add(g,0))),$=0;A>$;$++)b.get($).s(df,c)},lp("EdgeGroup",b,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(D){return this._70O.get(D)},indexOf:function(g){return this._70O.indexOf(g)},each:function(U,u){this._70O.each(U,u)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(v,x){this._siblings.each(function(n){n._70O.each(v,x)})}});var Je=function(u,i,R){var N=Uh[u]={type:u,action:i};if(R)for(var D in R)N[D]=R[D]};ae(U,{setConnectAction:Je,getConnectAction:function(r,X){if(!X){if(!r)return null;X=r.getCurrentConnectActionType()}return Uh[X]},doConnectAction:function(O,h,q,Q){Q=Q||O.getCurrentConnectActionType();var V=Uh[Q];if(!V)return!1;var G=V.action;return G?(h instanceof zd.Group?O.sm().getSelection().each(function(S){G.call(null,O,S,q)}):G.call(null,O,h,q),!0):!1},doDeleteConnectionAction:function(d,r,R){R=R||d.getCurrentConnectActionType();var g=Uh[R];if(!g||!g.delete)return!1;var N=g.delete.action;return N?(r instanceof zd.Group?d.sm().getSelection().each(function(A){N.call(null,d,A)}):N.call(null,d,r),!0):!1}});var Xb=X.JSONSerializer=function(w,$){this.dm=this._dataModel=w,this._hierarchical=U.forceHierarchicalSerialization?!0:$==u?w.isHierarchicalRendering():$};lp("JSONSerializer",b,{ms_ac:["hierarchical"],serialize:function(g){return U.stringify(this.toJSON(),g)},toJSON:function(){var a=this,T=a.dm,q=T.getRoots(),G=a.json={v:U.getVersion(),p:{},a:{},d:[]},b=T.getSerializableAttrs();T.getInit()&&(G.init=T.getInit()),T.getName()&&(G.p.name=T.getName()),T.getBackground()&&(G.p.background=T.getBackground()),T.getLayers()&&(G.p.layers=T.getLayers()),T.getEnvmap()&&(G.p.envmap=T.getEnvmap()),G.p.autoAdjustIndex=T.isAutoAdjustIndex(),G.p.hierarchicalRendering=T.isHierarchicalRendering();for(var X in b){var C=T.a(X);C!==f&&a[Sj](X,C,G.a)}return Dh(G.a)&&delete G.a,a._hierarchical?q.each(a.serializeData,this):T.each(function(_){a.serializeData(_)}),T.fireSerializeEvent({type:"serialize",json:G}),T.getPostProcessingData()&&(G.p.postProcessingData=T.getPostProcessingData()),G},isSerializable:function(){return!0},getProperties:function(k){return k.getSerializableProperties()},getStyles:function(x){return x.getSerializableStyles()},getAttrs:function(w){return w.getSerializableAttrs()},serializeData:function(t){var W=this;if(W.isSerializable(t)&&!t._refGraph){var M,n,I,h,s=Ff(t.getClassName())||t.getClass(),z=new s,P={c:t.getClassName(),i:t.getId(),p:{},s:{},a:{}};W.json.d.push(P),M=W.getProperties(t);for(n in M)if(/^_/.test(n)){if(I=t[n],("_width"===n||"_height"===n)&&I===f){var j;((t.s("layout.h")||t.s("layout.v"))&&t.getHost()||t instanceof X.Node&&(j=t.getParent())&&j instanceof X.Block||t.s("fullscreen"))&&(I=t[n]="_width"===n?t.getWidth():t.getHeight())}I!==z[n]&&W[Sj](n.substr(1),I,P.p)}else h=Xf(n),t[h]&&(I=t[h](),I!==z[h]()&&W[Sj](n,I,P.p));M=W.getStyles(t);for(n in M)I=t.s(n),I!==z.s(n)&&W[Sj](n,I,P.s);M=W.getAttrs(t);for(n in M)I=t.a(n),I!==z.a(n)&&W[Sj](n,I,P.a);Dh(P.p)&&delete P.p,Dh(P.s)&&delete P.s,Dh(P.a)&&delete P.a}W._hierarchical&&t.getChildren().each(W.serializeData,W)},serializeValue:function(U,g,$){hq(g)?g={__a:g._as}:g instanceof lc&&(g={__i:g.getId()}),$[U]=g},deserialize:function(a,i,Q){var j=this;return Bs(a)&&/.json$/.test(a)?(U.xhrLoad(a,function(v){j.deserializeImpl(v,i,Q)}),void 0):j.deserializeImpl(a,i,Q)},deserializeImpl:function(l,$,f){var q=this,Q=q.dm;f=Wr(f)?{setId:f}:Ze(f)?{finishFunc:f}:f||{},l=q.json=Bs(l)?U.parse(l):l,l.a&&l.a.onPreDeserialize&&!f.disableOnPreDeserialize&&l.a.onPreDeserialize(l,Q,f.view),Q.beginTransaction(),Gg++,q._82I={};var m=new _e,T=new _e,v=0,D=l.d.length;if(f.justDatas||(Ze(l.init)&&l.init(Q),Q.setInit(l.init)),!f.justDatas){for(var C in l.a)Q.a(C,q[qm](l.a[C]));for(var x in l.p)Q[ii(x)](l.p[x])}for(;D>v;v++){var L=l.d[v],Y=Ff(L.c),I=new Y,O=L.i;f.setId&&O!=u&&(I._id=O),q._82I[O]=I,m.add(I),T.add(L)}for(v=0;D>v;v++)q.deserializeData(m.get(v),T.get(v));return m.each(function(f){$&&!f.getParent()&&f.setParent($),Q.add(f)}),Q.fireSerializeEvent({type:"deserialize",json:l}),Gg--,Q.endTransaction(),l.a&&l.a.onPostDeserialize&&!f.disableOnPostDeserialize&&l.a.onPostDeserialize(l,Q,f.view,m),f.finishFunc&&f.finishFunc(l,Q,f.view,m),m},deserializeData:function(l,M){for(var U in M.p)l[ii(U)](this[qm](M.p[U]));for(U in M.s)l.s(U,this[qm](M.s[U]));for(U in M.a)l.a(U,this[qm](M.a[U]))},deserializeValue:function(J){if(Il(J)){var M=J.__i;if(M!=u)return this._82I[M];if(M=J.__a,En(M))return new _e(M)}return J}}),ae(ss,{serialize:function(e,J){return new Xb(this,J).serialize(e)},toJSON:function(L){return new Xb(this,L).toJSON()},deserialize:function(P,T,_){return new Xb(this).deserialize(P,T,_)}});var Mb=X.OverlappingBox=function(l){this.gv=l,this.boxes={}};lp("OverlappingBox",b,{clear:function(){var q,V,d=this.boxes;for(q in d)V=d[q],V.length=0},isOverlapping:function(C,u){var T,D,B=this,U=B.boxes,H=U[C];H?(T=H.rects,D=H.length):H=U[C]={rects:T=[],length:D=0};var Q,F,u;for(Q=0;D>Q;Q++)if(F=T[Q],F.x<u.x+u.w&&F.x+F.w>u.x&&F.y<u.y+u.h&&F.h+F.y>u.y)return!0;
return T.length<=D?(T.push(u),H.length++):T[H.length++]=u,!1}}),ae(U,{fetch:function(J,N){var A="GET",o=!1,D=null,e="";N&&(A=N.method||"GET",o=N.sync,e=N.url,D=N.data||null),J.open(A,e,!o),N.responseType?J.responseType=N.responseType:N.overrideMimeType&&J.overrideMimeType&&J.overrideMimeType(N.overrideMimeType),J.send(D)},convertImageSrc:function(j,H){H&&"function"==typeof H||(H=function(){}),H(j)}});var Yq=X.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};lp("Request",b,{_responseType:null,_overrideMimeType:"text/plain",send:function(A){var T=this._xhr,b=this.onload,H=this.onerror;this.getResponseType()?A.responseType=this.getResponseType():this.getOverrideMimeType()&&(A.overrideMimeType=this.getOverrideMimeType()),T.onload=b,T.onerror=H,U.fetch(T,A)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(_){this._responseType=_},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(o){this._overrideMimeType=o},getResponseText:function(){var J=this._xhr;return J.response||J.responseText}}),cm.GraphView=function(c){var Z=this;Z._24I={},Z._34I=new _e,Z._25I={},Z._56I={},Z._view=sm(1,Z),Z._canvas=ib(Z._view),Z.dm(c?c:new ss),this._coreInteractor=new kc(this),Z.setEditable(!1),Z.setScrollBarVisible(U.graphViewScrollBarVisible)},nq("GraphView",b,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Gl,bb,Xq,Jm,"resettable","editInteractor",ym,"zoomable","pannable","rectSelectable","autoScrollZone",ro,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:U.graphViewZoomable,_resettable:U.graphViewResettable,_pannable:U.graphViewPannable,_rectSelectable:U.graphViewRectSelectable,_autoScrollZone:U.graphViewAutoScrollZone,_rectSelectBackground:U.graphViewRectSelectBackground,_rectSelectBorderColor:U.graphViewRectSelectBorderColor,_editPointSize:U.graphViewEditPointSize,_editPointBorderColor:U.graphViewEditPointBorderColor,_editPointBackground:U.graphViewEditPointBackground,_scrollBarColor:Yb,_scrollBarSize:ck,_autoHideScrollBar:ag,_autoMakeVisible:We,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(S){this._dataModel.setLayers(S)},setEditable:function(J){var E=this,W=E.__interactorMap__;if(!W){var o=cm.XEditInteractor;W=E.__interactorMap__={scrollBar:new _m(E),select:new Ac(E),edit:o?new o(E):new ki(E),text:new Kq(E),move:new af(E),"default":new Ek(E),touch:new uq(E,{editable:!1})}}J?(E._uieditable=!0,E.setInteractors([W.scrollBar,W.select,W.edit,W.text,W.move,W.default,W.touch])):(E._uieditable=!1,E.setInteractors([W.scrollBar,W.select,W.move,W.default,W.touch]))},getCanvas:function(){return this._canvas},_33I:function(X){var x=X.getUIClass();return x?new x(this,X):u},getDataUI:function(m){var T=this,A=T._25I[m._id];return A===f&&(A=T._33I(m),T._25I[m._id]=A),A},getNodeRect:function(K){return U.getNodeRect(this,K)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(I){var M=this.getDataUI(I);return M?(M._79o(),M._78o):null},getEdgeSourcePosition:function(K){var y=this,S=y.getDataUI(K),Q=S.s,R=S._data._40I;return ql(y,R,Q("edge.source.position"),Q("edge.source.offset.x"),Q("edge.source.offset.y"),Q("edge.source.anchor.x"),Q("edge.source.anchor.y"))},getEdgeTargetPosition:function(m){var C=this,Y=C.getDataUI(m),I=Y.s,E=Y._data._41I;return ql(C,E,I("edge.target.position"),I("edge.target.offset.x"),I("edge.target.offset.y"),I("edge.target.anchor.x"),I("edge.target.anchor.y"))},invalidateAll:function(w){var o=this;if(w){for(var E in o._25I){var g=o._25I[E];g&&g.dispose()}o._25I={},o._56I={},o._24I={},o._34I.clear(),o.redraw()}else o.dm().each(function(G){o.invalidateData(G)})},invalidateSelection:function(){var r=this;r.sm().each(function(L){r.invalidateData(L)})},invalidateData:function(R){var m=this;m._24I[R._id]=R,m._21Q(R),m.iv()},_21Q:function(p){var V=this,$=V._24I;if(ej(p)&&ok[p.s(_j)]){var c=p.getSourceAgent();c&&c.getAgentEdges().each(function(g){$[g._id]=g}),c=p.getTargetAgent(),c&&c.getAgentEdges().each(function(s){$[s._id]=s}),V.iv()}},redraw:function(q){var d=this;d._32I||(q?d._34I.add(q):(d._32I=1,d._34I.clear()),d.iv())},each:function(V,j){var w,k,M,L=0,c=this.getLayers(),Y=this._dataModel,T=Y._datas._as,p=T.length;if(c){for(var o=c.length;o>L;L++)if(M=c[L],Il(M)&&(M=M.name),Y.isHierarchicalRendering()){var Q=function(S){return S._layer===M?j?V.call(j,S):V(S):void 0};if(this._dataModel.eachByHierarchical(Q)===!1)return}else for(var u=0;p>u;u++)if(w=T[u],w._layer===M&&(k=j?V.call(j,w):V(w),k===!1))return}else if(Y.isHierarchicalRendering())this._dataModel.eachByHierarchical(V,null,j);else for(;p>L;L++)if(w=T[L],k=j?V.call(j,w):V(w),k===!1)return},reverseEach:function(D,N){var i,m,Y,h,j=this._dataModel,c=j._layers,u=j._datas._as,y=u.length;if(c){for(i=c.length-1;i>=0;i--)if(h=c[i],Il(h)&&(h=h.name),j.isHierarchicalRendering()){var w=function(f){return f._layer===h?N?D.call(N,f):D(f):void 0};if(j.reverseEachByHierarchical(w)===!1)return}else for(var r=y-1;r>=0;r--)if(m=u[r],m._layer===h&&(Y=N?D.call(N,m):D(m),Y===!1))return}else if(j.isHierarchicalRendering())j.reverseEachByHierarchical(D,null,N);else for(i=y-1;i>=0;i--)if(m=u[i],Y=N?D.call(N,m):D(m),Y===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var i=this,L=i._84I;if(!L){var B=this.dm().a("width"),c=this.dm().a("height");B>0&&c>0?i._84I={x:0,y:0,width:B,height:c}:(i.each(function(t){i.isVisible(t)&&(L=Lj(L,i.getDataUIBounds(t)))}),i._84I=L?L:Wi)}return i._84I},getScrollRect:function(){return Lj(this.getContentRect(),this._29I)},makeCenter:function(x,L,a){var N=this;if(!N.getWidth()||!N.getHeight())return a||up(N.centerData,N,[x,L,!0],500),void 0;N.makeVisible(x),N.validate();var Y=N.getDataUIBounds(x);if(Y){var G=N.getWidth(),V=N.getHeight(),I=Y.x+Y.width/2,B=Y.y+Y.height/2,z=-I*N._zoom+G/2,w=-B*N._zoom+V/2;N.setTranslate(z,w,L)}},fitData:function(F,f,H,N,G){var p=this;if(!p.getWidth()||!p.getHeight())return G||up(p.fitData,p,[F,f,H,N,!0],500),void 0;var v=function(){p.makeVisible(F),p.validate();var g=p.getDataUIBounds(F);g&&(g=Qb(g),ce(g,H==u?20:H),p.fitRect(g,f,N))};f?U.callWhenLoaded(v):v()},fitContent:function(T,X,L,C){var G=this;if(!G.getWidth()||!G.getHeight())return C||up(G.fitContent,G,[T,X,L,!0],500),void 0;var R=function(){G.validate();var e=Qb(G.getContentRect());ce(e,X==u?20:X),G.fitRect(e,T,L)};T?U.callWhenLoaded(R):R()},fitRect:function(f,o,j){var F=this,q=F.getWidth(),k=F.getHeight(),g=f.x+f.width/2,O=f.y+f.height/2,s=I(q/f.width,k/f.height),U=F._zoom,$=-g*U+q/2,M=-O*U+k/2;0===s||isNaN(s)||(j&&(s=I(1,s)),o?(F._65I&&(delete F._65I.finishFunc,F._65I.stop(!0)),F._14o&&F._14o.stop(!0),F.setTranslate($,M,{finishFunc:function(){F.setZoom(s,o)}})):(F.setTranslate($,M),F.setZoom(s)))},toCanvas:function(n,N){N=N||this._zoom,this.validateImpl();var r=this,u=r.getContentRect();u.width||(u.width=10),u.height||(u.height=10);var B=ib(),e=u.x*N,S=u.y*N,I=u.width*N,c=u.height*N;Up(B,I,c,1);var g=Cp(B);return n=n||this._dataModel.getBackground(),n&&On(g,0,0,I,c,n),vk(g,-e,-S),g.scale(N,N),r._42(g),g.restore(),B},toDataURL:function(O,C,r){return this.toCanvas(O,r).toDataURL(C||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(v,x){var C=this,J=C.dm().getBackground();if(J){var R=C.dm().a("width"),j=C.dm().a("height");R>0&&j>0&&On(v,0,0,R,j,J)}var G=C.__htmlOrderList,h=[];if(C._93db(v,x),C.each(function(B){var q=C.getDataUI(B);if(q){var F=C._56I[B._id],W=q._htmlView;if(F){var m=q._79o();if(W=q._htmlView,X.HtmlNode&&B instanceof X.HtmlNode)q._42(v);else{var K=C.getViewRect(),L=W&&W.layoutHTML;!x||Pq(x,m)?(L&&(W.layoutHTML(),q.__outerLayout&&delete q.__outerLayout),q._42(v)):Pq(K,m)||!L||q.__outerLayout||(W.layoutHTML(),q.__outerLayout=!0)}}W&&(h.push(W),W.getView&&(W=W.getView()),W.style.display=F?"block":mg)}}),G&&h.length>0){var i=!1;if(G.length!==h.length)i=!0;else for(var o=0;o<h.length;o++)if(h[o]!==G[o]){i=!0;break}i&&(h.forEach(function(F){C.appendHTML(F,!0)}),this.__htmlOrderList=h)}else this.__htmlOrderList=h;C._92db(v,x)},validateImpl:function(){this.tryUpdateRootData();var X,M,m,c,K,I=this,F=I.tx(),d=I.ty(),z=I._zoom,P=I._canvas,V=this.getWidth(),q=this.getHeight(),G=I._29I,a={x:-F/z,y:-d/z,width:V/z,height:q/z},r={},x=I._34I,J=I._24I,N=I._32I,S=I._23I;I._24I={},(V!==P.clientWidth||q!==P.clientHeight)&&(Up(P,V,q),N=1),N||Me(a,G)||(N=1),I._29I=a,I.each(function(o){M=o._id;var K=r[M]=I.isVisible(o);K!==I._56I[M]&&(J[M]=o,m=I.getDataUI(J[M]),m&&m._84o(K),I._84o(o,K))},I);for(M in J)m=I.getDataUI(J[M]),m&&(!N&&I._56I[M]&&(K=m._79o(),K&&x.add(K)),m.invalidate()),I._83I=1;if(I._56I=r,!N)for(M in J)r[M]&&(m=I.getDataUI(J[M]),m&&(K=m._79o(),K&&x.add(K)));if(N?c=a:(x.each(function(A){Pq(a,A)&&(c=Lj(c,A))}),c&&(ce(c,l(1,1/z)),c.x=R(c.x*z)/z,c.y=R(c.y*z)/z,c.width=n(c.width*z)/z,c.height=n(c.height*z)/z,c=un(a,c))),I._74O=c,c){X=Cp(P);var Q=c.x,e=c.y,f=c.width,W=c.height;Q=Math.floor((Q*z+F)*Ee),e=Math.floor((e*z+d)*Ee),f=Math.ceil(f*z*Ee)+1,W=Math.ceil(W*z*Ee)+1,X.beginPath(),X.rect(Q,e,f,W),X.clip(),X.clearRect(Q,e,f,W),er(X,F,d,z),I._42(X,c),X.restore(),delete I._74O}if(x.clear(),delete I._32I,S&&V>0&&q>0){var m=I.getDataUI(S);if(m){var K=m._79o(),y=I._29I,H=y.x,$=y.y,w=y.width,C=y.height,z=I._zoom;K&&!Pq(K,y)&&(K.x+K.width<H&&I.tx(-K.x*z),K.x>H+w&&I.tx(-(K.x+K.width-w)*z),K.y+K.height<$&&I.ty(-K.y*z),K.y>$+C&&I.ty(-(K.y+K.height-C)*z))}delete I._23I}I._83I&&(delete I._83I,delete I._84I),I._98O(),I.countFrame(),Dh(I._24I)||up(I.iv,I)},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var d,v=this.getFullscreenDatas();for(var i in v)d=v[i],this.scaleRootData(d);this._rootDataUpdating=!1}},scaleRootData:function(Q){var N=Q.s("fullscreen");if("uniform"===N||"fill"===N){Q.getRotation()&&Q.setRotation(0);var C,Z,D,v=Q.s("fullscreen.gap")||0,W=this.getWidth()-2*v,U=this.getHeight()-2*v,Y=Q.getAnchor(),e=Q.getScaledSize(),f=e.width,V=e.height,l=Q.s("fullscreen.lock");if(l)return"uniform"===N?W/U>f/V?(C=U/V,f=V*W/U):(C=W/f,V=f*U/W):"v"===l?(C=U/V,f=W/C,Q.getWidth()!==f&&Q.setWidth(f)):(C=W/f,V=U/C,Q.getHeight()!==V&&Q.setHeight(V)),this.setZoom(C),Z=v-(Q.getX()-Y.x*f)*C,D=v-(Q.getY()-Y.y*V)*C,Z!==this.tx()&&this.tx(Z),D!==this.ty()&&this.ty(D),void 0;Z=this.tx(),D=this.ty(),C=this._zoom;var L={x:(-Z+v)/C,y:(-D+v)/C,width:W/C,height:U/C};if("uniform"===N){var u=f/V,E=Math.min(L.width,L.height*u),c=E/u;L.x+=.5*(L.width-E),L.y+=.5*(L.height-c),L.width=E,L.height=c}W=L.width/Q.getScaleX(),U=L.height/Q.getScaleY(),(Q.getWidth()!=W||Q.getHeight()!==U)&&Q.setSize(W,U);var G=L.x+Y.x*L.width,T=L.y+Y.y*L.height,j=Q.getPosition();(G!==j.x||T!==j.y)&&Q.setPosition(G,T)}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(j){var v=this;j!==v.isScrollBarVisible()&&(j?(qr(v._view,v._79O=rp()),qr(v._79O,v._27I=rp()),qr(v._79O,v._28I=rp())):(mp(v._79O),delete v._79O,delete v._27I,delete v._28I),v.fp("scrollBarVisible",!j,j))},getDebugTip:function(){return""},showScrollBar:function(){var g=this;g._79O&&(g._85I||(i(function(){g._86I()},uk),g.iv()),g._85I=new Date)},_86I:function(){var g=this;if(g._85I){var w=new Date,o=w.getTime();o-g._85I.getTime()>=uk?(delete g._85I,g.iv()):i(function(){g._86I()},uk)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var U=this,i=this._27I,B=this._28I;if(U._79O){if(U._autoHideScrollBar&&!U._85I)return i.style.visibility=Ie,B.style.visibility=Ie,void 0;var Y=U.getScrollBarColor(),D=U._zoom,z=U.getScrollBarSize(),T=U.getViewRect(),r=U.getScrollRect(),H=T.height*D,k=r.height*D,M=T.width*D-z-2,F=H*((T.y-r.y)*D/k),m=H*(H/k),l=i.style;k-.5>H?(qn>m&&(F=F+m/2-qn/2,0>F&&(F=0),F+qn>H&&(F=H-qn),m=qn),Ji(i,M,F,z,m),l.visibility=pl,l.background=Y,l.borderRadius=z/2+Lf):l.visibility=Ie;var g=T.width*D,E=r.width*D,F=T.height*D-z-2,M=g*((T.x-r.x)*D/E),R=g*(g/E),l=B.style;E-.5>g?(qn>R&&(M=M+R/2-qn/2,0>M&&(M=0),M+qn>g&&(M=g-qn),R=qn),Ji(B,M,F,R,z),l.visibility=pl,l.background=Y,l.borderRadius=z/2+Lf):l.visibility=Ie}},setDataModel:function(f){var b=this,Z=b._dataModel,V=b._selectionModel;Z!==f&&(Z&&(Z.ump(b.handleDataModelPropertyChange,b),Z.umm(b.handleDataModelChange,b),Z.umd(b.handleDataPropertyChange,b),Z.removeIndexChangeListener(b._75O,b),Z.removeHierarchyChangeListener(b.handleHierarchyChange,b),V||Z.sm().ums(b.handleSelectionChange,b)),b._dataModel=f,f.mp(b.handleDataModelPropertyChange,b),f.mm(b.handleDataModelChange,b),f.md(b.handleDataPropertyChange,b),f.addIndexChangeListener(b._75O,b),f.addHierarchyChangeListener(b.handleHierarchyChange,b),V?V._21I(f):f.sm().ms(b.handleSelectionChange,b),b.invalidateAll(!0),b.fp(Vq,Z,f),b.updateBackground())},getLayersInfo:function(){if(this._layersInfo===f){var Z=this.getLayers();Z?(this._layersInfo={},Z.forEach(function(b){var Q=Il(b)?b.name:b;this._layersInfo[Q]=b},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(K,z,n){var x,i,R=this,d=R.getDataUI(K),j=uj(d),s=sf(z,function(h){return Ln(j,100*h)},100,.001),b=Ln(j,100*s);if(!n){var X=eo(d),D=new Hh(b.x,b.y),B=49/(R._zoom*R._zoom);for(x=0,i=X.length;i>x;x++)if(D.distanceToSquared(X[x])<B)return{index:x,point:X[x],distance:Math.sqrt((X[x].x-z.x)*(X[x].x-z.x)+(X[x].y-z.y)*(X[x].y-z.y))}}return{percent:s,point:b,distance:Math.sqrt((b.x-z.x)*(b.x-z.x)+(b.y-z.y)*(b.y-z.y))}},calculateAttachPoint:function(){var u=new Hh,j=new Hh,i=new Hh;return function(D,Y){var q=this.getAttachPoints(D);if(!q||!q.length)return null;i.set(Y.x,Y.y);for(var P,w,V,N,Z=1/0,o=0,t=q.length;t>o;o++)V=q[o],j.x=V.x,j.y=V.y,u.x=V.offsetX||0,u.y=V.offsetY||0,N=ql(this,D,0,u.x,u.y,j.x,j.y),w=i.distanceToSquared(N),Z>w&&(P=o,Z=w);Z=Math.sqrt(Z);var p=this.getAttachStyle(D);if("close"===p){var K=D.s("attach.close.threshold")/this._zoom;if(Z>K)return null}return{index:P,distance:Z,info:q[P]}}}(),getAttachPoints:function(j){var l=j.s("attach.points");if(l)return l;var d=Hi(j._image);return d?wq(d.attachPoints,j,this)||null:void 0},getAttachStyle:function(v){var S=v.s("attach.style");if(S)return S;var d=Hi(v._image);return d?wq(d.attachStyle,v,this)||"close":void 0},updateLayers:function(){this._layersInfo=f,this.invalidateSelection(),this.redraw()},updateBackground:function(){var w=this.dm().a("width"),D=this.dm().a("height");this._canvas.style.background=w>0&&D>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(x){if("background"===x.property){var A=this._canvas.style.background,N=x.newValue||"";this.updateBackground(),this.fp("canvasBackground",A,N),this.redraw()}else"a:width"===x.property||"a:height"===x.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===x.property?this.updateLayers():"hierarchicalRendering"===x.property&&this.redraw()},handleDataPropertyChange:function(i){this.dm().isHierarchicalRendering()&&"parent"===i.property&&i.data.hasChildren()&&this.redraw(),this.invalidateData(i.data)},onPropertyChanged:function(c){var M=this,o=c.property;if(M.redraw(),"zoom"===o){var g=M.sm().getSelection();g.size()&&g.each(function(A){A.invalidate()})}Qr[o]?M.showScrollBar():o===ym&&M.onCurrentSubGraphChanged(c)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(N){var X=this,$=N.kind,g=N.data;if(X._83I=1,"add"===$)X.invalidateData(g),ej(g)&&g.getEdgeGroup()&&g.getEdgeGroup().eachSiblingEdge(X.invalidateData,X);else if($===tp){X._21Q(g);var D=g._id,d=X._25I[D];if(d){if(X._56I[D]){var O=d._79o();O&&X.redraw(O)}d.dispose(),delete X._25I[D],delete X._24I[D],delete X._56I[D]}g===X._currentSubGraph&&X.setCurrentSubGraph(u)}else $===Ch&&(X.invalidateAll(!0),X.setCurrentSubGraph(u))},_75O:function(e){this.invalidateData(e.data)},handleHierarchyChange:function(c){this.dm().isHierarchicalRendering()&&c.data.hasChildren()&&this.redraw(),this.invalidateData(c.data)},adjustIndex:function(f){var J=this;if(J.isVisible(f)){J.dm().beginTransaction();for(var O=f;O._parent&&J.isVisible(O._parent);)O=O._parent;O&&O!==f&&J._dataModel.adjustIndex(O),J._dataModel.adjustIndex(f),J.dm().endTransaction()}},getImage:function(E){return E.getImage?E.getImage():f},getSelectWidth:function(u){var t=Hi(this.getImage(u));return t&&wq(t.disableSelectedBorder,u,this)?0:u.s("select.width")},getSelectColor:function(u){return u.s("select.color")},isSelectable:function(Z,A){if(this.isSelected(Z))return!0;if(!A&&Z.getParent()instanceof ls&&this.isSelectable(Z.getParent(),!0)&&Z.getParent().isSyncSize())return!1;var M=this.getLayersInfo();if(M){var t=M[Z._layer];if(t&&t.selectable===!1)return!1}return Z.s("2d.selectable")&&this.sm().isSelectable(Z)},isMovable:function(_){var V=this;if(ej(_)&&_.getStyle(_j)!==kp)return!1;var K=this.getLayersInfo();if(K){var s=K[_._layer];if(s&&s.movable===!1)return!1}return _.s("2d.movable")?V._movableFunc?V._movableFunc(_):!0:!1},isEditable:function(U){var w=this;if(X._uiSerializing)return w._uieditable;if(!w._editInteractor||!w.isSelected(U))return!1;if(yi(U)){var z=w.getDataUI(U);if(!z||z._88I)return!1}if(ej(U)&&U.getStyle(_j)!==kp)return!1;var s=this.getLayersInfo();if(s){var _=s[U._layer];if(_&&_.editable===!1)return!1}return U.s("2d.editable")?w._editableFunc?w._editableFunc(U):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(q){return xp(q)&&0!==q.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(q):!0},isRectEditable:function(H){return this._rectEditableFunc?this._rectEditableFunc(H):!0},isAnchorEditable:function(c){return this._anchorEditableFunc?this._anchorEditableFunc(c):!0},isRotationEditable:function(m){return m.setRotation&&m.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(m):!0:!1},getRotationPoint:function(t){var j=t.getAnchor(),C=t.getScale(),_=this._zoom,q=si(t.getRotation(),0,-t.getHeight()*C.y*j.y-(C.y<0?-1:1)*(je?32:16)/_),l=t.p();return q.x+=l.x,q.y+=l.y,q},getLogicalPoint:function(W){var v=this;return _k(W,v._canvas,v.tx(),v.ty(),v._zoom,v._zoom)},getScreenPoint:function(p,G){var F,S=this;return"object"==typeof p?p.x!==f?(F=p.x,G=p.y):(F=p[0],G=p[1]):F=p,dd(F,G,S._canvas,S.tx(),S.ty(),S._zoom,S._zoom)},getSelectedDataAt:function(c){var $=this;return this.getDataAt(c,function(j){return $.isSelected(j)})},getDataInfoAt:function(F,w,n){var E,z=this.lp(F),I=this.getDataAt(z,w,n);if(I){var D=this.getDataUI(I);E={data:I,ui:D,point:z};var d=D._38o;if(d){var A=d.icons;for(var H in A){var x=A[H],m=d.rects[H];if(m)for(var Z=wq(x.names,I,this),j=Z?Z.length:0,c=m.rotation,T=j-1;T>=0;T--){var q=Z[T],f=m[T];if(oj(f,z,c))return E.part="icons",E.name=H,E.icon=q,E.rect=f,E.index=T,E.rotation=c,E}}}if(this.isNoteVisible(I)){if(D.note2Info&&oj(D.note2Info.clickRect,z,u,D.note2Info.scale))return E.part="note2",E;if(D.noteInfo&&oj(D.noteInfo.clickRect,z,u,D.noteInfo.scale))return E.part="note",E}if(this.isLabelVisible(I)){if(D.label2Info&&oj(D.label2Info.rect,z,D.label2Info.rotation,D.label2Info.scale))return E.part="label2",E;if(D.labelInfo&&oj(D.labelInfo.rect,z,D.labelInfo.rotation,D.labelInfo.scale))return E.part="label",E}if(I.isInRect&&I.isInRect(z))return E.part="body",E}return E},getDataAt:function(n,P,j){n.target&&(n=this.lp(n));var s,R=this._zoom;return this.reverseEach(function(o){return(P?P(o):this.isSelectable(o))&&this.rectIntersects(o,qp(n.x,n.y,j,R))?(s=o,!1):void 0},this),s},getIconInfoAt:function(k,x){var h=this;if(k.target&&(k=h.lp(k)),x||(x=h.getDataAt(k)),x){var r=h.getDataUI(x);if(r&&r._38o){var D,n=r._38o,W=new _e;for(D in n.icons)W.add(D);for(var q=W.size()-1;q>=0;q--){D=W.get(q);for(var T=n.rects[D],F=T.rotation,C=T.length-1;C>=0;C--){var d=T[C],Q=d.width,P=d.height,U={x:k.x-d.x-Q/2,y:k.y-d.y-P/2};F!=u&&(U=si(-F,U.x,U.y));var d={x:-Q/2,y:-P/2,width:Q,height:P};if(oj(d,U))return{key:D,index:C,name:n.icons[D].names[C],rect:T[C],point:k,rotation:F,relativeRect:d,relativePoint:U,data:x}}}}}return u},getDatasInRect:function(u,b,g){g===f&&(g=1);var q=this,K=new _e;return q.reverseEach(function(j){g&&!q.isSelectable(j)||(b?q.rectIntersects(j,u):q.rectContains(j,u))&&K.add(j)}),K},moveSelection:function(l,b){var i=this;i.dm().beginTransaction(),ze(i.sm().toSelection(i.isMovable,i),l,b),i.dm().endTransaction()},moveDatas:function(D,P,y){var T=this;T.dm().beginTransaction(),D instanceof _e||(D=new _e(D)),ze(D,P,y),T.dm().endTransaction()},getDataUIBounds:function(l){var o=this.getDataUI(l);return o?o._79o():u},drawData:function(Y,q,I){var w=this.getDataUI(q);if(w){var R=w._79o();(!I||Pq(I,R))&&(w._42(Y),q instanceof X.Block&&q.eachChild(function(K){this.drawData(Y,K,I)},this))}},getBoundsForGroup:function(N){return N.s(dk)?this.getDataUIBounds(N):u},isPixelPerfect:function(i){return i.s("pixelPerfect")},rectIntersects:function(X,h){this.validate();var t=u;if(this._56I[X._id]){var o=this._25I[X._id];if(o){var V=o._79o();if(Rn(h,V))t=!0;else if((h=un(h,V))&&(o.rectIntersects&&(t=o.rectIntersects(h)),t==u)){if(!this.isPixelPerfect(X))return!0;var O=h.x,l=h.y,$=h.width,b=h.height,N=this._zoom,d=U.hitMaxArea,g=$*b*N*N;if(g>d){var T=Math.sqrt(d/g);N*=T}$*=N,b*=N,2>$&&($=2),2>b&&(b=2),O*=N,l*=N;var Q=Jc($,b);vk(Q,-O,-l),Q.scale(N,N),this._drawForChecking=!0,this.drawData(Q,X,h),this._drawForChecking=!1;try{for(var I=0,H=Q.getImageData(0,0,$,b).data;I<H.length;I+=4)if(0!==H[I+3]){t=!0;break}Q.restore()}catch(G){vh=u,t=!1}}}}return t?!0:!1},rectContains:function(U,x){if(this._56I[U._id]){var L=this._25I[U._id];if(L)return Rn(x,L._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(t){if(!U.isInput(t.target)){var l=this,s=l._focusData,z=s&&l._25I[s._id],P=0,S=l._dataModel._datas;if(!(s&&s._enabled&&s._editable&&z&&z.onKeyDown&&z.onKeyDown(t)===!0))if(9===t.keyCode&&(s&&(P=S.indexOf(s),xd(t)?-1===--P&&(P=0):++P===S.size()&&(P=0)),l._focusData=s=S.get(P),l.sm().setSelection(s)),Zf(t)?l.selectAll():Db(t)&&l.isResettable()&&l.reset(),l.sm().isEmpty()){if(l._editing)return;var L=l.tx(),N=l.ty(),C=!1,b=xd()?100:10;el(t)&&(L-=b,C=!0),ek(t)&&(N-=b,C=!0),bs(t)&&(L+=b,C=!0),Sh(t)&&(N+=b,C=!0),C&&l.setTranslate(L,N)}else{ws(t)&&l.handleDelete(t);var p=xd()?10:1;el(t)&&(l.moveSelection(-p,0),l.fi({kind:"moveLeft"})),ek(t)&&(l.moveSelection(0,-p),l.fi({kind:"moveUp"})),bs(t)&&(l.moveSelection(p,0),l.fi({kind:"moveRight"})),Sh(t)&&(l.moveSelection(0,p),l.fi({kind:"moveDown"}))}}},handleScroll:function(d,U){if(wb(d),this.isZoomable()){if(!this.getEditInteractor()){var y=this.getDataAt(d);if(y){var X=Hi(this.getImage(y));if(X&&wq(X.scrollable,y,this))return}}var J=this.lp(d);U>0?this.scrollZoomIn(J):0>U&&this.scrollZoomOut(J)}},handlePinch:function(I,m,b){this.isZoomable()&&(this._68I||(m>b?this.pinchZoomIn(I):this.pinchZoomOut(I)))},checkDoubleClickOnNote:function(j,M){var Q=this,r=Q.lp(j),m=Q.getDataUI(M),y=m.note2Info;return y&&M.s("note2.toggleable")&&oj(y.clickRect,r)?(M.s(fc,!M.s(fc)),Q.fi({kind:"toggleNote2",event:j,data:M}),!0):(y=m.noteInfo,y&&M.s("note.toggleable")&&oj(y.clickRect,r)?(M.s(Pn,!M.s(Pn)),Q.fi({kind:"toggleNote",event:j,data:M}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(k,z){var y=this,I=y.getAutoScrollZone(),b=I/y.getZoom(),j=I/4,Q=y._29I,O=y.lp(k),q={x:y.tx(),y:y.ty()};return O&&I>0&&Q&&(O.x-Q.x<b?y.translate(j,0):Q.x+Q.width-O.x<b&&y.translate(-j,0),O.y-Q.y<b?y.translate(0,j):Q.y+Q.height-O.y<b&&y.translate(0,-j)),q.x=y.tx()-q.x,q.y=y.ty()-q.y,z&&(z.x+=q.x,z.y+=q.y),q},getMoveMode:function(Y,x){var P=x.s("2d.move.mode");return P?P:Fg["88"]?"x":Fg["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(F,o,P){var J=this;return"currentSubGraph"===o?{__i:F.getId()}:P.serializeProperty(F,o,J)},deserializeProperty:function(a,R,I){var c=this;if("currentSubGraph"===R){var C=c.dm(),m=C.__idMap;return m[a.__i]}return I.deserializeProperty(a,R,c)},setDefaultCursor:function(x,Y){this._defaultCursor=x,Y!==!1&&this.setCursor(x)},setCursor:function(O){"default"===O&&(O=this._defaultCursor||O);var i=this.getView().style;i.cursor=O,i.cursor="-webkit-"+O,i.cursor="-moz-"+O},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(z){return z===u||U.getConnectAction(null,z)?(this._currentActionType=z,this.redraw(),!0):!1},getEditStyle:function(O){var E=this.getEditInteractor();return E?E.getStyle(O):f},setEditStyle:function(J,L,q){var p=this.getEditInteractor();return p?(p.setStyle(J,L,q),!0):!1},isConnectActionVisible:function(J){var E=U.getConnectAction(this);if(!E)return!1;var f=E.visible;return Ze(f)&&(f=f(this,J)),f},isInteractive:function(t){var B=Hi(this.getImage(t));return B&&wq(B.interactive,t,this)?!0:t.s("interactive")},appendHTML:function(L,X){var O=this.getView();if(!(X||L&&L.parentNode!==O))return!1;var y=L.getView&&L.getView();if(!X&&y&&y.parentNode===O)return!1;(L.getView||L.isSelfViewEvent)&&(L=L.getView());var h=this.getEditInteractor();return h&&h._canvas?O.insertBefore(L,h._canvas):this.isScrollBarVisible()?O.insertBefore(L,this.getView().lastChild):qr(O,L),!0},_layoutHTMLImpl:function(q,M,w){if(arguments.length>1){var d,n=this,Y=n._zoom;if(M.getView&&(d=M,M=M.getView()),M.style.position="absolute",w){var g=q.getRect();Ji(d||M,n.tx()+g.x*Y,n.ty()+g.y*Y,g.width*Y,g.height*Y)}else{var _=new Vg,g=q.getAnchorRect(),Q=q.getPosition(),N=q.getScale(),s=M.style;Ji(d||M,g),_.appendTranslate(n.tx(),n.ty()),_.appendScale(Y,Y),_.append(new Vg(q.getRotation(),Q.x,Q.y,N.x,N.y)),xh(s,"transform","matrix("+_.a.toFixed(5)+", "+_.b.toFixed(5)+", "+_.c.toFixed(5)+",\n    "+_.d.toFixed(5)+", "+_.tx.toFixed(5)+", "+_.ty.toFixed(5)+")"),xh(s,"transformOrigin",(-g.x).toFixed(5)+"px "+(-g.y).toFixed(5)+"px"),M._matrixAppend=_.invert().translate(-g.x,-g.y)}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(d){return d instanceof lq?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(x){var _="state",y=x.s(_);if(y)return y;var d=Hi(x._image);return d?wq(d[_],x,this)||null:void 0}}),b.defineProperties(cm.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(f){this._layoutHTML=f}}});var io=function(I,O){var S=this;S.gv=I,S.s=function(M){return O.getStyle(M)},S._data=O,S._87I=new _e};xk(io,b,{_6I:u,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var d=this,g=d.gv.isSelected(d._data);return!g||d.isShadowed()?0:d.gv.getSelectWidth(d._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(k){var h=this._data,X=this.gv.getBodyColor(h);return X?X:k?h.getStyle(k):u},_2Q:function(U){return this.s(U)},_1Q:function(I,d,q,f){var r=this.s,u=r("2d.gray"),J=r(d+".dash.color");if(u&&(J=U.toGrayColor(J)),I.strokeStyle=J,I.lineWidth=q,I.stroke(),r(d+".dash.3d")){var w=r(d+".dash.3d.color");Zn(I,J,u?U.toGrayColor(w):w,q,this.gv._zoom,r(d+".dash.3d.accuracy"))}Ve(I,f)},invalidate:function(){this._6I=u},_79o:function(){var b=this;if(!b._6I){var k=b._data,t=b.gv;b.labelInfo=b.label2Info=b.noteInfo=b.note2Info=b._38o=u,b._87I.clear(),b.interactiveInfo=t.isInteractive(k)?{}:u,b._3O(),b._55O=t.isEditable(k)?{_42O:t.isRectEditable(k),_43O:t.isPointEditable(k),_56O:t.isRotationEditable(k)}:u,b._6I=b._81o()}return b._6I},_3O:function(){},getPosition:function(){return Wi},_68o:function($,Q){$&&this._87I.add(yl($,Q))},_81o:function(){var q=this,m=q.s;q._24O(Fr,"getLabel"),q._24O(Nb,"getLabel2"),q._26O(cf,"getNote"),q._26O(ic,"getNote2"),q._15O(),q._55O&&q._48O();var A;if(q._87I.each(function(G){A=Lj(A,G)}),A&&q.isShadowed()){var l=Qb(A);l.x+=m("shadow.offset.x"),l.y+=m("shadow.offset.y"),ce(l,m("shadow.blur")),A=Lj(A,l)}return q._87I.clear(),A},_42:function(l){var c=this,s=c._data,N=c.gv,h=c.s,a=h("opacity"),i=this.isShadowed();if(i){var O=l.shadowOffsetX,U=l.shadowOffsetY,C=l.shadowBlur,B=l.shadowColor,f=N.getZoom();l.shadowOffsetX=h("shadow.offset.x")*f,l.shadowOffsetY=h("shadow.offset.y")*f,l.shadowBlur=h("shadow.blur")*f,l.shadowColor=c.getSelectColor()}if(a!=u){var Z=l.globalAlpha;l.globalAlpha=a}c._80o(l),N.isLabelVisible(s)&&((!N._drawForChecking||h("label.selectable"))&&Ic(l,c.labelInfo),(!N._drawForChecking||h("label2.selectable"))&&Ic(l,c.label2Info)),N.isNoteVisible(s)&&(wg(l,c.noteInfo),wg(l,c.note2Info)),c._99O(l),a!=u&&(l.globalAlpha=Z),i&&(l.shadowOffsetX=O,l.shadowOffsetY=U,l.shadowBlur=C,l.shadowColor=B)},_80o:function(){},_47O:function(){},_24O:function(Y,d){var E=this,L=E._data,h=E.gv,P=E.s,S=h[d](L);if(S!=u){var F=P(Y+".scale"),v=P(Y+".max"),f=P(Y+".position"),e=E[Y+"Info"]={label:S,scale:F,color:h[d+"Color"](L),font:P(Y+".font"),opacity:P(Y+".opacity"),align:P(Y+".align"),rotation:E.getRotation(P(Y+".rotation"),!1,f),background:h[d+"Background"](L)},b=Lc(e,S);v>0&&v<b.width&&(e.labelWidth=b.width,b.width=v),1!==F&&(b.width*=F,b.height*=F);var V=E.getPosition(f,P(Y+".offset.x"),P(Y+".offset.y"),b,P(Y+".position.fixed"));if(b.x=V.x-b.width/2,b.y=V.y-b.height/2,E._68o(e.rect=b,e.rotation),1!==F){var s=b.width/F,Q=b.height/F;e.rect={x:V.x-s/2,y:V.y-Q/2,width:s,height:Q}}}},_26O:function(Z,D){var j=this,S=j.gv,Q=j._data,W=j.s,P=S[D](Q);if(P!=u){var x,g,i=W(Z+".scale"),O=j[Z+"Info"]={note:P,scale:i,data:Q,view:S,expanded:W(Z+".expanded"),font:W(Z+".font"),color:W(Z+".color"),opacity:W(Z+".opacity"),align:W(Z+".align"),icon:W(Z+".icon"),backgroundImage:W(Z+".backgroundImage"),borderWidth:W(Z+".border.width"),borderColor:W(Z+".border.color"),background:S[D+"Background"](Q)},B=j.getPosition(W(Z+".position"),W(Z+".offset.x"),W(Z+".offset.y")),l=B.x,_=B.y;if(O.expanded){var C,r=W(Z+".max"),h=W(Z+".backgroundImage");h?(h=Hi(h),C={width:Bp(h,Q),height:Fd(h,Q)}):C=Lc(O,P),C.width+=6,C.height+=2,r>0&&r<C.width&&(O.labelWidth=C.width,C.width=r),x=C.width,g=C.height+8,O.clickRect={x:l-x*i/2,y:_-g*i,width:x*i,height:g*i*C.height/g}}else{var V=W(Z+".icon");V?(V=Hi(V),x=Bp(V,Q),g=Fd(V,Q)):(x=12,g=18),O.clickRect={x:l-x*i/2,y:_-g*i,width:x*i,height:g*i}}O.rect={x:l-x/2,y:_-g*i/2-g/2,width:x,height:g};var R=n(O.borderWidth/2)*i;j._68o({x:l-x*i/2-R,y:_-g*i-R,width:x*i+2*R,height:g*i+2*R})}},_48O:function(){},_99O:function($){var P=this,w=P._38o;if(w){var Z=P.gv,U=P._data,t=w.icons,b=P.interactiveInfo;b&&(b._38o={});for(var a in t){var N=t[a],F=w.rects[a];if(F){b&&(b._38o[a]=[]);var I=wq(N.opacity,U,Z),L=wq(N.names,U,Z),C=L?L.length:0,V=F.rotation;if(I!=u){var x=$.globalAlpha;$.globalAlpha*=I}for(var J=0;C>J;J++){var Y=L[J],d=Hi(Y),l=F[J];if(V){var W=l.x+l.width/2,q=l.y+l.height/2;$.save(),vk($,W,q),ts($,V),vk($,-W,-q)}b&&b._38o[a].push($.interactiveInfo={compInfos:[],matrix:V?new Vg(V,W,q).appendTranslate(-W,-q):new Vg}),fh($,d,wq(N.stretch,U,Z),l.x,l.y,l.width,l.height,P._data,P.gv),$.interactiveInfo=u,V&&$.restore()}I!=u&&($.globalAlpha=x)}}}}});var Lr=function(c,Q){ef(Lr,this,[c,Q])};xk(Lr,io,{_checkEmptyRect:!0,_40O:function(w,t){var g=this,$=g.s,f=w.rect;
(w.borderColor=g.gv.getBorderColor(g._data))&&(w.borderType=$("border.type"),w.borderWidth=$("border.width"),w.borderPadding=$("border.padding"),t=l(t,w.borderPadding+w.borderWidth/2));var v=g._data.getScale(),y=l(1,l(k(v.x),k(v.y)));if(w.selectWidth=g.getSelectWidth()){var Y=g.gv._zoom;w.selectType=$("select.type"),w._97o=g.getSelectColor(),w.selectPadding=$("select.padding"),t=l(t,(w.selectPadding+w.selectWidth/2/Y)/y)}t>0&&(t*=y,f=Qb(f),ce(f,t)),g._68o(f)},_39O:function(V,W){var X,D=this,Q=W.rect;if(W.borderWidth>0&&(X=W.borderPadding,V.strokeStyle=W.borderColor,V.lineWidth=W.borderWidth,gn(V,W.borderType,{x:Q.x-X,y:Q.y-X,width:Q.width+2*X,height:Q.height+2*X}),V.stroke()),W.selectWidth>0){var B=D.gv._zoom;if(X=W.selectPadding,V.strokeStyle=W._97o,V.lineWidth=W.selectWidth/B,W.rotation!=u){V.save(),V.translate(W.position.x,W.position.y),V.rotate(W.rotation);var z=D._data,d=z.getWidth(),H=z.getHeight(),I=W.scale,T=W.anchor;Q={x:I.x*-d*T.x,y:I.y*-H*T.y,width:I.x*d,height:I.y*H}}gn(V,W.selectType,{x:Q.x-X,y:Q.y-X,width:Q.width+2*X,height:Q.height+2*X}),W.rotation!=u&&V.restore(),V.stroke()}},dispose:function(){var F=this,$=F._htmlView;Lr.superClass._3O.call(F),$&&($.onHTMLRemoved&&$.onHTMLRemoved(),mp($))},_3O:function(){var G=this,i=G.s,N=G._data,z=G.gv,S=N.getStyle(Kn),D=G.getBodyColor(),n=G._83o=S?{shape:S,_53o:G.getBodyColor("shape.background"),_27Q:Hi(i("shape.repeat.image"),D),shapeGradientPack:i("shape.gradient.pack"),_54o:i("shape.border.width"),_55o:i("shape.border.color"),_56o:i("shape.border.3d"),_57o:i("shape.border.3d.color"),_58o:i("shape.border.3d.accuracy"),shapeGradient:i("shape.gradient"),_59o:i("shape.gradient.color"),_60o:i("shape.border.pattern"),_61o:i("shape.border.cap"),_62o:i("shape.border.join"),shapeForeground:i("shape.foreground"),bodyColor:D,gray:i("2d.gray")}:{img:Hi(z.getImage(N),D),bodyColor:D,gray:i("2d.gray"),stretch:i("image.stretch")};if(O&&!P);else{var v,p=n.img;p&&p.renderHTML?(G._htmlInfo&&G._htmlInfo.img!==p&&(G._htmlInfo=u),G._htmlInfo||(G._htmlInfo={img:p,cache:{}}),v=p.renderHTML(N,z,G._htmlInfo.cache)):G._htmlInfo=u,G._htmlView&&G._htmlView!==v&&(G._htmlView.onHTMLRemoved&&G._htmlView.onHTMLRemoved(),mp(G._htmlView.getView?G._htmlView.getView():G._htmlView)),(G._htmlView=v)&&z.appendHTML(v)&&(v.onHTMLAddedSync&&v.onHTMLAddedSync(),v.onHTMLAdded&&up(v.onHTMLAdded)),n.rect=N.getRect(),n.position=N.p(),n.scale=N.getScale(),n.anchor=N.getAnchor(),n.rotation=N.getRotation(),S===Ej&&(n._63o=i("shape.depth"));var e=0;if(S)e=Fe(u,n._54o/2,n._62o),G.s("shape.dash")&&(e=l(e,(G.s("shape.dash.width")||n._54o)/2));else if(p&&p.boundExtend)if(e=wq(p.boundExtend,N,z),p.boundExtendAbsolute){var W=N.getScale();e/=z._zoom*l(1,l(k(W.x),k(W.y)))}else if(!wq(p.fitSize,N,z)){var U=wq(p.width,N,z),a=wq(p.height,N,z);e*=l(N.getWidth()/U,N.getHeight()/a)}G._40O(n,e);var f=i("clip.percentage");if(1>f&&(0>f&&(f=0),n.clipRect=zp(N.getAnchorRect(),i("clip.direction"),f)),S){var B=i("shape.fill.clip.percentage");1>B&&(0>B&&(B=0),n.shapeClipRect=zp(N.getAnchorRect(),i("shape.fill.clip.direction"),B));var F=i("shape.foreground.clip.percentage");1>F&&(0>F&&(F=0),n.shapeForegroundClipRect=zp(N.getAnchorRect(),i("shape.foreground.clip.direction"),F))}}},getPosition:function(X,R,g,K){var N=Eg(X,this._83o.rect,K);return N.x+=R,N.y+=g,N},_80o:function(S){var X=this,F=X.s,K=X.gv,w=X._data,y=X._83o,I=y.rect,m=y.position,Z=y.rotation,p=y.anchor,J=y.scale,R=y.shape,Q=y.clipRect;if(!X._checkEmptyRect||I.width>0&&I.height>0){var v=w.getSize();if(v.x=-v.width*p.x,v.y=-v.height*p.y,S.save(),vk(S,m.x,m.y),ts(S,Z),Zo(S,J.x,J.y),Q&&(S.beginPath(),S.rect(Q.x,Q.y,Q.width,Q.height),S.clip()),K._drawForChecking&&y.img&&wq(y.img.pixelPerfect,w,K)===!1)On(S,v.x,v.y,v.width,v.height,"#888888");else if(X.freeDraw)X.freeDraw(S,v,y);else if(R){var k,A,q,x,E=y._60o,D=Pp(S,E),H=y._27Q,h=y._54o,l=y.shapeGradientPack,d=y.gray,o=S.lineJoin,Y=S.lineCap,C=function(B){return d?U.toGrayColor(B):B};"roundRect"===R?k=F("shape.corner.radius"):"polygon"===R?k=F("shape.polygon.side"):"arc"===R&&(k=F("shape.arc.from"),A=F("shape.arc.to"),q=F("shape.arc.close"),x=F("shape.arc.oval")),S.lineJoin=y._62o,S.lineCap=y._61o;var i=C(y._53o);if(i||H||l){var _=y.shapeClipRect;_&&(S.save(),S.beginPath(),S.rect(_.x,_.y,_.width,_.height),S.clip()),gn(S,R,v,k,A,q,x),l?Af(S,l):H?Un(S,H,C(y.bodyColor),null,w,K):Dl(S,i,y.shapeGradient,C(y._59o),v),S.fill(),_&&S.restore(),l&&S.restore(),S!==D&&gn(D,R,v,k,A,q,x)}else gn(D,R,v,k,A,q,x);var e=y.shapeForeground;if(e){S.save();var n=y.shapeForegroundClipRect;n&&(S.beginPath(),S.rect(n.x,n.y,n.width,n.height),S.clip()),gn(S,R,v,k,A,q,x),Dl(S,e,F("shape.foreground.gradient"),C(F("shape.foreground.gradient.color")),v),S.fill(),S.restore()}if(h>0){var G=F("shape.border.width.absolute");G&&(S.save(),S.setTransform(1,0,0,1,0,0)),S.lineWidth=h;var L=C(y._55o);S.strokeStyle=L,S.stroke(),G&&S.restore(),y._56o&&Zn(S,L,C(y._57o),h,K._zoom,y._58o)}if(Ve(S,E),F("shape.dash")){var j=F("shape.dash.width")||h;if(j>0){E=F("shape.dash.pattern");var D=Pp(S,E,X._2Q("shape.dash.offset"));D!==S&&gn(D,R,v,k,A,q,x),X._1Q(S,"shape",j,E)}}hg(S,i,y._63o,v),S.lineJoin=o,S.lineCap=Y}else{var T=X.interactiveInfo;T&&(S.interactiveInfo=T.bodyInfo={compInfos:[],matrix:new Vg(Z,m.x,m.y,J.x,J.y)}),y.gray&&(S.compGray=!0);var s=y.img;s&&s.cacheRule!=u&&(s=Jj(S,s,y.stretch,v.width,v.height,w,K,y.bodyColor)),fh(S,s,y.stretch,v.x,v.y,v.width,v.height,w,K,y.bodyColor),S.compGray=!1,S.interactiveInfo=u}S.restore()}X._39O(S,y)},_48O:function(){},_47O:function(){}});var gh=function(E,s){ef(gh,this,[E,s])},sl=function(u,E,j,f){var P=Di(u,E);return j=f?I(j,P):An(j,P),P?j/=P:j=0,{x:u.x+(E.x-u.x)*j,y:u.y+(E.y-u.y)*j}};xk(gh,io,{_3O:function(){var C,c=this,N=c._data,K=c.gv,v=c.s,p=v(_j),V=N.isLooped(),Q=v("edge.width"),T=v("edge.center"),L=v("edge.offset"),D=K.getBorderColor(N),X=D?v("border.width"):0,s=c.getSelectWidth(),R=N._40I,k=N._41I,q=c._78o=R&&k?{looped:V,type:p,width:Q,center:T,color:c.getBodyColor("edge.color"),borderColor:D,borderWidth:X,_97o:s?c.getSelectColor():u,selectWidth:s,pattern:v("edge.pattern"),cap:v("edge.cap"),join:v("edge.join"),is3d:v("edge.3d"),_67o:v("edge.3d.color"),_66o:v("edge.3d.accuracy"),gray:v("2d.gray")}:u;if(q){var z=U.getEdgeType(p);if(z){var E=z(N,Gr(c,K,N,V,p),K,c._19Q);E.points&&E.points.size()>1?(q.edgeTypeInfo=E,C=ys(q.edgeTypeInfo.points)):E[pg]&&E.rect&&(q.edgeTypeInfo=E,C=E.rect)}else{var P=v("edge.source.anchor.x"),Y=v("edge.source.anchor.y"),O=v("edge.target.anchor.x"),J=v("edge.target.anchor.y"),g=ug(K,N,"source"),S=ug(K,N,"target");if(p===kp){var h=q.points=v(zq)||Ii,e=h.size();q.segments=v("edge.segments");var i=P!==f||Y!==f||ej(R),w=O!==f||J!==f||ej(k);if(!T)if(L)i||(g=sl(g,e?h.get(0):S,L,e)),w||(S=sl(S,e?h.get(e-1):g,L,e));else{var d;i||(d=Gp(g,e?h.get(0):S,wo(K,R)),d&&(g={x:d[0],y:d[1]})),w||(d=Gp(e?h.get(e-1):g,S,wo(K,k)),d&&(S={x:d[0],y:d[1]}))}C=Lj(ys(q.points),ys(g,S))}else{var W=Gr(c,K,N,V,p);if(c._19Q||(W=-W),V)g=Qb(g),g.x=K.getNodeRect(R).x,q.radius=W,C={x:g.x-W,y:g.y-W,width:2*W,height:2*W};else{var n=Di(g,S),b=An(L,n),r={x:b,y:W},o={x:n-b,y:W},G=$(S.y-g.y,S.x-g.x),_=q.mat=new Cg(G);if(q.orienAngle=G,q.angle=S.x<g.x?G+y:G,q.rect={x:r.x,y:r.y,width:o.x-r.x,height:0},q.origin=g,r=_.tf(r),r.x+=g.x,r.y+=g.y,o=_.tf(o),o.x+=g.x,o.y+=g.y,T){var t={x:n,y:0};t=_.tf(t),t.x+=g.x,t.y+=g.y,C=ys([g,r,o,t]),q.c1=g,q.c2=t}else C=ys(r,o);g=r,S=o}}q.sourcePoint=g,q.targetPoint=S,N._lastSourcePoint=g,N._lastTargetPoint=S}var F=0;v("edge.dash")&&(F=v("edge.dash.width")||Q);var m="square"===q.cap?.71:.5;Fe(C,l(F*m,Q*m+X+s),q.join),c._68o(C)}},getRotation:function(o,G,Z){o=o||0;var M=this._78o;if(M){var k,A=M.angle,K=M.points,j=M.edgeTypeInfo;if(A!=u)return G?M.orienAngle+o:A+o;if(j&&j[pg])return j.getRotation?j.getRotation(this,o,G,Z):0;if(j&&j.points){var L=j.points;return k=L.size(),gc[Z]?k&&0===k%2?Hk(L.get(k/2-1),L.get(k/2),G,o):o:rf[Z]?Hk(L.get(0),L.get(1),G,o):Hk(L.get(k-2),L.get(k-1),G,o)}if(K)return k=K.size(),gc[Z]?k&&0===k%2?Hk(K.get(k/2-1),K.get(k/2),G,o):o:rf[Z]?Hk(M.sourcePoint,k?K.get(0):M.targetPoint,G,o):Hk(k?K.get(k-1):M.sourcePoint,M.targetPoint,G,o)}return o},getPosition:function(o,Q,C,I,S){var w=this._78o;if(w){var x,p=w.type,g=w.points,V=w.edgeTypeInfo,n=w.sourcePoint,$=w.targetPoint;if(!p)return w.looped?{x:n.x-w.radius+Q,y:n.y+C}:(S&&n&&$&&(n.x>$.x||n.x===$.x&&n.y>$.y)&&(o=$i[o],C=-C),x=Eg(o,w.rect,I),x.x+=Q,x.y+=C,x=w.mat.tf(x),x.x+=w.origin.x,x.y+=w.origin.y,x);if(V&&V[pg])return V.getPosition?V.getPosition(this,o,Q,C,I,S):{x:(n.x+$.x)/2,y:(n.y+$.y)/2};if(g){var x,t=g.size();if(gc[o]){if(t){var q=t%2;if(0===q)return Vo(g.get(t/2-1),g.get(t/2),o,Q,C,I,S);x=g.get((t-q)/2)}else x={x:(n.x+$.x)/2,y:(n.y+$.y)/2};return x=Eg(o,{x:x.x,y:x.y,width:0,height:0},I),x.x+=Q,x.y+=C,x}return rf[o]?Vo(n,t?g.get(0):$,o,Q,C,I,S):Vo(t?g.get(t-1):n,$,o,Q,C,I,S)}if(V){var d=V.points,t=d.size();if(gc[o]){var q=t%2;return 0===q?Vo(d.get(t/2-1),d.get(t/2),o,Q,C,I,S):(x=d.get((t-q)/2),x=Eg(o,{x:x.x,y:x.y,width:0,height:0},I),x.x+=Q,x.y+=C,x)}return rf[o]?Vo(d.get(0),d.get(1),o,Q,C,I,S):Vo(d.get(t-2),d.get(t-1),o,Q,C,I,S)}}return Wi},_42:function(V){this._78o&&gh.superClass._42.call(this,V)},drawPath:function(n,k){n.beginPath();var L=k.type,X=k.points,R=k.segments,f=k.edgeTypeInfo;if(!L||X){var w=k.sourcePoint,G=w.x,I=w.y,N=k.targetPoint,o=N.x,t=N.y;if(L)if(R){var K=new _e({x:G,y:I});K.addAll(X),K.add({x:o,y:t}),mm(n,K,R)}else n.moveTo(G,I),X.each(function(Y){n.lineTo(Y.x,Y.y)}),n.lineTo(o,t);else k.looped?n.arc(G,I,k.radius,0,e,!0):k.center?(n.moveTo(k.c1.x,k.c1.y),n.lineTo(G,I),n.lineTo(o,t),n.lineTo(k.c2.x,k.c2.y)):(n.moveTo(G,I),n.lineTo(o,t))}else f&&(f.points?mm(n,f.points,f.segments):f[pg]&&f[pg](n,f))},_80o:function($){var l=this,y=l.s,Y=l._78o,L=Y.width,i=Y.selectWidth,p=Y.borderWidth,d=$.lineJoin,G=$.lineCap,o=Y.gray,m=Y.pattern;$.lineJoin=Y.join,$.lineCap=Y.cap,l.drawPath(Pp($,m),Y);var v=y("edge.width.absolute");v&&($.save(),$.setTransform(1,0,0,1,0,0)),i&&($.strokeStyle=Y._97o,$.lineWidth=L+2*(p+i),$.stroke()),p&&($.strokeStyle=o?U.toGrayColor(Y.borderColor):Y.borderColor,$.lineWidth=L+2*p,$.stroke());var b=o?U.toGrayColor(Y.color):Y.color,c=o?U.toGrayColor(Y._67o):Y._67o;if($.strokeStyle=b,$.lineWidth=L,$.stroke(),Y.is3d&&Zn($,b,c,L,l.gv._zoom,Y._66o),v&&$.restore(),Ve($,m),y("edge.dash")){m=y("edge.dash.pattern");var M=Pp($,m,l._2Q("edge.dash.offset"));M!==$&&l.drawPath(M,Y),l._1Q($,"edge",y("edge.dash.width")||L,m)}$.lineJoin=d,$.lineCap=G},_48O:function(){},_47O:function(){}});var rc=function(y,Z){ef(rc,this,[y,Z])};xk(rc,Lr,{_3O:function(){var K,I,c=this,h=c.s,m=c._data,d=c.gv;if(c._88I=u,m.isExpanded()&&m.eachChild(function(q){if(xp(q)){var P=d.getBoundsForGroup(q);P&&(I||(I=[]),I.push(P),K=Lj(K,P))}}),K){var v=d.getLabel(m),s=h("group.type");K=Nn(s,I,K),Sf(K,m,"group.padding",1);var D=c._88I={type:s,rect:K,_64o:K};if(!s&&v!=u){var j,M=c.labelInfo={label:v,color:h("group.title.color"),font:h("group.title.font"),align:h("group.title.align")},f=Lc(M,v),O=f.width,J=f.height,e=h("group.title.align"),N=h("group.title.orientation");if((N===hk||N===nh)&&O>K.width?K.width=O:(N===nk||N===yq)&&O>K.height&&(K.height=O),M.rect={y:K.y-J,width:f.width,height:J},j=e===nk?K.x:e===yq?K.x+K.width-O:K.x+K.width/2-O/2,M.rect.x=j,N===nh)D.titleRect={x:K.x,y:K.y+K.height,width:K.width,height:J},D.rect={x:K.x,y:K.y,width:K.width,height:K.height+J},M.rect={x:j,y:K.y+K.height,width:O,height:J};else if(N===nk){var o=D.titleRect={x:K.x-J,y:K.y,width:J,height:K.height};D.rect={x:K.x-J,y:K.y,width:K.width+J,height:K.height},M.rect={x:o.x+J/2-K.height/2,y:o.y+K.height/2-J/2,width:K.height,height:J},M.rotation=-Math.PI/2}else if(N===yq){var o=D.titleRect={x:K.x+K.width,y:K.y,width:J,height:K.height};D.rect={x:K.x,y:K.y,width:K.width+J,height:K.height},M.rect={x:o.x+J/2-K.height/2,y:o.y+K.height/2-J/2,width:K.height,height:J},M.rotation=Math.PI/2}else D.titleRect={x:K.x,y:K.y-J,width:K.width,height:J+1},D.rect={x:K.x,y:K.y-J,width:K.width,height:K.height+J}}c._40O(D,h("group.border.width")/2)}else rc.superClass._3O.call(c)},getPosition:function(P,q,N,v){var X=this._88I;if(X){var K=Eg(P,X.rect,v);return K.x+=q,K.y+=N,K}return rc.superClass.getPosition.apply(this,arguments)},_24O:function(a,u){var x=this._88I;(!x||x.type||"label2"===a)&&rc.superClass._24O.call(this,a,u)},_80o:function(i){var z=this,b=z._88I;if(b){var V=z._data,F=z.s,e=z.gv,T=b.type,M=b.rect,S=b._64o,E=b.titleRect,o=z.getBodyColor(),C=Hi(F("group.image"),o),k=F("group.image.stretch"),v=z.getBodyColor("group.background"),m=Hi(F("group.repeat.image"),o),q=F("group.gradient.pack"),U=F("group.gradient"),c=F("group.gradient.color"),B=F("group.border.width"),g=F("group.border.color"),u=F("group.border.pattern"),Y=F("group.title.orientation"),y=F("group.depth");if(T){var I=i.lineJoin,h=i.lineCap;if(i.lineJoin=F("group.border.join"),i.lineCap=F("group.border.cap"),C){if(i.save(),gn(i,T,M),i.clip(),fh(i,C,k,M.x,M.y,M.width,M.height,V,e,o),i.restore(),B>0){var A=Pp(i,u);gn(A,T,M),i.lineWidth=B,i.strokeStyle=g,i.stroke(),Ve(i,u)}}else{var A=Pp(i,u);v||m||q?(gn(i,T,M),q?Af(i,q):m?Un(i,m,o,null,V,e):Dl(i,v,U,c,M),i.fill(),q&&i.restore(),i!==A&&gn(A,T,M)):gn(A,T,M),B>0&&(i.lineWidth=B,i.strokeStyle=F("group.border.color"),i.stroke()),Ve(i,u),T===Ej&&hg(i,v,y,M)}i.lineJoin=I,i.lineCap=h}else{var l=F("group.title.background"),R=F("group.border.radius");if(C)fh(i,C,k,S.x,S.y,S.width,S.height,V,e,z.getBodyColor());else if(v||m)if(m?Un(i,m,o,null,V,e):Dl(i,v,U,c,S),0===B)gn(i,Ej,S),i.fill(),hg(i,v,y,S);else{switch(i.beginPath(),Y){case nh:ff(i,S.x,S.y,S.width,S.height,R,R,0,0);break;case nk:ff(i,S.x,S.y,S.width,S.height,0,R,0,R);break;case yq:ff(i,S.x,S.y,S.width,S.height,R,0,R,0);break;case hk:ff(i,S.x,S.y,S.width,S.height,0,0,R,R)}i.fill()}if(E&&l)if(0===B)On(i,E.x,E.y,E.width,E.height,l),hg(i,l,y,E);else{switch(i.beginPath(),i.fillStyle=l,Y){case nh:ff(i,E.x,E.y,E.width,E.height,0,0,R,R);break;case nk:ff(i,E.x,E.y,E.width,E.height,R,0,R,0);break;case yq:ff(i,E.x,E.y,E.width,E.height,0,R,0,R);break;case hk:ff(i,E.x,E.y,E.width,E.height,R,R,0,0)}i.fill()}if(B>0){var A=Pp(i,u);if(gn(A,"roundRect",M,R),i.lineWidth=B,i.strokeStyle=g,E&&F("group.splitLine")){var N=E.x,W=E.y,x=E.width,H=E.height;Y===nh?(i.moveTo(N,W),i.lineTo(N+x,W)):Y===nk?(i.moveTo(N+x,W),i.lineTo(N+x,W+H)):Y===yq?(i.moveTo(N,W),i.lineTo(N,W+H)):(i.moveTo(N,W+H),i.lineTo(N+x,W+H))}i.stroke(),Ve(i,u)}}z._39O(i,b)}else rc.superClass._80o.call(z,i)}});var Sd=function(d,t){ef(Sd,this,[d,t])};xk(Sd,Lr,{_80o:function(X){this._39O(X,this._83o)}});var jq=function(I,O){ef(jq,this,[I,O])};xk(jq,Lr,{_3O:function(){var U=this,m=U._data,O=U.s,b=U.gv,I=m.getPoints(),N=b.getBorderColor(m),G=N?O("border.width"):0,z=U.getSelectWidth(),B=O("shape.border.width"),C=m.getRect(),H=m.getAnchorRect(),_=b.getBodyColor(m),D=U._99o=I.isEmpty()?u:{rect:C,rotation:m.getRotation(),fillRule:O("shape.fill.rule"),scale:m.getScale(),position:m.p(),points:I,segments:m.getSegments(),bodyColor:_,borderColor:N,borderWidth:G,_94o:O("shape.border.3d"),_95o:O("shape.border.3d.color"),_96o:O("shape.border.3d.accuracy"),_97o:z?U.getSelectColor():u,selectWidth:z,_53o:O("shape.background"),_27Q:Hi(O("shape.repeat.image"),_),shapeGradientPack:O("shape.gradient.pack"),_54o:B,_55o:O("shape.border.color"),shapeGradient:O("shape.gradient"),_59o:O("shape.gradient.color"),_60o:O("shape.border.pattern"),_61o:O("shape.border.cap"),_62o:O("shape.border.join"),shapeForeground:O("shape.foreground"),gray:O("2d.gray")};if(D){H.x+=D.position.x,H.y+=D.position.y,D.gradientRect=H;var a=m.getScale(),n=l(1,l(k(a.x),k(a.y)));O("shape.dash")&&O("shape.dash.width")>B&&(B=O("shape.dash.width"));var v=B*("square"===D._61o?.71:.5)+G+z/U.gv._zoom/n;v&&(v*=n,C=Qb(C),Fe(C,v,D._62o)),U._68o(C);var A=O("clip.percentage");1>A&&(0>A&&(A=0),D.clipRect=zp(m.getAnchorRect(),O("clip.direction"),A));var L=O("shape.fill.clip.percentage");1>L&&(0>L&&(L=0),D.shapeClipRect=zp(m.getAnchorRect(),O("shape.fill.clip.direction"),L));var j=O("shape.foreground.clip.percentage");1>j&&(0>j&&(j=0),D.shapeForegroundClipRect=zp(m.getAnchorRect(),O("shape.foreground.clip.direction"),j))}},getPosition:function(m,i,E,K){var X=this._99o;if(X){var V=Eg(m,X.rect,K);return V.x+=i,V.y+=E,V}return Wi},_42:function(k){this._99o&&jq.superClass._42.call(this,k)},_80o:function(m){var e,G=this,A=G.s,y=G._99o,V=y.position,t=y.scale,n=y.rotation,r=y.borderWidth,l=y.selectWidth/G.gv._zoom,H=y._27Q,Q=y.shapeGradientPack,g=y._54o,Y=y.clipRect,C=y.shapeClipRect,f=y.points,N=y.segments,I=G._data.isClosePath(),O=y.fillRule,L=y.gray,p=function(W){return L?U.toGrayColor(W):W},M=p(y._53o),z=M||H||Q;m.save(),vk(m,V.x,V.y),ts(m,n),Zo(m,t.x,t.y),Y&&(m.beginPath(),m.rect(Y.x,Y.y,Y.width,Y.height),m.clip()),z&&C&&(m.save(),m.beginPath(),m.rect(C.x,C.y,C.width,C.height),m.clip()),vk(m,-V.x,-V.y);var E=y._60o,s=Pp(m,E),d=m.lineJoin,x=m.lineCap;m.lineJoin=y._62o,m.lineCap=y._61o;var T=p(y.bodyColor);z?(mm(m,f,N,I),Q?Af(m,Q):H?Un(m,H,T,null,G._data,G.gv):(e=T?T:M,Dl(m,e,y.shapeGradient,p(y._59o),y.gradientRect)),m.fill(O),C&&(m.restore(),vk(m,-V.x,-V.y)),Q&&m.restore(),s!==m&&mm(s,f,N,I)):mm(s,f,N,I);var X=y.shapeForeground;if(X){m.save();var b=y.shapeForegroundClipRect;b&&(vk(m,V.x,V.y),m.beginPath(),m.rect(b.x,b.y,b.width,b.height),m.clip(),vk(m,-V.x,-V.y)),mm(m,f,N,I),Dl(m,X,A("shape.foreground.gradient"),p(A("shape.foreground.gradient.color")),y.gradientRect),m.fill(O),m.restore()}var S=A("shape.border.width.absolute");if(S&&(m.save(),m.setTransform(1,0,0,1,0,0)),l&&(m.strokeStyle=y._97o,m.lineWidth=g+2*(r+l),m.stroke()),r&&(m.strokeStyle=p(y.borderColor),m.lineWidth=g+2*r,m.stroke()),g&&(e=p(y._55o),!M&&T&&(e=T),m.strokeStyle=e,m.lineWidth=g,m.stroke(),y._94o&&Zn(m,e,p(y._95o),g,G.gv._zoom,y._96o)),S&&m.restore(),Ve(m,E),A("shape.dash")){var K=A("shape.dash.width")||g;if(K>0){E=A("shape.dash.pattern");var s=Pp(m,E,G._2Q("shape.dash.offset"));s!==m&&mm(s,f,N,I),G._1Q(m,"shape",K,E)}}m.lineJoin=d,m.lineCap=x,m.restore()},_48O:function(){},_47O:function(){}});var Ye=function(I,x){ef(Ye,this,[I,x])};xk(Ye,jq,{getRotation:function(w,a,u){w=w||0;var T=this._data.getPoints(),C=T.size();return C>1?gc[u]?C&&0===C%2?Hk(T.get(C/2-1),T.get(C/2),a,w):w:rf[u]?Hk(T.get(0),T.get(1),a,w):Hk(T.get(C-2),T.get(C-1),a,w):w},getPosition:function(f,e,t,P,h){var U=this._data.getPoints(),H=U.size();if(H>1){if(gc[f]){var V=H%2;if(0===V)return Vo(U.get(H/2-1),U.get(H/2),f,e,t,P,h);var Z=U.get((H-V)/2),F={x:Z.x,y:Z.y,width:0,height:0};return Z=Eg(f,F,P),Z.x+=e,Z.y+=t,Z}return rf[f]?Vo(U.get(0),U.get(1),f,e,t,P,h):Vo(U.get(H-2),U.get(H-1),f,e,t,P,h)}return Wi}});var Le=function(a,B){ef(Le,this,[a,B])};xk(Le,Lr,{_3O:function(){var f=this;Le.superClass._3O.call(f);var e=f.s,V=f._83o;f._82o=V.img||V.shape?u:{background:f.getBodyColor("grid.background"),depth:e("grid.depth"),rect:V.rect,_88o:e("grid.cell.depth"),cellBorderColor:e("grid.cell.border.color"),_89o:e("grid.row.count"),_90o:e("grid.column.count"),block:e("grid.block"),_91o:e("grid.block.color"),_92o:e("grid.block.padding"),_93o:e("grid.block.width")}},_80o:function(d){var m=this,r=m._82o;if(!r)return Le.superClass._80o.call(m,d),void 0;var K,W,u=m._data,U=r.background,M=r.rect,V=r.block,a=r._91o,f=r._92o,i=r._93o,A=r._88o,O=r.cellBorderColor,l=r._89o,n=r._90o;if(U)if(On(d,M.x,M.y,M.width,M.height,U),hg(d,U,r.depth,M),A)for(K=0;l>K;K++)for(W=0;n>W;W++)M=u.getCellRect(K,W),M&&hg(d,U,A,M);else if(O){for(d.beginPath(),K=0;l>K;K++)for(W=0;n>W;W++)M=u.getCellRect(K,W),M&&d.rect(M.x,M.y,M.width,M.height);d.strokeStyle=O,d.lineWidth=1,d.stroke()}if("h"===V)for(K=0;l>K;K++)M=Lj(u.getCellRect(K,0),u.getCellRect(K,n-1)),ce(M,f),ti(d,a,M.x,M.y,M.width,M.height,i);else if("v"===V)for(W=0;n>W;W++)M=Lj(u.getCellRect(0,W),u.getCellRect(l-1,W)),ce(M,f),ti(d,a,M.x,M.y,M.width,M.height,i);m._39O(d,m._83o)}});var Em=function(e,c){ef(Em,this,[e,c])};xk(Em,Lr,{_checkEmptyRect:!1,_81o:function(){var v=this._data,t=Em.superClass._81o.call(this),F=v.s("text");if(F!=u){var I,Z,j=v.s("text.font"),y=v.s("text.align"),h=v.s("text.vAlign"),f=Nh(j,F),g=f.width,B=f.height,A=v.getAnchor(),p=v.getWidth(),e=v.getHeight();"left"===y?I=-p*A.x:"center"===y?I=-p*A.x+(p-g)/2:"right"===y&&(I=p*(1-A.x)-f.width),"top"===h?Z=-e*A.y:"middle"===h?Z=-e*A.y+(e-B)/2:"bottom"===h&&(Z=e*(1-A.y)-f.height);var Y,W=v.getMatrix();if(Y=ys([W.tf(I,Z),W.tf(I+g,Z),W.tf(I+g,Z+B),W.tf(I,Z+B)]),t=Lj(t,Y),t&&v.s("text.shadow")){var P=Qb(t);P.x+=v.s("text.shadow.offset.x"),P.y+=v.s("text.shadow.offset.y"),ce(P,v.s("text.shadow.blur")),t=Lj(t,P)}}return t}});var on=cm.Interactor=function(F){this.gv=this._graphView=F};nq("Interactor",b,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function($){this.gv.fi($)},setCursor:function(A){je||this.gv.setCursor(A)},startDragging:function(f){var $=this;$._lastClientPoint=Jl(f),$._lastLogicalPoint=$.gv.lp(f),Te($,f)},clearDragging:function(){var L=this;L._lastClientPoint=L._lastLogicalPoint=L._logicalPoint=u},autoScroll:function(w){return this.gv.autoScroll(w,this._lastClientPoint)}});var zr=u,hf=function(A){zr.handleWindowTouchMove(A)},rq=function(A){zr.handleWindowTouchEnd(A),M.removeEventListener(_i,hf,V),M.removeEventListener(uo,rq,V),zr=u},ji=function(U){zr.handleWindowMouseMove(U)},ci=function(I){zr.handleWindowMouseUp(I),M.removeEventListener(No,ji,V),M.removeEventListener(Xe,ci,V),zr=u},sc=function(W,S){W!==zr&&(zr?je?zr.handleWindowTouchEnd(S):zr.handleWindowMouseUp(S):je?(M.addEventListener(_i,hf,V),M.addEventListener(uo,rq,V)):(M.addEventListener(No,ji,V),M.addEventListener(Xe,ci,V)),zr=W)},kc=function(D){var O=this;O.gv=D,O._is2d=D instanceof cm.GraphView,O._is2d&&(O.filter=function(X){return D.isSelectable(X)&&D.isInteractive(X)}),D.getView(),["mousedown","mousemove","mouseleave","touchstart","touchmove",ne].forEach(function(f){O.addListener(f)}),O.initImageResource()};xk(kc,on,{enableVR:function(B){var c=this;if(!!c._vrEnable!==B)if(c._vrEnable=B,B)c.gv.vr.mp(c.onVRControllerChange,c);else if(c.gv.vr.ump(c.onVRControllerChange,c),c._vrRayPolyline){var Z=c.gv.dm();Z.remove(c._vrRayPolyline),Z.remove(c._vrRayHitPoint),c._vrRayPolyline=f,c._vrRayHitPoint=f}},onVRControllerChange:function(z){var I=this,T=z.property,w=z.newValue,D=I.gv.vr.getController(w.id),X=D.getRay();X&&("gamepad.button.trigger"===T?"down"===w._62O?I.handle_mousedown(X):I.handleWindowMouseUp(X):"gamepad.pose"===T&&(I.handle_mousemove(X),I.handleWindowMouseMove(X)))},drawVRRay:function(i,w,T){var D,$=this,A=$.gv,E=$._vrRayPolyline,H=!1;if(E)D=$._vrRayHitPoint;else{var r=A.dm();$._vrRayPolyline=E=new X.Polyline,$._vrRayHitPoint=D=new X.Node,D.s({shape3d:"billboard","shape3d.transparent":!0,"shape3d.texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),D.setAnchor3d(.5,.5,.499);var p=.2/A.vr.measureOflength;D.s3(p,p,p),E.s("intersect",!1),D.s("intersect",!1),r.add(E),r.add(D),H=!0}if(w){var y=T.world,s=T.worldNormal,O=y.x,V=y.y,G=y.z;E.s("shape.border.color","red"),E.setPoints([{x:i.origin.x,y:i.origin.z,e:i.origin.y},{x:O,y:G,e:V}]),D.s("3d.visible",!0),D.p3(O,V,G),D.lookAtDirection([s.x,s.y,s.z],"front")}else{E.s("shape.border.color","blue");var Z=new X.Math.Vector3;Z.copy(i.direction).setLength(1e3/$.gv.vr.measureOflength).add(i.origin),E.setPoints([{x:i.origin.x,y:i.origin.z,e:i.origin.y},{x:Z.x,y:Z.z,e:Z.y}]),D.s("3d.visible",!1)}A.fi({kind:"vrRayIntersect",ray:i,data:w,intersect:T,polyline:E,hitNode:D,begin:H})},addListener:function(f){var L=this;L.gv.getView().addEventListener(f,function(z){U.preventDefault(z),L.disabled||L["handle_"+f](z)},V)},handleWindowTouchMove:function(m){this.handleWindowMouseMove(m)},handleWindowMouseMove:function(n){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",n):(this.handleDownInfo("onBeginDrag",n),this.isDragging=!0))},handleWindowTouchEnd:function(k){this.handleWindowMouseUp(k)},handleWindowMouseUp:function(Y){if(this.isDragging&&(this.handleDownInfo("onEndDrag",Y),this.isDragging=!1),this.downInfo){var V=this.handle("onUp",Y);if(V&&V.data===this.downInfo.data){this.handleMissingUp(Y);var M=this,F=2===Y.button?"onContextMenu":"onClick";if(!M._dbclickTimer)return M._dbclickTimer=i(function(){delete M._dbclickTimer,M.handleClick(Y,F,V),this.downInfo=u},U.clickDelay),void 0;_(M._dbclickTimer),delete M._dbclickTimer,F="onDoubleClick",M.handleClick(Y,F,V)}else this.handleDownInfo("onUp",Y);this.downInfo=u}},handle_mouseleave:function(H){var L=this,O=L.gv,R=L.currentInfo?L.currentInfo.data:u;if(R){R.s("onLeave")&&R.s("onLeave")(H,R,O),L.fire("data","onLeave",H,R);var f=L.currentInfo?L.currentInfo.hits:u;if(f)for(var x in f)L.handleLeave(H,x);L.currentInfo=u}},handle_mousewheel:function(E){E.scrollDelta=E.wheelDelta/40,this.handle("onScroll",E)},handle_DOMMouseScroll:function(m){m.scrollDelta=2===m.axis?-m.detail:0,this.handle("onScroll",m)},handle_touchstart:function(h){this.handle_mousedown(h)},handle_touchmove:function(I){this.handle("onMove",I)},handle_mousedown:function(c){this.isDragging&&(this.handleDownInfo("onEndDrag",c),this.isDragging=!1),this.downInfo=this.handle("onDown",c),this.downInfo&&sc(this,c)},handle_mousemove:function($){var w=this,W=w.gv;w._hoverTimer&&(_(w._hoverTimer),delete w._hoverTimer);var k,m,d,t=w.handle("onMove",$),J=this.currentInfo?this.currentInfo.data:u,v=this.currentInfo?this.currentInfo.hits:u;if(t&&(m=t.data,d=t.hits,w._hoverTimer=i(function(){_(w._hoverTimer),delete w._hoverTimer,w.handle("onHover",$,t)},W.getHoverDelay()||U.hoverDelay)),m!==J){if(J&&(J.s("onLeave")&&J.s("onLeave")($,J,W),this.fire("data","onLeave",$,J)),m&&(m.s("onEnter")&&m.s("onEnter")($,m,W),this.fire("data","onEnter",$,m)),v)for(k in v)this.handleLeave($,k);if(d)for(k in d){var h=d[k];h.target.onEnter&&h.target.onEnter($,m,W,h.point,h.width,h.height),this.fire(h.type,"onEnter",h.event,h.data,h.image,h.comp,h.point,h)}}else{if(v)for(k in v)d&&d[k]||this.handleLeave($,k);if(d)for(k in d)if(!v||!v[k]){var h=d[k];h.target.onEnter&&h.target.onEnter($,m,W,h.point,h.width,h.height),this.fire(h.type,"onEnter",h.event,h.data,h.image,h.comp,h.point,h)}}this.currentInfo=t},handle:function(k,R,t){var O,n=this,H=n.gv;if(n._is2d){if(t=t||H.getDataInfoAt(R,this.filter),!t)return;if(O=t.ui.interactiveInfo){var I,m=t.data;if(m.s(k)&&m.s(k)(R,m,H),this.fire("data",k,R,m),"body"===t.part&&O.bodyInfo)I="body",t.hits=this.handleImage(I,H.getImage(m),k,R,m,t.point,O.bodyInfo);else if("icons"===t.part&&O._38o){var q=O._38o[t.name];q&&q[t.index]&&(I="icons|"+t.name+"|"+t.index,t.hits=this.handleImage(I,t.icon,k,R,m,t.point,q[t.index]))}}return t}var m,V;if(!t)if(R&&R instanceof X.Math.Ray){var s=H.vr.intersectWorld(R);if(m=s.data,V=s.intersect,n.drawVRRay(R,m,V),!m)return;var u=H.getData3dUI(m);if(O=u.interactiveInfo,!O)return;t={data:m,part:V.part,ui:u}}else{if(t=H.getDataInfoAt(R),!t)return;t&&(t={data:t.data,part:t.part})}if(!V){m=t.data;var u=H.getData3dUI(m);if(t.ui=u,O=u.interactiveInfo,!O)return t;if(V=H.intersectObject(R,m),!V)return}m.s(k)&&m.s(k)(R,m,H),this.fire("data",k,R,m);var B,K=V.part;return"body"!==K&&(B=m.s(K+".image")||m.s("shape3d."+K+".image")),B||(B=m.s("all.image")||m.s("shape3d.image")),O="object"==typeof B?O[B.uuid]:O[B],O&&O.bodyInfo?(t.part="body",t.interactiveInfo=O,t.point=V.uv.multiply({x:O.bodyInfo.rect.width,y:O.bodyInfo.rect.height}),t.image=B,t.hits=this.handleImage("body",B,k,R,m,t.point,O.bodyInfo),t):t},_handleLeaveOrMissing:function(Q,p,E){var H="leave"===Q?this.currentInfo:this.downInfo;if(H){var e=H.interactiveInfo||H.ui.interactiveInfo;if(e){var F,v,x=H.data;if(this._is2d){if(v=this.gv.lp(p),"body"===H.part&&e.bodyInfo)F="body","leave"===Q?this.handleLeaveImage(E,F,this.gv.getImage(x),p,x,v,e.bodyInfo):this.handleMissingUpImage(F,this.gv.getImage(x),p,x,v,e.bodyInfo);else if("icons"===H.part&&e._38o){var t=e._38o[H.name];t&&t[H.index]&&(F="icons|"+H.name+"|"+H.index,"leave"===Q?this.handleLeaveImage(E,F,H.icon,p,x,v,t[H.index]):this.handleMissingUpImage(F,H.icon,p,x,v,t[H.index]))}}else{if(!e.bodyInfo)return;var d=this.gv.intersectObject(p,x);v=d?d.uv.multiply({x:e.bodyInfo.rect.width,y:e.bodyInfo.rect.height}):{x:1/0,y:1/0},"leave"===Q?this.handleLeaveImage(E,"body",H.image,p,x,v,e.bodyInfo):this.handleMissingUpImage("body",H.image,p,x,v,e.bodyInfo)}}}},handleClick:function(U,_,L){var t=this,R=this.downInfo;if(R&&L){var i,e=L.interactiveInfo||L.ui.interactiveInfo,G=L.data,g=this.gv;if(G.s(_)&&G.s(_)(U,G,g),t.fire("data",_,U,G),e)if(this._is2d){if(R.part===L.part){var W=g.lp(U);"body"===L.part&&e.bodyInfo&&(i="body",this.handleClickImage(i,g.getImage(G),_,U,G,W,e.bodyInfo,L))}}else{if(!e.bodyInfo)return;var I=g.intersectObject(U,G);if(!I)return;W=I.uv.multiply({x:e.bodyInfo.rect.width,y:e.bodyInfo.rect.height}),this.handleClickImage("body",R.image,_,U,G,W,e.bodyInfo,L)}}},handleDownInfo:function(A,R){if(this.downInfo){var u=this.downInfo,n=this.gv,M=u.interactiveInfo||u.ui.interactiveInfo;if(M){var b,h=u.data;if(h.s(A)&&h.s(A)(R,h,n),this.fire("data",A,R,h),this._is2d){var a=n.lp(R);if("body"===u.part&&M.bodyInfo)b="body",this.handleDownInfoImage(b,n.getImage(h),A,R,h,a,M.bodyInfo);else if("icons"===u.part&&M._38o){var B=M._38o[u.name];B&&B[u.index]&&(b="icons|"+u.name+"|"+u.index,this.handleDownInfoImage(b,u.icon,A,R,h,a,B[u.index]))}}else{if(!M.bodyInfo)return;var v=n.intersectObject(R,h);if(!v)return;a=v.uv.multiply({x:M.bodyInfo.rect.width,y:M.bodyInfo.rect.height}),this.handleDownInfoImage("body",u.image,A,R,h,a,M.bodyInfo)}}}},fire:function(V,O,Q,S,Z,E,F,Y){this.gv.fi({kind:O,type:V,event:Q,data:S,image:Z,comp:E,view:this.gv,point:F,width:Y?Y.width:f,height:Y?Y.height:f})},handleImage:function(z,W,k,u,d,b,h){var p={};if(W&&(W=Hi(W))){var I=this.gv,r=h.rect,v=this.convertPoint(b,h);v.inRect&&(W[k]&&W[k](u,d,I,v,r.width,r.height),this.fire("image",k,u,d,W,f,v,r),p[z+"|image"]={target:W,type:"image",image:W,data:d,event:u,point:v,width:r.width,height:r.height});for(var P=h.compInfos,x=W,L=P.length-1;L>=0;L--){var H=P[L],Q=H.comp;v=this.convertPoint(b,H,x,Q,I,d),v.inRect&&(r=H.rect,Q[k]&&Q[k](u,d,I,v,r.width,r.height),this.fire("comp",k,u,d,W,Q,v,r),(W=r.image)&&(W[k]&&W[k](u,d,I,v,r.width,r.height),this.fire("image",k,u,d,W,f,v,r)),p[z+"|"+L]={target:Q,type:"comp",comp:Q,image:W,data:d,event:u,point:v,width:r.width,height:r.height},W&&(p[z+"|"+L+"|image"]={target:W,type:"image",image:W,data:d,event:u,point:v,width:r.width,height:r.height}))}}return p},handleLeave:function(c,K){return this._handleLeaveOrMissing("leave",c,K)},handleMissingUp:function(e){return this._handleLeaveOrMissing("missing",e)},handleLeaveImage:function(m,t,b,z,M,c,k){if(b&&(b=Hi(b))){var h=this.gv,p=k.rect,Z=this.convertPoint(c,k);m===t+"|image"&&(b.onLeave&&b.onLeave(z,M,h,Z,p.width,p.height),this.fire("image","onLeave",z,M,b,f,Z,p));for(var n=k.compInfos,y=b,d=n.length-1;d>=0;d--){var l=n[d],x=l.comp;Z=this.convertPoint(c,l,y,x,h,M),p=l.rect,m===t+"|"+d&&(x.onLeave&&x.onLeave(z,M,h,Z,p.width,p.height),this.fire("comp","onLeave",z,M,b,x,Z,p)),(b=p.image)&&m===t+"|"+d+"|image"&&(b.onLeave&&b.onLeave(z,M,h,Z,p.width,p.height),this.fire("image","onLeave",z,M,b,f,Z,p))}}},handleMissingUpImage:function(K,B,N,P,g,O){var A="onUp",$=this.downInfo.hits;if($&&B&&(B=Hi(B))){var v=this.gv,G=O.rect,J=this.convertPoint(g,O);!J.inRect&&$[K+"|image"]&&(B[A]&&B[A](N,P,v,J,G.width,G.height),this.fire("image",A,N,P,B,f,J,G));for(var V=O.compInfos,E=B,I=V.length-1;I>=0;I--){var y=V[I],T=y.comp;J=this.convertPoint(g,y,E,T,v,P),J.inRect||(G=y.rect,$[K+"|"+I]&&(T[A]&&T[A](N,P,v,J,G.width,G.height),this.fire("comp",A,N,P,B,T,J,G)),(B=G.image)&&$[K+"|"+I+"|image"]&&(B[A]&&B[A](N,P,v,J,G.width,G.height),this.fire("image",A,N,P,B,f,J,G)))}}},handleDownInfoImage:function(S,u,d,K,q,R,Y){var P=this.downInfo.hits;if(P&&u&&(u=Hi(u))){var l=this.gv,e=Y.rect,D=this.convertPoint(R,Y);P[S+"|image"]&&(u[d]&&u[d](K,q,l,D,e.width,e.height),this.fire("image",d,K,q,u,f,D,e));for(var i=Y.compInfos,w=u,j=i.length-1;j>=0;j--){var V=i[j],J=V.comp;D=this.convertPoint(R,V,w,J,l,q),e=V.rect,P[S+"|"+j]&&(J[d]&&J[d](K,q,l,D,e.width,e.height),this.fire("comp",d,K,q,u,J,D,e)),(u=e.image)&&P[S+"|"+j+"|image"]&&(u[d]&&u[d](K,q,l,D,e.width,e.height),this.fire("image",d,K,q,u,f,D,e))
}}},handleClickImage:function(z,w,D,E,c,B,O,Q){var r=this.downInfo.hits,k=Q.hits;if(r&&w&&(w=Hi(w))){var m=this.gv,M=O.rect,P=this.convertPoint(B,O);r[z+"|image"]&&(w[D]&&w[D](E,c,m,P,M.width,M.height),this.fire("image",D,E,c,w,f,P,M));for(var y=O.compInfos,R=w,Y=y.length-1;Y>=0;Y--){var h=y[Y],l=h.comp;P=this.convertPoint(B,h,R,l,m,c),M=h.rect,r[z+"|"+Y]&&k[z+"|"+Y]&&(l[D]&&l[D](E,c,m,P,M.width,M.height),this.fire("comp",D,E,c,w,l,P,M)),(w=M.image)&&r[z+"|"+Y+"|image"]&&(w[D]&&w[D](E,c,m,P,M.width,M.height),this.fire("image",D,E,c,w,f,P,M))}}},initImageResource:function(){U.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},convertPoint:function(O,z,I,C,N,l){var P=z.rect,v=z.matrix.applyInverse(O).sub(P),r=v.x>=0&&v.y>=0&&v.x<=P.width&&v.y<=P.height;if(!r)return v;if(C&&wq(C.pixelPerfect,l,N)){var P,H=1;this._is2d?(H=N.getZoom(),P=qp(O.x,O.y,f,H)):P=qp(O.x,O.y);var Y=!1,Q=P.x,j=P.y,R=P.width,g=P.height,B=U.hitMaxArea,J=R*g*H*H;if(J>B){var e=Math.sqrt(B/J);H*=e}R*=H,g*=H,2>R&&(R=2),2>g&&(g=2),Q*=H,j*=H;var X=Jc(R,g),m=new Vg(0,-Q,-j,H,H);m.append(z.matrix),N._drawForChecking=!0,C.transform=m;var D=I.comps;I.comps=[C],Fp(X,I,0,0,R,g,l,self),I.comps=D,delete C.transform,N._drawForChecking=!1;try{for(var E=0,k=X.getImageData(0,0,R,g).data;E<k.length;E+=4)if(0!==k[E+3]){Y=!0;break}X.restore()}catch($){vh=u,Y=!1}v.inRect=Y}else v.inRect=!0;return v}});var Ek=cm.DefaultInteractor=function(E){ef(Ek,this,[E])};nq("DefaultInteractor",on,{handle_mousedown:function(D){wb(D);var k=this,R=k.gv,f=R.getDataAt(D);if(R.setFocus(D)&&!R._editing&&!R._scrolling){Ar(D)?R.handleDoubleClick(D,f):R.handleClick(D,f);var Y=Gh(D);!Db()&&!Y&&f&&(R.isMovable(f)||R.isInteractive(f))||!R.isPannable()||!js(D)&&!Y||Be(D)||(k._tx=R.tx(),k._ty=R.ty(),k.startDragging(D))}},handleWindowMouseUp:function(S){var u=this,F=u.gv;F._panning&&(delete F._panning,F.onPanEnded(),u.fi({kind:"endPan",event:S})),delete u._tx,delete u._ty,u.clearDragging()},handle_mousemove:function(k){var X=this,w=X.gv;X._hoverTimer&&(_(X._hoverTimer),delete X._hoverTimer),X._hoverTimer=i(function(){X.fi({kind:"hover",event:k}),_(X._hoverTimer),delete X._hoverTimer},w.getHoverDelay()||U.hoverDelay)},handle_touchmove:function(F){this.handle_mousemove(F)},handleWindowMouseMove:function(v){var Z=this,E=Z.gv;Z.fi({kind:E._panning?"betweenPan":"beginPan",event:v}),E._panning=1;var C=fo(E,v,Z._lastClientPoint);E.setTranslate(Z._tx+C.x,Z._ty+C.y)},handle_mousewheel:function(l){this.gv.handleScroll(l,l.wheelDelta)},handle_DOMMouseScroll:function(p){2===p.axis&&this.gv.handleScroll(p,-p.detail)},handle_keydown:function(E){this.gv.handleKeyDown(E)}});var Ac=cm.SelectInteractor=function(b){ef(Ac,this,[b])};nq("SelectInteractor",on,{_42:function(){var n=this,l=n.gv,G=l.getZoom(),x=n.mark,F=n.div;F||(F=n.div=rp(),qr(n.getView(),F));var p={};p.x=x.x*G+l.tx(),p.y=x.y*G+l.ty(),p.width=x.width*G,p.height=x.height*G,Ji(F,p),this.intersects()?(F.style.border="",F.style.background=l.getRectSelectBackground()):(F.style.background="",F.style.border="1px solid "+l.getRectSelectBorderColor())},handle_mousedown:function(O){var v=this,s=v.gv;if(v._57I=u,v.pendingClickThrough=u,!(s._editing||s._scrolling||Db()||Gh(O))){var t=s.getDataAt(O),R=s.sm();t?Be(O)?R.co(t)?R.rs(t):R.as(t):R.co(t)?t instanceof ls&&t.isClickThroughEnabled()&&js(O)&&(v.pendingClickThrough=Jl(O)):R.ss(t):Be(O)||!s.isPannable()?js(O)&&(Be(O)||R.cs(),s.isRectSelectable()&&(v.startDragging(O),s._77O=1)):js(O)&&(v._57I=Jl(O))}},handle_mouseup:function(R){var L=this,D=L.gv,Q=L._57I;if(Q&&(Di(Q,Jl(R))<=1&&D.sm().cs(),L._57I=u),L.pendingClickThrough){if(Di(L.pendingClickThrough,Jl(R))<=1){var I=D.getDataAt(R);if(I instanceof ls&&I.isClickThroughEnabled()){var i=D.getDataAt(R,function(p){var w=p.getParent()===I&&D.isSelectable(p,!0);return w});i&&(R.clickThrough=!0,D.sm().ss(i))}}L.pendingClickThrough=u}},handleWindowMouseUp:function($){this.clear($)},handleWindowMouseMove:function(E){var r=this,D=r.gv;r._logicalPoint=D.lp(E),r.mark?(r.fi({kind:"betweenRectSelect",event:E}),D.isPannable()&&r.autoScroll(E),r.redraw()):r.fi({kind:"beginRectSelect",event:E}),r.mark=ys(r._lastLogicalPoint,r._logicalPoint),r.redraw()},intersects:function(){var Q=this,q=Q._lastLogicalPoint,W=Q._logicalPoint;return q.x>W.x||q.y>W.y},clear:function(L){var T=this,n=T.gv,z=T.mark;if(T._57I=u,T.pendingClickThrough=u,T._lastLogicalPoint){if(z){if(0!==z.width&&0!==z.height){var R=n.getDatasInRect(z,T.intersects());if(!R.isEmpty()){var e=n.sm(),D=e.toSelection();R.each(function($){e.co($)?D.remove($):D.add($)}),e.ss(D)}}mp(T.div),delete T.div,delete T.mark,T.redraw(),T.fi({kind:"endRectSelect",event:L}),n.onRectSelectEnded()}T.clearDragging(),delete n._77O}},redraw:function(){var X=this;X._draw||(X._draw=1,i(function(){X.mark&&X._42(),delete X._draw},16))}});var af=cm.MoveInteractor=function(V){ef(af,this,[V])};nq("MoveInteractor",on,{handle_mousedown:function(D){var g=this,p=g.gv;if(js(D)&&!p._editing&&!p._scrolling&&!Db()){var X=p.getSelectedDataAt(D);!X||p.isInteractive(X)&&!p.isMovable(X)?p._focusData=u:(g._data=X,p.handleMouseDown&&p.handleMouseDown(D,X),g.startDragging(D),p.isMovable(X)&&(p._moving=1))}},handleWindowMouseUp:function(a){var n=this,e=n.gv;e.handleMouseUp&&e.handleMouseUp(a,n._data),n.clear(a)},handleWindowMouseMove:function(x){var j=this,N=j._data,X=j.gv;if((!X._93O||!X._93O(x,N))&&X._moving){j._logicalPoint||j.fi({kind:"prepareMove",event:x});var y=j._logicalPoint?"betweenMove":"beginMove",m={kind:y,event:x},p=j._logicalPoint=X.lp(x);"beginMove"!==y||j._alreadyBeginTransaction||(j._alreadyBeginTransaction=!0,X.getDataModel().beginTransaction());var Y=j._calcShift(y,x),h=Y.x,G=Y.y,M=j.gv.getMoveMode(x,N);M&&("x"===M?G=0:"y"===M?h=0:"xy"!==M&&(h=G=0)),X.moveSelection(h,G),j._lastLogicalPoint=p,j.autoScroll(x),j.fi(m)}},_calcShift:function(){var Q=this,i=Q._logicalPoint,w=Q._lastLogicalPoint,h=i.x-w.x,C=i.y-w.y;return{x:h,y:C}},clear:function(w){var P=this,n=P.gv;P._lastLogicalPoint&&(P._lastLogicalPoint=P._data=n._moving=u,P._logicalPoint&&(P.fi({kind:"endMove",event:w}),n.onMoveEnded()),P.clearDragging()),P._alreadyBeginTransaction&&(P._alreadyBeginTransaction=!1,n.getDataModel().endTransaction())}});var Kq=cm.TextEditInteractor=function(p){ef(Kq,this,[p]),this.init()};nq("TextEditInteractor",on,{init:function(){var l=this,Q=this.input=Y.createElement("input"),T=Q.style;Q.text="text",T.border="1px solid #d8d8d8",T.position="absolute",T.padding="2px 3px",T.outline="none",T.marginLeft="-90px",T.marginTop="-16px",T.backgroundColor="rgba(255,255,255, 0.9)",T.fontSize="14px",T.width="180px",T.height="32px",T.boxShadow="0 0 13px rgba(16,142,233, 0.5)",T.textAlign="center",T.boxSizing="border-box",Q.addEventListener("keyup",function(b){Wp(b)&&l.endTextEdit()}),Q.addEventListener("focus",function(){Q.select()});var X=this.textarea=Y.createElement("textarea"),W=this.wrap=Y.createElement("div");W.appendChild(X),T=X.style,T.margin=0,T.padding="4px",T.overflow="hidden",T.boxSizing="border-box",T.position="absolute",T.outline="none",T.backgroundColor="transparent",T.resize="none",T.textAlign="center",T.fontSize="14px",T.border="none",T.borderWidth=0,T.width="100%",T.top="50%",T=W.style,T.boxSizing="border-box",T.margin=0,T.padding=0,T.position="absolute",T.boxShadow="0 0 13px rgba(16,142,233, 0.5)",T.border="1px solid #d8d8d8",T.backgroundColor="rgba(255,255,255, 0.9)",T.width="180px",T.marginLeft="-90px",X.addEventListener("keydown",function(P){return(xd()||Be())&&Wp(P)?(l.endTextEdit(),void 0):(l.calculateTextareaHeight(String.fromCharCode(P.keyCode)),void 0)}),X.addEventListener("focus",function(){X.select()});var A=function(b){b.stopPropagation()};Q.addEventListener("mousedown",A),Q.addEventListener("touchstart",A),X.addEventListener("mousedown",A),X.addEventListener("touchstart",A),l.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],l.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",l.handleWindowClick=function(K){var f=l._editingDOM,R=f.getBoundingClientRect(),M=Jl(K);oj(R,M)||l.endTextEdit()}},handle_mousedown:function(j){var H=this,G=H.gv;if(Ar(j)&&!G._editing){var t=G.getDataAt(j);if(t){var O=G.getTextEditInfo(t);O&&(this._editInfo=O,this._editTarget=t,G._editing=!0,O.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var S=this,Z=S.gv,F=S._editTarget,d=S.getTargetValue(),t=S.textarea,g=S.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===d||d===f)&&(d=""),t.value=d,S._editingDOM=t,Z.getView().appendChild(g),this.layoutHTML(g,F),this.calculateTextareaHeight(),i(function(){t.focus(),M.addEventListener("mousedown",S.handleWindowClick),M.addEventListener("touchstart",S.handleWindowClick)},10)},handleTextEdit:function(){var F=this,o=F.gv,u=F._editTarget,q=F.getTargetValue(),z=F.input;(null===q||q===f)&&(q=""),z.value=q,F._editingDOM=z,o.getView().appendChild(z),this.layoutHTML(z,u),i(function(){z.focus(),M.addEventListener("mousedown",F.handleWindowClick),M.addEventListener("touchstart",F.handleWindowClick)},10)},layoutHTML:function(C,h){var $=this.gv,W=$.getZoom();if(h instanceof X.Node){var m=h.getRect();C.style.left=(m.x+m.width/2)*W+$.tx()+"px",C.style.top=(m.y+m.height/2)*W+$.ty()+"px"}else if(h instanceof X.Edge){var u=$.getDataUI(h),m=u._6I;C.style.left=(m.x+m.width/2)*W+$.tx()+"px",C.style.top=(m.y+m.height/2)*W+$.ty()+"px"}},endTextEdit:function(){var r=this,b=r._editInfo.isMultiline?r.wrap:r.input,L=r._editInfo.isMultiline?r.textarea:r.input;r.setTargetValue(L.value),r.gv.getView().removeChild(b),r.gv._editing=!1,delete r._editingDOM,M.removeEventListener("mousedown",r.handleWindowClick),M.removeEventListener("touchstart",r.handleWindowClick)},setTargetValue:function(m){var I=this,s=I._editTarget,q=I._editInfo,A=q.accessType,f=q.name;if(f&&A||(A="p",f="name"),"p"===A){var c=X.Default.setter(f);s[c](m)}else"a"===A?s.a(f,m):s.s(f,m)},getTargetValue:function(){var N=this,w=N._editTarget,I=N._editInfo,C=I.accessType,j=I.name;if(j&&C||(C="p",j="name"),"p"===C){var D=X.Default.getter(j);return w[D]()}return"a"===C?w.a(j):w.s(j)},createHiddenTextarea:function(){this.hiddenTextarea=Y.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(c,h){if(h&&this.computedStyleCache)return this.computedStyleCache;var K=this,A=M.getComputedStyle(c),d=A.getPropertyValue("box-sizing")||A.getPropertyValue("-moz-box-sizing")||A.getPropertyValue("-webkit-box-sizing"),o=parseFloat(A.getPropertyValue("padding-bottom"))+parseFloat(A.getPropertyValue("padding-top")),p=parseFloat(A.getPropertyValue("border-bottom-width"))+parseFloat(A.getPropertyValue("border-top-width")),F=K.SIZING_STYLE.map(function(X){return X+":"+A.getPropertyValue(X)}).join(";"),D={sizingStyle:F,paddingSize:o,borderSize:p,boxSizing:d};return h&&(this.computedStyleCache=D),D},calculateTextareaHeight:function(q){q=q||"";var z=this,a=z.textarea,x=z.hiddenTextarea,g=z.wrap,y=32,R=z.calculateHTMLStyle(a,!1),O=R.paddingSize,A=R.borderSize,f=R.boxSizing,S=R.sizingStyle;x.setAttribute("style",S+";"+z.HIDDEN_TEXTAREA_STYLE),x.value=a.value+q;var E=x.scrollHeight;"border-box"===f?E+=A:"content-box"===f&&(E-=O),a.style.height=E+"px",a.style.marginTop=0-.5*E+"px",g.style.height=Math.max(E,y)+"px",g.style.marginTop=E*-.5+"px"}});var _m=cm.ScrollBarInteractor=function(U){ef(_m,this,[U])};nq("ScrollBarInteractor",on,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(i){var O=this.gv.getViewRect();return this._41o()&&(O.x+O.width-this.gv.lp(i).x)*this.gv.getZoom()<zi},isH:function(M){var O=this.gv.getViewRect();return this._40o()&&(O.y+O.height-this.gv.lp(M).y)*this.gv.getZoom()<zi},handle_mousemove:function(y){this.handle_touchmove(y)},handle_touchmove:function(w){if(!eg&&js(w)&&this.gv.isScrollBarVisible()){var k=this,K=k.isV(w),x=k.isH(w);(K||x)&&k.gv.showScrollBar(),k.gv._scrolling=K||x}},handleWindowMouseUp:function(d){this.handleWindowTouchEnd(d)},handleWindowTouchEnd:function(i){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=u,this.fi({kind:"endScroll",event:i})},handle_mousedown:function(z){this.handle_touchstart(z)},handle_touchstart:function(H){var C=this;if(C.gv.setFocus(H),wb(H),C.handle_touchmove(H),!(Wg(H)>1)&&C.gv._scrolling&&C.gv.isScrollBarVisible()){C._cp=Jl(H),C._tx=C.gv.tx(),C._ty=C.gv.ty();var k=C.isV(H);C._state=k?"vScroll":"hScroll",Te(C,H),C.fi({kind:"beginScroll",event:H})}},handleWindowMouseMove:function(b){this.handleWindowTouchMove(b)},handleWindowTouchMove:function(o){var H=Jl(o),M=this.gv.getViewRect(),n=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-H.y)*n.height/M.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-H.x)*n.width/M.width),this.fi({kind:"betweenScroll",event:o})}});var uq=cm.TouchInteractor=function(r,h){h=h||{},h.selectable===f&&(h.selectable=!0),h.movable===f&&(h.movable=!0),h.pannable===f&&(h.pannable=!0),h.pinchable===f&&(h.pinchable=!0),h.editable===f&&(h.editable=!0),this.params=h,ef(uq,this,[r])};nq("TouchInteractor",on,{ms_edit:1,setUp:function(){var R=this;uq.superClass.setUp.call(R),je&&R.params.editable&&R.gv.setEditInteractor(R)},tearDown:function(){var Z=this;uq.superClass.tearDown.call(Z),je&&Z.params.editable&&Z.gv.setEditInteractor(u)},clear:function(J){var i=this,Z=i.gv;Z._moving&&(i.fi({kind:"endMove",event:J}),delete Z._moving,Z.onMoveEnded(),Z.dm().endTransaction()),Z._panning&&(i.fi({kind:"endPan",event:J}),delete Z._panning,Z.onPanEnded()),Z._pinching&&(i.fi({kind:"endPinch",event:J}),delete Z._pinching,Z.onPinchEnded()),Z._editing&&(i._46O(J),i._77I=i._node=i._edge=i._shape=i._rect=i._89I=i._index=Z._editing=u),i._moving=i._panning=i._pinching=i._editing=i._57I=i._data=i._beginHistory=u,i.clearDragging()},handle_touchstart:function(y){var s=this;if(!s.gv._editing){wb(y),s._57I=u;var N=s.params,g=s.gv,m=g.sm(),W=g.getDataAt(y),Z=Wg(y);if(1===Z){if(Ar(y))return g.handleDoubleClick(y,W),void 0;g.handleClick(y,W),W&&(g.handleMouseDown&&g.handleMouseDown(y,W),s._data=W),N.selectable||(W=u),W?(m.co(W)||m.ss(W),N.editable&&g.isEditable(W)&&s._79I(y,W,!0)?(s._editing=1,s.startDragging(y)):N.movable&&g.isMovable(W)&&(s._moving=1,s.startDragging(y))):(s._57I=Jl(y),N.pannable&&g.isPannable()&&(s._panning=1,s.startDragging(y),s._translate={x:g.tx(),y:g.ty()}))}else if(N.pinchable&&2===Z){s._pinching=1,s.startDragging(y);var I=g.getView(),z=g.getZoom(),f=I.getBoundingClientRect(),_=y.touches[0],H=y.touches[1],Y={x:(_.clientX+H.clientX)/2-f.left,y:(_.clientY+H.clientY)/2-f.top};Y.x-=g.tx(),Y.y-=g.ty(),Y.x/=z,Y.y/=z,s._p=Y,s._d=Hm(y)}}},handle_touchend:function(R){var e=this,c=e.gv,b=e._57I,A=e._data;b&&(Di(b,Jl(R))<=1&&c.sm().cs(),e._57I=u),A&&c.handleMouseUp&&c.handleMouseUp(R,A)},handleWindowTouchEnd:function(o){this.clear(o)},handleWindowTouchMove:function(u){var C=this,d=C.gv,W=Wg(u);if(1===W){if(C._editing&&(C._beginHistory||(C._beginHistory=1,d.dm().beginTransaction()),d._editing=1,C._78I(u)),C._moving)C._beginHistory||(C._beginHistory=1,d.dm().beginTransaction()),C.handleMove(u);else if(C._panning){var m=Jl(u),x=fo(d,m,C._lastClientPoint);d.setTranslate(C._translate.x+x.x,C._translate.y+x.y),C.fi({kind:d._panning?"betweenPan":"beginPan",event:u}),d._panning=1}}else if(2===W&&C._pinching){var E=Hm(u);d.handlePinch(C._p,E,C._d),C._d=E,C.fi({kind:d._pinching?"betweenPinch":"beginPinch",event:u}),d._pinching=1}},handleMove:function(j){var y=this,q=y.gv,h=q.lp(j);q._93O&&q._93O(j,y._data)||(q.moveSelection(h.x-y._lastLogicalPoint.x,h.y-y._lastLogicalPoint.y),y._lastLogicalPoint=h,y.autoScroll(j),y.fi({kind:q._moving?"betweenMove":"beginMove",event:j}),q._moving=1)}});var X=M.ht,zd=X.graph._editor={Math:X.Math,Guide:{}};zd.getStyle=function(h){var z,Y=zd.StyleMap;return Y&&(z=Y[h],z!==f)?z:zd.DefaultStyleMap[h]},zd.setStyle=function(N,I){var L=zd.StyleMap;L||(L=zd.StyleMap={}),L[N]=I},zd.inEdit=function(w){return w._inXEdit===!0},zd.startEdit=function(L){L._inXEdit=!0,zd.Inject.doInject(L)},zd._46O=function(S){S._inXEdit=!1,zd.Inject.undoInject(S)},zd.toScreenPosition=function(Z,z){var S=Z.tx(),G=Z.ty(),$=Z._zoom;return new zd.Math.Vector2(z.x*$+S,z.y*$+G)},zd.checkHit=function(a,m,Q){return a.distanceTo(m)<Q?!0:!1},zd.toWorldPosition=function(d,X){var Q=d.tx(),N=d.ty(),Z=d._zoom;return{x:(X.x-Q)/Z,y:(X.y-N)/Z}},zd.setAntialias=function(_,G){for(var b,W=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],L=0,g=W.length;g>L&&(b=W[L],!(b in _));L++);_[b],_[b]=G},zd.getTargetCornersOnScreen=function(V,v){if(!v)return null;var L,r=[];if(Dk(v,V)){var h=wo(V,v);L=[{x:h.x,y:h.y},{x:h.x+h.width,y:h.y},{x:h.x+h.width,y:h.y+h.height},{x:h.x,y:h.y+h.height}]}else{if(!v.getCorners)return null;L=v.getCorners()}return L.forEach(function(U){var G=zd.toScreenPosition(V,U);r.push(G.x,G.y)}),r},zd.log=function(){};var Vh=zd.Inject={_modules:[]};Vh.registAsModule=function(K,E){var k={},C={};for(var r in K){var n=E.prototype[r];k[r]=n}K.getBackup=function(M){return k[M]},K.getBackups=function(){return k},C.doInject=function(){for(var r in K)"getBackup"!==r&&(E.prototype[r]=K[r])},C.undoInject=function(){for(var D in K)"getBackup"!==D&&(E.prototype[D]=k[D])},Vh._modules.push(C)},Vh.doInject=function(t){for(var I,z=Vh._modules,e=0,Y=z.length;Y>e;e++)I=z[e],I.doInject(t)},Vh.undoInject=function(Y){for(var Z,T=Vh._modules,K=0,X=T.length;X>K;K++)Z=T[K],Z.undoInject(Y)};var on=X.graph.EditInteractor=function(S){var G=this,r=Y.createElement("canvas");r.className="editCanvas",r.style.position="absolute",G._styleMap={},G._canvas=r,G._context=r.getContext("2d"),on.superClass.constructor.call(G,S),zd.setAntialias(G._context,!1),G._subModules=[new zd.Anchor(G),new zd.RotateX(G),new zd.MoveDummy(G),new zd.Rect(G),new zd.Curve(G),new zd.MoveHelper(G)],G._gridGuide=new zd.Guide.Grid(G),G._rectGuide=new zd.Guide.Rect(G),G._hoverGuide=new zd.Guide.Hover(G)},ki=on;X.Default.def(on,X.graph.Interactor,{ms_edit:1,ms_fire:1}),b.defineProperties(on.prototype,{editDetail:{get:function(){var d=!!this._editDetail;return d},set:function(C){var P=this,Q=P._editDetail;Q!==C&&(P._editDetail=C,P.gv._editing=C,P.fp("editDetail",Q,C),P.fp("pointsEditingMode",Q,C),P.fi({kind:C?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(X){(!this._editDetail||X)&&(this.gv._editing=X,X||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(t){this._editing=t,this.gvEditing=t}},pointsEditingMode:{get:function(){return this.editDetail},set:function(U){var u=this;u.editDetail!==U&&(U?u._tryEnterEditDetailMode():u._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var E=this._gridEnabled;if(!E)return!1;var C=this.gv;return C?!0:!0},set:function(M){M!==this._gridEnabled&&(this._gridEnabled=M,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(l){l!==this._agEnabled&&(this._agEnabled=l,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),on.prototype.getSubModule=function(g){var R,I,W,y=this._subModules;for(I=0,W=y.length;W>I;I++)if(R=y[I],R.catalog===g)return R},on.prototype.invokeSubModule=function($,s){var M=this,d=M._subModules;if(d)for(var x,C,P,B=Array.prototype.slice.call(arguments,2),l=0,h=d.length;h>l;l++)if(x=d[l],C=x[$],C&&(P=C.apply(x,B),P!=f&&s))return x},on.prototype.invokeSubModuleInverse=function(S,F){var J=this,U=J._subModules;if(U)for(var x,N,j,b=Array.prototype.slice.call(arguments,2),Q=U.length-1;Q>=0;Q--)if(x=U[Q],N=x[S],N&&(j=N.apply(x,b),j!=f&&F))return x},on.prototype.setUp=function(){zd.log("setUp");var M=this,D=M.gv,J=D.getView(),t=M._canvas;on.superClass.setUp.call(M),D.setEditInteractor(M),D._79O?J.insertBefore(t,D._79O):J.appendChild(t),zd.startEdit(D),M.invokeSubModule("setUp"),D.dm().mm(M._onDataModelChanged,M),D.dm().md(M._onDataPropertyChanged,M)},on.prototype.tearDown=function(){zd.log("tearDown");var Q=this,p=Q.gv,b=p.getView();Q._resetCustomCursorStyle(),on.superClass.tearDown.call(Q),p.dm().umm(Q._onDataModelChanged,Q),p.dm().umd(Q._onDataPropertyChanged,Q),p.setEditInteractor(null),b.removeChild(Q._canvas),Q._drawTimer&&(_(Q._drawTimer),Q._drawTimer=null),zd._46O(p),Q.invokeSubModule("tearDown")},on.prototype._onDataModelChanged=function(S){var V=this;("clear"===S.kind||"remove"===S.kind&&V.editDetail&&S.data===V.getSubModule("Curve").target)&&(V.editDetail=!1,V._42())},on.prototype._onDataPropertyChanged=function(v){var o=this;if(o.editDetail){var G=o.getSubModule("Curve"),g=v.data;g===G.target&&(g._writing||G._handleDataChanged(v))}},on.prototype.clear=function(){zd.log("clear")},on.prototype.redraw=function(){this._42()},on.prototype._42=function(){var $=this;$._drawTimer||($._drawTimer=i(function(){$._drawTimer=null,$.drawImpl()},0))},on.prototype.drawImpl=function(){var m;for(m in{_42:!0})break;return function(){var e=this,U=e._canvas,E=e.gv,S=E.getWidth(),c=E.getHeight(),K=e._context,v=X.Default.getInternal(),o=M.devicePixelRatio;(U.width!==S||U.height!==c)&&v.setCanvas(U,S,c,o),K.clearRect(0,0,U.width,U.height);var f=e._getValidSelection();K.save(),K.scale(o,o),e._gridGuide._42(),e.invokeSubModuleInverse(m,!1,K,E,f),e._rectGuide._42(),e._hoverGuide._42(),K.restore()}}(),on.prototype._getValidSelection=function(){var L=this,H=L.gv,b=H.sm().getSelection(),j=[];return b.each(function(P){H.isVisible(P)&&H.isEditable(P)&&j.push(P)}),j},on.prototype.handle_touchmove=function(U){return this.handle_mousemove(U)},on.prototype.handle_mousemove=function(a){if(!X.Default.isDragging()){var v=this;if(v.editDetail||!Db()&&!Gh(a))if(v.gvEditing=!1,v._checkEdit(a))v.gvEditing=!0;else{if(!v.getStyle("hoverGuideEnabled"))return;v.hoverData=v.gv.getDataAt(a),v._42()}}},on.prototype.handle_touchstart=function(h){return this.handle_mousedown(h)},on.prototype.handle_mousedown=function(_){wb(_);var T=this;if(T.editDetail||!Db()&&!Gh(_)){if(Ar(_)&&!_.clickThrough){if(T.editDetail){if(T._tryQuitEditDetailMode(_))return}else if(T._tryEnterEditDetailMode())return;T.gv.dm().beginTransaction();var L=T.invokeSubModule("handleDoubleClick",!0,_);if(T.gv.dm().endTransaction(),L)return}var A=T._checkEdit(_);A&&(T._downPosition=T._getLogicalPoint(_),T.gv.dm().beginTransaction(),A.startEdit(T,_),T.editing=!0)}},on.prototype._checkEdit=function(I){var U=this,p=U.gv,B=U._getLogicalPoint(I),K=U.invokeSubModule("check",!0,p,I,B)||null;return U._editMod=K,K},on.prototype.handleWindowTouchMove=function(D){return this.handleWindowMouseMove(D)},on.prototype.handleWindowMouseMove=function(A){var l=this,r=l._downPosition;if(r){var u=l._getLogicalPoint(A);if(u.distanceTo(r)<l.getStyle("moveSensitivity"))return;delete l._downPosition}var Z=l._editMod;Z&&Z.handleEdit(l.gv,A)},on.prototype._getLogicalPoint=function(b){var r=this,P=X.Default.getLogicalPoint(b,r._canvas);return new zd.Math.Vector2(P)},on.prototype.handleWindowTouchEnd=function(t){return this.handleWindowMouseUp(t)},on.prototype.handleWindowMouseUp=function(){var D;for(D in{_46O:!0})break;return function(b){var m=this;m.editing=!1,m.setCursor("default"),m.invokeSubModule(D,!1,b),m._42(),m.gv.dm().endTransaction()}}(),on.prototype.handle_mousewheel=function(Y){var k=this;wb(Y),k.invokeSubModule("preHandleScroll",!0)||k.gv.handleScroll(Y,Y.wheelDelta)},on.prototype.handleDelete=function(){var Y=this;if(!Y.editDetail){Y.gv.dm().beginTransaction();var m=Y.invokeSubModule("handleNormalStateDelete",!0);return Y.gv.dm().endTransaction(),m||Y.gv.removeSelection(),void 0}Y.gv.dm().beginTransaction(),Y.invokeSubModule("handleDelete",!0),Y.gv.dm().endTransaction(),Y._42()},on.prototype.handle_keydown=function(S){var R=this;if((S.metaKey||S.ctrlKey)&&R._42(),Db(S)&&!R.editing)return R.gvEditing=!1,R.setCursor("default"),R._42(),void 0;var O=Wp(S);return R.editDetail?((O||hj(S))&&(R.editDetail=!1,R._42()),R.gv.dm().beginTransaction(),R.invokeSubModule("handle_keydown",!0,S),R.gv.dm().endTransaction(),void 0):(R.gv.dm().beginTransaction(),R.invokeSubModule("handleNormalStateKeyDown",!0,S),R.gv.dm().endTransaction(),O&&R._tryEnterEditDetailMode(),void 0)},on.prototype.handle_keyup=function(r){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,r),this.gv.dm().endTransaction()},on.prototype._tryEnterEditDetailMode=function(){var E=this;return!E.editDetail&&E.invokeSubModule("canEnterEditDetailMode",!0)&&1===E._getValidSelection().length?(E.editDetail=!0,E._42(),!0):void 0},on.prototype._tryQuitEditDetailMode=function(K){var Y=this;return Y.editDetail?!K||Y.invokeSubModule("canQuitEditDetailMode",!0,K)?(Y.editDetail=!1,Y._42(),!0):!1:!1},on.prototype.setStyle=function(H,Y,e){var u=this;e?zd.setStyle(H,Y):u._styleMap[H]=Y,"baseColor"===H&&(ge=Y),u.fp("styleChanged",null,{key:H,value:Y,base:e}),u._42()},on.prototype.getStyle=function(i){var c=this,D=c._styleMap[i];return D!==f?D:zd.getStyle(i)},on.prototype.setCursor=function(k){this._resetCustomCursorStyle(),X.graph.EditInteractor.superClass.setCursor.call(this,k)},on.prototype._resetCustomCursorStyle=function(){var H=this;if(H._customStyle){var N=this.gv.getView();N.classList&&N.classList.remove&&N.classList.remove(H._customStyle),H._customStyle=null}},on.prototype._setRotateCursor=function(h){var l=this,F=l._cursorFactory;F||(F=l._cursorFactory=new zd.CursorFactory(l));var V=F.getRotateCursor(h),A=l.gv.getView();l._resetCustomCursorStyle(),l._customStyle=V,A.classList&&A.classList.add&&A.classList.add(V)};var Dm=zd.Group=function(c){var G=this;G._entities=c,G._64O=0,G._position={x:0,y:0},G._scale={x:1,y:1},G._anchor={x:.5,y:.5},G._anchor2={x:.5,y:.5}};Dm.prototype={},Dm.prototype.constructor=Dm;var im=null;Dm.findOrCreateGroup=function(s){if(im&&im.checkIsMe(s))return im;var v=new zd.Group(s);return v.getKeyOb()?(im=v,v):void 0},Dm.prototype.checkIsMe=function(J){var v=this._entities;if(v.length!==J.length)return!1;var U,I={},y=J.length;for(U=0;y>U;U++)I[J[U]._id]=!0;for(U=0;y>U;U++)if(!I[v[U]._id])return!1;return!0},Dm.prototype.getRotation=function(){return this._64O},Dm.prototype.getPosition=function(){return this._position},Dm.prototype.getAnchor=function(){return this._anchor},Dm.prototype.getWidth=function(){return this._width},Dm.prototype.getScale=function(){return this._scale},Dm.prototype.getSize=function(){return{width:this._width,height:this._height}},Dm.prototype.getHeight=function(){return this._height},Dm.prototype.getKeyOb=function(){for(var W=this._entities,V=W.length-1;V>=0;V--){var j=W[V];if(this.isNode(j))return j}},Dm.prototype.getAnchor2=function(){var p=this,k=p.rotateCenter;if(k)return k;var v=p.getKeyOb();if(!v)return p._anchor;var b=p._anchor2,N=v.getMatrix();return N.tf({x:v.getWidth()*(b.x-v.getAnchor().x),y:v.getHeight()*(b.y-v.getAnchor().y)})},Dm.prototype.setAnchor2=function(x,V){var X=this,b=X.getKeyOb();if(b){var Q,y=b.getMatrix();Q="number"==typeof x?{x:x,y:V}:x;var W=y.tfi(Q);X._anchor2={x:b.getAnchor().x+W.x/b.getWidth(),y:b.getAnchor().y+W.y/b.getHeight()}}},Dm.prototype.setRotation=function(){},Dm.prototype.beginRotate=function(c){this.rotateCenter=c.pos,this.rotateMode=c.groupRotateMode},Dm.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Dm.prototype.addRotation=function(H,O){return"batch"===O?this._addRotationInBatchMode(H):"block"===O?this._addRotationInBlockMode(H):void 0},Dm.prototype._addRotationInBlockMode=function(E){var X=this,P=X.rotateCenter||X.getPosition();X._entities.forEach(function(j){if(X.isNode(j)){var m=j.getMatrix();m.translate(-P.x,-P.y),m.rotate(E),m.translate(P.x,P.y);var q=Math.sign(j.getScale().x);j.setRotation($(m.b*q,m.a*q)),j.setPosition(m.tx,m.ty)}})},Dm.prototype._addRotationInBatchMode=function(y){var b=this,_=b._anchor2;b._entities.forEach(function(f){if(b.isNode(f)){var K=f.getAnchor(),T=f.getMatrix(),x=T.tf({x:f.getWidth()*(_.x-K.x),y:f.getHeight()*(_.y-K.y)}),o=new zd.Math.Matrix2d;o.set(T.a,T.b,T.c,T.d,T.tx,T.ty),o.translate(-x.x,-x.y),o.rotate(y),o.translate(x.x,x.y);var p=Math.sign(f.getScale().x);f.setRotation($(o.b*p,o.a*p)),f.setPosition(o.tx,o.ty)}})},Dm.prototype.setPosition=function(h){var u,I,N,_,V=this,m=V._position,M=h.x-m.x,G=h.y-m.y,b=V._entities;for(I=0,N=b.length;N>I;I++)u=b[I],xp(u)&&(_=u.getPosition(),u.setPosition(_.x+M,_.y+G));V._position=h},Dm.prototype.setScale=function(U,g){var l=this,S=U/l._scale.x,z=g/l._scale.y;l._adjustChildScaleOrSize(S,z,"size"),l._scale={x:U,y:g}},Dm.prototype.getRect=function(){var N=this,h=N._position,w=N._width,B=N._height;return{x:h.x-w/2,y:h.y-B/2,width:w,height:B}},Dm.prototype.setSize=function(G,L){var j=this,G=Math.max(1,G),L=Math.max(1,L),z=G/j._width,u=L/j._height;j._adjustChildScaleOrSize(z,u,"size"),j._width=G,j._height=L},Dm.prototype._adjustChildScaleOrSize=function(u,n,d){var r,i,w,L,C,Y,t,c,G,s,P,x,k,Z,W=this,O=W._position,e=W._entities,q=new zd.Math.Matrix2d;for(i=0,w=e.length;w>i;i++)if(r=e[i],W.isNode(r)){if(L=r.getPosition(),C=r.getRotation(),Y=r.getWidth(),t=r.getHeight(),c=r.getScale(),P=c.x*Y,x=c.y*t,q.identity().scale(P,x).rotate(C).translate(L.x,L.y).translate(-O.x,-O.y).rotate(-W._64O),C=$(q.b*Math.sign(P),q.a*Math.sign(P)),q.scale(u,n),G=Math.cos(C),s=Math.sin(C),Math.abs(G)<.001?(k=q.b/s,Z=-q.c/s):(k=q.a/G,Z=q.d/G),"scale"===d)r.setScale(k/Y,Z/t);else if("size"===d){var V=k/c.x,S=Z/c.y;r.setScale(Zm(k)*Math.abs(c.x),Zm(Z)*Math.abs(c.y)),r.setSize(Math.max(.1,Math.abs(V)),Math.max(.1,Math.abs(S)))}q.rotate(W._64O).translate(O.x,O.y),r.setPosition(q.tx,q.ty)}},Dm.prototype.getMatrix=function(){var A=this,Y=A._position,P=X.Default.getInternal(),n=A._scale;return new P.Mat(A._64O,Y.x,Y.y,n.x,n.y)},Dm.prototype.toGlobal=function(p){return this.getMatrix().tf(p)},Dm.prototype.getCorners=function(){var S=this,r=S._width,j=S._height,Y=S._anchor,X=-r*Y.x,F=-j*Y.y,x=S.getMatrix();return[x.tf(X,F),x.tf(X,F+j),x.tf(X+r,F+j),x.tf(X+r,F)]},Dm.prototype.calcInfo=function(){var k,H,E,l,B,D,S=this,o=[],I=S._entities,M=S._64O;for(l=0,B=I.length;B>l;l++)D=I[l],S.isNode(D)&&D.getCorners&&o.push.apply(o,D.getCorners());if(o.length){var c=Math.cos(-M),y=Math.sin(-M),$=1/0,i=-1/0,z=1/0,p=-1/0;for(l=0,B=o.length;B>l;l++)E=o[l],k=E.x,H=E.y,E.x=c*k-y*H,E.y=y*k+c*H,$=Math.min($,E.x),i=Math.max(i,E.x),z=Math.min(z,E.y),p=Math.max(p,E.y);S._width=(i-$)/S._scale.x,S._height=(p-z)/S._scale.y,c=Math.cos(M),y=Math.sin(M);var U=S._anchor;k=$+(i-$)*U.x,H=z+(p-z)*U.y,S._position={x:c*k-y*H,y:y*k+c*H}}},Dm.prototype.isNode=function(Q){return xp(Q)?Dk(Q)?!1:!0:!1},Dm.prototype._42=function(R,_,v){var X,H,l,j,g,b,d,f,T=this,n=T._entities,N=T.rotateMode;for("batch"===N&&(f=T.getKeyOb()),X=0,H=n.length;H>X;X++)l=n[X],T.isNode(l)&&(b=l.getRect(),j=zd.toScreenPosition(v,{x:b.x,y:b.y}),g=zd.toScreenPosition(v,{x:b.x+b.width,y:b.y+b.height}),d={min:j,max:g},l===f&&(d.isKeyOb=!0),zd.Icons.DrawIcon(R,_,zd.Icons.GroupSubEntityRect,d))};var bp=zd.CurveActiving=function(N,T){this._curve=N,this._interactor=N._interactor;for(var B in T)this[B]=T[B]};bp.prototype={},bp.prototype.constructor=bp,b.defineProperties(bp.prototype,{point:{get:function(){return this._point
},set:function(j){var p=this;p._point=j,p.editingCtrl||p._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(W){var R=this;R._pairs=W,R.editingCtrl&&R._firePointChange()}}}),bp.prototype._firePointChange=function(){var Z=this,N=Z.getCurrentEditingPoint(),m=Z._interactor;if(!N)return m.fi({kind:"selectPoint"}),void 0;var W=this._curve.target;if(W){var C=zd.getDataMatrix(W).invert(),z=N.e;N=C.apply(zd.toWorldPosition(m.gv,N)),N.e=z;var y=Z._lastFirePoint;y&&Math.abs(N.x-y.x)<1e-5&&Math.abs(N.y-y.y)<1e-5&&(N.e==f&&y.e==f||Math.abs(N.e-y.e)<1e-5)||(Z._lastFirePoint=N,m.fi({kind:"selectPoint",x:N.x,y:N.y,e:N.e}))}},bp.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},bp.prototype.getCurrentEditingPoint=function(){var c=this,J=c.editingCtrl;if(J){var $=c.pairs;if($){var q=$[J.pairId],B=q[J.type];if(B)return B}}return c._point};var Yp=zd.CursorFactory=function(T){var z=this;z._interactor=T,z._rotateCursorStyles={}};Yp.prototype={},Yp.prototype.constructor=Yp,Yp.prototype.getRotateCursor=function(e){var Q=this;0>e&&(e+=2*Math.PI);var p=Q._interactor,i=p.getStyle("rotateCursorSize"),q=p.getStyle("rotateCursorRound"),s=Math.round(180*(e/Math.PI)/q);s*q>=360&&(s=0);var n=Q._rotateCursorStyles,Y="htCustomRotateStyle_"+i+"_"+q+"_"+s;return n[Y]||(Q._produceRotateCursor(Y,i,q,s),n[Y]=!0),Y},Yp.prototype._produceRotateCursor=function(P,$,L,y){var j=this;j._interactor;var w=j._canvas;w||(w=j._canvas=Y.createElement("canvas")),w.width=w.height=$*devicePixelRatio,w.style.width=w.style.height=$+" px";var W=w.getContext("2d");zd.setAntialias(W,!1),W.scale(devicePixelRatio,devicePixelRatio);var t,N,B,v,c,O=Math.round($/2),Q=""+O+" "+O+",auto !important;";t=Math.PI/180*y*L,W.clearRect(0,0,$,$),W.save(),W.scale($/32,$/32),W.translate(16,16),W.rotate(t+Math.PI/2),W.beginPath(),W.moveTo(-8,0),W.lineTo(-8,3),W.lineTo(-5,3),W.moveTo(8,0),W.lineTo(8,3),W.lineTo(5,3),W.moveTo(-8,3),W.quadraticCurveTo(0,-6,8,3),W.restore(),W.strokeStyle="white",W.lineWidth=4,W.stroke(),W.strokeStyle="black",W.lineWidth=2,W.stroke(),N=JSON.stringify(w.toDataURL()),v="cursor:url("+N+")"+Q,1!==devicePixelRatio&&(B='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+$+'px" height="'+$+'px"><image xlink:href='+N+' width="'+$+'" height="'+$+'"/></svg>',v+="cursor:url(data:image/svg+xml;base64,"+btoa(B)+")"+Q,v+="cursor:-webkit-image-set(url("+N+")"+devicePixelRatio+"x,url("+N+")1x)"+Q),c=Y.createElement("style"),c.textContent="body."+P+" *, ."+P+"{"+v+"}",Y.head.appendChild(c)};var Gq=zd.Guide.Grid=function(i){var b=this;b._interactor=i,b._alignmentGuideId=0,b._xAlignmentGuide=[],b._yAlignmentGuide=[]};Gq.prototype={},Gq.prototype.constructor=Gq,b.defineProperties(Gq.prototype,{gridBlockSize:{get:function(){var j=this;return j._gridBlockSize||j._interactor.getStyle("gridBlockSize")},set:function(z){this._gridBlockSize=z,this._interactor._42()}},gridThickLinesEvery:{get:function(){var U=this;return U._gridThickLinesEvery||U._interactor.getStyle("gridThickLinesEvery")},set:function(O){this._gridThickLinesEvery=O,this._interactor._42()}},gridEnabled:{get:function(){var T=this,n=T._interactor;return n.gridEnabled&&T.isValidGrid()}}}),Gq.prototype._42=function(){var x=this,B=x._interactor;x.gridEnabled&&x.drawGrid(),B.alignmentGuideEnabled&&x.drawAlignmentGuide()},Gq.prototype.makeMatrix=function(){var K=this,J=K._interactor.getStyle("gridAngle"),H=K._interactor.getStyle("gridRotation"),D=new zd.Math.Matrix2d,x=Math.sin(J),i=Math.cos(J);return D.set(1,0,i,x,0,0),D.rotate(H),D},Gq.prototype.isValidGrid=function(){var U=this,z=Math.PI,h=U._interactor,s=h.gv;if(s._zoom<h.getStyle("gridZoomThreshold"))return!1;var P=h.getStyle("gridAngle"),a=Math.abs(180*(P%z/z)),F=1-1e-8;return F>a||a>180-F?!1:!0},Gq.prototype.drawAlignmentGuide=function(){var F=this,T=F._interactor,i=T.gv,N=T._canvas,d=T._context,J=N.width,e=N.height,W=i.tx(),w=i.ty(),X=i._zoom;d.beginPath(),d.strokeStyle=T.getStyle("gridAlignmentGuideColor"),d.lineWidth=1,F._xAlignmentGuide.forEach(function(_){var y=_.p*X+W;d.moveTo(y,0),d.lineTo(y,e)}),F._yAlignmentGuide.forEach(function(f){var u=f.p*X+w;d.moveTo(0,u),d.lineTo(J,u)}),d.stroke()},Gq.prototype.drawGrid=function(){function Q(r,V,v,$){var P=zd.toScreenPosition(a,B.apply({x:r,y:V})),j=zd.toScreenPosition(a,B.apply({x:v,y:$}));n.moveTo(P.x,P.y),n.lineTo(j.x,j.y)}var K=this,s=K._interactor,X=K.gridBlockSize,q=K.gridThickLinesEvery,L=s.getStyle("gridThickColor"),F=s.getStyle("gridLightColor"),a=s.gv,r=s._canvas,n=s._context,W=r.width,S=r.height,B=K.makeMatrix(),t=B.applyInverse(zd.toWorldPosition(a,{x:0,y:0})),v=B.applyInverse(zd.toWorldPosition(a,{x:W,y:0})),D=B.applyInverse(zd.toWorldPosition(a,{x:0,y:S})),j=B.applyInverse(zd.toWorldPosition(a,{x:W,y:S})),U=Math.min(t.x,v.x,D.x,j.x),x=Math.max(t.x,v.x,D.x,j.x),Y=Math.min(t.y,v.y,D.y,j.y),y=Math.max(t.y,v.y,D.y,j.y);W=x-U,S=y-Y;var i=Math.ceil(U/X),p=Math.floor(x/X),d=Math.ceil(Y/X),J=Math.floor(y/X);a.tx(),a.ty(),a._zoom;var w,V,$;for(n.save(),n.lineWidth=1,n.beginPath(),n.strokeStyle=L,$=Math.ceil(i/q)*q;p>=$;$+=q)w=$*X,Q(w,Y,w,y);for($=Math.ceil(d/q)*q;J>=$;$+=q)V=$*X,Q(U,V,x,V);for(n.stroke(),n.beginPath(),n.strokeStyle=F,$=i;p>=$;$++)0!==$%q&&(w=$*X,Q(w,Y,w,y));for($=d;J>=$;$++)0!==$%q&&(V=$*X,Q(U,V,x,V));n.stroke(),n.restore()},Gq.prototype.getAlignmentGuides=function(){var I=this;return{x:I._xAlignmentGuide,y:I._yAlignmentGuide}},Gq.prototype.addAlignmentGuide=function(_,l,r){var D=this,M="x"===_?D._xAlignmentGuide:D._yAlignmentGuide,r=r?r:++D._alignmentGuideId,L={p:l,id:r};if(M.length){var G=D._findClosestAlignmentGuide(L.p,M);G.dis<0?M.splice(G.index+1,0,L):M.splice(G.index,0,L)}else M.push(L);return D._interactor._42(),r},Gq.prototype.findClosest=function(X,r,E){var w=this,x=w._interactor,T=x.gv;E&&(X=zd.toWorldPosition(T,X));var U,B,z,f=1/0,y=1/0,v=X.x,j=X.y;if(w.gridEnabled){var G=w.gridBlockSize,i=w.makeMatrix(),J=i.applyInverse(X);J=i.apply({x:Math.round(J.x/G)*G,y:Math.round(J.y/G)*G}),f=J.x-v,y=J.y-j,z=!0}if(x.alignmentGuideEnabled&&(U=w._findClosestAlignmentGuide(v,w._xAlignmentGuide).dis,B=w._findClosestAlignmentGuide(j,w._yAlignmentGuide).dis,Math.abs(U)<Math.abs(f)&&(f=U,z=!0),Math.abs(B)<Math.abs(y)&&(y=B,z=!0)),z){z=!1;var o=T._zoom,g=x.getStyle("smartGuideSensitivity")/o,L={};if(Math.abs(f)<g&&"y"!==r&&(L.x=E?f*o:f,z=!0),Math.abs(y)<g&&"x"!==r&&(L.y=E?y*o:y,z=!0),z)return L}},Gq.prototype._findClosestAlignmentGuide=function(E,P){if(!P.length)return{dis:1/0};for(var $,L=0,k=P.length-1;k-L>1;)$=Math.floor((L+k)/2),P[$].p<E?L=$:k=$;var H=P[L].p-E,J=P[k].p-E;return Math.abs(H)<=Math.abs(J)?{line:P[L],dis:H,index:L}:{line:P[k],dis:J,index:k}},Gq.prototype.removeAllAlignmentGuide=function(b){var P=this;"y"!==b&&(P._xAlignmentGuide=[]),"x"!==b&&(P._yAlignmentGuide=[]),P._interactor._42()},Gq.prototype.removeAlignmentGuide=function(_){for(var j,X,s,J=this,U=J._xAlignmentGuide,u=0;2>u;u++)for(U=0===u?J._xAlignmentGuide:J._yAlignmentGuide,j=0,X=U.length;X>j;j++)if(s=U[j],s.id===_)return U.splice(j,1),J._interactor._42(),{axis:0===u?"x":"y",position:s.p};return!1},Gq.prototype.adjustAlignmentGuide=function(A,X){var R=this,j=R.removeAlignmentGuide(A);return j?(R.addAlignmentGuide(j.axis,X,A),!0):!1};var fi=zd.Guide.Rect=function(r){var F=this;F._interactor=r};fi.prototype={},fi.prototype.constructor=fi,fi.prototype.gatherRects=function(){var N,D,B,G,f=this,b=f._interactor.gv,d=[],U=[],u={x:d,y:U},q={},w=b.getDataModel(),x=w.a("width"),O=w.a("height");x&&O&&(N=0,D=0,B=x,G=O,d.push({node:w,type:0,p:N},{node:w,type:1,p:N+B/2},{node:w,type:2,p:N+B}),U.push({node:w,type:0,p:D},{node:w,type:1,p:D+G/2},{node:w,type:2,p:D+G}),q[w._id||0]={x:N,y:D,width:B,height:G}),w.each(function(Q){if(xp(Q)&&!b.isSelected(Q)&&b.isVisible(Q)){var R=!1;if(b.sm().getSelection().each(function(E){R||(Q.isHostOn(E)?R=!0:Q.isDescendantOf(E)&&(R=!0))}),!R){var w=Q.getRect();N=w.x,D=w.y,B=w.width,G=w.height,d.push({node:Q,type:0,p:N},{node:Q,type:1,p:N+B/2},{node:Q,type:2,p:N+B}),U.push({node:Q,type:0,p:D},{node:Q,type:1,p:D+G/2},{node:Q,type:2,p:D+G}),q[Q._id]=w}}}),d.sort(function(E,T){return E.p-T.p}),U.sort(function(i,y){return i.p-y.p}),f._grid=u,f._87I=q},fi.prototype.gatherLines=function(O,z,T){var p,Z,E,h,u,I,K,A,r,Y,l,Q,J=this,c=[J.findClosest({x:O.x,y:O.y},z),J.findClosest({x:O.x+O.w/2,y:O.y+O.h/2},z),J.findClosest({x:O.x+O.w,y:O.y+O.h},z)],s={},y=J._87I;T=T||255;var G,d;for(J._guideLine=[],p=0;2>p;p++)for(s={},0===p?(h="y",A=O.x,r=A+O.w):(h="x",A=O.y,r=A+O.h),Z=0;3>Z;Z++)u=c[Z],u&&isFinite(u[h])&&(G=1<<3*p+Z,T&G&&(I=u[h+"Line"],K=I.node,d=K._id||0,s[d]||(s[d]=!0,Q=y[d],"y"===h?(Y=Q.x,l=Q.x+Q.width):(Y=Q.y,l=Q.y+Q.height),E=I.p,J._guideLine.push({type:h,a:A,b:r,c:Y,d:l,p:E,center:1===I.type}))))},fi.prototype._binarySearchClosest=function(I,e){if(!e.length)return{dis:1/0};for(var O,j=0,s=e.length-1;s-j>1;)O=Math.floor((j+s)/2),e[O].p<I?j=O:s=O;var f=e[j].p-I,N=e[s].p-I;return Math.abs(f)<=Math.abs(N)?{line:e[j],dis:f}:{line:e[s],dis:N}},fi.prototype.findClosest=function(p,T,b){var U=this,M=U._interactor,m=M.gv,D=U._grid;b&&(p=zd.toWorldPosition(m,p));var H,Q=U._binarySearchClosest(p.x,D.x),q=U._binarySearchClosest(p.y,D.y),o=Q.dis,l=q.dis,I=m._zoom,y=M.getStyle("smartGuideSensitivity")/I,z={};return Math.abs(o)<y&&"y"!==T&&(z.x=b?o*I:o,z.xLine=Q.line,H=!0),Math.abs(l)<y&&"x"!==T&&(z.y=b?l*I:l,z.yLine=q.line,H=!0),H?z:void 0},fi.prototype._42=function(){var w=this,q=w._guideLine;if(q&&!X.Default.isCtrlDown()){var W,s,R,u,b,S,g,k,x,O,I,N,m,c,D,Q,C,v=w._interactor,h=v.gv,$=v._context,r=h.tx(),Z=h.ty(),l=h._zoom,A=v.getStyle("guideLineTextSpacing");for(W=0,s=q.length;s>W;W++)R=q[W],k=R.type,x=R.p,O=R.a,I=R.b,N=R.c,m=R.d,c=Math.min(O,N),D=Math.max(I,m),"x"===k?(u=x*l+r,b=c*l+Z,S=u,g=D*l+Z):(u=c*l+r,b=x*l+Z,S=D*l+r,g=b),zd.Icons.DrawIcon(v,$,zd.Icons.MoveLineGuide,{rect:[u,b,S,g],center:R.center}),m>=O&&I>=N||(c=O>m?m:I,D=O>m?O:N,C=D-c,"x"===k?(R.center2center||(u-=A,S=u),b=c*l+Z,g=D*l+Z,Q=zd.Icons.MoveLineGuideDistanceV):"y"===k&&(R.center2center||(b-=A,g=b),u=c*l+r,S=D*l+r,Q=zd.Icons.MoveLineGuideDistanceH),zd.Icons.DrawIcon(v,$,Q,{x0:u,y0:b,x1:S,y1:g,dis:C}))}},fi.prototype.clear=function(){this._guideLine=null};var qs=zd.Guide.Hover=function(Y){var j=this;j._interactor=Y};qs.prototype={},qs.prototype.constructor=qs,b.defineProperties(qs.prototype,{}),qs.prototype._42=function(){var a=this._interactor;if(a.getStyle("hoverGuideEnabled")&&!a.gvEditing){var q=a.hoverData,J=a.gv;if(!xp(q)||J.isSelected(q))return a.hoverData=null,void 0;var e=wo(J,q),z=zd.toScreenPosition(J,{x:e.x,y:e.y}),B=zd.toScreenPosition(J,{x:e.x+e.width,y:e.y+e.height});zd.Icons.DrawIcon(a,a._context,zd.Icons.HoverDataRect,{min:z,max:B,color:a.getStyle("hoverGuideColor")||a.getStyle("baseColor")})}},zd.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyVisible:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,guideLineTextSpacing:0,hoverGuideEnabled:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var wp=zd.Icons={},fl=1e4,Am=null,ge=zd.DefaultStyleMap.baseColor,Cl="rgb(183,232,135)",Yj="rgb(255,204,153)",qe=6;X.Default.setImage("Icons.RectPoint",{width:qe,height:qe,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return ge}},rect:[0,0,qe,qe]}]}),wp.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var d=wp.GroupSubEntityRect.data;if(!d)return[];var R=d.min,M=d.max;return[R.x,R.y,R.x,M.y,M.x,M.y,M.x,R.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return wp.GroupSubEntityRect.data.isKeyOb?ge:ge}}}]};var $n=4;wp.HoverDataRect={comps:[{type:"shape",points:{func:function(){var A=wp.HoverDataRect.data;if(!A)return[];var u=A.min,c=A.max,y=$n;return u.x-=y,u.y-=y,c.x+=y,c.y+=y,[u.x,u.y,u.x,c.y,c.x,c.y,c.x,u.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return wp.HoverDataRect.data.color}},borderCap:"round",borderPattern:[1,4]}]},wp.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[wp.Line.data.P1.x,wp.Line.data.P1.y],qe,qe]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[wp.Line.data.P2.x,wp.Line.data.P2.y],qe,qe]}}}]},wp.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return wp.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},wp.Rect={comps:[{type:"shape",points:{func:function(){var F=wp.Rect.data;if(!F)return[];var i=F.LT,A=F.LB,d=F.RB,N=F.RT;return[i.x,i.y,A.x,A.y,d.x,d.y,N.x,N.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return ge}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return wp.Rect.data.rotation}},rect:{func:function(){return[[wp.Rect.data.LT.x,wp.Rect.data.LT.y],qe,qe]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return wp.Rect.data.rotation}},rect:{func:function(){return[[wp.Rect.data.LB.x,wp.Rect.data.LB.y],qe,qe]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return wp.Rect.data.rotation}},rect:{func:function(){return[[wp.Rect.data.RB.x,wp.Rect.data.RB.y],qe,qe]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return wp.Rect.data.rotation}},rect:{func:function(){return[[wp.Rect.data.RT.x,wp.Rect.data.RT.y],qe,qe]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return wp.Rect.data.rotation}},visible:{func:function(){return wp.Rect.data.L?!0:!1}},rect:{func:function(){return[[wp.Rect.data.L.x,wp.Rect.data.L.y],qe,qe]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return wp.Rect.data.rotation}},visible:{func:function(){return wp.Rect.data.R?!0:!1}},rect:{func:function(){return[[wp.Rect.data.R.x,wp.Rect.data.R.y],qe,qe]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return wp.Rect.data.rotation}},visible:{func:function(){return wp.Rect.data.T?!0:!1}},rect:{func:function(){return[[wp.Rect.data.T.x,wp.Rect.data.T.y],qe,qe]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return wp.Rect.data.rotation}},visible:{func:function(){return wp.Rect.data.B?!0:!1}},rect:{func:function(){return[[wp.Rect.data.B.x,wp.Rect.data.B.y],qe,qe]}}}]};var $d=16;X.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return ge}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return ge}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),wp.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[wp.Anchor.data.POS.x,wp.Anchor.data.POS.y],$d,$d]}}}]},wp.TipShiftX=12,wp.TipShiftY=12;var ns=[8,28];wp.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[wp.TipHelper.data.helperPos.x,wp.TipHelper.data.helperPos.y,ns[0]*wp.TipHelper.data.size,ns[1]]}},background:{func:function(){return Am.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return wp.TipHelper.data.text}},rect:{func:function(){return[wp.TipHelper.data.helperPos.x,wp.TipHelper.data.helperPos.y,ns[0]*wp.TipHelper.data.size,ns[1]]}},color:{func:function(){return Am.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var Sr=7;wp.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!wp.ShapePoint.data.dynamicVisible}},rect:{func:function(){var I=wp.ShapePoint.data.point,l=wp.ShapePoint.data.size||Sr;return[I,l+10,l+10]}},background:{func:function(){var _=Date.now(),q=wp.ShapePoint.data.dynamicPeriod||1500,n=Math.sin(_%q/q*Math.PI);return"rgba(27,124,22,"+.5*n+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var x=wp.ShapePoint.data.point,Y=wp.ShapePoint.data.size||Sr;return[x,Y,Y]}},background:{func:function(){var V=wp.ShapePoint.data.isEnd;return V?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return wp.ShapePoint.data.color||ge}}},{type:"rect",visible:{func:function(){return!!wp.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return ge}},rect:{func:function(){var E=5;return[wp.ShapePoint.data.point,E,E]}}}]},wp.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!wp.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return wp.ShapeBgCurve.data.P}},segments:{func:function(){return wp.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var r=Date.now(),i=wp.ShapeBgCurve.data.dynamicPeriod||1500,G=Math.sin(r%i/i*Math.PI);return"rgba(27,124,22,"+.3*G+")"}}},{type:"shape",points:{func:function(){return wp.ShapeBgCurve.data.P}},segments:{func:function(){return wp.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return wp.ShapeBgCurve.data.color||ge}}}]};var _r=8;wp.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var a=wp.ShapeHighlighPoint.data;return[[a.x,a.y],_r,_r]}},background:{func:function(){return Am.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Ym=10;wp.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var m=wp.ShapeHighlighRealPoint.data;return[[m.x,m.y],Ym,Ym]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return ge}}}]};var ep=8;wp.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var g=wp.ShapeHighlighCtrlPoint.data,P=g.x,e=g.y,M=ep/2;return[P-M,e-M,P-M,e+M,P+M,e+M,P+M,e-M]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Am.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Am.getStyle("shapeCtrlPointBorderColor")||ge}}}]};var fs=3;wp.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return wp.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:fs,borderColor:{func:function(){return Am.getStyle("curveHighlightColor")}}}]},wp.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return wp.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},wp.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return wp.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return wp.MoveLineGuide.data.center?Cl:Yj}}}]};var yj=5;wp.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var P=wp.MoveLineGuideDistanceH.data,K=P.x0,v=P.y0;return[K,v-yj,K,v+yj]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Yj},{type:"shape",points:{func:function(){var j=wp.MoveLineGuideDistanceH.data,G=j.x1,z=j.y1;return[G,z-yj,G,z+yj]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Yj},{type:"text",text:{func:function(){return Math.round(wp.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var Q=wp.MoveLineGuideDistanceH.data;return[[(Q.x0+Q.x1)/2,Q.y0-10],20,20]}},color:Yj,font:"12px Arial",align:"center"}]},wp.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var p=wp.MoveLineGuideDistanceV.data,c=p.x0,v=p.y0;return[c-yj,v,c+yj,v]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Yj},{type:"shape",points:{func:function(){var $=wp.MoveLineGuideDistanceV.data,T=$.x1,l=$.y1;return[T-yj,l,T+yj,l]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Yj},{type:"text",text:{func:function(){return Math.round(wp.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var I=wp.MoveLineGuideDistanceV.data;return[[I.x0-10,(I.y0+I.y1)/2],20,20]}},color:Yj,font:"12px Arial",align:"center"}]},X.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),wp.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var k=wp.EdgeElevationGuide.data,$=k.x,x=k.y,E=Am.getStyle("curveElevationIntersectSize"),L=Am.getStyle("curveElevationGuideShift");return $+=L[0],x+=L[1],[$-E,x-E,2*E,2*E]}}}]},X.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),X.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),wp.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return wp.ConnectGuide.data.rotation}},rect:{func:function(){var B=wp.ConnectGuide.data.connect;B.x,B.y;var T=Am.getStyle("connectGuideIntersectSize");return[[B.x,B.y],2*T,2*T]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var n=wp.ConnectGuide.data.cursorPos||wp.ConnectGuide.data.connect,a=Am.getStyle("connectGuideIntersectSize");return[[n.x,n.y],2*a-2,2*a-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var k=wp.ConnectGuide.data.connect,i=wp.ConnectGuide.data.cursorPos||k;return[k.x,k.y,k.x+.5*(i.x-k.x),k.y,i.x+.5*(k.x-i.x),i.y,i.x,i.y]}}}]},X.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),X.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),wp.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var L=wp.ConnectGuideGarbage.data.hover;return L?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var O=wp.ConnectGuideGarbage.data,G=Am.getStyle("connectGuideGarbageIntersectsize");return O.hover&&(G+=5),[[O.x,O.y],2*G,2*G]}}}]};var rb=6;wp.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return wp.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var K=wp.ShapeActivingCtrl.data;return[K.point.x,K.point.y,K.c1.x,K.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return ge}}},{type:"shape",visible:{func:function(){return wp.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var Y=wp.ShapeActivingCtrl.data;return[Y.point.x,Y.point.y,Y.c2.x,Y.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return ge}}},{type:"shape",visible:{func:function(){return wp.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var o=wp.ShapeActivingCtrl.data.c1,q=o.x,H=o.y,b=rb/2;return"c1"===wp.ShapeActivingCtrl.data.hl&&(b+=.5),[q-b,H-b,q-b,H+b,q+b,H+b,q+b,H-b]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Am.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===wp.ShapeActivingCtrl.data.hl?Am.getStyle("shapeCtrlPointHighlightBorder")||ge:Am.getStyle("shapeCtrlPointBorderColor")||ge}}},{type:"shape",visible:{func:function(){return wp.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var H=wp.ShapeActivingCtrl.data.c2,_=H.x,z=H.y,U=rb/2;return"c2"===wp.ShapeActivingCtrl.data.hl&&(U+=.5),[_-U,z-U,_-U,z+U,_+U,z+U,_+U,z-U]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Am.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===wp.ShapeActivingCtrl.data.hl?Am.getStyle("shapeCtrlPointHighlightBorder")||ge:Am.getStyle("shapeCtrlPointBorderColor")||ge}}}]},wp.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return ge}},rect:{func:function(){return[[wp.RoundPoint.data.x,wp.RoundPoint.data.y],qe,qe]}}}]},wp.AttachPoint={comps:[{type:"rect",background:{func:function(){return wp.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return ge}},rect:{func:function(){var j=wp.AttachPoint.data.isAttach?qe+4:qe;return[[wp.AttachPoint.data.x,wp.AttachPoint.data.y],j,j]}}}]},wp.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return wp.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return wp.SimpleRect.data.color||ge}},rect:{func:function(){var C=wp.SimpleRect.data;return[C.x,C.y,C.width,C.height]}}}]},X.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),wp.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var H=wp.MoveDummy.data;return[[H.pos.x,H.pos.y],2*H.size,2*H.size]}}}]},zd.Icons.DrawIcon=function(D,r,x,O){x.width=x.height=fl,x.data=O,Am=D,X.Default.drawImage(r,x,0,0,fl,fl)},zd.Icons.MapPoints=function(M,Z){for(var _=0,z=M.length;z>_;_++)M[_]/=Z},zd.roundTo=function(H,c,y){var A=Math.abs(H%c);return y>A||y>c-A?c*Math.round(H/c):H},zd.toFixed=function(o){return Math.round(100*o)/100},zd.getDataMatrix=function(t){if(t instanceof X.Shape){var $=new X.Math.Matrix2d,A=t.getPosition();return $.translate(-A.x,-A.y).scale(t.getScale().x,t.getScale().y).rotate(t.getRotation()).translate(A.x,A.y),$}return t.getMatrix?t.getMatrix():new X.Math.Matrix2d};var Ef=zd.Math.Curve=function(){this._curves=[]};Ef.prototype={},Ef.prototype.constructor=Ef,Ef.prototype.createFromHtShape=function(e,Z,L){Z instanceof X.List&&(Z=Z.toArray());var R,K,r,i,Y,y,N,$=this,p=null,u=null,_=0,b=zd.Math.Vector2,j=zd.Math.CubicBezier,E=function(P){return new b(e[P],e[P+1],L?L[P/2]:f)};for(K=0,r=Z.length;r>K;K++){switch(i=Z[K],Y=null,i){case 1:u=E(_),p=u,_+=2;break;case 2:R=E(_),_+=2,Y=new j(u,u.clone(),R.clone(),R),u=R;break;case 3:y=E(_),R=E(_+2),_+=4,Y=new j(u,y.clone().sub(u).multiplyScalar(2/3).add(u),y.clone().sub(R).multiplyScalar(2/3).add(R),R),u=R;break;case 4:y=E(_),N=E(_+2),R=E(_+4),_+=6,Y=new j(u,y,N,R),u=R;break;case 5:if(!p)break;Y=new j(u,u.clone(),p.clone(),p),u=null,p=null}Y&&(Y._index=$._curves.length,$._curves.push(Y))
}},Ef.prototype.checkPoint=function(m,$){var Q,v,q,M,h,S=this,I=S._curves;for(Q=0,v=I.length;v>Q;Q++)if(M=I[Q],h=M.intersectRect(m,$,$),h.length)return q=0,h.forEach(function(b){q+=b.t}),q/=h.length,m=M.getPointAt(q),m.t=q,{bezier:M,intersection:m}},Ef.prototype.insertKnot=function(r,E){var G=r.insertKnot(E),R=this,I=R._curves;I.splice(r._index,1,G[0],G[1])},Ef.prototype._isCloseEnough=function(W,I){return Math.abs(W.x-I.x)<1e-6&&Math.abs(W.y-I.y)<1e-6},Ef.prototype._isSamePoint=function(M,L){return M===L},Ef.prototype.moveRealPoint=function(K,R){var J=this,C=J._curves,X=R.clone().sub(K);C.forEach(function(s){var G=s._p1;s._p2,s._p3;var f=s._p4;J._isSamePoint(G,K)&&(s._p2.add(X),s._p1=R),J._isSamePoint(f,K)&&(s._p3.add(X),s._p4=R)})},Ef.prototype.moveCtrlDueToRealPointMovement=function(u,Z){var x=this,v=x._curves,g=function(J){J.add(Z),J.e&&Z.e&&(J.e+=Z.e)};v.forEach(function(M){var P=M._p1;M._p2,M._p3;var J=M._p4;x._isSamePoint(P,u)&&g(M._p2),x._isSamePoint(J,u)&&g(M._p3)})},Ef.prototype.moveCtrlPoint=function(R,a,I){var _=R[I];if(_){_.e!==f&&(a.e=_.e);var E=this,P=E._curves;a.clone().sub(_),P.forEach(function($){var Z;"c2"===I?Z="_p2":"c1"===I&&(Z="_p3"),E._isSamePoint($[Z],_)&&($[Z]=a)}),R[I]=a}},Ef.prototype.deleteRealPoint=function(V,n){var T,S,M,x,O,$,d,Y=this,A=Y._curves,_={},L=[],D=zd.Math.CubicBezier;for(S=0,M=A.length;M>S;S++)T=A[S],x=T._p1,O=T._p2,$=T._p3,d=T._p4,(_[S]||!Y._isSamePoint(x,V))&&(Y._isSamePoint(d,V)?M>S+1&&Y._isSamePoint(A[S+1]._p1,V)&&(n||L.push(new D(x,O,A[S+1]._p3,A[S+1]._p4))):L.push(T));Y._curves=L},Ef.prototype.findPairs=function(C,F){var D,J,t,R,U,i,k,Q,q=this,s=q._curves,c={},X=[];for(J=0,t=s.length;t>J;J++)D=s[J],R=D._p1,U=D._p2,i=D._p3,k=D._p4,!c[J]&&q._isSamePoint(R,C)&&(F?X.push({point:R,r2:k}):X.push({point:R,c2:U})),q._isSamePoint(k,C)&&(Q=F?{point:k,r1:R}:{point:k,c1:i},t>J+1&&q._isSamePoint(s[J+1]._p1,C)&&(F?Q.r2=s[J+1]._p4:Q.c2=s[J+1]._p2,c[J+1]=!0),X.push(Q));return X},Ef.prototype.toHtShape=function(){var G=this,A=G._curves,f=[],M=[],N={x:1/0,y:1/0};return A.forEach(function(U){var R=U._p1,s=U._p2,L=U._p3,y=U._p4;return G._isCloseEnough(R,N)||(f.push(1),M.push(R.clone())),N=y,G._isCloseEnough(R,s)&&G._isCloseEnough(L,y)?(f.push(2),M.push(y.clone()),void 0):(f.push(4),M.push(s.clone(),L.clone(),y.clone()),void 0)}),{segments:f,points:M}};var gl=zd.Math.CubicBezier=function(e,J,V,R){var t=this;t._id=zd.Math.CubicBezier._globalId++,t._p1=e,t._p2=J,t._p3=V,t._p4=R};gl._globalId=1,gl.prototype={},gl.prototype.constructor=gl,gl.prototype.toString=function(){return this._id},gl.prototype.intersectRect=function(e,A,_){var j=A/2,l=_/2,p=e.x,X=e.y,k=zd.Math.Vector2,Q=new k(-j+p,-l+X),s=new k(j+p,l+X),t=new k(s.x,Q.y),m=new k(Q.x,s.y),N=this,a=N.intersectLine(Q,t),C=N.intersectLine(t,s),d=N.intersectLine(s,m),c=N.intersectLine(m,Q),x=a.concat(C).concat(d).concat(c);return x},gl.prototype.intersectLine=function(L,Y){var W,V,C,B,k,$,o,w,l,K,U,e,J,y=this,c=L.clone().min(Y),H=L.clone().max(Y);B=y._p1,k=y._p2,$=y._p3,o=y._p4,W=B.clone().multiplyScalar(-1),V=k.clone().multiplyScalar(3),C=$.clone().multiplyScalar(-3),U=W.add(V).add(C).add(o),W=B.clone().multiplyScalar(3),V=k.clone().multiplyScalar(-6),C=$.clone().multiplyScalar(3),K=W.add(V).add(C),W=B.clone().multiplyScalar(-3),V=k.clone().multiplyScalar(3),l=W.add(V),w=B.clone(),J=new zd.Math.Vector2(L.y-Y.y,Y.x-L.x),e=L.x*Y.y-Y.x*L.y;for(var Q=y.getRoots(J.dot(U),J.dot(K),J.dot(l),J.dot(w)+e),v=new Array,g=0,z=Q.length;z>g;g++){var j=Q[g];if(!(0>j||j>1)){var x=B.clone().lerp(k,j),a=k.clone().lerp($,j),N=$.clone().lerp(o,j),s=x.lerp(a,j),_=a.lerp(N,j),m=s.lerp(_,j);m.t=j,L.x==Y.x?c.y<=m.y&&m.y<=H.y&&v.push(m):L.y==Y.y?c.x<=m.x&&m.x<=H.x&&v.push(m):m.x>=c.x&&m.y>=c.y&&m.x<=H.x&&m.y<=H.y&&v.push(m)}}return v},gl.prototype.solveTForPoint=function(M){var u,B,x,V,H=this;u=H._p1.x-M.x,B=H._p2.x-M.x,x=H._p3.x-M.x,V=H._p4.x-M.x;for(var A=H.getRoots(V-3*x+3*B-u,3*x-6*B+3*u,3*B-3*u,u),Y=f,m=1/0,o=0,l=A.length;l>o;o++){var $=A[o];if(!(0>$||$>1)){var i=H._p1.clone().lerp(H._p2,$),Q=H._p2.clone().lerp(H._p3,$),v=H._p3.clone().lerp(H._p4,$),k=i.lerp(Q,$),L=Q.lerp(v,$),C=k.lerp(L,$);C.t=$;var R=Math.abs(C.y-M.y);m>R&&(m=R,Y=C)}}return Y},gl.prototype.getPointAt=function(i){var M=this,K=M._p1,C=M._p2,z=M._p3,G=M._p4,k=K.clone().lerp(C,i),J=C.clone().lerp(z,i),Y=z.clone().lerp(G,i),l=k.lerp(J,i),X=J.lerp(Y,i);return l.lerp(X,i)},gl.prototype.getRoots=function(p,q,o,n){var M,i,s,v,Y,C=new Array;if(Math.abs(p)<1e-6){var M=q,i=o/M,s=n/M,v=i*i-4*s;if(v>0){var Y=Math.sqrt(v);C.push(.5*(-i+Y)),C.push(.5*(-i-Y))}else 0==v&&C.push(.5*-i)}q/=p,o/=p,n/=p,M=(3*o-q*q)/3,i=(2*q*q*q-9*o*q+27*n)/27;var b=q/3,y=i*i/4+M*M*M/27,W=i/2;if(Math.abs(y)<=1e-6&&(y=0),y>0){var k,X,Y=Math.sqrt(y);k=-W+Y,X=k>=0?Math.pow(k,1/3):-Math.pow(-k,1/3),k=-W-Y,k>=0?X+=Math.pow(k,1/3):X-=Math.pow(-k,1/3),C.push(X-b)}else if(0>y){var Z=Math.sqrt(-M/3),V=Math.atan2(Math.sqrt(-y),-W)/3,T=Math.cos(V),U=Math.sin(V),E=Math.sqrt(3);C.push(2*Z*T-b),C.push(-Z*(T+E*U)-b),C.push(-Z*(T-E*U)-b)}else{var k;k=W>=0?-Math.pow(W,1/3):Math.pow(-W,1/3),C.push(2*k-b),C.push(-k-b)}return C},gl.prototype._70I=function(){var j=this;return j._p1.distanceToSquared(j._p2)<1e-10&&j._p3.distanceToSquared(j._p4)<1e-10},gl.prototype.insertKnot=function(d){var p=this,W=p._p1,v=p._p2,m=p._p3,c=p._p4,x=W.clone().lerp(v,d),G=v.clone().lerp(m,d),Q=m.clone().lerp(c,d),y=x.clone().lerp(G,d),I=G.clone().lerp(Q,d),k=y.clone().lerp(I,d);return p._70I()?(W.clone().lerp(c,d),[new zd.Math.CubicBezier(W,W.clone(),k.clone(),k),new zd.Math.CubicBezier(k,k.clone(),c.clone(),c)]):[new zd.Math.CubicBezier(W,x,y,k),new zd.Math.CubicBezier(k,I,Q,c)]};var gh=X.Default.getInternal().ui().EdgeUI,ni={_47O:function(L){var X=this,c=ni.getBackups()._47O;zd.inEdit(X.gv)||c.call(X,L)}};zd.Inject.registAsModule(ni,gh);var Lr=X.Default.getInternal().ui().NodeUI,op={_47O:function(B){var Q=this,L=op.getBackups()._47O;zd.inEdit(Q.gv)||L.call(Q,B)},getSelectWidth:function(){var L=this,n=L.gv,N=L._data;if(n.isEditable(N)&&zd.inEdit(n))return 0;var Y=op.getBackup("getSelectWidth");return Y.call(L)}};zd.Inject.registAsModule(op,Lr);var gd=X.graph.GraphView,Og={_editPointSize:function(){var $=X.Default.isTouchable,x=zd.getStyle("pointSize");return x[$?0:1]}(),isPointEditable:function(Y){var o=this;if(zd.inEdit(o))return o._pointEditableFunc?o._pointEditableFunc(Y):!0;var e=Og.getBackup("isPointEditable");e.call(o,Y)},isEditable:function(N){var R,p=this,S=Og.getBackup("isEditable");if(R=N instanceof zd.Group?!0:S.call(p,N),!zd.inEdit(p))return R;if(!(N instanceof X.Edge))return R;if(!N.s("2d.editable"))return!1;var H=p.getEditableFunc();return H?H(N):!0},_42:function(D,f){var l=this,a=Og.getBackups()._42;if(a.call(l,D,f),zd.inEdit(l)){var X=l.getEditInteractor();X.drawImpl()}}};zd.Inject.registAsModule(Og,gd);var jq=X.Default.getInternal().ui().ShapeUI,Od={_47O:function(J){var L=this,v=Od.getBackups()._47O;zd.inEdit(L.gv)||v.call(L,J)}};zd.Inject.registAsModule(Od,jq);var Ek=X.graph.DefaultInteractor,lk={handle_mousewheel:function(n){var s=this,C=lk.getBackup("handle_mousewheel");zd.inEdit(s.gv)||C.call(s,n)}};zd.Inject.registAsModule(lk,Ek);var af=X.graph.MoveInteractor,ub={_calcShift:function(_,D){var y=this,K=ub.getBackup("_calcShift"),e=y.gv;if(!zd.inEdit(e))return K.call(y,_,D);var x=e.getEditInteractor(),W=x.getSubModule("Move").calcShift(_,D,y);return W||K.call(y,_,D)},clear:function(e){var f=this,s=ub.getBackup("clear");s.call(f,e);var L=f.gv;if(zd.inEdit(L)){var H=L.getEditInteractor();H.getSubModule("Move").clear(e)}}};zd.Inject.registAsModule(ub,af);var fi=zd.Rect=function(F){this.catalog="Rect",this._interactor=F};fi.prototype={},fi.prototype.constructor=fi,fi.prototype.gatherInfo=function(S,V){var f=this;if(1===V.length){var u=V[0];return u instanceof X.Shape&&u._70I()?f.gatherLine(S,u):Dk(u,S)?!1:f.gatherSingleTarget(S,u)}return V.length>1?f.gatherMultiTargets(S,V):!1},fi.prototype.gatherSingleTarget=function(F,o){if(o.getCorners){var h,A=this,X=A.info;A.target=o,h=A.screenInfo={};var l=o.getCorners();X.LT=new zd.Math.Vector2(l[0]),X.LB=new zd.Math.Vector2(l[1]),X.RB=new zd.Math.Vector2(l[2]),X.RT=new zd.Math.Vector2(l[3]),X.T=X.LT.clone().add(X.RT).divideScalar(2),X.B=X.LB.clone().add(X.RB).divideScalar(2),X.L=X.LT.clone().add(X.LB).divideScalar(2),X.R=X.RT.clone().add(X.RB).divideScalar(2);for(var y in X)h[y]=zd.toScreenPosition(F,X[y]);var R=A._interactor,f=R.getStyle("checkSize"),c=function(Q,j,r){var B=j.clone().sub(Q).setLength(-f),s=r.clone().sub(Q).setLength(-f),Y=B.add(s).add(Q);return Y};return h.rotLT=c(h.LT,h.RT,h.LB),h.rotLB=c(h.LB,h.LT,h.RB),h.rotRB=c(h.RB,h.LB,h.RT),h.rotRT=c(h.RT,h.LT,h.RB),h.rotT=h.rotLT.clone().add(h.rotRT).divideScalar(2),h.rotB=h.rotLB.clone().add(h.rotRB).divideScalar(2),h.rotL=h.rotLT.clone().add(h.rotLB).divideScalar(2),h.rotR=h.rotRT.clone().add(h.rotRB).divideScalar(2),h.rotation=o.getRotation(),A.gatherConnectInfo(),!0}},fi.prototype.gatherConnectInfo=function(){var r=this,V=r.target,L=r._interactor,D=r.screenInfo,J=L.gv;if(J.isConnectActionVisible(V)&&L.getStyle("connectGuideVisible")){var f;V.s&&(f=V.s("connectGuideShift")),f||(f=L.getStyle("connectGuideShift"));var F=V.getAnchor(),B=V.getSize(),o=V.toGlobal({x:B.width*(f[0]-F.x),y:B.height*(f[1]-F.y)});o=zd.toScreenPosition(J,o),D.P1?o.add(D.P2.clone().sub(D.P1).setLength(f[2])):(o.add(D.RT.clone().sub(D.LT).setLength(f[2])),o.add(D.LB.clone().sub(D.LT).setLength(f[3]))),D.connect=o}},fi.prototype.gatherMultiTargets=function(i,A){var G=zd.Group.findOrCreateGroup(A);if(!G)return!1;var w=this;return w.editing&&"rotate"!==w.editing.mode||G.calcInfo(),w.gatherSingleTarget(i,G)},fi.prototype.gatherLine=function(S,e){this.target=e;var R=this.screenInfo={},d=e.getPoints(),E=zd.getDataMatrix(e);return R.P1=zd.toScreenPosition(S,E.apply(d.get(0))),R.P2=zd.toScreenPosition(S,E.apply(d.get(1))),this.gatherConnectInfo(),!0},fi.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],fi.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],fi.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],fi.prototype.check=function(s,M,y){if(X.Default.isLeftButton(M)){var n=this;if(n.editing=null,n.tipInfo=null,n.screenInfo){var t=n.target,z=s.isEditable(t),T=n.screenInfo;if(z&&T.connect){var O=n._checkConnect(y);if(O)return O}if(T.P1)return n._checkLine(y);var q,$,a,g=null,G=n._interactor,h=G.getStyle("checkSize");if(z&&s.isRectEditable(t))for($=0;$<zd.Rect.ResizeKeys.length;$++)if(a=zd.Rect.ResizeKeys[$],zd.checkHit(y,T[a],h)){g=a,q="resize";break}if(!g&&z&&s.isRotationEditable(t)&&!G.getStyle("rotateAsClock")){var H=G.getStyle("rotateCheckSize");for($=0;$<zd.Rect.RotateKeys.length;$++)if(a=zd.Rect.RotateKeys[$],zd.checkHit(y,T[a],H)){g=a,q="rotate";break}}if(!g)return G.setCursor("default"),void 0;if("rotate"===q){var r,e=s.lp(M);if(t instanceof zd.Group){var b=G.getStyle("groupRotateModeKey");"string"==typeof b&&(b=[b]);for(var f=!1,D=0,u=b.length;u>D;D++)if(M[b[D]]){f=!0;break}var E=G.getStyle("groupRotateModeDefault");r=f?"batch"===E?"block":"batch":E}var F="batch"===r?t.getAnchor2():t.getPosition(),d=Math.atan2(e.y-F.y,e.x-F.x);G._setRotateCursor(d),n.editing={mode:q,key:g,pos:F,flipY:t.getScale().y<0,rotation:t.getRotation(),hitRot:d},r&&(n.editing.groupRotateMode=r)}else{var W=zd.Rect.ResizeKeys.indexOf(g),i=zd.Rect.ResizeDirection[W],R=Math.cos(t.getRotation()),Z=Math.sin(t.getRotation()),k=i.x*Math.sign(t.getScale().x),U=i.y*Math.sign(t.getScale().y),I=Math.atan2(-Z*k-R*U,R*k-Z*U),Y=(Math.round(I/(Math.PI/4))+8)%8,N=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][Y];this._interactor.setCursor(N);var o=t.getWidth(),_=t.getHeight(),Q=t.getAnchor();n.editing={mode:q,key:g,rect:{x:-o*Q.x,y:-_*Q.y,width:o,height:_},anchor:Q,matrix:t.getMatrix()}}return g}}},fi.prototype._checkLine=function(H){var D=this;D.screenInfo;var W,C=D._interactor.getStyle("checkSize");if(zd.checkHit(H,D.screenInfo.P1,C))W="P1";else{if(!zd.checkHit(H,D.screenInfo.P2,C))return this._interactor.setCursor("default"),void 0;W="P2"}return D.editing={mode:"line",key:W},W},fi.prototype._checkConnect=function(o){var x=this,v=x.screenInfo,A=x._interactor,R=A.getStyle("connectGuideIntersectSize"),z=v.connect,q=o.x,s=z.x;if(s>q&&R>s-q&&Math.abs(z.y-o.y)<R||q>=s&&zd.checkHit(o,z,R)){var D="connect",y=U.getConnectAction(A.gv);if(x.editing={mode:D},y&&y.delete)if(x.target instanceof zd.Group){var p=!0;A.gv.sm().getSelection().each(function(j){y.delete.visible.call(null,A.gv,j)||(p=!1)}),x.editing.hasDeleteAction=p}else y.delete.visible.call(null,A.gv,x.target)&&(x.editing.hasDeleteAction=!0);return A.setCursor("default"),D}},fi.prototype._fireEditEvent=function(M,I){var T=this._interactor,k=this.editing;if(k){var i=k.mode;i="rotate"===i?"Rotation":"connect"===i?"Connection":i[0].toUpperCase()+i.slice(1),T.fi({kind:M+"Edit"+i,event:I})}},fi.prototype.startEdit=function(U,W){U.startDragging(W);var d=this;d._interactor.fi({kind:"prepareEdit",event:W});var z=d.editing,H=d.target;if(z){if(d._fireEditEvent("begin",W),"rotate"===z.mode)return z.groupRotateMode&&H.beginRotate(z),void 0;if("connect"!==z.mode)("line"===z.mode||H&&0===H.getRotation())&&(d._inSmartGuide=!0,d._interactor.rectGuide.gatherRects());else if(z.hasDeleteAction){var s=U.gv,B=d._interactor.getStyle("connectGuideGarbageShift");z.garbageInfo={x:s.getWidth()*B[0]+B[2],y:s.getHeight()*B[1]+B[3],size:d._interactor.getStyle("connectGuideGarbageIntersectsize")},U._42()}}},fi.prototype._46O=function(Y){var v,R,z=this,w=z.editing,F=z.target;if(w){if("connect"===w.mode&&!w.canceled&&!w.deleted)try{w.garbageInfo&&w.garbageInfo.hover?U.doDeleteConnectionAction(z._interactor.gv,F):U.doConnectAction(z._interactor.gv,F,w.target)}catch(A){console.error(A)}R=w.freezeFlag,v=z.editing.groupRotateMode,z._fireEditEvent("end",Y),z.editing=null}z.tipInfo=null,z._inSmartGuide&&(z._interactor.rectGuide.clear(),z._inSmartGuide=!1),v&&F&&F.endRotate(),F instanceof X.Block&&(R===f?delete F._freezeSyncFromChildren:F._freezeSyncFromChildren=R,F.updateFromChildren())},fi.prototype.handleNormalStateDelete=function(){var P=this,O=P.editing;if(O&&"connect"===O.mode&&!O.canceled&&!O.deleted){if(O.garbageInfo){try{U.doDeleteConnectionAction(P._interactor.gv,P.target)}catch(n){console.error(n)}O.garbageInfo=null}return O.cursorPos=null,O.targetCorners=null,O.deleted=!0,P._interactor._42(),!0}},fi.prototype.handleNormalStateKeyDown=function(D){var Z=this,S=Z.editing;return!S||"connect"!==S.mode||S.canceled||S.deleted?void 0:X.Default.isEsc(D)?(S.cursorPos=null,S.targetCorners=null,S.canceled=!0,Z._interactor._42(),!0):void 0},fi.prototype.handleEdit=function(S,v){var Z=this,C=Z.editing;if(C){var r,M,Q,n,T,P=Z.target,c=C.key,V=C.mode,Y=S.lp(v),y=Z._interactor;if("connect"===V){if(C.canceled)return;if(C.deleted)return;C.cursorPos=y._getLogicalPoint(v);var $=C.garbageInfo;return $&&zd.checkHit(C.cursorPos,$,$.size)?($.hover=!0,C.target=null,C.targetCorners=null):($&&($.hover=!1),C.target=S.getDataAt(Y,function(W){return S.isSelectable(W)?xp(W)?!0:!1:!1})||null,C.targetCorners=zd.getTargetCornersOnScreen(S,C.target)),y._42(),void 0}if("rotate"===V){var i,b,k=C.pos,D=Math.atan2(Y.y-k.y,Y.x-k.x);if(C.groupRotateMode?b=D-C.hitRot:(i=D-C.hitRot,b=C.rotation+i),b%=2*Math.PI,0>b&&(b+=2*Math.PI),!X.Default.isCtrlDown(v)){var L,o;xd(v)?(L=y.getStyle("shiftRotateRound"),o=L/2):(L=y.getStyle("rotateRound"),o=y.getStyle("rotateSensitivity")),b=zd.roundTo(b,L,o)}C.groupRotateMode?(i=b-(C.lastRotation||0),0!==i&&(P.addRotation(i,C.groupRotateMode),C.lastRotation=b)):P.setRotation(b),y._setRotateCursor(D),b>Math.PI&&(b-=2*Math.PI);var u=180*(b/Math.PI);u=u.toFixed(2),r=""+u+""}else if("resize"===V){var t=C.rect;Q=t.x,n=t.y;var j,R=t.width,d=t.height,U=C.anchor,g=C.matrix,e=P.s&&P.s("keepAspectRatio")||y.getStyle("keepAspectRatio");xd(v)&&(e=!e);var B=Z._unionPointMode1,N=Z._unionPointMode2;if(Z._inSmartGuide&&!X.Default.isCtrlDown(v)&&!e){var _;"L"===c||"R"===c?_="x":("T"===c||"B"===c)&&(_="y"),Z._adsorbedToClosest(Y,_),T=!0}j=g.tfi(Y);var W;"LT"===c?(t=B(j,{x:Q+R,y:n+d},R,d,e),W=9):"T"===c?(t=N({x:Q,y:j.y},{x:Q+R,y:n+d},R,d,e,"v"),W=1):"RT"===c?(t=B(j,{x:Q,y:n+d},R,d,e),W=33):"L"===c?(t=N({x:j.x,y:n},{x:Q+R,y:n+d},R,d,e,"h"),W=8):"R"===c?(t=N({x:Q,y:n},{x:j.x,y:n+d},R,d,e,"h"),W=32):"LB"===c?(t=B(j,{x:Q+R,y:n},R,d,e),W=12):"B"===c?(t=N({x:Q,y:n},{x:Q+R,y:j.y},R,d,e,"v"),W=4):"RB"===c&&(t=B(j,{x:Q,y:n},R,d,e),W=36);var K=g.tf(t.x+t.width*U.x,t.y+t.height*U.y);P instanceof X.Block&&(C.hasOwnProperty("freezeFlag")||(C.freezeFlag=P._freezeSyncFromChildren,P._freezeSyncFromChildren=!0)),P.setPosition(K),P.setSize(t.width,t.height),T&&(M=P.getRect(),y.rectGuide.gatherLines({node:P,x:M.x,y:M.y,w:M.width,h:M.height},_,W)),r=""+Math.round(t.width)+" * "+Math.round(t.height)}else if("line"===V){if(xd(v)){var f=P.getPoints(),A="P1"===c?f.get(1):f.get(0),J={x:Y.x-A.x,y:Y.y-A.y},G=y.getStyle("shiftLineRotateRound"),E=Z._shiftDirList;if(!E||Z._shiftRotateRound!==G){Z._shiftRotateRound=G,Z._shiftDirList=E=[];for(var w=0;w<Math.PI;w+=G)E.push({x:x(w),y:p(w)})}for(var h,I=0,l=0,F=E.length;F>l;l++){var a=E[l],H=a.x*J.x+a.y*J.y;Math.abs(H)>Math.abs(I)&&(I=H,h=a)}Y={x:A.x+h.x*I,y:A.y+h.y*I},y.rectGuide.clear()}else Z._inSmartGuide&&!X.Default.isCtrlDown(v)&&(Z._adsorbedToClosest(Y),T=!0);var q=zd.getDataMatrix(P).applyInverse(Y);P.setPoint("P1"===c?0:1,q,!0);var s=P.getPoints(),z=s.get(0),O=s.get(1);Q=z.x-O.x,n=z.y-O.y,r=" "+Math.round(Math.sqrt(Q*Q+n*n))+" ",T&&(M=P.getRect(),y.rectGuide.gatherLines({node:P,x:M.x,y:M.y,w:M.width,h:M.height}))}if(r){var m=X.Default.getLogicalPoint(v,y._canvas);m.x+=zd.Icons.TipShiftX,m.y+=zd.Icons.TipShiftY,Z.tipInfo={helperPos:m,text:r,size:r.length}}Z._fireEditEvent("between",v)}},fi.prototype._unionPointMode1=function(j,f,r,d,q){if(q&&r&&d){var x=j.x-f.x,e=j.y-f.y;Math.abs(x*d)<Math.abs(e*r)?(e=Math.sign(e)*Math.abs(x*d/r),j.y=f.y+e):(x=Math.sign(x)*Math.abs(e*r/d),j.x=f.x+x)}return X.Default.unionPoint(j,f)},fi.prototype._unionPointMode2=function(e,d,B,s,b,I){var N=X.Default.unionPoint(e,d);if(b&&B&&s){var S;"v"===I?(S=N.x+N.width/2,N.width=B*N.height/s,N.x=S-N.width/2):(S=N.y+N.height/2,N.height=s*N.width/B,N.y=S-N.height/2)}return N},fi.prototype._adsorbedToClosest=function(O,B){var y=this,M=y._interactor,e=M.rectGuide.findClosest(O,B),c=M.gridGuide.findClosest(O,B),u=1/0,H=1/0;e&&(isFinite(e.x)&&(u=e.x),isFinite(e.y)&&(H=e.y)),c&&(isFinite(c.x)&&Math.abs(c.x)<Math.abs(u)&&(u=c.x),isFinite(c.y)&&Math.abs(c.y)<Math.abs(H)&&(H=c.y)),isFinite(u)&&(O.x+=u),isFinite(H)&&(O.y+=H)},fi.prototype._42=function(l,P,G){var Q=this;Q.info={},Q.screenInfo=null;var U=Q._interactor;if(!U.editDetail&&Q.gatherInfo(P,G)){var I=Q.editing,H=I?I.groupRotateMode:null,D=Q.screenInfo;if("block"!==H){if(D.P1?zd.Icons.DrawIcon(U,l,zd.Icons.Line,D):zd.Icons.DrawIcon(U,l,zd.Icons.Rect,D),D.connect&&(zd.Icons.DrawIcon(U,l,zd.Icons.ConnectGuide,{rotation:D.rotation,connect:D.connect,cursorPos:I?I.cursorPos:null}),I)){if(I.targetCorners){for(var j={x:1/0,y:1/0},f={x:-1/0,y:-1/0},c=0,h=I.targetCorners.length;h>c;c+=2)j.x=Math.min(j.x,I.targetCorners[c]),f.x=Math.max(f.x,I.targetCorners[c]),j.y=Math.min(j.y,I.targetCorners[c+1]),f.y=Math.max(f.y,I.targetCorners[c+1]);zd.Icons.DrawIcon(U,l,zd.Icons.HoverDataRect,{min:j,max:f,color:U.getStyle("hoverGuideColor")||U.getStyle("baseColor")})}I.garbageInfo&&zd.Icons.DrawIcon(U,l,zd.Icons.ConnectGuideGarbage,I.garbageInfo)}Q.tipInfo&&zd.Icons.DrawIcon(U,l,zd.Icons.TipHelper,Q.tipInfo)}Q.target instanceof zd.Group&&Q.target._42(U,l,P)}};var Qd=zd.Anchor=function(F){this.catalog="Anchor",this._interactor=F};Qd.prototype={},Qd.prototype.constructor=Qd,Qd.prototype.gatherInfo=function(S,b){var Z=this;if(1===b.length){var l=b[0];if(!l.getAnchor)return;if(l instanceof X.Shape&&l._70I())return;if(Dk(l,S))return;return Z.gatherSingleTarget(S,b[0])}return b.length>1?Z.gatherMultiTargets(S,b):!1},Qd.prototype.gatherSingleTarget=function(s,d){var E=this;return E.info.POS=d.getPosition(),E.screenInfo.POS=zd.toScreenPosition(s,E.info.POS),E.target=d,!0},Qd.prototype.gatherMultiTargets=function(V,J){var P=this,k=zd.Group.findOrCreateGroup(J);return k?(P.screenInfo.POS=zd.toScreenPosition(V,k.getAnchor2()),P.target=k,!0):!1},Qd.prototype.isVisible=function(){var k=this,g=k._interactor;if(g.getStyle("anchorVisible")===!1)return!1;var O=k.target;if(O){if(this.editing)return!0;var c=O.getAnchor(),R=g.getStyle("anchorOutsideVisibleThreshold");if(c.x<-R||c.x>1+R||c.y<-R||c.y>1+R)return!0;var Q=O.getSize(),Y=O.getScale(),h=Math.min(Math.abs(Q.width*Y.x),Math.abs(Q.height*Y.y));if(h*g.gv._zoom<g.getStyle("anchorHideThreshold"))return!1}return!0},Qd.prototype.check=function($,h,r){if(X.Default.isLeftButton(h)){var Y=this,T=Y._interactor;if(Y.isVisible()&&T.getStyle("anchorMovable")!==!1){Y.editing=null,Y.tipInfo=null;var Z=Y.target;if(Z&&$.isAnchorEditable(Z)&&$.isEditable(Z)){var x;if(Y.screenInfo&&(x=Y.screenInfo.POS)&&zd.checkHit(r,new zd.Math.Vector2(x),T.getStyle("checkSize"))){if(Z instanceof zd.Group)return Y.editing={},!0;var M=Z.getWidth(),c=Z.getHeight(),q=Z.getAnchor();return Y.editing={rect:{x:-M*q.x,y:-c*q.y,width:M,height:c},anchor:q,matrix:Z.getMatrix()},!0}}}}},Qd.prototype.startEdit=function(H,x){H.startDragging(x),H.fi({kind:"beginEditAnchor",event:x})},Qd.prototype._46O=function(d){var z=this;z.editing&&(z.editing=null,z._interactor.fi({kind:"endEditAnchor",event:d})),z.tipInfo=null},Qd.prototype.handleEdit=function(P,R){var j=this,M=j.target;if(M){var S=j.editing;if(S){var B=P.lp(R),h=j._interactor;if(M instanceof zd.Group)return M.setAnchor2(B),h._42(),void 0;var C=S.matrix,v=C.tfi(B),U=S.rect,x=(v.x-U.x)/U.width,o=(v.y-U.y)/U.height;if(!X.Default.isCtrlDown(R)){var J=h.getStyle("anchorRound"),Y=h.getStyle("anchorSensitivity");x=zd.roundTo(x,J,Y),o=zd.roundTo(o,J,Y)}M.setAnchor(x,o,!0);var F=X.Default.getLogicalPoint(R,h._canvas);F.x+=zd.Icons.TipShiftX,F.y+=zd.Icons.TipShiftY;var w=""+x.toFixed(2)+", "+o.toFixed(2);j.tipInfo={helperPos:F,text:w,size:w.length},h.fi({kind:"betweenEditAnchor",event:R})}}},Qd.prototype._42=function(z,e,c){var V=this;V.info={},V.screenInfo={};var b=V._interactor;b.editDetail||V.gatherInfo(e,c)&&V.isVisible()&&(zd.Icons.DrawIcon(b,z,zd.Icons.Anchor,V.screenInfo),V.tipInfo&&zd.Icons.DrawIcon(b,z,zd.Icons.TipHelper,V.tipInfo))};var vd=zd.MoveDummy=function(d){this.catalog="MoveDummy",this._interactor=d};vd.prototype={},vd.prototype.constructor=vd,vd.prototype.gatherInfo=function(){var N=this,P=this._interactor.getSubModule("Rect");if(P){var f=P.screenInfo;if(f){var t=N._interactor,p=N.getMovableTarget(P.target);if(p){var I=t.getStyle("moveDummyVisible"),v=f.LT||f.P1,n=f.RT||f.P2,B=f.LB||v;if(v){var a=f.P1,Q=Math.min(v.distanceTo(B),v.distanceTo(n));if(!(Q>I)){var w=t.getStyle("moveDummyPosition"),e=n.clone().sub(v),x=B.clone().sub(v),Y=w[2],s=w[3];if(a){var L=t.getStyle("moveDummyLineExtraShift");L&&(Y+=L[0],s+=L[1])}var r=v.clone().add(e.clone().multiplyScalar(w[0])).add(e.setLength(Y)).add(x.clone().multiplyScalar(w[1])).add(x.setLength(s));return N.screenInfo.pos=r,N.screenInfo.size=t.getStyle("moveDummySensitivity"),!0}}}}}},vd.prototype.getMovableTarget=function(O){var k=this._interactor.gv;if(xp(O)){if(k.isMovable(O))return O}else if(O instanceof zd.Group)for(var o=O._entities,R=o.length-1;R>=0;R--){var m=o[R];if(xp(m)&&k.isMovable(m))return m}return null},vd.prototype.getMoveInteractor=function(){for(var V,d,q,Z=this._interactor.gv,e=Z.getInteractors(),V=0,d=e.length;d>V;V++)if(q=e.get(V),q instanceof af)return q},vd.prototype.startEdit=function(a,z){a.startDragging(z);var Z=this.getMoveInteractor();if(Z){var C=this.selectedTarget,_=a.gv;_._moving=1,Z._data=C,_.handleMouseDown&&_.handleMouseDown(z,C)}},vd.prototype._46O=function(c){var p=this,V=p.getMoveInteractor();V&&(V.handleWindowMouseUp(c),p.selectedTarget=null)},vd.prototype.handleEdit=function(N,S){var J=this.getMoveInteractor();J&&J.handleWindowMouseMove(S)},vd.prototype.check=function(M,m,B){if(this.selectedTarget=null,X.Default.isLeftButton(m)&&!M._scrolling&&!Db()){var N=this,d=N.screenInfo.pos;if(d&&!(B.distanceTo(d)>N.screenInfo.size)){var G=N._interactor;return N.selectedTarget=N.getMovableTarget(G.getSubModule("Rect").target),G.setCursor("default"),!0}}},vd.prototype._42=function(M,H,f){var o=this;o.screenInfo={};var F=o._interactor;F.editDetail||o.gatherInfo(H,f)&&(!F.editing||o.selectedTarget)&&zd.Icons.DrawIcon(F,M,zd.Icons.MoveDummy,o.screenInfo)};var fr=zd.RotateX=function(k){this.catalog="RotateX",this._interactor=k};fr.prototype={},fr.prototype.constructor=fr,fr.prototype.gatherInfo=function(P,z){var T=this;if(1===z.length){var a=z[0];return a instanceof X.Shape&&a._70I()||Dk(a,P)?!1:T.gatherSingleTarget(P,a)}return z.length>1?T.gatherMultiTargets(P,z):!1},fr.prototype.gatherSingleTarget=function(){var S=new X.Math.Vector2,Y=new X.Math.Vector2,F=new X.Math.Vector2,W=new X.Math.Vector2,k=function(Z,r){var N=Z.x-r.x,L=Z.y-r.y;return N*N+L*L};return function(j,c){if(c.getCorners){var J=this,e=c.getCorners(),X=15,I=c.getPosition();S.copy(e[0]),F.copy(e[1]),W.copy(e[3]),Y.copy(S).add(W).divideScalar(2).add(S.sub(F).setLength(X/j.getZoom()));var $=Math.max(k(I,e[0]),k(I,e[1]),k(I,e[2]),k(I,e[3]));return J.info.POS=Y.clone(),J.screenInfo.POS=zd.toScreenPosition(j,J.info.POS),J.screenInfo.LEN=Math.sqrt($)*j.getZoom()+X,J.screenInfo.CENTER=zd.toScreenPosition(j,I),J.target=c,!0}}}(),fr.prototype.gatherMultiTargets=function(S,B){var J=this,C=zd.Group.findOrCreateGroup(B);if(!C)return!1;var J=this;return J.gatherSingleTarget(S,C)},fr.prototype.isVisible=function(){var i=this._interactor;if(!i.getStyle("rotateAsClock"))return!1;var H=this.target;if(!H)return!0;var p=i.gv;return p.isEditable(H)&&p.isRotationEditable(H)?!0:!1},fr.prototype.check=function(n,N,v){var X=this,A=X._checkImpl(n,N,v);return(A||X._clockPainted)&&X._interactor._42(),A},fr.prototype._checkImpl=function(P,K,v){if(X.Default.isLeftButton(K)){var j=this;j.editing=null,j.tipInfo=null;var A;if(j.screenInfo&&(A=j.screenInfo.POS)&&j.isVisible()){var E=j._interactor;if(zd.checkHit(v,A,E.getStyle("checkSize"))){var $=j.target,M=P.lp(K),k=$.getPosition(),R=Math.atan2(M.y-k.y,M.x-k.x);return E._setRotateCursor(R),j.editing={pos:k,rotation:$.getRotation(),hitRot:R,groupRotateMode:"block",screenInfo:{CENTER:j.screenInfo.CENTER,LEN:j.screenInfo.LEN}},!0}}}},fr.prototype.startEdit=function(k,D){k.startDragging(D),k.fi({kind:"beginEditRotation",event:D}),this.target instanceof zd.Group&&this.target.beginRotate(this.editing)},fr.prototype._46O=function(t){var r=this;r.editing&&(r.editing=null,r._interactor.fi({kind:"endEditRotation",event:t})),r.target instanceof zd.Group&&r.target.endRotate(),r.tipInfo=null},fr.prototype.handleEdit=function(b,d){var D=this,O=D.editing;if(O){var C,s,w=D.target,V=b.lp(d),P=D._interactor,z=O.pos,L=Math.atan2(V.y-z.y,V.x-z.x),A=w instanceof zd.Group;if(A?s=L-O.hitRot:(C=L-O.hitRot,s=O.rotation+C),s%=2*Math.PI,0>s&&(s+=2*Math.PI),!X.Default.isCtrlDown(d)){var R,Z;xd(d)?(R=P.getStyle("shiftRotateRound"),Z=R/2):(R=P.getStyle("rotateRound"),Z=P.getStyle("rotateSensitivity")),s=zd.roundTo(s,R,Z)}A?(C=s-(O.lastRotation||0),0!==C&&(w.addRotation(C,O.groupRotateMode),O.lastRotation=s)):w.setRotation(s),P._setRotateCursor(L),s>Math.PI&&(s-=2*Math.PI);var M=180*(s/Math.PI),j=""+M.toFixed(2)+"",W=X.Default.getLogicalPoint(d,P._canvas);W.x+=zd.Icons.TipShiftX,W.y+=zd.Icons.TipShiftY,D.tipInfo={helperPos:W,text:j,size:j.length},P.fi({kind:"betweenEditRotation",event:d})}},fr.prototype._42=function(v,I,m){var P=this;P._clockPainted=!1,P.info={},P.screenInfo={};var F=P._interactor;F.editDetail||P.gatherInfo(I,m)&&P.isVisible()&&(zd.Icons.DrawIcon(F,v,zd.Icons.RoundPoint,P.screenInfo.POS),P.tipInfo&&zd.Icons.DrawIcon(F,v,zd.Icons.TipHelper,P.tipInfo),P.editing&&P.drawClock(v))},fr.prototype.drawClock=function(R){R.save();var u=this;u._clockPainted=!0;var I=u.editing||{},r=I.screenInfo||u.screenInfo,n=r.LEN,e=n+8,F=n+18;R.save(),R.translate(r.CENTER.x,r.CENTER.y),R.beginPath(),R.strokeStyle="rgb(150, 150, 150)";for(var b,U,z,V,k,v=0;360>v;v++)b=v*Math.PI/180,0===v%5&&(U=p(b)*n,z=x(b)*n,V=p(b)*e,k=x(b)*e,R.moveTo(U,z),R.lineTo(V,k)),0===v%45&&(U=p(b)*n,z=x(b)*n,V=p(b)*F,k=x(b)*F,R.moveTo(U,z),R.lineTo(V,k));R.stroke(),R.rotate(-N);var l=I.lastRotation||u.target.getRotation();R.beginPath(),R.fillStyle="rgba(255, 0, 0, 0.1)",R.strokeStyle="rgb(157, 157, 157)",R.moveTo(0,0),R.arc(0,0,F,0,l,!1),R.fill(),R.beginPath(),R.moveTo(0+F,0),R.arc(0,0,F,0,l,!1),R.stroke(),R.restore()};var Ef=zd.Curve=function(c){this.catalog="Curve",this._interactor=c};Ef.prototype={},Ef.prototype.constructor=Ef,b.defineProperties(Ef.prototype,{activing:{get:function(){return this._activing},set:function(r){var M=this;if(r)M._activing=new zd.CurveActiving(this,r);else{var j=M._activing;j&&j.dispose(),M._activing=null}}}}),Ef.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Ef.prototype.setUp=function(){var r=this,M=r._interactor;M&&M.gv.mp(r._onGraphviewPropertyChanged,r)},Ef.prototype._onGraphviewPropertyChanged=function(c){("zoom"===c.property||"translateX"===c.property||"translateY"===c.property)&&this._handleDataChanged()},Ef.prototype.tearDown=function(){var C=this,J=C._interactor;J&&J.gv.ump(C._onGraphviewPropertyChanged,C)},Ef.prototype.canEnterEditDetailMode=function(){var $=this,e=$._interactor,s=e._getValidSelection();if(1===s.length){var N=s[0],M=N instanceof X.Edge;if(N instanceof X.Shape||M){if(M){var h=N.s("edge.type");if(h&&"points"!==h)return}var u=e.gv;if(u.isPointEditable(N)&&u.isEditable(N))return $.target=N,!0}}},Ef.prototype.canQuitEditDetailMode=function(j){var l=this,k=l._interactor._getLogicalPoint(j);return l._checkEditRealPoint(k)?void 0:l._interactor.gv.getDataAt(j)!==l.target?!0:void 0},Ef.prototype.preHandleScroll=function(){var t=this.editing;return t&&t.inEdit?!0:void 0},Ef.prototype.getCurrentSelectintStatus=function(){var D=this;if(D.activing&&!D.activing.selections){if(D.activing.status!=f)return D.activing.status;var w=function(n){var U=D.activing.status;D.activing.status=n,D._interactor.fp("shapePointStatus",U,n)},m=zd.Curve.PointType,x=D.activing.point,s=D.activing.pairs;if(!s||1!==s.length)return w(m.Mirrored);var z=s[0],e=z.c1&&z.c1.isNearEnough(x),u=z.c2&&z.c2.isNearEnough(x);if(!z.c1||!z.c2)return e||u?w(m.Straight):w(m.Disconnected);if(e&&u)return w(m.Straight);if(e||u)return w(m.Asymmetric);var j=z.c1.clone().sub(x),M=z.c2.clone().sub(x);return Math.abs(j.x*M.y-j.y*M.x)>1e-5||j.x*M.x>0?w(m.Disconnected):Math.abs(j.length()-M.length())>1e-5?w(m.Asymmetric):w(m.Mirrored)}},Ef.prototype.handle_keydown=function(b){var E=this;if(E._interactor.editDetail){var J=zd.Curve.PointType;"1"===b.key?E._setCurrentSelectionStatus(J.Straight):"2"===b.key?E._setCurrentSelectionStatus(J.Mirrored):"3"===b.key?E._setCurrentSelectionStatus(J.Disconnected):"4"===b.key&&E._setCurrentSelectionStatus(J.Asymmetric)}},Ef.prototype.setCurrentSelectionStatus=function(q){var N=this,F=N._interactor;if(F){var W=F.gv;W.dm().beginTransaction(),this._setCurrentSelectionStatus(q),W.dm().endTransaction()}},Ef.prototype._setCurrentSelectionStatus=function(l){var S=this,f=S.activing;if(f){var G=S.getCurrentSelectintStatus();if(null!==G&&G!==l){f.status=l;var x=S.activing.point,k=S.activing.pairs;if(k&&1===k.length){var y=k[0],_=S.screenInfo.curve,O=zd.Curve.PointType,R=function(){S._writeToHt(),S._interactor.fp("shapePointStatus",G,l)};if(l===O.Straight)return _.moveCtrlPoint(y,x,"c1"),_.moveCtrlPoint(y,x,"c2"),R(),void 0;if(G===O.Straight){var U=_.findPairs(x,!0),b=U[0],Y=b.r1||x,t=b.r2||x,V=t.clone().sub(Y).multiplyScalar(.25);return _.moveCtrlPoint(y,x.clone().sub(V),"c1"),_.moveCtrlPoint(y,x.clone().add(V),"c2"),R(),void 0}var w=y.c1,v=y.c2;if(w&&v){if(l===O.Mirrored)return _.moveCtrlPoint(y,x.clone().multiplyScalar(2).sub(v),"c1"),R(),void 0;if(l===O.Asymmetric&&G===O.Disconnected){var d=w.clone().sub(x).length(),V=x.clone().sub(v).setLength(d).add(x);return _.moveCtrlPoint(y,V,"c1"),R(),void 0
}}f._firePointChange(),S._interactor.fp("shapePointStatus",G,l)}}}},Ef.prototype._handleDataChanged=function(){var S="points,segments,shape,position,rotation,scale".split(",");return function(U){var r=this;if(r.screenInfo&&r.target){if(U&&S.indexOf(U.property)<0)return;var A=r._interactor;r.gatherSingleTarget(A.gv,r.target,!0),r.check(A.gv,null,new zd.Math.Vector2(A._lastClientPoint)),A._42()}}}(),Ef.prototype.gatherSingleTarget=function(i,o,Y){var b,M,P=this;P.screenInfo&&P.screenInfo.curve&&(M=P.screenInfo.curve._curves);var m=P.editing;b=m?P.screenInfo:P.screenInfo={};var O,k,s=o instanceof X.Edge;s?(O=o.s("edge.segments"),k=o.s("edge.points")||new X.List):(O=o._58O,k=o._59O),b.S=O;var B,u=b.P=[],L=zd.getDataMatrix(o);if(o instanceof X.Polyline&&(B=o.getElevation()||0,b.E=[]),k.each(function(T){b.E&&b.E.push(T.e||B),T=L.apply(T);var W=zd.toScreenPosition(i,T);u.push(W.x,W.y)}),s){var p=zd.toScreenPosition(i,o._lastSourcePoint),I=zd.toScreenPosition(i,o._lastTargetPoint);u.splice(0,0,p.x,p.y),u.push(I.x,I.y)}if(!b.S||!b.S.size()){b.S=new X.List,b.S.add(1);for(var C=0;C<u.length/2-1;C++)b.S.add(2)}if((!m||Y)&&P.convertToCubicBezier(M),P.activing&&(Y||!P.editing||"realPoint"===P.editing.type)){var Q=b.curve.findPairs(P.activing.point);P.activing.pairs=Q}s&&"points"!==o.s("edge.type")&&P._writeToHt()},Ef.prototype._convertToNewPoint=function(z,b,h){var L,O,y;for(L=0,O=b.length;O>L;L++){if(y=b[L],y._p1.isNearEnough(z))return y._p1;if(y._p4.isNearEnough(z))return y._p4}if(h)for(L=0,O=Math.min(h.length,O);O>L;L++){if(y=h[L],y._p1===z)return b[L]._p1;if(y._p4===z)return b[L]._p4}},Ef.prototype.convertToCubicBezier=function(z){var C,K,B=this,V=new zd.Math.Curve,c=B.screenInfo;if(V.createFromHtShape(c.P,c.S,c.E),c.curve=V,B.activing){var G=V._curves;if(C=B.activing.point,K=B._convertToNewPoint(C,G,z),K&&(B.activing.point=K),B.activing.selections){var U=-1,l=B.activing.selections;l.forEach(function(R){U++,K=B._convertToNewPoint(R,G,z),K&&(l[U]=K)})}}},Ef.prototype.check=function(W,j,_){if(!j||js(j)||Gh(j)){var m=this;if(m._interactor.setCursor("default"),m.editing=null,m.highlight=null,m.tipInfo=null,m.edgeEditResult=null,m.screenInfo){if(Db()||Gh(j))return m._interactor._42(),!0;if(m._checkEditCtrlPoint(_))return m._interactor._42(),!0;if(m._checkEditRealPoint(_))return m._interactor._42(),!0;if(m._checkEditElevation(_))return m._interactor._42(),!0;var O=m.screenInfo.curve,X=O.checkPoint(_,m._interactor.getStyle("curveIntersectSize"));if(X){var c=m.highlight={};c.type="insertKnot",c.bezier=X.bezier,c.point=X.intersection}return m._interactor._42(),!0}}},Ef.prototype._checkEditRealPoint=function(T){var i,C,s,o,M,a,q=this,y=q.screenInfo.curve._curves,e=q._interactor.getStyle("curvePointIntersectSize"),G=1/0;for(e*=e,s=0,o=y.length;o>s;s++)i=y[s],M=i._p1,a=T.distanceToSquared(M),G>a&&(G=a,C=M),M=i._p4,a=T.distanceToSquared(M),G>a&&(G=a,C=M);if(G>e)return!1;var Z=q.highlight={};return Z.type="changeRealPoint",Z.point=C,q.editing={type:"realPoint",point:C,shiftGuide:{point:C.clone(),dir:"x",limit:0}},q._interactor.setCursor("crosshair"),!0},Ef.prototype._checkEditElevation=function(A){var g=this;if(!g._interactor.getStyle("curveElevationVisible"))return!1;var O=g.activing;if(!O)return!1;var m=O.getCurrentEditingPoint();if(!m)return!1;var L=g._interactor,H=L.getStyle("curveElevationGuideShift"),i=L.getStyle("curveElevationIntersectSize"),M=A.distanceToSquared({x:m.x+H[0],y:m.y+H[1]});if(!(M>i*i)){var y=g.highlight={};y.type="elevation";var d=new zd.Math.Vector2(A.x,A.y,m.e);return g.editing={type:"elevation",startPoint:d},g._interactor.setCursor("crosshair"),!0}},Ef.prototype._checkEditCtrlPoint=function(g){var o=this;if(o.activing&&!o.activing.selections){var Z=o.getCurrentSelectintStatus();if(Z!==zd.Curve.PointType.Straight){var W=o.activing.pairs;if(W){var q=o._interactor.getStyle("curvePointIntersectSize");q*=q;var s,x,y,b,n,k,r,Y,m,w=1/0;for(r=0,m=W.length;m>r;r++)for(b=W[r],Y=0;2>Y;Y++)n=0===Y?"c1":"c2",b[n]&&(k=g.distanceToSquared(b[n]),w>k&&(w=k,s=b,x=r,y=n));if(w>q)return!1;o.activing.hlpair=s,o.activing.hltype=y;var l=o.highlight={};return l.type="changeCtrlPoint",l.point=s[y],o.editing={type:"ctrlPoint",pair:s,pairId:x,ctrlType:y,direction:s[y].clone().sub(o.activing.point).normalize()},o._interactor.setCursor("crosshair"),!0}}}},Ef.prototype.startEdit=function(D,w){D.startDragging(w);var x=this;x.highlight&&"insertKnot"===x.highlight.type&&(x.insertKnot(),x.gatherSingleTarget(x._interactor.gv,x.target),x.activing=null,x._checkEditRealPoint(x._interactor._getLogicalPoint(w)));var $=x._activing;if($){var f=x.editing?x.editing.type:null;"ctrlPoint"===f?$.editingCtrl={pairId:x.editing.pairId,type:$.hltype}:"realPoint"===f&&($.editingCtrl=!1)}var d=x.highlight,i=X.Default.isCtrlDown(w);if(!d||Db()||Gh(w)){var c=x._interactor.gv;if(!c.setFocus(w)||c._scrolling)return;return i?x._multiSelect={startPoint:c.lp(w)}:c.isPannable()&&(js(w)||Gh(w))&&(x._pan={tx:c.tx(),ty:c.ty()},D.fi({kind:"beginPan",event:w})),void 0}if("changeRealPoint"===d.type){var U,y=x.activing?x.activing.point:null,Z=x.activing?x.activing.selections:null;if(i&&x.activing)y===d.point?(Z?(x.activing={point:Z[0]},Z.length>1&&(Z.splice(0,1),x.activing.selections=Z)):x.activing=null,x.editing=null):Z&&(U=Z.indexOf(d.point))>=0?(Z.length>1?Z.splice(U,1):delete x.activing.selections,x.editing=null):Z?(Z.push(y),x.activing={point:d.point,selections:Z}):x.activing={point:d.point,selections:[y]};else if(Z)y===d.point||((U=Z.indexOf(d.point))>=0?(Z.splice(U,1,y),x.activing={point:d.point,selections:Z}):x.activing={point:d.point});else{var T;y===d.point&&(T=x.activing.status),x.activing={point:d.point},T&&(x.activing.status=T)}D.fi({kind:"beginEditPoint",event:w})}},Ef.prototype.insertKnot=function(){var j=this,I=j.highlight,$=j.screenInfo.curve;$.insertKnot(I.bezier,I.point.t),j._writeToHt()},Ef.prototype._writeToHt=function(){var o,h,I,y,w=this,R=w.screenInfo.curve,Y=R.toHtShape(),e=Y.points,H=[],Z=Y.segments,U=w._interactor.gv,T=w.target,J=T instanceof X.Edge,C=zd.getDataMatrix(T).invert();y=T instanceof X.Polyline,y&&(I=T.getElevation());for(var K=0,Q=e.length;Q>K;K++)o=e[K],h=zd.toWorldPosition(U,o),h=C.apply(h),o.e!=f&&o.e!==I&&(h.e=o.e),H.push(h);if(T._writing=!0,J){T.s("edge.type","points"),T.setStyle("edge.segments",Z),T.setStyle("edge.points",H.slice(1,H.length-1)),T.setStyle("edge.source.offset.x",0),T.setStyle("edge.source.offset.y",0),T.setStyle("edge.target.offset.x",0),T.setStyle("edge.target.offset.y",0);var c=w._nextChangeEdgeHost;delete w._nextChangeEdgeHost,c&&("source"===c.type?T.setSource(c.host):T.setTarget(c.host)),w._writeEdgeHostAnchor("source",H[0]),w._writeEdgeHostAnchor("target",H[H.length-1])}else H.length?(T.setSegments(Z),T.setPoints(H,!0)):T.removeFromDataModel();delete T._writing},Ef.prototype._writeEdgeHostAnchor=function(H,m){var N=this,P=N.target,R=N._calcHostAnchor(P,H,m);R.index!==f?(P.setStyle("edge."+H+".index",R.index),P.setStyle("edge."+H+".percent",f),P.setStyle("edge."+H+".anchor.x",f),P.setStyle("edge."+H+".anchor.y",f)):R.percent!==f?(P.setStyle("edge."+H+".percent",R.percent),P.setStyle("edge."+H+".index",f),P.setStyle("edge."+H+".anchor.x",f),P.setStyle("edge."+H+".anchor.y",f)):(P.s("edge."+H+".anchor.x",R.x),P.s("edge."+H+".anchor.y",R.y),R.offsetX||R.offsetY?(P.s("edge."+H+".offset.x",R.offsetX),P.s("edge."+H+".offset.y",R.offsetY)):(P.s("edge."+H+".offset.x",0),P.s("edge."+H+".offset.y",0)))},Ef.prototype._calcHostAnchor=function(R,T,U,a){a||(a="source"===T?R.getSource():R.getTarget());var L=this._interactor.gv,G=L.calculateAttachPoint(a,U);if(G)return G.info;if(ej(a)){var j=L.calculateEdgePosition(a,U);return j}var X=a.getRotation(),x=a.getAnchor();if(Dk(a,L)&&(X=0),X){var O=a.getMatrix(),A=O.tfi(U),Y=a.getSize();return{x:A.x/Y.width+x.x,y:A.y/Y.height+x.y}}var w=wo(L,a),k={x:(U.x-w.x)/w.width,y:(U.y-w.y)/w.height};return k},Ef.prototype._handlePanning=function(X){var f=this,j=f._pan;if(j){j.started=!0;var t=f._interactor,y=t.gv,d=t._lastClientPoint,k=Jl(X),W=fo(y,k,d);y.setTranslate(j.tx+W.x,j.ty+W.y),f.gatherSingleTarget(t.gv,f.target),t._42(),t.fi({kind:"betweenPan",event:X})}},Ef.prototype.handleEdit=function(i,P){var A=this,$=A.editing;if(A._pan)return A._handlePanning(P),void 0;if(A._multiSelect)return A._multiSelect.endPoint=i.lp(P),A._interactor.redraw(),void 0;if($){$.inEdit=!0;var y,H,G,V=A._interactor._getLogicalPoint(P),q=X.Default.isCtrlDown(P),U=X.Default.isShiftDown(P),d=$.type,n=A.activing;if(A._guideInfo=null,"ctrlPoint"===d&&U){var M=A.editing.direction.clone();y=n.point;var D=M.dot(V.clone().sub(y));V=M.setLength(D).add(y)}else if("ctrlPoint"===d||"realPoint"===d){var M;if("realPoint"===d&&U){var W=A.editing.shiftGuide;H=W.point;var e=Math.abs(V.x-H.x),r=Math.abs(V.y-H.y);e>r&&e>W.limit&&"y"===W.dir&&(W.dir="x"),r>e&&r>W.limit&&"x"===W.dir&&(W.dir="y"),M=W.dir,"x"===M?(V.y=H.y,W.limit=Math.max(W.limit,e)):"y"===M&&(V.x=H.x,W.limit=Math.max(W.limit,r))}var R=A._isEditEdgeSourceTarget();if(R){var v=A._editEdgeSourceTarget(R,V,q);v&&(A.edgeEditResult=v,G=v.tipText)}else if(!q){var j=A._guidingToEdit(V,M),J="realPoint"===d?A._interactor.gridGuide.findClosest(V,M,!0):null,K=1/0,u=1/0;J&&(J.x&&(K=J.x),J.y&&(u=J.y));var O=!1;j&&(j.xList&&(Math.abs(j.x)<=Math.abs(K)?(O=!0,K=j.x):delete j.xList),j.yList&&(Math.abs(j.y)<=Math.abs(u)?(O=!0,u=j.y):delete j.yList),O&&(A._guideInfo=j)),isFinite(K)&&(V.x+=K),isFinite(u)&&(V.y+=u),O&&(j.v=V)}}var Z=A.screenInfo.curve;if("realPoint"===$.type){y=$.point,y.e!==f&&(V.e=y.e),Z.moveRealPoint(y,V),$.point=V,A.highlight.point=V;var Q=n.status,l=n.selections;if(A.activing={point:V,status:Q},l){var o=V.clone().sub(y),g=0;l.forEach(function(U){var n=U.clone().add(o);Z.moveRealPoint(U,n),l[g++]=n}),A.activing.selections=l}}else if("ctrlPoint"===$.type){var T=n.pairs,p=T[$.pairId];Z.moveCtrlPoint(p,V,$.ctrlType);var S=n.status,b=zd.Curve.PointType;if((S===b.Mirrored||S===b.Asymmetric)&&p.c1&&p.c2){var y=new zd.Math.Vector2(n.point),Y="c1"===$.ctrlType?"c2":"c1";if(S===zd.Curve.PointType.Mirrored)Z.moveCtrlPoint(p,y.clone().multiplyScalar(2).sub(V),Y);else if(S===b.Asymmetric){var D=p[Y].clone().sub(y).length(),B=y.clone().sub(p[$.ctrlType]).setLength(D).add(y);isNaN(B.x)||Z.moveCtrlPoint(p,B,Y)}}n._firePointChange()}else if("elevation"===$.type){H=$.startPoint;var x=H.e+(H.y-V.y)/i._zoom;A._setCurrentPointImpl("e",x),n._firePointChange(),G="E: "+zd.toFixed(x)}var _=X.Default.getLogicalPoint(P,A._interactor._canvas);if(_.x+=zd.Icons.TipShiftX,_.y+=zd.Icons.TipShiftY,!G){var F=zd.toWorldPosition(i,V);G=""+zd.toFixed(F.x)+", "+zd.toFixed(F.y)}A.tipInfo={helperPos:_,text:G,size:G.length},A._writeToHt(),A._interactor.fi({kind:"betweenEditPoint",event:P})}},Ef.prototype._setCurrentPointImpl=function(F,z){var N=this,k=N._activing;if(!k)return!1;var J=N.target;if(!J)return!1;var c=k.getCurrentEditingPoint();if(!c)return!1;var D=k.editingCtrl;if(!D)var A=c.clone();if("e"===F)c.e=z;else{var l;if("x"===F||"y"===F){var r=k._lastFirePoint;l="x"===F?{x:z,y:r?r.y:0}:{x:r?r.x:0,y:z}}else"object"==typeof F?(l=F,F.e!==f&&(c.e=F.e)):(l={x:arguments[0],y:arguments[1]},arguments[2]!==f&&(c.e=arguments[2]));var y=zd.getDataMatrix(J);l=zd.toScreenPosition(N._interactor.gv,y.apply(l)),c.x=l.x,c.y=l.y}if(!D){var s=A.multiplyScalar(-1).add(c);c.e&&A.e&&(s.e=c.e-A.e),N.screenInfo.curve.moveCtrlDueToRealPointMovement(c,s)}return!0},Ef.prototype.setCurrentPoint=function(H,Z){return this._setCurrentPointImpl(H,Z)?(this._writeToHt(),!0):!1},Ef.prototype._isEditEdgeSourceTarget=function(){var Q=this,U=Q.target;if(!(U instanceof X.Edge))return!1;var C=Q.editing.point,L=Q.screenInfo.curve._curves;return C===L[0]._p1?"source":C===L[L.length-1]._p4?"target":!1},Ef.prototype._editEdgeSourceTarget=function(J,Z,s){var q,p=this,u=p.target;if(q="source"===J?u.getSource():u.getTarget()){var o,d=p._interactor.gv,b=zd.toWorldPosition(d,Z),B=p._calcHostAnchor(u,J,b,q);if(o=B.index!==f||B.percent!==f?B.distance*d.getZoom()>p._interactor.getStyle("edgeHostEdgeMaxDistance"):p._interactor.getStyle("edgeHostDetectPerFrame")?!0:B.x<0||B.x>1||B.y<0||B.y>1?!0:!1){var H=d.getDataAt(b,function(H){return d.isSelectable(H)?H===q?!1:u.canSetSourceTarget(H,J)?!0:!1:!1});if(H){var X=p._calcHostAnchor(u,J,b,H);q=H,p._nextChangeEdgeHost={type:J,host:H},B=X}}var $,h,N;if(s||B.x===f)(B.percent!==f||B.index!==f)&&(h=B.point);else{var T=p._interactor.getStyle("anchorRound"),V=p._interactor.getStyle("anchorSensitivity");$=d.calculateAttachPoint(q,b),$?B=$.info:(B.x=zd.roundTo(B.x,T,V),B.y=zd.roundTo(B.y,T,V)),h=q.getAttachPosition(B.x,B.y,B.offsetX,B.offsetY)}h&&(N=zd.toScreenPosition(d,h),Z.x=N.x,Z.y=N.y),p._edgeHostGuideInfo={corners:zd.getTargetCornersOnScreen(d,q),attach:$?$.index:-1,host:q};var v;return B.percent!==f?v="percent: "+B.percent.toFixed(2):B.index!==f?v="index: "+B.index:(v=""+B.x.toFixed(2)+", "+B.y.toFixed(2),(B.offsetX||B.offsetY)&&(v+=" offset: "+B.offsetX.toFixed(2)+", "+B.offsetY.toFixed(2))),{host:q,anchor:B,tipText:v}}},Ef.prototype._guidingToEdit=function(K,N){var u,r,f=this;if(u=f.screenInfo.curve){r=u._curves;var o,n,t,s,C,J,F,Y,k=1/0,j=1/0,y=[];for(f.editing&&"realPoint"===f.editing.type&&(Y=f.editing.point),C=0,J=2*r.length;J>C;C++)F=r[Math.floor(C/2)][C%2?"_p4":"_p1"],y.indexOf(F)>=0||(y.push(F),Y&&Y===F||(t=F.x-K.x,s=F.y-K.y,Math.abs(t)<Math.abs(k)?(k=t,o=[F]):t===k&&o.push(F),Math.abs(s)<Math.abs(j)?(j=s,n=[F]):s===j&&n.push(F)));var z=f._interactor.getStyle("smartGuideSensitivity");if((Math.abs(k)>z||"y"===N)&&(o=null),(Math.abs(j)>z||"x"===N)&&(n=null),o||n){var _=!1,d={};if(o&&(_=!0,d.xList=o,d.x=k),n&&(_=!0,d.yList=n,d.y=j),_)return d}}},Ef.prototype._46O=function(F){var v=this;v.editing&&(v.editing=null,v._interactor.fi({kind:"endEditPoint",event:F})),v._guideInfo=null,v._edgeHostGuideInfo=null,v._pan&&(v._pan=null,v._interactor.fi({kind:"endPan",event:F})),v._multiSelect&&(v._handleMultiSelect(v._multiSelect),v._multiSelect=null),v.tipInfo=null,v.edgeEditResult=null},Ef.prototype._handleMultiSelect=function(A){if(A.startPoint&&A.endPoint){var p,i,G,x,q,I=this,e=I._interactor,b=e.gv,g=zd.toScreenPosition(b,A.startPoint),u=zd.toScreenPosition(b,A.endPoint),v=X.Default.unionPoint(g,u),s=I.screenInfo.curve._curves,n=[],t=function(Z){Z.x>=v.x&&Z.y>=v.y&&Z.x<=v.x+v.width&&Z.y<=v.y+v.height&&n.indexOf(Z)<0&&n.push(Z)};for(p=0,i=s.length;i>p;p++)q=s[p],t(q._p1),t(q._p4);if(n.length){var T=I.activing||{},F=T.selections||[];for(T.point&&F.push(T.point),p=0,i=F.length;i>p;p++)G=F[p],x=n.indexOf(G),x>=0?n[x]=f:n.push(G);var B=n;for(n=[],p=0,i=B.length;i>p;p++)B[p]&&n.push(B[p]);i=n.length,0===i?I.activing=null:1===i?I.activing={point:n[0]}:(G=n[i-1],I.activing={point:G,selections:n.splice(0,i-1)}),e.redraw()}}},Ef.prototype._canDeletePoint=function(w,v){var C=this.target;if(!(C instanceof X.Edge))return!0;var x=w._curves[0],H=w._curves[w._curves.length-1];return x._p1===v||H._p4===v?!1:!0},Ef.prototype.handleDelete=function(){var V=this;if(V.activing&&V.screenInfo){var b=X.Default.isShiftDown(),T=V.screenInfo.curve;V._canDeletePoint(T,V.activing.point)&&T.deleteRealPoint(V.activing.point,b),V.activing.selections&&V.activing.selections.forEach(function(s){V._canDeletePoint(T,s)&&T.deleteRealPoint(s,b)}),V.activing=null,delete V.editing,delete V.tipInfo,delete V.edgeEditResult,delete V._pan,delete V._multiSelect,V._writeToHt(),V._interactor.fp("deleteShapePoint",!1,!0)}},Ef.prototype.handleDoubleClick=function(z){var y=this,F=y._interactor._getLogicalPoint(z);if(y.screenInfo&&y._checkEditRealPoint(F)){var C=y.getCurrentSelectintStatus(),W=zd.Curve.PointType;return C=C===W.Mirrored?W.Straight:W.Mirrored,y._setCurrentSelectionStatus(C),y._interactor._42(),!0}},Ef.prototype._drawHighlight=function(F){var R=this,W=R.highlight;if(W){var w=W.bezier,P=R._interactor;w&&zd.Icons.DrawIcon(P,F,zd.Icons.ShapeHighlightCurve,[w._p1.x,w._p1.y,w._p2.x,w._p2.y,w._p3.x,w._p3.y,w._p4.x,w._p4.y]);var y=W.point;y&&"insertKnot"===W.type&&zd.Icons.DrawIcon(P,F,zd.Icons.ShapeHighlighPoint,y)}},Ef.prototype._drawGuide=function(O){var F=this,B=F._guideInfo;if(B){var x,c,e,X,_=B.v;for(x=0;2>x;x++)if(X=0===x?B.xList:B.yList)for(c=0,e=X.length;e>c;c++)zd.Icons.DrawIcon(F._interactor,O,zd.Icons.ShapeGuideLine,[_.x,_.y,X[c].x,X[c].y])}},Ef.prototype._drawCurrentPoint=function(T){var c=this;if(c.activing){var j=c.activing,l=c.getCurrentSelectintStatus(),i=c._interactor;if(l!==zd.Curve.PointType.Straight){var n=j.pairs;j.hlpair,j.hltype;var d=j.selections,b=j.editingCtrl;if(n&&!d){var k,S,P;for(S=0,P=n.length;P>S;S++)k=n[S],b&&S===b.pairId&&k[b.type]?zd.Icons.DrawIcon(i,T,zd.Icons.ShapeActivingCtrl,{point:k.point,c1:k.c1,c2:k.c2,hl:b.type}):zd.Icons.DrawIcon(i,T,zd.Icons.ShapeActivingCtrl,k)}}zd.Icons.DrawIcon(i,T,zd.Icons.ShapeHighlighRealPoint,c.activing.point),d&&d.forEach(function(_){zd.Icons.DrawIcon(i,T,zd.Icons.ShapeHighlighRealPoint,_)})}},Ef.prototype.clear=function(){var D=this;D.editing=null,D._guideInfo=null,D.activing=null,D.highlight=null},Ef.prototype._42=function(Y){var u=this;u.info={},u.editing||(u.screenInfo=null);var v=u._interactor;if(!v.editDetail)return u.clear(),void 0;var H=v.gv;if(!u.target||!H.isSelected(u.target)||!H.isVisible(u.target))return v.editDetail=!1,u.clear(),void 0;if(u.gatherSingleTarget(H,u.target),zd.Icons.DrawIcon(v,Y,zd.Icons.ShapeBgCurve,u.screenInfo),u._drawHighlight(Y),u._drawCurrentPoint(Y),u._getRealPoint().forEach(function(b){zd.Icons.DrawIcon(v,Y,zd.Icons.ShapePoint,b)}),u._drawGuide(Y),u.tipInfo&&zd.Icons.DrawIcon(v,Y,zd.Icons.TipHelper,u.tipInfo),u._edgeHostGuideInfo){zd.Icons.DrawIcon(v,Y,zd.Icons.NodeHoverGuide,u._edgeHostGuideInfo.corners);var K=u._edgeHostGuideInfo.host;if(K){var Q=H.getAttachPoints(K);if(Q&&Q.length)for(var W=0,L=Q.length;L>W;W++){var e=Q[W],f=K.getAttachPosition(e.x,e.y,e.offsetX,e.offsetY);f=zd.toScreenPosition(H,f),f.isAttach=u._edgeHostGuideInfo.attach===W,zd.Icons.DrawIcon(v,Y,zd.Icons.AttachPoint,f)}}}if(u._interactor.getStyle("curveElevationVisible")&&u.target instanceof X.Polyline&&u.activing){var V=u.activing.getCurrentEditingPoint();V&&zd.Icons.DrawIcon(v,Y,zd.Icons.EdgeElevationGuide,V)}if(u.edgeEditResult&&u._drawEdgeHostHighlight(Y,u.edgeEditResult.host,u.edgeEditResult.anchor),u._multiSelect&&u._multiSelect.endPoint){var t=X.Default.unionPoint(zd.toScreenPosition(H,u._multiSelect.startPoint),zd.toScreenPosition(H,u._multiSelect.endPoint));t.color=H.getRectSelectBorderColor(),Y.save(),Y.setTransform(1,0,0,1,0,0);var l=M.devicePixelRatio,T=t.borderWidth=Math.round(l);T/=2,t.x=Math.round(t.x*l)+T,t.y=Math.round(t.y*l)+T,t.width=Math.round(t.width*l),t.height=Math.round(t.height*l),zd.Icons.DrawIcon(v,Y,zd.Icons.SimpleRect,t),Y.restore()}},Ef.prototype._drawEdgeHostHighlight=function(m,c,Q){this.drawEdgeHostHighlight(m,c,Q),this._interactor.redraw()},Ef.prototype.drawEdgeHostHighlight=function(j,z,e){if(ej(z)){var v,H,F,M,d=this,k=d._interactor,R=k.gv,P=R.getDataUI(z),o=rr(P),l=[];for(F=0,M=o.points.length;M>F;F++)H=zd.toScreenPosition(R,o.points.get(F)),l.push(H.x,H.y);o.segments&&(v=o.segments.toArray());var X=k.getStyle("edgeHostHighlighPeriod"),N=k.getStyle("edgeHostEdgeHighlighColor");zd.Icons.DrawIcon(k,j,zd.Icons.ShapeBgCurve,{P:l,S:v,color:N,dynamicVisible:e.index===f,dynamicPeriod:X}),N=k.getStyle("edgeHostPointHighlighColor");var C=eo(P);for(F=0,M=C.length;M>F;F++){var O=C[F],B=zd.toScreenPosition(R,O);zd.Icons.DrawIcon(k,j,zd.Icons.ShapePoint,{point:{x:B.x,y:B.y},color:N,size:12,dynamicVisible:F===e.index,dynamicPeriod:X})}}},Ef.prototype._getRealPoint=function(){var A,h=this.screenInfo,c=h.P,i=h.S,U=-1,S=[],k=-1,p=i.length;return i.each(function(G){k++;var j=1;if(3===G)j=2;else if(4===G)j=3;else if(5===G)return;U+=j,A=k+1>=p?!0:1===i.get(k+1)?!0:!1,S.push({point:{x:c[2*U],y:c[2*U+1]},segmentIndex:k,pointIndex:U,isEnd:A})}),S},Ef.prototype.getEditingPointsInfo=function(O){var Q=this,l=Q.activing;if(!l)return!1;var h=l.point;if(!h)return!1;var m=this._getRealPoint(),s=[{screen:h}];l.selections&&l.selections.forEach(function(p){s.push({screen:p})});var A,q,b=m.length;return s.forEach(function(W){for(A=0;b>A;A++)if(q=m[A],W.screen.isNearEnough(q.point)){W.segmentIndex=q.segmentIndex,W.pointIndex=q.pointIndex,W.point=Q.target.getPoints().get(q.pointIndex);break}}),O&&s.sort(function(Z,B){return Z.segmentIndex-B.segmentIndex}),s};var qj=zd.MoveHelper=function(Z){var N=this;N.catalog="Move",N._interactor=Z};qj.prototype={},qj.prototype.constructor=qj,qj.prototype.calcShift=function(Q,B,i){var f,H,z=this,I=z._interactor.gv,k=I.lp(B);if("beginMove"===Q&&z._gatherGridInfo(i._lastLogicalPoint||k),f=z._target){var A=f.downPosition;if(A){var m=z._interactor.getStyle("moveSensitivity")/I._zoom;if(A.distanceTo(k)<m)return{x:0,y:0};delete f.downPosition}var W;H=X.Default.isShiftDown(B),H&&(k=z._dealShiftDown(k),W=f.shiftGuide.dir);var U,R=f.rawPos={x:f.pos.x+k.x-f.lp.x,y:f.pos.y+k.y-f.lp.y};if(X.Default.isCtrlDown(B)){if(U=z._calcShiftByAddon(),z._target.node instanceof zd.Group){var b=z._target.node;b._position.x+=U.x,b._position.y+=U.y}return U}for(var j,x=f.x+R.x,E=f.y+R.y,e={x:x,y:E},r={x:x+f.w/2,y:E+f.h/2},n={x:x+f.w,y:E+f.h},F=z._interactor.rectGuide,o=z._interactor.gridGuide,$=[F.findClosest(e,W),F.findClosest(r,W),F.findClosest(n,W),o.findClosest(e,W),o.findClosest(r,W),o.findClosest(n,W)],Y=1/0,O=1/0,M=0,C=$.length;C>M;M++)j=$[M],j&&(x=j.x,E=j.y,isFinite(x)&&Math.abs(x)<Math.abs(Y)&&(Y=x),isFinite(E)&&Math.abs(E)<Math.abs(O)&&(O=E));if(isFinite(Y)||(Y=0),isFinite(O)||(O=0),U=z._calcShiftByAddon(Y,O),z._target.node instanceof zd.Group){var b=z._target.node;b._position.x+=U.x,b._position.y+=U.y}var p=f.node;if(!Dk(p,I)){var d=R.x+Y,L=R.y+O;z._interactor.rectGuide.gatherLines({node:p,x:f.x+d,y:f.y+L,w:f.w,h:f.h},W)}return U}},qj.prototype._calcShiftByAddon=function(p,I){var B=this._target,N=B.rawPos,F=B.node.getPosition();return p=p||0,I=I||0,{x:N.x-F.x+p,y:N.y-F.y+I}},qj.prototype._dealShiftDown=function(u){var N=this,D=N._target.shiftGuide,J=N._target.lp,y=Math.abs(u.x-J.x),i=Math.abs(u.y-J.y);y>i&&y>D.limit&&"y"===D.dir&&(D.dir="x"),i>y&&i>D.limit&&"x"===D.dir&&(D.dir="y");var A=D.dir;return"x"===A?(u.y=J.y,D.limit=Math.max(D.limit,y)):"y"===A&&(u.x=J.x,D.limit=Math.max(D.limit,i)),u},qj.prototype._gatherGridInfo=function(a){var L,Q=this,r=Q._interactor,$=r._getValidSelection();if($.length){if(1===$.length){if(L=$[0],!L.getRect)return Q._target=null,void 0}else if(L=zd.Group.findOrCreateGroup($),!L)return Q._target=null,void 0}else{var $=r.gv.sm().getSelection();if($.length&&(L=$.get(0),!L.getRect))return Q._target=null,void 0}var K=L.getPosition(),Z=L.getRect();Q._target={node:L,x:Z.x-K.x,y:Z.y-K.y,w:Z.width,h:Z.height,lp:{x:a.x,y:a.y},pos:{x:K.x,y:K.y},shiftGuide:{dir:"x",limit:0},downPosition:new zd.Math.Vector2(a)},r.rectGuide.gatherRects()},qj.prototype.clear=function(){var U=this;U._interactor.rectGuide.clear(),U._interactor._42()};var yb="directional",Dp="point",xf="spot",vn="light.color",Rk=function(S,s){Bs(s)&&Dg.test(s)?ve(S,s):Il(s)&&s.modelType?Bm(S,s):rl[S]=s},jr=function(a){if(Il(a))return a.modelType?a.uuid?rl[a.uuid]:(a.uuid=X.Math.generateUUID(),Bm(a.uuid,a),f):a;var _=rl[a];return a&&_===f&&Dg.test(a)&&(ab&&ab[a]||ve(a,a)),_},Ig=function(C,h){C.frameStack?C.frameStack.push(h):C.frameStack=[h],C.bindFramebuffer(C.FRAMEBUFFER,h)},hm=function(v){var N=v.frameStack;if(N){if(N.pop(),N.length)return v.bindFramebuffer(v.FRAMEBUFFER,N[N.length-1]),void 0;v.frameStack=null}v.bindFramebuffer(v.FRAMEBUFFER,null)};ae(U,{graph3dViewAttributes:u,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:y/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:dp,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:y/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,setShape3dModel:Rk,getShape3dModel:jr,createMatrix:function(Q,X){En(Q)||(Q=[Q]);for(var t=Q.length-1;t>=0;t--){var n=Q[t];X=Cm(n.mat,n.s3,n.r3,n.rotationMode,n.t3,X)}return X},transformVec:function(Y,I){return Jo(Y,I)},glBindFrame:Ig,glUnbindFrame:hm,createBoxModel:function(){return{vs:Zp,ns:wl,uv:md,is:Rr}},createRoundRectModel:function(c,p){return Jf.roundRect(c,p)},createStarModel:function(v,G){return Jf.star(v,G)},createRectModel:function(t,W){return Jf.rect(t,W)},createTriangleModel:function(x,b){return Jf.triangle(x,b)},createRightTriangleModel:function(r,V){return Jf.rightTriangle(r,V)},createParallelogramModel:function(y,Z){return Jf.parallelogram(y,Z)},createTrapezoidModel:function(H,J){return Jf.trapezoid(H,J)},createSmoothSphereModel:function(S,A,H,C,W,Q,t){return gf(new Kh(S,A,H,C,W,Q,t))},createSphereModel:function(l,A,I,z,s,n){return l?fj(l,A,I,z,s,n):U.createSmoothSphereModel()},createSmoothConeModel:function(v,R,w,z,I){return en(v,R,w,z,I)},createConeModel:function(V,w,X,g,o,A){return V?Se(V,w,X,g,o,A):en(A)},createSmoothCylinderModel:function(n,J,q,N,B,b,f,l){return gf(new Sc(n,J,q,N,B,b,f,l))},createCylinderModel:function(l,E,t,W,j,N,v){return l?Vl(l,E,t,W,j,N,v):pi(N,v)},createSmoothTorusModel:function(x,y,I,H,k,s){return gf(new qg(x,y,I,H,k,s))},createTorusModel:function(i,g,W,G,O,t,n){return i?jd(i,g,W,G,O,t,n):jp(t,n)},createExtrusionModel:function(z,$,g,k,l,P,N,s){return Rf(z,$,g,k,l,P,N,s)},createSmoothRingModel:function(x,n,h,W,B,l){for(var T=[],N=0;N<x.length-1;N+=2)T.push({x:x[N],y:x[N+1]});for(x=Lm(T,n,h)[0],T=[],N=0;N<x.length;N++){var D=x[N];T.push(new Fh(D.x,0,D.y))}return gf(new us(T,l,W,B))},createTextGeometry:function(f,U){return gf(new Tm(f,U))},loadFontFace:function(Y,_){U.xhrLoad(Y,function(k){if(!k)return _();var G;try{G=JSON.parse(k)}catch(y){G=JSON.parse(k.substring(65,k.length-2))}sg.loadFace(G),_&&_(G.familyName.toLowerCase())},_?null:{sync:!0})},createRingModel:function(F,c,y,$,T,L,w,E,B,f){for(var O=[],b=0;b<F.length-1;b+=2)O.push({x:F[b],y:F[b+1]});L=L||U.shapeSide,w=w||0,E=E||L;var d,N,Q,A,l,Z,k,G,h,J,b,t,q,M,R,V,s,Y,C=[],_=[],r=B?[]:u,K=B?[]:u,m=f?[]:u,j=f?[]:u,i=$?[]:u,H=$?[]:u,W=T?[]:u,X=T?[]:u,F=Lm(O,c,y),P=br(F),z=0,o=2*Math.PI/L;return F.forEach(function(e){if(Q=e.length,Q>1){if(A=e[0],$)for(Z=A.x,G=A.y,b=w;E>b;b++)t=b+1,q=b*o,M=t*o,R=p(q),V=x(q),s=p(M),Y=x(M),i.push(R*Z,G,-V*Z,s*Z,G,-Y*Z,0,G,0),H.push(.5-.5*R,.5-.5*V,.5-.5*s,.5-.5*Y,.5,.5);for(J=0;Q>J;J++){for(l=e[J],Z=A.x,k=l.x,G=A.y,h=l.y,d=z/P,z+=Di(A,l),N=z/P,b=w;E>b;b++)t=b+1,q=b*o,M=t*o,R=p(q),V=x(q),s=p(M),Y=x(M),C.push(R*k,h,-V*k,s*k,h,-Y*k,R*Z,G,-V*Z,s*k,h,-Y*k,s*Z,G,-Y*Z,R*Z,G,-V*Z),_.push(b/L,N,t/L,N,b/L,d,t/L,N,t/L,d,b/L,d),B&&b===w&&(r.push(0,G,0,0,h,0,R*k,h,-V*k,R*k,h,-V*k,R*Z,G,-V*Z,0,G,0),K.push(0,.5-G,0,.5-h,2*k,.5-h,2*k,.5-h,2*Z,.5-G,0,.5-G)),f&&t===E&&(m.push(0,G,0,s*k,h,-Y*k,0,h,0,s*k,h,-Y*k,0,G,0,s*Z,G,-Y*Z),j.push(1,.5-G,1-2*k,.5-h,1,.5-h,1-2*k,.5-h,1,.5-G,1-2*Z,.5-G));A=l}if(T)for(Z=A.x,G=A.y,b=w;E>b;b++)t=b+1,q=b*o,M=t*o,R=p(q),V=x(q),s=p(M),Y=x(M),W.push(s*Z,G,-Y*Z,R*Z,G,-V*Z,0,G,0),X.push(.5-.5*s,.5+.5*Y,.5-.5*R,.5+.5*V,.5,.5)}}),{vs:C,uv:_,bottom_vs:W,bottom_uv:X,top_vs:i,top_uv:H,from_vs:r,from_uv:K,to_vs:m,to_uv:j}}},!0),ae(W,{"3d.move.mode":f,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":f,"edge.gradient.color":f,"edge.source.t3":f,"edge.target.t3":f,"light.type":Dp,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":y/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":dr,"wf.short":!1,"wf.mat":f,"wf.geometry":!1,batch:f,"transparent.mask":!1,brightness:f,"select.brightness":.7,"repeat.uv.length":f,alphaTest:.4,renderTextureSamples:4,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"shape3d.vector.dynamic.maxsize":2048,"label.face":gr,"label.t3":f,"label.r3":f,"label.texture.scale":2,"label.rotationMode":Tb,"label.light":!1,"label.blend":f,"label.reverse.flip":!1,"label.reverse.color":Tg,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":gr,"label2.t3":f,"label2.r3":f,"label2.texture.scale":2,"label2.rotationMode":Tb,"label2.light":!1,"label2.blend":f,"label2.reverse.flip":!1,"label2.reverse.color":Tg,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":gr,"note.t3":f,"note.r3":f,"note.texture.scale":2,"note.rotationMode":Tb,"note.light":!1,"note.blend":f,"note.reverse.flip":!1,"note.reverse.color":Tg,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":gr,"note2.t3":f,"note2.r3":f,"note2.texture.scale":2,"note2.rotationMode":Tb,"note2.light":!1,"note2.blend":f,"note2.reverse.flip":!1,"note2.reverse.color":Tg,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:f,"shape3d.color":iq,"shape3d.top.color":f,"shape3d.bottom.color":f,"shape3d.from.color":f,"shape3d.to.color":f,"shape3d.image":f,"shape3d.top.image":f,"shape3d.bottom.image":f,"shape3d.from.image":f,"shape3d.to.image":f,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":f,"shape3d.side.to":f,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":f,"shape3d.opacity":f,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Tg,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":f,"shape3d.uv.scale":f,"shape3d.top.uv.offset":f,"shape3d.top.uv.scale":f,"shape3d.bottom.uv.offset":f,"shape3d.bottom.uv.scale":f,"shape3d.from.uv.offset":f,"shape3d.from.uv.scale":f,"shape3d.to.uv.offset":f,"shape3d.to.uv.scale":f,"shape3d.top.cap":f,"shape3d.bottom.cap":f,"shape3d.start.angle":0,"shape3d.sweep.angle":e,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":f,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":iq,"all.image":f,"all.blend":f,"all.opacity":f,"all.reverse.flip":!1,"all.reverse.color":Tg,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":f,"all.uv.offset":f,"all.uv.scale":f,"all.discard.selectable":!0,mat:f,"left.mat":f,"right.mat":f,"top.mat":f,"bottom.mat":f,"front.mat":f,"back.mat":f},!0);var cd,Tf=!1,fn=[0,0,0,0],Eh={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:nk,2:yq,3:hk,4:nh,5:gr,6:cl}},Vn=function(a,X,t,v){if(X.getFaceVisible(a,t)){Sb(X,Ge(a,X.getFaceMat(a,t)||X.getMat(a)));var h=X._26I;X.getFaceReverseCull(a,t)?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),oi(h,X._prg.uFixPickReverseColor,Eh[t]),cc(h),Nq(h,v,6),Sm(h),Uj(X)}},Bj=function(t){return t instanceof wn},gs=function(N){return[N.x,N.e||0,N.y]},Fl=function(_,s,q){for(var s=Ke(s),e=s[0],Q=s[1],V=s[2];q--;)_.push(e,Q,V)},Uf=function(I,H,n){for(var H=Ke(H),b=H[0],t=H[1],F=H[2],G=H[3];n--;)I.push(b,t,F,G)},Po=function(A,O,y){if(O)for(var C,P,g,T=O[0],w=O[1],R=O[2],z=O[4],G=O[5],n=O[6],c=O[8],v=O[9],d=O[10],$=O[12],h=O[13],j=O[14],q=y.length,Q=0,Q=0;q>Q;Q+=3)C=y[Q],P=y[Q+1],g=y[Q+2],A.push(T*C+z*P+c*g+$,w*C+G*P+v*g+h,R*C+n*P+d*g+j);
else Ab(A,y)},Oj=function(t,B){var Y=B.s("light.intensity"),n=Ke(B.s(vn)),N=n[0],j=n[1],E=n[2];1!==Y&&(N*=Y,j*=Y,E*=Y),t.push(N,j,E,B.s("light.disabled")?1:0)},Ap=function(R,F,W){oi(F,W.uHeadlightRange,R._headlightRange);var t=R._headlightIntensity,U=Ke(R._headlightColor);1!==t&&(U=[U[0]*t,U[1]*t,U[2]*t]),oi(F,W.uHeadlightColor,[U[0],U[1],U[2],R._headlightDisabled?1:0]);var b=R._59O,x=R._spots,v=R._dirs;if(b.length){var P=[],K=[],y=[];b.forEach(function(v){Oj(P,v),Ab(K,R._transformPointToViewSpace(v.p3())),y.push(v.s("light.range"))}),F.uniform4fv(W.uPointColor,P),F.uniform1fv(W.uPointRange,y),F.uniform3fv(W.uPointPosition,K)}if(x.length){var _=[],h=[],f=[],w=[],i=[],V=[];x.forEach(function(b){Oj(_,b),Ab(h,R._transformPointToViewSpace(b.p3())),Ab(i,R._transformDirectionToViewSpace(b.p3(),b.s("light.center"))),f.push(b.s("light.range")),w.push(p(b.s("light.angle")/2)),V.push(b.s("light.exponent"))}),F.uniform4fv(W.uSpotColor,_),F.uniform1fv(W.uSpotRange,f),F.uniform1fv(W.uSpotAngle,w),F.uniform1fv(W.uSpotExponent,V),F.uniform3fv(W.uSpotPosition,h),F.uniform3fv(W.uSpotDirection,i)}if(v.length){var D=[],u=[];v.forEach(function(v){Oj(D,v),Ab(u,R._transformDirectionToViewSpace(v.p3()))}),F.uniform4fv(W.uDirColor,D),F.uniform3fv(W.uDirDirection,u)}},Mm=function(H){return H>0&&0===(H-1&H)},zo=function(v){return v=l(0,I(y,v)),v=l(mo,I(y-mo,v))},Xg=function(){return.05+d()/2},an=function(R,k,N,C){var b,g=R.getEye();return R.isOrtho()?(b=Zq(R.getCenter(),g),b[0]+=C[0],b[1]+=C[1],b[2]+=C[2]):b=g,ec(k,N,C,b)},ec=function(x,I,H,R){var Y=yk(x,I),z=Zq(R,H,!0),t=yk(z,I);if(k(t)<mo)return u;var p=(Y-yk(H,I))/t;return[H[0]+z[0]*p,H[1]+z[1]*p,H[2]+z[2]*p]},yr=function(J,m){return{x:2*J.x-m.x,y:2*J.y-m.y}},Dd=function(i,h,D,v){var d,Y;if(!i)return d=$(h.y-D.y,D.x-h.x),{x:h.x+v*x(d),y:h.y+v*p(d)};if(!D)return d=$(i.y-h.y,h.x-i.x),{x:h.x+v*x(d),y:h.y+v*p(d)};var N=Zq([i.x,i.y,0],[h.x,h.y,0],!0),J=Zq([D.x,D.y,0],[h.x,h.y,0],!0),t=-(N[0]+J[0])/2,q=-(N[1]+J[1])/2,E=r(t*t+q*q);if(mo>E)return d=$(i.y-h.y,h.x-i.x),{x:h.x+v*x(d),y:h.y+v*p(d)};var k=i.x-h.x,S=i.y-h.y,Q=D.x-h.x,g=D.y-h.y,b=r(k*k+S*S),f=r(Q*Q+g*g);d=T(yk(N,J))/2,Y=N[1]*J[0]-N[0]*J[1]>0?-1:1,t/=E,q/=E;var L=v/x(d),w=l(b,f)/p(d);E=Math.min(L,w);var H={x:h.x+Y*E*t,y:h.y+Y*E*q};return D.b&&L>f/p(d)&&(H.adjust=!0),H},Mi=function(R){var v=R[1],E=R[2],B=R[3],X=R[6],z=R[7],V=R[11];R[1]=R[4],R[2]=R[8],R[3]=R[12],R[4]=v,R[6]=R[9],R[7]=R[13],R[8]=E,R[9]=X,R[11]=R[14],R[12]=B,R[13]=z,R[14]=V},Yc=function(X){var J=X[0],k=X[1],A=X[2],G=X[3],r=X[4],g=X[5],p=X[6],Z=X[7],W=X[8],y=X[9],K=X[10],P=X[11],o=X[12],B=X[13],w=X[14],m=X[15],L=J*g-k*r,I=J*p-A*r,a=J*Z-G*r,e=k*p-A*g,D=k*Z-G*g,M=A*Z-G*p,z=W*B-y*o,Y=W*w-K*o,S=W*m-P*o,q=y*w-K*B,N=y*m-P*B,E=K*m-P*w,t=L*E-I*N+a*q+e*S-D*Y+M*z;return t?(t=1/t,X[0]=(g*E-p*N+Z*q)*t,X[1]=(A*N-k*E-G*q)*t,X[2]=(B*M-w*D+m*e)*t,X[3]=(K*D-y*M-P*e)*t,X[4]=(p*S-r*E-Z*Y)*t,X[5]=(J*E-A*S+G*Y)*t,X[6]=(w*a-o*M-m*I)*t,X[7]=(W*M-K*a+P*I)*t,X[8]=(r*N-g*S+Z*z)*t,X[9]=(k*S-J*N-G*z)*t,X[10]=(o*D-B*a+m*L)*t,X[11]=(y*a-W*D-P*L)*t,X[12]=(g*Y-r*q-p*z)*t,X[13]=(J*q-k*Y+A*z)*t,X[14]=(B*I-o*e-w*L)*t,X[15]=(W*e-y*I+K*L)*t,void 0):u},Ah=function(X,e){if(e){var E=e[0],$=e[1],d=e[2];X[12]=X[0]*E+X[4]*$+X[8]*d+X[12],X[13]=X[1]*E+X[5]*$+X[9]*d+X[13],X[14]=X[2]*E+X[6]*$+X[10]*d+X[14],X[15]=X[3]*E+X[7]*$+X[11]*d+X[15]}},_d=function(Y,f){if(f){var U=f[0],y=f[1],u=f[2];Y[0]=Y[0]*U,Y[1]=Y[1]*U,Y[2]=Y[2]*U,Y[3]=Y[3]*U,Y[4]=Y[4]*y,Y[5]=Y[5]*y,Y[6]=Y[6]*y,Y[7]=Y[7]*y,Y[8]=Y[8]*u,Y[9]=Y[9]*u,Y[10]=Y[10]*u,Y[11]=Y[11]*u}},Nj=function(U,g,j){var y=g[0],X=g[1],e=g[2],H=g[3],z=g[4],I=g[5],N=g[6],R=g[7],q=g[8],Y=g[9],E=g[10],d=g[11],G=g[12],c=g[13],J=g[14],C=g[15],f=j[0],m=j[1],Q=j[2],a=j[3];return U[0]=f*y+m*z+Q*q+a*G,U[1]=f*X+m*I+Q*Y+a*c,U[2]=f*e+m*N+Q*E+a*J,U[3]=f*H+m*R+Q*d+a*C,f=j[4],m=j[5],Q=j[6],a=j[7],U[4]=f*y+m*z+Q*q+a*G,U[5]=f*X+m*I+Q*Y+a*c,U[6]=f*e+m*N+Q*E+a*J,U[7]=f*H+m*R+Q*d+a*C,f=j[8],m=j[9],Q=j[10],a=j[11],U[8]=f*y+m*z+Q*q+a*G,U[9]=f*X+m*I+Q*Y+a*c,U[10]=f*e+m*N+Q*E+a*J,U[11]=f*H+m*R+Q*d+a*C,f=j[12],m=j[13],Q=j[14],a=j[15],U[12]=f*y+m*z+Q*q+a*G,U[13]=f*X+m*I+Q*Y+a*c,U[14]=f*e+m*N+Q*E+a*J,U[15]=f*H+m*R+Q*d+a*C,U},Ho=function(m,x,u,S){var i,C,z,t,y,O,o,L,a,V,j=x[0],D=x[1],q=x[2],d=S[0],v=S[1],c=S[2],B=u[0],Y=u[1],E=u[2];return k(j-B)<mo&&k(D-Y)<mo&&k(q-E)<mo?Mo(m):(o=j-B,L=D-Y,a=q-E,V=1/r(o*o+L*L+a*a),o*=V,L*=V,a*=V,i=v*a-c*L,C=c*o-d*a,z=d*L-v*o,V=r(i*i+C*C+z*z),V?(V=1/V,i*=V,C*=V,z*=V):(i=0,C=0,z=0),t=L*z-a*C,y=a*i-o*z,O=o*C-L*i,V=r(t*t+y*y+O*O),V?(V=1/V,t*=V,y*=V,O*=V):(t=0,y=0,O=0),m[0]=i,m[1]=t,m[2]=o,m[3]=0,m[4]=C,m[5]=y,m[6]=L,m[7]=0,m[8]=z,m[9]=O,m[10]=a,m[11]=0,m[12]=-(i*j+C*D+z*q),m[13]=-(t*j+y*D+O*q),m[14]=-(o*j+L*D+a*q),m[15]=1,m)},Wk=function(m,p,K,a,z){var X=1/h(p/2),W=1/(a-z);return m[0]=X/K,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=X,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=(z+a)*W,m[11]=-1,m[12]=0,m[13]=0,m[14]=2*z*a*W,m[15]=0,m},Xn=function(F,d,l,p,Z,E,M){var r=1/(d-l),T=1/(p-Z),o=1/(E-M);return F[0]=-2*r,F[1]=0,F[2]=0,F[3]=0,F[4]=0,F[5]=-2*T,F[6]=0,F[7]=0,F[8]=0,F[9]=0,F[10]=2*o,F[11]=0,F[12]=(d+l)*r,F[13]=(Z+p)*T,F[14]=(M+E)*o,F[15]=1,F},lm=function(i,N){var $=N[0],G=N[1],I=N[2],C=N[3],J=$*$+G*G+I*I+C*C,L=J?1/J:0;return i[0]=-$*L,i[1]=-G*L,i[2]=-I*L,i[3]=C*L,i},mb=function(m,Q){var u=Q[0]+Q[5]+Q[10],E=0;return u>0?(E=2*Math.sqrt(u+1),m[3]=.25*E,m[0]=(Q[6]-Q[9])/E,m[1]=(Q[8]-Q[2])/E,m[2]=(Q[1]-Q[4])/E):Q[0]>Q[5]&Q[0]>Q[10]?(E=2*Math.sqrt(1+Q[0]-Q[5]-Q[10]),m[3]=(Q[6]-Q[9])/E,m[0]=.25*E,m[1]=(Q[1]+Q[4])/E,m[2]=(Q[8]+Q[2])/E):Q[5]>Q[10]?(E=2*Math.sqrt(1+Q[5]-Q[0]-Q[10]),m[3]=(Q[8]-Q[2])/E,m[0]=(Q[1]+Q[4])/E,m[1]=.25*E,m[2]=(Q[6]+Q[9])/E):(E=2*Math.sqrt(1+Q[10]-Q[0]-Q[5]),m[3]=(Q[1]-Q[4])/E,m[0]=(Q[8]+Q[2])/E,m[1]=(Q[6]+Q[9])/E,m[2]=.25*E),m},Tr=function(V,m,Q){var S=m[0],z=m[1],c=m[2],F=m[3],w=S+S,r=z+z,I=c+c,L=S*w,A=S*r,J=S*I,t=z*r,_=z*I,D=c*I,M=F*w,P=F*r,N=F*I;return V[0]=1-(t+D),V[1]=A+N,V[2]=J-P,V[3]=0,V[4]=A-N,V[5]=1-(L+D),V[6]=_+M,V[7]=0,V[8]=J+P,V[9]=_-M,V[10]=1-(L+t),V[11]=0,V[12]=Q[0],V[13]=Q[1],V[14]=Q[2],V[15]=1,V},ei=function(){var n=[0,0,0],y=[0,0,0],b=[0,0,0],O=function(F,o,X){F[0]=o[1]*X[2]-o[2]*X[1],F[1]=o[2]*X[0]-o[0]*X[2],F[2]=o[0]*X[1]-o[1]*X[0]},p=function(k){return k[0]*k[0]+k[1]*k[1]+k[2]*k[2]},D=function(L){var s=Math.sqrt(p(L));L[0]/=s,L[1]/=s,L[2]/=s},T=function(H,i,v){H[0]=i[0]-v[0],H[1]=i[1]-v[1],H[2]=i[2]-v[2]};return function(m,A,W){var d=sh();return T(b,m,A),0===p(b)&&(b[2]=1),D(b),O(n,W,b),0===p(n)&&(1===Math.abs(W[2])?b[0]+=1e-4:b[2]+=1e-4,D(b),O(n,W,b)),D(n),O(y,b,n),d[0]=n[0],d[4]=y[0],d[8]=b[0],d[1]=n[1],d[5]=y[1],d[9]=b[1],d[2]=n[2],d[6]=y[2],d[10]=b[2],d}}(),Pe=function(o,W){if(o.vr.enable){var D=o.vr.getViewMatrix(W);if(D)return D}return Ho(W?W:sh(),o._eye,o._center,o._up)},Wn=function(z){if(z.vr.enable){var v=z.vr.getProjectMatrix();if(v)return v}var Z=z.getAspect(),j=z._near,y=z._far,g=sh();if(z._ortho){var F=z._orthoWidth/2,t=F/Z;Xn(g,-F,F,-t,t,j,y)}else Wk(g,z._fovy,Z,j,y);return g},uh=function(j,W){if(!j)return u;var L=0,o=1,e=2,B=[],F=0,q=j.length,v=q/3;if(W){for(;q>F;F++)B[F]=0;for(F=0;F<W.length;F+=3){var R=[],C=[],y=[];R[L]=j[3*W[F+1]+L]-j[3*W[F]+L],R[o]=j[3*W[F+1]+o]-j[3*W[F]+o],R[e]=j[3*W[F+1]+e]-j[3*W[F]+e],C[L]=j[3*W[F+2]+L]-j[3*W[F+1]+L],C[o]=j[3*W[F+2]+o]-j[3*W[F+1]+o],C[e]=j[3*W[F+2]+e]-j[3*W[F+1]+e],y[L]=R[o]*C[e]-R[e]*C[o],y[o]=R[e]*C[L]-R[L]*C[e],y[e]=R[L]*C[o]-R[o]*C[L];for(var H=0;3>H;H++)B[3*W[F+H]+L]+=y[L],B[3*W[F+H]+o]+=y[o],B[3*W[F+H]+e]+=y[e]}}else for(F=0;v>F;F+=3){var R=[],C=[],y=[];R[L]=j[3*(F+1)+L]-j[3*F+L],R[o]=j[3*(F+1)+o]-j[3*F+o],R[e]=j[3*(F+1)+e]-j[3*F+e],C[L]=j[3*(F+2)+L]-j[3*(F+1)+L],C[o]=j[3*(F+2)+o]-j[3*(F+1)+o],C[e]=j[3*(F+2)+e]-j[3*(F+1)+e],y[L]=R[o]*C[e]-R[e]*C[o],y[o]=R[e]*C[L]-R[L]*C[e],y[e]=R[L]*C[o]-R[o]*C[L];for(var H=0;3>H;H++)B[3*(F+H)+L]=y[L],B[3*(F+H)+o]=y[o],B[3*(F+H)+e]=y[e]}for(F=0;q>F;F+=3){var $=[];$[L]=B[F+L],$[o]=B[F+o],$[e]=B[F+e];var i=r($[L]*$[L]+$[o]*$[o]+$[e]*$[e]);0===i&&(i=mo),$[L]=$[L]/i,$[o]=$[o]/i,$[e]=$[e]/i,B[F+L]=$[L],B[F+o]=$[o],B[F+e]=$[e]}return new Jk(B)},Pb=function(w,f,U,L){if(U||(U=w.createTexture()),f){var y=w.TEXTURE_2D,e=w.REPEAT,x=w.CLAMP_TO_EDGE,Y=w.TEXTURE_MIN_FILTER;L!==w.NEAREST&&(L=w.LINEAR),Nk(w,U),w.texImage2D(y,0,w.RGBA,w.RGBA,w.UNSIGNED_BYTE,f),Vj(w,w.TEXTURE_MAG_FILTER,L);var C=f.naturalWidth||f.width,X=f.naturalHeight||f.height;Mm(C)&&Mm(X)&&!f.clampToEdge?(Vj(w,w.TEXTURE_WRAP_S,e),Vj(w,w.TEXTURE_WRAP_T,e),Vj(w,Y,w.LINEAR_MIPMAP_LINEAR),w.generateMipmap(y)):(Vj(w,w.TEXTURE_WRAP_S,x),Vj(w,w.TEXTURE_WRAP_T,x),Vj(w,Y,L)),Nk(w,u)}return U},Rd=function(d,S){var X=new Uint8Array(4);return S=S||d.createTexture(),Nk(d,S),Vj(d,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,1,1,0,d.RGBA,d.UNSIGNED_BYTE,X),S},jj=function(C){C._26I&&C._prg&&(C._26I.deleteProgram(C._prg),C._prg=u)},Wm=function(C,r,x,R){var W=C.createShader(x);return C.shaderSource(W,R),C.compileShader(W),C.attachShader(r,W),W},ig=function(K){return K.createBuffer()},Nk=function(f,P){f.bindTexture(f.TEXTURE_2D,P)},Vj=function(x,c,O){x.texParameteri(x.TEXTURE_2D,c,O)},tl=function(H,W){H.enable(H.POLYGON_OFFSET_FILL),H.polygonOffset(W[0],W[1])},Ce=function(o){o.disable(o.POLYGON_OFFSET_FILL)},xe=function(f,H){if(H){var H=Ke(H);f.clearColor(H[0],H[1],H[2],H[3])}},Vk=function(j,S){oi(j,S.uFix,!0),vf(j,S.aNormal)},Bg=function(p,h){oi(p,h.uFix,!1),Mg(p,h.aNormal)},gj=function(j,Z,U,D,a,P,o,K){j._picking||(U?(oi(j,Z.uBlend,!0),oi(j,Z.uBlendColor,U)):oi(j,Z.uBlend,!1),oi(j,Z.uLight,D==u?!0:D),Pr(a)&&1!==a&&oi(j,Z.uPartOpacity,a),oi(j,Z.uReverseFlip,P==u?!1:P),oi(j,Z.uFixPickReverseColor,o||Tg)),K?j.enable(j.CULL_FACE):j.disable(j.CULL_FACE)},vg=function(F,U){F._picking||oi(F,U.uPartOpacity,1)},cc=function(){var q=[0,0,1,1];return function(X,m,F,j,_,A,V,$,D){return F?(oi(X,m.uTexture,!0),oi(X,m.uDiscardSelectable,Wr(j)?j:!0),Mg(X,m.aUv),Er(X,_,A,m.aUv,2),D?(oi(X,m.uBlendTexture,!0),X.activeTexture(X.TEXTURE1),Nk(X,D),X.uniform1i(m.uBlendSampler,1)):(oi(X,m.uBlendTexture,!1),X.activeTexture(X.TEXTURE1),Nk(X,X._emptyBlendTexture)),X.activeTexture(X.TEXTURE0),Nk(X,F),X.uniform1i(m.uSampler,0),V?(q[0]=V[0],q[1]=V[1]):(q[0]=0,q[1]=0),$?(q[2]=$[0],q[3]=$[1]):(q[2]=1,q[3]=1),oi(X,m.uOffsetScale,q),void 0):(X.activeTexture(X.TEXTURE0),Nk(X,X._emptyTexture),X.activeTexture(X.TEXTURE1),Nk(X,X._emptyBlendTexture),void 0)}}(),Sm=function(f,U,C){f.activeTexture(f.TEXTURE0),Nk(f,u),f.activeTexture(f.TEXTURE1),Nk(f,u),C&&(vf(f,U.aUv),oi(f,U.uTexture,!1),oi(f,U.uBlendTexture,!1))},Ao=function(n,X,B,i,p,f){!B||q||Jg||n.lineWidth(B),i&&!n._picking&&oi(n,X.uFixPickReverseColor,i),p&&Er(n,p,f,X.aPosition)},Tq=function(b,l,y,g){cd&&(g=b[cd]),b.drawArrays(g==u?b.TRIANGLES:g,l,y);var r=b._renderInfo;r&&(r.calls++,r.vertices+=y,(g==u||g===b.TRIANGLES)&&(r.faces+=y/3),g===b.LINES&&(r.lines+=y/2))},Nq=function(V,A,Z,H){cd&&(H=V[cd]),V.drawElements(H==u?V.TRIANGLES:H,Z,V.UNSIGNED_SHORT,A==u?0:2*A);var x=V._renderInfo;x&&(x.calls++,x.vertices+=Z,(H==u||H===V.TRIANGLES)&&(x.faces+=Z/3),H===V.LINES&&(x.lines+=Z/2))},og=function(C,d,b,I,H){var G=C.ARRAY_BUFFER;C.bindBuffer(G,d),b&&C.bufferData(G,b,C.STATIC_DRAW),I!=u&&C.vertexAttribPointer(I,H?H:3,C.FLOAT,!1,0,0)},Er=function(f,F,o,w,s){return o?(gm(f,f.ARRAY_BUFFER,F,o),w!=u&&f.vertexAttribPointer(w,s?s:3,f.FLOAT,!1,0,0),void 0):og(f,F,o,w,s)},Rm=function(H,D,c){var v=H.ELEMENT_ARRAY_BUFFER;H.bindBuffer(v,D),c&&H.bufferData(v,c,H.STATIC_DRAW)},Hn=function(w,e,E){gm(w,w.ELEMENT_ARRAY_BUFFER,e,E)},gm=function(F,u,Z,L){var j=L._bufId;j||(j=L._bufId=X.Math.generateIncreasingID());var Z,b=F._bufPool;(Z=b[j])&&Z._buf?F.bindBuffer(u,Z._buf):(Z=b[j]={_buf:ig(F)},F.bindBuffer(u,Z._buf),F.bufferData(u,L,F.STATIC_DRAW)),Z._fid=F._renderInfo.frame},oi=function($,W,N){if(N!=u&&W!=u){N=Ke(N);var E=N.length;3===E?$.uniform3fv(W,N):4===E?$.uniform4fv(W,N):16===E?$.uniformMatrix4fv(W,!1,N):Wr(N)?$.uniform1i(W,N?1:0):2===E?$.uniform2fv(W,N):$.uniform1f(W,N)}},Mg=function(v,e){e!=u&&e>=0&&v.enableVertexAttribArray(e)},vf=function(H,b){b!=u&&b>=0&&H.disableVertexAttribArray(b)},Uj=function(z,D){var $=z.getGL(),B=z._prg;z._7O=z._8O.pop(),D&&(oi($,B.uMVMatrix,z._7O),z._6O=D,oi($,B.uNMatrix,D))},Jb=function(D,v){return v||(v=sh()),xg(v,D),Yc(v),Mi(v),v},Sb=function(j,U){var Q=j.getGL(),E=j._prg,f=j._7O;U&&(j._8O.push(Or(f)),oi(Q,E.uMMatrix,U),Nj(f,f,U),j._7O=f),oi(Q,E.uMVMatrix,f),oi(Q,E.uNMatrix,Jb(f,j._6O))},Ih=function(u,e,U,V,K,l){if(U){if(V){var Z=U.value++,Q=2147483648|Z,M=[(255&Q>>16)/255,(255&Q>>8)/255,(255&Q)/255,(255&Q>>24)/255];U[Z]={data:K,part:l}}else M=fn;return oi(u,e.uFixPickReverseColor,M),M}},ac=function(){var $={center:function(Q,_,Z,G,S){var z=-_[1]/2,x={x:-_[0]/2,y:z,width:_[0],height:_[1]},V=Eg(Q,x,Z);return[V.x+G,-V.y-S,Xg()]},front:function(O,I,C,D,b){var S=-I[1]/2,H={x:-I[0]/2,y:S,width:I[0],height:I[1]},s=Eg(O,H,C);return[s.x+D,-s.y-b,I[2]/2+Xg()]},back:function(v,e,Y,u,I){var x=-e[0]/2,C=-e[1]/2,J={x:x,y:C,width:e[0],height:e[1]},d=Eg(v,J,Y);return[-d.x-u,-d.y-I,-e[2]/2-Xg()]},left:function(S,L,u,Q,$){var i=-L[1]/2,J={x:-L[2]/2,y:i,width:L[2],height:L[1]},F=Eg(S,J,u);return[-L[0]/2-Xg(),-F.y-$,F.x+Q]},right:function(b,_,c,z,a){var g=-_[2]/2,d=-_[1]/2,R={x:g,y:d,width:_[2],height:_[1]},E=Eg(b,R,c);return[_[0]/2+Xg(),-E.y-a,-E.x-z]},top:function(D,u,y,V,Y){var H={x:-u[0]/2,y:-u[2]/2,width:u[0],height:u[2]},K=Eg(D,H,y);return[K.x+V,u[1]/2+Xg(),K.y+Y]},bottom:function(Q,I,F,y,o){var Y=-I[2]/2,U={x:-I[0]/2,y:Y,width:I[0],height:I[2]},d=Eg(Q,U,F);return[d.x+y,-I[1]/2-Xg(),-d.y-o]}};return function(Q,T,L,k,_,f){return $[k](Q,T,L,_||0,f||0)}}(),Wj=function(Y,f,V,u,w,K,D,o,O,S){if(w&&(f[0]+=w[0],f[1]+=w[1],f[2]+=w[2]),Ah(Y,V),o){var q=sh();if(Ug(q,O,S),Jo(f,q),Ah(Y,f),Y.auto=o,Y.pos=Jo([0,0,0],Y),K){var x=Y.mat2=sh();Ug(x,K,D)}}else Ug(Y,O,S),Ah(Y,f),u===nk?Uo(Y,-N):u===yq?Uo(Y,N):u===hk?Fb(Y,-N):u===nh?Fb(Y,N):u===cl&&Uo(Y,y),Ug(Y,K,D);return Y},oq=function(C,X){var H=X.auto,T=X.mat2,R=C.gv;if(H){var m,g=sh(),L=[0,0,0,0];m="string"==typeof H?[H.indexOf("x")<0?R._eye[0]:R._center[0],H.indexOf("y")<0?R._eye[1]:R._center[1],H.indexOf("z")<0?R._eye[2]:R._center[2]]:R._eye,mb(L,Ho(sh(),m,R._center,R._up)),Tr(g,lm(L,L),X.pos),T&&Nj(g,g,T),Sb(R,g)}else Sb(R,X)},wf=function(f,b,c,E,B){var e=f.s,v=f.gv,l=v.getGL(),a=v._prg,R=v._buffer,A=v._1O;Pb(l,vh,A),oq(f,c),gj(l,a,e(b+".blend"),e(b+".light"),e(b+".opacity"),e(b+".reverse.flip"),e(b+".reverse.color"),e(b+".reverse.cull")),cc(l,a,A,B,R.uv,Jn),Er(l,R.vs,E,a.aPosition),Er(l,R.ns,Lg,a.aNormal),Hn(l,R.is,Ci),Nq(l,0,Ci.length),Sm(l,a,A),vg(l,a),Uj(v)},as=function(G,g,V){var u=G.gv,b=G.data,X=G[g]={blend:u.getBodyColor(b)||u.getFaceBlend(b,g),light:u.getFaceLight(b,g),color:u.getFaceColor(b,g),opacity:u.getFaceOpacity(b,g),transparent:u.getFaceTransparent(b,g),reverseFlip:u.getFaceReverseFlip(b,g),reverseColor:u.getFaceReverseColor(b,g),reverseCull:u.getFaceReverseCull(b,g),texture:u.getFaceImage(b,g),blendTexture:u.getFaceBlendImage(b,g),discardSelectable:u.getFaceDiscardSelectable(b,g)};if("csg"!==g){X.uv=u.getFaceUv(b,g)||V&&V[g+"Uv"],X.uvScale=u.getFaceUvScale(b,g)||V&&V[g+"UvScale"],X.uvOffset=u.getFaceUvOffset(b,g)||V&&V[g+"UvOffset"];var q=u.getFaceMat(b,g);q&&(X.mat=Ge(b,q))}return X},Vp=function(M,v,p,e,Z){if(e){if(!Z(e.transparent))return;var D=M.data,t=M.gv,P=t._buffer,w=t.getTexture(e.texture,D),z=t.getTexture(e.blendTexture,D);cc(v,p,w,e.discardSelectable,P.uv,e.tuv,e.uvOffset,e.uvScale,z),gj(v,p,e.blend,e.light,e.opacity,e.reverseFlip,e.reverseColor,e.reverseCull),oi(v,p.uDiffuse,e.color||W["color.empty"]),Er(v,P.vs,e.vs,p.aPosition),Er(v,P.ns,e.ns,p.aNormal),Tq(v,0,e.vs.length/3),vg(v,p),Sm(v,p,w)}},He=function(A,U,h,$,Z,M){var N,D,b,c,C,n,o,S,e,L,a,s=[$-U,Z-h],z=A?A.length:0;for(b=0;z>b;b++){for(c=2,N=A[b],C=N[0],n=N[1];c+1<N.length;){if(o=N[c],S=N[c+1],D=so(U,h,$,Z,C,n,o,S,!0)){e=[o-C,S-n],L=Di(e),e[0]/=L,e[1]/=L,L=yk(s,e),L=L>0?M:-M,a=[e[0]*L,e[1]*L];break}C=o,n=S,c+=2}if(a)break}if(a)for($=U+a[0],Z=h+a[1],b=0;z>b;b++)for(c=2,N=A[b],C=N[0],n=N[1];c+1<N.length;){if(o=N[c],S=N[c+1],D=so(U,h,$,Z,C,n,o,S,!0))return[0,0];C=o,n=S,c+=2}return a?a:[$-U,Z-h]},fb=X.graph3d={},Li=function(M,O,q){xk(Q+".graph3d."+M,O,q)},Ei="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",hn="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";ae(U,{setBatchInfo:function(s,z){Zd[s]=z},getBatchInfo:function(B){return Zd[B]}},!0);var Pl=[1,1,1],re=[1,0,0,0,0,1,0,1,1,1,1,0],Hf=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],Aq=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Hr=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],pb=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Re=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],sj=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],pf=function(J,Z){$f(J,Z,"_batchModelMap","_batchIndexMap"),Cr(J,Z,"_wireframeModelMap","_wireframeIndexMap"),Cr(J,Z,"_polylineModelMap","_polylineIndexMap"),Cr(J,Z,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),Cr(J,Z,"_polylineModelMapSwap","_polylineIndexMapSwap")},$f=function(r,l,s,J){if(!l)return r[s]={},r[J]={},void 0;var q=l._id,N=r[J],e=N[q];if(e){var T=r[s],C=e.batch,H=T[C],f=H.ds,K=e.index;if(H.invalidate=!0,delete N[q],f.splice(K,1),oo(f))return delete T[C],void 0;for(var z=e.begin,Y=e.size,X=3*z,p=3*Y,F=4*z,U=4*Y,u=H.vs,R=H.ps,D=H.uv,j=H.cs,B=H.bs,E=H.rs,v=H.ns,P=H.ls;K<f.length;K++)e=N[f[K]._id],e.index--,e.begin-=Y;u.splice(X,p),R.splice(F,U),D&&D.splice(2*z,2*Y),j&&j.splice(F,U),B&&B.splice(X,p),E&&E.splice(z,Y),v&&v.splice(X,p),P&&P.splice(z,Y)}},Cr=$f,os=function(E,V,K,c){if(!c)return u;var d=V[c];if(!d){var x=Zd[c]||Cd,p=x.image?[]:u;d=V[c]={vs:[],ns:[],uv:p,cs:p?u:x.color?u:[],bs:x.blend?[]:u,ps:[],rs:x.brightness?[]:u,ds:[]}}return d.invalidate=!0,E[K._id]={index:d.ds.length,begin:d.vs.length/3,batch:c},d.ds.push(K),d},Lh=function(c,C){return C!=u&&1!==C?[c[0]*C,c[1]*C,c[2]*C,c[3]]:c},Qe=function(w,k,W){var m=w.getBrightness(k),P=Ke(W.color||"white"),A=P[3]<1,$=Math.ceil(W.width)||1,X=(A?"T":"O")+$,c=w._wireframeIndexMap,i=w._wireframeModelMap,V=i[X];V||(V=i[X]={vs:[],cs:[],ps:[],ds:[],T:A,W:$});var L,p=w.getData3dUI(k),F=Hb(p);if(W.geometry){if(!F)return;if(L=Tj(F),!L)return}else L=W.short?sd:Mf;V.invalidate=!0;var J=V.vs,e=V.cs,H=V.ds,Z=c[k._id]={index:H.length,begin:J.length/3,batch:X};H.push(k);var x=Ge(k,W.mat),d=p._calcAnchorMat(k);d&&Nj(x,x,d),Po(J,x,L);var I=Z.size=J.length/3-Z.begin;Uf(e,Lh(P,m),I)},ak=function(L,S,U,E,I,H,a,A,q){var x=L.getBrightness(S);x==u&&(x=1);var C=Lh(Ke(E),x),G=C[3]<1;H=Math.ceil(H)||1;var T=(G?"T":"O")+H;if(a){var w=a[0],$=(a[1]||w)+w;T+="-"+w+"-"+$,q&&(T+="-"+$j(q)+"-"+x,q=Lh(Ke(q),x))}var D=L._polylineIndexMap,Q=L._polylineModelMap,_=Q[T];_||(_=Q[T]={vs:[],cs:[],ps:[],ds:[],ls:a?[]:u,T:G,W:H},a&&(_.D=w,_.G=$,_.A=q)),_.invalidate=!0;var X,k=_.vs,V=_.cs,s=_.ds,K=_.ls,F=D[S._id]={index:s.length,begin:k.length/3,batch:T};s.push(S),Ab(k,U);var y,B=F.size=k.length/3-F.begin,i=U.length,J=0,g=[];if(a||I)for(X=0;i>X;X+=6)y=Di([U[X],U[X+1],U[X+2]],[U[X+3],U[X+4],U[X+5]]),g.push(y),J+=y;if(J&&I){var z,Z=Lh(Ke(I),x),N=[Z[0]-C[0],Z[1]-C[1],Z[2]-C[2],Z[3]-C[3]],O=0;for(X=0;i>X;X+=6)z=O/J,Uf(V,[C[0]+N[0]*z,C[1]+N[1]*z,C[2]+N[2]*z,C[3]+N[3]*z],1),O+=g[X/6],z=O/J,Uf(V,[C[0]+N[0]*z,C[1]+N[1]*z,C[2]+N[2]*z,C[3]+N[3]*z],1)}else Uf(V,C,B);if(a)for(O=A||0,X=0;i>X;X+=6)K.push(O),O+=g[X/6],K.push(O)},Ec=function(y,q,Z){if(q)for(var V=4*q.begin,E=Z[q.batch].ps,u=0;u<q.size;u++)E[V++]=y[0],E[V++]=y[1],E[V++]=y[2],E[V++]=y[3]},no=function(U,v){var z=v+["32"],Z=U[v],R=U[z];Z?R&&R.length===Z.length?(R.set(Z),R._bufId=null):U[z]=new Jk(Z):delete U[z]},be=function(q,x,t,T,C,z,E,v,f){if(En(t))t.forEach(function(j){be(q,x,j,T,C,z,E,v,f)});else if(Bs(t))be(q,x,Hb(T,t),T,C,z,E,v,f);else if(Il(t)){var K,n=wq(t.mat,x,q),G=wq(t.s3,x,q),k=wq(t.t3,x,q),Z=wq(t.r3,x,q);if((G||Z||k||n)&&(K=Cm(n,G,Z,wq(t.rotationMode,x,q),k),z.push(K)),t.shape3d)be(q,x,t.shape3d,T,C,z,E,v,t);else{var J=T.s;f=f||Cd;var F=z[0],p=z.length,$=J("shape3d.color",t.color,f.color);if(C||(C=J("shape3d.blend",t.blend,f.blend)),p>1){F=Or(F);for(var B=1;p>B;B++)Nj(F,F,z[B])}t.vs&&J(np,t.visible,f.visible)&&Cs(F,E,v,t.vs,t.uv,t.is,C,$),t.top_vs&&J(Ib,t.topVisible,f.topVisible)&&Cs(F,E,v,t.top_vs,t.top_uv,t.top_is,C,J("shape3d.top.color",t.topColor,f.topColor)||$),t.bottom_vs&&J(rm,t.bottomVisible,f.bottomVisible)&&Cs(F,E,v,t.bottom_vs,t.bottom_uv,t.bottom_is,C,J("shape3d.bottom.color",t.bottomColor,f.bottomColor)||$),t.from_vs&&J(Tn,t.fromVisible,f.fromVisible)&&Cs(F,E,v,t.from_vs,t.from_uv,t.from_is,C,J("shape3d.from.color",t.fromColor,f.fromColor)||$),t.to_vs&&J(tr,t.toVisible,f.toVisible)&&Cs(F,E,v,t.to_vs,t.to_uv,t.to_is,C,J("shape3d.to.color",t.toColor,f.toColor)||$)}K&&z.pop()}},Cs=function(G,k,b,e,q,i,y,F){var Y,D=k.cs,l=k.uv,z=k.bs;if(i){Y=i.length;for(var w=0;Y>w;w++){var L=i[w];Po(b,G,[e[3*L],e[3*L+1],e[3*L+2]]),l&&Ab(l,[q[2*L],q[2*L+1]])}}else Y=e.length/3,Po(b,G,e),l&&Ab(l,q);D&&Uf(D,F,Y),z&&(y?Fl(z,y,Y):Ab(z,Pl,Y))},wk=function(q,Q,s,L){var h=[];L?be(q.gv,q.data,L,q,q.getBodyColor(),[Q],s,h):(ap(q,nk,Q,s,h),ap(q,yq,Q,s,h),ap(q,gr,Q,s,h),ap(q,cl,Q,s,h),ap(q,hk,Q,s,h),ap(q,nh,Q,s,h),ap(q,"csg",Q,s,h)),h.length&&(Ab(s.vs,h),Ab(s.ns,uh(h)))},ap=function(f,x,M,s,b){var g=f[x];if(g){var L=g.tuv;if(L){var X,i,Z,U,w=g.uvScale,P=g.uvOffset;if(w)for(X=L.length,i=w[0],Z=w[1],U=0;X>U;U+=2)L[U]*=i,L[U+1]*=Z;if(P)for(X=L.length,i=P[0],Z=P[1],U=0;X>U;U+=2)L[U]+=i,L[U+1]+=Z}Cs(M,s,b,g.vs,L,u,g.blend,g.color)}},Fo=function(N,y,P,Q,r,L,V,F){var u,k=P.cs,H=P.uv,s=P.bs;if(N.getFaceVisible(y,L)){var J=N.getFaceMat(y,L);if(J&&(r=Ge(y,J)),Po(V,r,F),k&&Uf(k,N.getFaceColor(y,L),6),H){var $=N.getFaceUv(y,L)||Q[L+"Uv"],m=N.getFaceUvScale(y,L)||Q[L+"UvScale"],t=N.getFaceUvOffset(y,L)||Q[L+"UvOffset"];$=$?[$[6],$[7],$[0],$[1],$[2],$[3],$[2],$[3],$[4],$[5],$[6],$[7]]:re;var l=$[0],z=$[1],T=$[2],j=$[3],n=$[4],b=$[5],R=$[6],w=$[7],Z=$[8],x=$[9],O=$[10],E=$[11];if(m){var g=m[0],v=m[1];l*=g,z*=v,T*=g,j*=v,n*=g,b*=v,R*=g,w*=v,Z*=g,x*=v,O*=g,E*=v}if(t){var o=t[0],p=t[1];l+=o,z+=p,T+=o,j+=p,n+=o,b+=p,R+=o,w+=p,Z+=o,x+=p,O+=o,E+=p}H.push(l,z,T,j,n,b,R,w,Z,x,O,E)}s&&(u=N.getBodyColor(y)||N.getFaceBlend(y,L),u?Fl(s,u,6):Ab(s,Pl,6))}},Bk=function(f,$,p,r){var k=f.getGL(),_=f._prg,o=f._buffer;if(!f.drawFilter&&!Dh($)){Sb(f),Vk(k,_);for(var K in $){var Y=$[K];if(!(r&&!Y.T||!r&&Y.T)){Y.invalidate?(Y.invalidate=!1,no(Y,"vs"),no(Y,"cs"),no(Y,"ls"),no(Y,"ps")):p&&no(Y,"ps");var J=Y.vs32,T=p?Y.ps32:Y.cs32;Ao(k,_,Y.W,u,o.vs,J);var j=Y.D,C=!f._dashDisabled&&j;oi(k,_.uAlphaTest,W.alphaTest),C&&(oi(k,_.uDash,!0),oi(k,_.uDashDistance,j),oi(k,_.uDashGapDistance,Y.G),Mg(k,_.aLineDistance),Er(k,o.lineDistance,Y.ls32,_.aLineDistance,1),oi(k,_.uDiffuse,Y.A||W["color.empty"]));var t=!f._batchColorDisabled;t&&(oi(k,_.uBatchColor,!0),Mg(k,_.aBatchColor),Er(k,o.batchColor,T,_.aBatchColor,4)),cc(k),Tq(k,0,J.length/3,k.LINES),Sm(k),t&&(oi(k,_.uBatchColor,!1),vf(k,_.aBatchColor)),C&&(oi(k,_.uDash,!1),vf(k,_.aLineDistance))}}Bg(k,_)}},Rh=function(J,N,b){var A,M,a,p,w,F,y,U,o,l,m,d=J.getGL(),T=J._prg,Z=J._buffer,G=J._batchModelMap;if(!Dh(G)){Sb(J);for(A in G)if(M=Zd[A]||Cd,!(b&&!M.transparent||!b&&M.transparent)&&(a=G[A],N||!M.transparentMask)){var E=b&&M.autoSort!==!1&&(J._33Q||a.invalidate);if(a.invalidate?(a.invalidate=!1,no(a,"vs"),no(a,"ns"),no(a,"cs"),no(a,"rs"),no(a,"ps"),no(a,"bs"),no(a,"uv")):N&&no(a,"ps"),w=a.vs32,F=N?a.ps32:a.cs32,o=a.uv32,y=a.bs32,U=a.rs32,m=w.length/3,E&&(a.is=Sq(w,J.getEye())),m){p=M.light,l=J.getTexture(M.image),gj(d,T,u,M.light,M.opacity,M.reverseFlip,M.reverseColor,M.reverseCull),F?J._batchColorDisabled||(oi(d,T.uBatchColor,!0),Mg(d,T.aBatchColor),Er(d,Z.batchColor,F,T.aBatchColor,4)):oi(d,T.uDiffuse,M.color||W["color.empty"]);var j=M.alphaTest;oi(d,T.uAlphaTest,j===f?W.alphaTest:j);var v=y&&!J._batchBlendDisabled;v&&(oi(d,T.uBatchBlend,!0),Mg(d,T.aBatchBlend),Er(d,Z.batchBlend,y,T.aBatchBlend));var e=U&&!J._batchBrightnessDisabled;e&&(oi(d,T.uBatchBrightness,!0),Mg(d,T.aBatchBrightness),Er(d,Z.batchBrightness,U,T.aBatchBrightness,1)),o?cc(d,T,l,M.discardSelectable,Z.uv,o,M.uvOffset,M.uvScale):cc(d),Er(d,Z.vs,w,T.aPosition),Er(d,Z.ns,a.ns32,T.aNormal),a.is?(Rm(d,Z.is,a.is),Nq(d,0,m)):Tq(d,0,m),o?Sm(d,T,l):Sm(d),F&&!J._batchColorDisabled&&(oi(d,T.uBatchColor,!1),vf(d,T.aBatchColor)),v&&(oi(d,T.uBatchBlend,!1),vf(d,T.aBatchBlend)),e&&(oi(d,T.uBatchBrightness,!1),vf(d,T.aBatchBrightness)),vg(d,T)}}}},Sq=function(S,k){for(var J=S.length/3,l=new Array(J),n=J/3,T=new Array(n),x=0;n>x;x++)T[x]=x;T.sort(function(O,p){var d=9*O,Z=[(S[d]+S[d+3]+2*S[d+6])/4,(S[d+1]+S[d+4]+2*S[d+7])/4,(S[d+2]+S[d+5]+2*S[d+8])/4];
d=9*p;var y=[(S[d]+S[d+3]+2*S[d+6])/4,(S[d+1]+S[d+4]+2*S[d+7])/4,(S[d+2]+S[d+5]+2*S[d+8])/4],P=Di(k,Z)-Di(k,y);return P>0?-1:0>P?1:0});for(var x=0;n>x;x++){var E=3*x,R=3*T[x];l[E]=R,l[E+1]=R+1,l[E+2]=R+2}return new Gk(l)},yn={obj:function(j,n){var y={mat:j.mat,s3:j.s3,r3:j.r3,rotationMode:j.rotationMode,t3:j.t3,cube:j.cube==u?!0:j.cube,center:j.center==u?!0:j.center,ignoreMtls:j.ignoreMtls,ignoreTransparent:j.ignoreTransparent,ignoreColor:j.ignoreColor,ignoreImage:j.ignoreImage,ignoreNormal:j.ignoreNormal,prefix:j.prefix,flipY:j.flipY,flipFace:j.flipFace,reverseFlipMtls:j.reverseFlipMtls,finishFunc:function(Z,M){if(Z){var M=[];for(var v in Z){var Q=Z[v];M.rawS3=Q.rawS3,M.push(Q),j.eachModel&&j.eachModel(v,Q)}M.json=j,n(M)}else n()}};U.loadObj(j.obj,j.mtl,y)}};U.getModelTypeHandlers=function(){return yn},U.setModelTypeHandler=function(Z,b){yn[Z]=b},U.getModelTypeHandler=function(F){return yn[F]},U.handleModelLoaded=function(){},U.handleUnfoundModel=function(){};var ab=u,Qo=u,Jp=function(f){ab&&!f._loadingModelView_&&(Qo||(Qo={}),Qo[f._loadingModelView_=Pk()]=f)},ve=function(H,e){ab||(ab={});var m=ab[H];if(m){if(m.url===e)return;m.request.onload=td,m.request.onerror=td}var $=new Yq;if(ab[H]={request:$,url:e},e=U.beforeLoadURL(e),e.data){var l=U.parse(e.data);Bm(H,l,e)}else{$.onload=function(){if(200===this.status||0===this.status){delete ab[H];var l=U.parse($.getResponseText());Bm(H,l,e)}else nf(H,U.handleUnfoundModel(H,e)||u)},$.onerror=function(){nf(H,U.handleUnfoundModel(H,e)||u)};var O={};O.url=encodeURI(e),O.sync=!1,$.send(O)}},Bm=function(c,N,$){var r=N.modelType;if(!r)return nf(c,N),U.handleModelLoaded(c,N),void 0;var k=U.getModelTypeHandler(r);if(k){if(ab||(ab={}),ab[c])return;ab[c]=!0;var x=function(O){O?(nf(c,O),U.handleModelLoaded(c,O)):nf(c,U.handleUnfoundModel(c,$)||u)};k(N,x)}else nf(c,U.handleUnfoundModel(c,$)||u)},nf=function(D,t){if(rl[D]=t,delete ab[D],Dh(ab)&&(ab=u,Qo)){for(var B in Qo){var b=Qo[B];b.invalidateAll&&b.invalidateAll(f,"modelLoaded",D),b.redraw&&b.redraw(),b.iv(),delete b._loadingModelView_}Qo=u}if(t&&Qo)for(var B in Qo){var b=Qo[B];b.invalidateAll&&b.invalidateAll(f,"modelLoading",D),b.redraw&&b.redraw(),b.iv()}},Jn=new Jk([0,0,0,1,1,1,1,0]),Lg=new Jk([0,0,1,0,0,1,0,0,1,0,0,1]),Ci=new Gk([0,1,2,2,3,0]),Zp=new Jk([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Rr=new Gk([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),md=new Jk([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),wl=uh(Zp,Rr),gk=(new Jk([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Gk([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[nk,gr,yq,cl,hk,nh]),Mf=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],sd=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],fj=function(Z,d,P,w,b,O){O=O||16,Z=Z||16,d=d||0,P=P||Z;var t,X,m,R,N,L,s,B,o=.5,k=[],U=[],G=e/Z,l=y/O;for(t=0;O>t;t++)for(N=t+1,R=t*l,B=N*l,X=d;P>X;X++)L=X+1,m=X*G,s=L*G,k.push(o*x(R)*p(m),o*p(R),-o*x(R)*x(m),o*x(B)*p(s),o*p(B),-o*x(B)*x(s),o*x(R)*p(s),o*p(R),-o*x(R)*x(s),o*x(R)*p(m),o*p(R),-o*x(R)*x(m),o*x(B)*p(m),o*p(B),-o*x(B)*x(m),o*x(B)*p(s),o*p(B),-o*x(B)*x(s)),U.push(X/Z,t/O,L/Z,N/O,L/Z,t/O,X/Z,t/O,X/Z,N/O,L/Z,N/O);if(w){var Y=[],$=[];for(m=d*G,t=0;O>t;t++)N=t+1,R=t*l,B=N*l,Y.push(0,0,0,o*x(B)*p(m),o*p(B),-o*x(B)*x(m),o*x(R)*p(m),o*p(R),-o*x(R)*x(m)),$.push(0,.5,d/Z,N/O,d/Z,t/O)}if(b){var I=[],z=[];for(m=P*G,t=0;O>t;t++)N=t+1,R=t*l,B=N*l,I.push(0,0,0,o*x(R)*p(m),o*p(R),-o*x(R)*x(m),o*x(B)*p(m),o*p(B),-o*x(B)*x(m)),z.push(1,.5,P/Z,t/O,P/Z,N/O)}return{vs:k,uv:U,from_vs:Y,from_uv:$,to_vs:I,to_uv:z}},jp=function(i,Y,J){i=i||.17,Y=Y||12,J=J||18,0>i?i=0:i>.25&&(i=.25);var b,v,Q,d,I,k,q,M=.5,g=[],W=[],f=[],l=e/J,n=e/Y,s=M-i;for(v=0;Y>=v;v++)for(d=-y+v*n,k=p(d),I=x(d),b=0;J>=b;b++)Q=b*l,q=s+i*k,g.push(p(Q)*q,I*i,-x(Q)*q),W.push(b/J,1-v/Y);for(v=0;Y>v;v++){var w=v*(J+1),N=(v+1)*(J+1);for(b=0;J>b;b++)f.push(w+b,N+b+1,N+b,w+b,w+b+1,N+b+1)}return{vs:g,uv:W,is:f}},jd=function($,M,j,Z,S,r,l){l=l||12,$=$||18,M=M||0,j=j||$,r=r||.17,0>r?r=0:r>.25&&(r=.25);var G,N,H,Y,v,z,s,I,q,U,J=.5,d=[],m=[],A=e/$,c=e/l,a=J-r;for(H=0;l>H;H++)for(Y=H+1,s=-y+H*c,I=-y+Y*c,G=M;j>G;G++)N=G+1,v=G*A,z=N*A,q=a+r*p(s),U=a+r*p(I),d.push(p(v)*q,x(s)*r,-x(v)*q,p(z)*q,x(s)*r,-x(z)*q,p(z)*U,x(I)*r,-x(z)*U,p(v)*q,x(s)*r,-x(v)*q,p(z)*U,x(I)*r,-x(z)*U,p(v)*U,x(I)*r,-x(v)*U),m.push(G/$,1-H/l,N/$,1-H/l,N/$,1-Y/l,G/$,1-H/l,N/$,1-Y/l,G/$,1-Y/l);if(Z){var R=[],F=[];for(H=0;l>H;H++)Y=H+1,s=-y+H*c,I=-y+Y*c,v=M*A,q=a+r*p(s),U=a+r*p(I),R.push(p(v)*q,x(s)*r,-x(v)*q,p(v)*U,x(I)*r,-x(v)*U,p(v)*a,0,-x(v)*a),F.push(.5+.5*p(s),.5-.5*x(s),.5+.5*p(I),.5-.5*x(I),.5,.5)}if(S){var D=[],o=[];for(H=0;l>H;H++)Y=H+1,s=-y+H*c,I=-y+Y*c,v=j*A,q=a+r*p(s),U=a+r*p(I),D.push(p(v)*q,x(s)*r,-x(v)*q,p(v)*a,0,-x(v)*a,p(v)*U,x(I)*r,-x(v)*U),o.push(.5-.5*p(s),.5-.5*x(s),.5,.5,.5-.5*p(I),.5-.5*x(I))}return{vs:d,uv:m,from_vs:R,from_uv:F,to_vs:D,to_uv:o}},pi=function(C,z){for(var _,Z,S,b=.5,g=16,N=[],$=[],s=[],E=e/g,R=0;g>=R;R++)_=R*E,Z=p(_)*b,S=x(_)*b,N.push(Z,-b,S,Z,b,S),$.push(1-R/g,1,1-R/g,0);for(R=0;g>R;R++)s.push(2*R,2*R+1,2*R+3,2*R,2*R+3,2*R+2);if(z){var B=[],H=[],W=[];for(B.push(0,-b,0),H.push(.5,.5),R=0;g>=R;R++)_=R*E,Z=p(_),S=x(_),B.push(Z*b,-b,-S*b),H.push(.5+.5*Z,.5+.5*S);for(R=0;g>R;R++)W.push(0,R+2,R+1)}if(C){var y=[],q=[],I=[];for(y.push(0,b,0),q.push(.5,.5),R=0;g>=R;R++)_=R*E,Z=p(_),S=x(_),y.push(Z*b,b,-S*b),q.push(.5+.5*Z,.5-.5*S);for(R=0;g>R;R++)I.push(0,R+1,R+2)}return{vs:N,uv:$,is:s,bottom_vs:B,bottom_uv:H,bottom_is:W,top_vs:y,top_uv:q,top_is:I}},Vl=function(R,Z,T,N,j,o,C){R=R||12,Z=Z||0,T=T||R;for(var r,d,m,P,V,I,q,i,X=.5,F=[],z=[],U=e/R,s=Z;T>s;s++)r=s+1,d=s*U,m=r*U,P=p(d)*X,V=x(d)*X,I=p(m)*X,q=x(m)*X,F.push(P,-X,-V,I,-X,-q,P,X,-V,I,-X,-q,I,X,-q,P,X,-V),z.push(s/R,1,r/R,1,s/R,0,r/R,1,r/R,0,s/R,0);if(C){var Q=[],y=[];for(s=Z;T>s;s++)d=U*s,m=U*(s+1),P=p(d),V=x(d),I=p(m),q=x(m),Q.push(P*X,-X,-V*X,0,-X,0,I*X,-X,-q*X),y.push(.5+.5*P,.5+.5*V,.5,.5,.5+.5*I,.5+.5*q)}if(o){var W=[],E=[];for(s=Z;T>s;s++)d=U*s,m=U*(s+1),P=p(d),V=x(d),I=p(m),q=x(m),W.push(P*X,X,-V*X,I*X,X,-q*X,0,X,0),E.push(.5+.5*P,.5-.5*V,.5+.5*I,.5-.5*q,.5,.5)}if(N){var S=[],J=[];d=U*Z,P=p(d)*X,V=x(d)*X,i=Z/R,S.push(0,X,0,0,-X,0,P,-X,-V,P,-X,-V,P,X,-V,0,X,0),J.push(0,0,0,1,i,1,i,1,i,0,0,0)}if(j){var n=[],H=[];d=U*T,P=p(d)*X,V=x(d)*X,i=T/R,n.push(0,-X,0,0,X,0,P,X,-V,P,X,-V,P,-X,-V,0,-X,0),H.push(1,1,1,0,i,0,i,0,i,1,1,1)}return{vs:F,uv:z,bottom_vs:Q,bottom_uv:y,top_vs:W,top_uv:E,from_vs:S,from_uv:J,to_vs:n,to_uv:H}},en=function(P,I,Z,K,A){I=I||18,Z=Z||0,K=K==u?e:K,A=A==u?.5:A;for(var k,v,y,s,V,a,g=[0,.5,.75,.875,.9375],L=[],h=[],o=[],r=K/I,j=0;j<g.length;j++){var c=0===j%2?0:.5;for(k=0;I>=k;k++)v=(k+c)*r+Z,y=1-g[j],L.push(p(v)*A*y,-A+2*g[j]*A,-x(v)*A*y),h.push((k+c)/I,y)}for(j=0;j<g.length-1;j++){var C=j*(I+1),t=(j+1)*(I+1);for(k=0;I>k;k++)o.push(C+k,t+k+1,t+k,C+k,C+k+1,t+k+1)}for(a=L.length/3-(I+1),k=0;I>k;k++)L.push(0,A,0),h.push((k+.5)/I,0);for(k=0;I>k;k++)o.push(a+k,a+k+1,a+(I+1)+k);if(P){var E=[],Y=[],U=[];for(E.push(0,-A,0),Y.push(.5,.5),k=0;I>=k;k++)v=k*r+Z,s=p(v),V=x(v),E.push(s*A,-A,-V*A),Y.push(.5+.5*s,.5+.5*V);for(k=0;I>k;k++)U.push(0,k+2,k+1)}return{vs:L,uv:h,is:o,bottom_vs:E,bottom_uv:Y,bottom_is:U}},Se=function(v,k,Y,b,i,C){v=v||16,k=k||0,Y=Y||v;for(var L=.5,N=[],u=[],o=e/v,S=k;Y>S;S++){var O=S+1,z=o*S,n=o*O;N.push(p(z)*L,-L,-x(z)*L,p(n)*L,-L,-x(n)*L,0,L,0),u.push(S/v,1,O/v,1,(S+O)/2/v,0)}if(C){var P=[],g=[];for(S=k;Y>S;S++){z=o*S,n=o*(S+1);var V=p(z),h=x(z),a=p(n),I=x(n);P.push(V*L,-L,-h*L,0,-L,0,a*L,-L,-I*L),g.push(.5+.5*V,.5+.5*h,.5,.5,.5+.5*a,.5+.5*I)}}if(b){var $=[],R=[];z=o*k,$.push(0,L,0,0,-L,0,p(z)*L,-L,-x(z)*L),R.push(0,0,0,1,k/v,1)}if(i){var r=[],D=[];z=o*Y,r.push(0,-L,0,0,L,0,p(z)*L,-L,-x(z)*L),D.push(1,1,1,0,Y/v,1)}return{vs:N,uv:u,bottom_vs:P,bottom_uv:g,from_vs:$,from_uv:R,to_vs:r,to_uv:D}},Rf=function(I,v,b,O,h,o,t,e){for(var E=[],_=0;_<I.length-1;_+=2)E.push({x:I[_],y:I[_+1]});return cj(E,v,b,O,h,o,t,e,!1)},Jf={roundRect:function(N,l){return Rf([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],N,l,3)},star:function(q,z){return Rf([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],q,z)},rect:function(B,M){return Rf([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],B,M)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(d,r){return Rf([0,-.5,.5,.5,-.5,.5],[1,2,2,5],d,r)},rightTriangle:function(B,g){return Rf([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],B,g)},parallelogram:function(b,V){return Rf([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],b,V)},trapezoid:function(I,n){return Rf([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],I,n)}},Sn={sphere:1,cylinder:1,cone:1,torus:1},Hc={torus:1,sphere:1},Tk=ae(Qb(Jf),{cylinder:1}),hb=ae(Qb(Jf),{cylinder:1,cone:1}),ui=function(s,c,I){var q,y=wq(s.anchor3d,I,c),E=wq(s.mat,I,c),M=wq(s.s3,I,c),K=wq(s.t3,I,c),R=wq(s.r3,I,c),Y=M||R||K||E;if(y||Y){q=Or(c._6O);var D=Y?Cm(E,M,R,wq(s.rotationMode,I,c),K):sh();y&&Ah(D,[.5-y[0],.5-y[1],.5-y[2]]),Sb(c,D)}return q},vs=function(F,v,Y,r,o,I,M){if(En(Y))Y.forEach(function(y){vs(F,v,y,r,o,I,M)});else if(Bs(Y))vs(F,v,Hb(r,Y),r,o,I,M);else if(Il(Y))if(Y.shape3d){var a=ui(Y,F,v);vs(F,v,Y.shape3d,r,o,I,Y),a&&Uj(F,a)}else Mk(F,v,Y,r.s,o,I,M)},Mk=function(W,O,Z,k,q,z,n){if(n=n||Cd,!z||z(k("shape3d.transparent",Z.transparent,n.transparent))){var m=ui(Z,W,O);to(Z);var t=W._26I,U=W._prg,p=W._buffer,b=k("shape3d.color",Z.color,n.color);q||(q=k("shape3d.blend",Z.blend,n.blend));var Y,F=Z.opacity==u?n.opacity:Z.opacity,K=k("shape3d.opacity");Y=K!=u&&F!=u?F*K:F!=u?F:K,gj(t,U,q,k("shape3d.light",Z.light,n.light),Y,k("shape3d.reverse.flip",Z.reverseFlip,n.reverseFlip),k("shape3d.reverse.color",Z.reverseColor,n.reverseColor),k("shape3d.reverse.cull",Z.reverseCull,n.reverseCull));var G=k("polygonOffset",Z.polygonOffset,n.polygonOffset);Z.vs&&k(np,Z.visible,n.visible)&&zn(t,U,p,b,W.getTexture(k("shape3d.image",Z.image,n.image),O),k("shape3d.discard.selectable",Z.discardSelectable,n.discardSelectable),Z.vs,Z.uv,Z.ns,Z.is,k("shape3d.uv.offset",Z.uvOffset,n.uvOffset),k("shape3d.uv.scale",Z.uvScale,n.uvScale),G),Z.top_vs&&k(Ib,Z.topVisible,n.topVisible)&&zn(t,U,p,k("shape3d.top.color",Z.topColor,n.topColor)||b,W.getTexture(k("shape3d.top.image",Z.topImage,n.topImage),O),k("shape3d.top.discard.selectable",Z.topDiscardSelectable,n.topDiscardSelectable),Z.top_vs,Z.top_uv,Z.top_ns,Z.top_is,k("shape3d.top.uv.offset",Z.topUvOffset,n.topUvOffset),k("shape3d.top.uv.scale",Z.topUvScale,n.topUvScale),G),Z.bottom_vs&&k(rm,Z.bottomVisible,n.bottomVisible)&&zn(t,U,p,k("shape3d.bottom.color",Z.bottomColor,n.bottomColor)||b,W.getTexture(k("shape3d.bottom.image",Z.bottomImage,n.bottomImage),O),k("shape3d.bottom.discard.selectable",Z.bottomDiscardSelectable,n.bottomDiscardSelectable),Z.bottom_vs,Z.bottom_uv,Z.bottom_ns,Z.bottom_is,k("shape3d.bottom.uv.offset",Z.bottomUvOffset,n.bottomUvOffset),k("shape3d.bottom.uv.scale",Z.bottomUvScale,n.bottomUvScale),G),Z.from_vs&&k(Tn,Z.fromVisible,n.fromVisible)&&zn(t,U,p,k("shape3d.from.color",Z.fromColor,n.fromColor)||b,W.getTexture(k("shape3d.from.image",Z.fromImage,n.fromImage),O),k("shape3d.from.discard.selectable",Z.fromDiscardSelectable,n.fromDiscardSelectable),Z.from_vs,Z.from_uv,Z.from_ns,Z.from_is,k("shape3d.from.uv.offset",Z.fromUvOffset,n.fromUvOffset),k("shape3d.from.uv.scale",Z.fromUvScale,n.fromUvScale),G),Z.to_vs&&k(tr,Z.toVisible,n.toVisible)&&zn(t,U,p,k("shape3d.to.color",Z.toColor,n.toColor)||b,W.getTexture(k("shape3d.to.image",Z.toImage,n.toImage),O),k("shape3d.to.discard.selectable",Z.toDiscardSelectable,n.toDiscardSelectable),Z.to_vs,Z.to_uv,Z.to_ns,Z.to_is,k("shape3d.to.uv.offset",Z.toUvOffset,n.toUvOffset),k("shape3d.to.uv.scale",Z.toUvScale,n.toUvScale),G),vg(t,U),m&&Uj(W,m)}},zn=function(g,T,_,e,f,R,$,O,t,N,y,Q,x){$&&(x&&tl(g,x),oi(g,T.uDiffuse,e||W["color.empty"]),O?cc(g,T,f,R,_.uv,O,y,Q):cc(g),Er(g,_.vs,$,T.aPosition),Er(g,_.ns,t,T.aNormal),N?(Hn(g,_.is,N),Nq(g,0,N.length)):Tq(g,0,$.length/3),O?Sm(g,T,f):Sm(g),x&&Ce(g))},Hb=function(E,G){var y=E.s;if(G||(G=y(Yi)),!G)return u;var d=jr(G);if(d)return d;if("text"===G){var q={amount:y("shape3d.text.amount"),size:y("shape3d.text.size"),font:y("shape3d.text.font"),style:y("shape3d.text.style"),weight:y("shape3d.text.weight"),fill:y("shape3d.text.fill"),curveSegments:y("shape3d.text.curveSegments"),spacing:y("shape3d.text.spacing")},w=E.gv.getShape3dText(E.data),F=w;for(var O in q)F+="_"+(q[O]===f?"U":q[O]);return E._cachedTextKey===F?E._cachedTextGeometry:(E._cachedTextKey=F,E._cachedTextGeometry=U.createTextGeometry(w,q))}var O=G;if(Sn[G]){var k=y("shape3d.side"),K=y("shape3d.side.from"),J=y("shape3d.side.to"),N=y(Tn),v=y(tr);3>k?(k=0,K=0,J=0,N=!1,v=!1):((K==u||0>K)&&(K=0),(J==u||J>k)&&(J=k),0===K&&J===k&&(N=!1,v=!1)),O+="-"+k+"-"+K+"-"+J+"-"+N+"-"+v}if(Tk[G]){var R=y(Ib);O+="-"+R}if(hb[G]){var z=y(rm);O+="-"+z}if("torus"===G){var _=y("shape3d.torus.radius");0>_?_=0:_>.25&&(_=.25),O+="-"+_}if(Hc[G]){var e=y(jn);O+="-"+e}return d=Vf[O],d||("box"===G?d=U.createBoxModel():Jf[G]?d=Jf[G](R,z):"sphere"===G?d=U.createSphereModel(k,K,J,N,v,e):G===Wl?d=U.createCylinderModel(k,K,J,N,v,R,z):"cone"===G?d=U.createConeModel(k,K,J,N,v,z):"torus"===G&&(d=U.createTorusModel(k,K,J,N,v,_,e)),Vf[O]=d),d},to=function(){var Y=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],V=["is","top_is","bottom_is","from_is","to_is"];return s=Xk(Ei.substr(Ei.indexOf("^#")+2)),_n(U[Xf(Fi+Y[15]+"n"+Y[16])]())&&Oc()?function(M){M&&!M._complete_&&(M._complete_=!0,M.vs&&oo(M.ns)&&(M.ns=uh(M.vs,M.is)),M.top_vs&&oo(M.top_ns)&&(M.top_ns=uh(M.top_vs,M.top_is)),M.bottom_vs&&oo(M.bottom_ns)&&(M.bottom_ns=uh(M.bottom_vs,M.bottom_is)),M.from_vs&&oo(M.from_ns)&&(M.from_ns=uh(M.from_vs,M.from_is)),M.to_vs&&oo(M.to_ns)&&(M.to_ns=uh(M.to_vs,M.to_is)),Y.forEach(function(j){var g=M[j];En(g)&&(M[j]=new Jk(g))}),V.forEach(function(k){var j=M[k];En(j)&&(M[k]=new Gk(j))}))}:void 0}(),Zj=function(L,d){var c=L[d];En(c)&&(L[d]=new Jk(c))};ae($r,{_25Q:function(X){X._16O=function(K,S,q,g,u,G,x,B,f){var s=this.info;if(s){var r,t,Q,W,V,z,o=sh();if(gc[S]?(r=s.p3,t=s.c1,Q=s.c2):rf[S]?(t=s.s1||s.c1,Q=s.s2||s.c2):(t=s.t1||s.c1,Q=s.t2||s.c2),r)z=ac(S,Ue,q,g,B,f);else{var n=Zq(Q,t),O=Di(t,Q);W=[0,-$(n[2],n[0]),C(n[1]/O)],V="zyx",r=[(t[0]+Q[0])/2,(t[1]+Q[1])/2,(t[2]+Q[2])/2],z=ac(S,[O,0,0],q,g,B,f)}return Wj(o,z,r,g,u,G,x,K,W,V)}return kl},X._80o=function(C,U,s){var o=this,X=o.shapeModel;if(X){var M=o.gv;Sb(M),vs(M,o.data,X,o,o.getBodyColor(),s)}},X.createLineModel=function(A,T,x,P,$){for(var Z=this,X=Z.s,S=Lb(A,T,X(jn)),j=[],g=0;g<S.length;g++){var W=S[g],b=W.length;if(b>1){var f=W[0];j.push(f.x,f.y,f.z);for(var k=1;b-1>k;k++)f=W[k],j.push(f.x,f.y,f.z),j.push(f.x,f.y,f.z);f=W[b-1],j.push(f.x,f.y,f.z)}}var t,N,F,E=X(P+".color"),e=X($),c=0;return e&&(N=X($+".color"),t=X($+".pattern"),c=X($+".offset"),F=E),ak(Z.gv,Z.data,j,N||E,F?u:X(P+".gradient.color"),x,t||X(P+".pattern"),c,F),S},X.createTubeModel=function(D,h,s,m){for(var Q=this,q=Q.s,W=q("shape3d.side")||Of,p=q("shape3d.start.angle"),K=q("shape3d.sweep.angle"),w=q(Ib)?q("shape3d.top.cap"):u,x=q(rm)?q("shape3d.bottom.cap"):u,H="flat"===w,N="flat"===x,E=H&&(m?m.uv:q("shape3d.top.image")),r=N&&(m?m.uv:q("shape3d.bottom.image")),O=m?m.uv:q("shape3d.image"),v={vs:[],uv:O?[]:u,top_vs:H?[]:u,top_uv:E?[]:u,bottom_vs:N?[]:u,bottom_uv:r?[]:u},C=Lb(D,h,q(jn),s),c=0,g=C.length;g>c;c++)Fj(v,C[c],q(ms),s,W,p,K,w,x);if(m){var f=[];be(Q.gv,Q.data,v,Q,Q.getBodyColor(),[],m,f),f.length&&(Ab(m.vs,f),Ab(m.ns,uh(f)))}else Q.shapeModel=v;return C},X.getCache=function(){var h=this.info;if(h){var p=h.list;if(p){var R=h.cache;return R||(R=h.cache=Eq(p)),R}}return u}}});var Mh=function(p,s){for(var L,O=0,G=p.length,E=0,F=G-1;F>=E;)if(O=R(E+(F-E)/2),L=p[O].length-s,0>L)E=O+1;else{if(!(L>0)){F=O;break}F=O-1}O=F;var g=p[O],i=g.point;return O===G-1||g.length===s||(i=(new Fh).subVectors(p[O+1].point,i).normalize().multiplyScalar(s-g.length).add(i)),{point:i,tangent:g.tangent}},Eq=function(c){for(var I,$,X=[],C=0,m=0;m<c.length;m++){for(var T=c[m],p=0;p<T.length;p++){I=T[p],$&&(C+=$.distanceTo(I));var t=new Fh,n=T[p+1];n?t.subVectors(n,I):$?t.subVectors(I,$):t.x=1,t.normalize(),X.push({point:I,length:C,tangent:t}),$=I}$=null}return X},Lb=function(r,V,G,F){G=G||ur;for(var q=[],Y=0,S=r.size();S>Y;Y++){var n=r.get(Y);q.push(new Fh(n.x,n.e||0,n.y))}V&&(hq(V)&&(V=V._as),V.length||(V=null));for(var N,B,f,g,H,x=[],J=0,O=0,M=V?V.length:S;M>O;O++)if(H=V?V[O]:0===O?1:2,1===H)x.push(f=[]),f.push(q[J++]);else if(2===H||5===H)if(g=2===H?q[J++]:f[0],F){var m=V?V[O+1]:M>O+1?2:u;if(2===m||5===m){var l=f[f.length-1],d=2===m?q[J]:f[0],w=(new Fh).subVectors(l,g),p=(new Fh).subVectors(d,g),k=w.length(),b=p.length();if(k&&b)if(F>k/2&&F>b/2)f.push(g);else for(w.multiplyScalar(I(F,k/2)/k).add(g),p.multiplyScalar(I(F,b/2)/b).add(g),N=new Ki(w,g,p).getPoints(G),B=0;G>=B;B++)f.push(N[B])}else f.push(g)}else f.push(g);else if(3===H)for(N=new Ki(f[f.length-1],q[J++],q[J++]).getPoints(G),B=1;G>=B;B++)f.push(N[B]);else if(4===H)for(N=new Gm(f[f.length-1],q[J++],q[J++],q[J++]).getPoints(G),B=1;G>=B;B++)f.push(N[B]);return x},Qf=function(l){for(var g,c,a=new Fh,Z=[],m=[],U=[],C=0,L=l.length;L>C;C++)g=l[C],c=l[C+1],c?a.subVectors(c,g):a.subVectors(g,l[C-1]),Z.push(a.normalize().clone());var H,B,E,r,D=new Fh,o=new Fh,j=new me,p=1e-4,O=Number.MAX_VALUE,N=Z[0],w=m[0]=new Fh,x=U[0]=new Fh;for(B=k(N.x),E=k(N.y),r=k(N.z),O>=B&&(O=B,D.set(1,0,0)),O>=E&&(O=E,D.set(0,1,0)),O>=r&&D.set(0,0,1),o.crossVectors(N,D).normalize(),w.crossVectors(N,o),x.crossVectors(N,w),C=1;L>C;C++)m[C]=m[C-1].clone(),U[C]=U[C-1].clone(),o.crossVectors(Z[C-1],Z[C]),o.length()>p&&(o.normalize(),H=T(ml(Z[C-1].dot(Z[C]),-1,1)),m[C].applyMatrix4(j.makeRotationAxis(o,H))),U[C].crossVectors(Z[C],m[C]);return{B:U,T:Z,N:m}},Fj=function(){var L=function(R){for(var m=1;m<arguments.length;m++){var H=arguments[m];R.push(H.x,H.y,H.z)}},b=function(l){for(var c=1;c<arguments.length;c++){var k=arguments[c].uv;l.push(k[0],k[1])}},m=function(S,t,s,b,A){var G=-b*p(A),_=b*x(A);return new Fh(S.x+G*s.x+_*t.x,S.y+G*s.y+_*t.y,S.z+G*s.z+_*t.z)},K=function(Z,B,E,h,l,W,L,V){L=L||e;for(var x=[],Y=L/l,y=0;l>=y;y++){var J=m(Z,B,E,h,y*Y+W);x.push(J),V!=u&&(J.uv=[V,y/l])}return x},X=function(U,F,T,i,G,K,j,r,g){g=g||e;var Y=F?U.top_vs:U.bottom_vs;if(Y)for(var c=F?U.top_uv:U.bottom_uv,z=g/j,q=0;j>q;q++){var W,d;F?(W=q*z+r,d=(q+1)*z+r):(d=q*z+r,W=(q+1)*z+r),L(Y,m(T,i,G,K,W),m(T,i,G,K,d),T),c&&c.push(.5-.5*p(W),.5-.5*x(W),.5-.5*p(d),.5-.5*x(d),.5,.5)}};return function(l,d,y,G,v,m,N,M,A){var h=d.length;if(h>1){var J,H,g,a,D,C,B,E=Qf(d),W=E.T,I=E.N,$=E.B;"flat"===M&&X(l,!0,d[0],$[0],I[0],G,v,m,N),"flat"===A&&X(l,!1,d[h-1],$[h-1],I[h-1],G,v,m,N);var z,p,k=[],x=n(v/2),i="round"===M,Q="round"===A,Z=d[0],P=W[0],o=$[0],V=I[0],w=d[h-1],F=W[h-1],O=$[h-1],T=I[h-1];if(i){for(g=1;x>=g;g++)I.splice(0,0,V),$.splice(0,0,o),W.splice(0,0,P),p=-g/x*G,d.splice(0,0,P.clone().multiplyScalar(p).add(Z)),k[x-g]=r(G*G-p*p);h+=x}if(Q){for(g=1;x>=g;g++)I.push(T),$.push(O),W.push(F),p=g/x*G,d.push(F.clone().multiplyScalar(p).add(w)),k[d.length-1]=r(G*G-p*p);h+=x}if(l.uv){var t=0,S=0,e=[];for(y&&(t=y),D=d[0],e[0]=0,g=1;h>g;g++)a=d[g],e[g]=D.distanceTo(a),D=a,y||(t+=e[g]);for(z=[],g=0;h>g;g++)S+=e[g],z[g]=t?S/t:0}for(g=0;h>g;g++){if(a=d[g],C=$[g],B=I[g],J=K(a,C,B,k[g]===f?G:k[g],v,m,N,z?z[g]:u),H)for(var c=0;v>c;c++){var Y=H[c],U=H[c+1]||H[0],s=J[c],q=J[c+1]||J[0];L(l.vs,U,Y,s,s,q,U),l.uv&&b(l.uv,U,Y,s,s,q,U)}H=J}}}}();ae(U,{getLineLength:function(W){return W[W.length-1].length},getLineOffset:function(R,C){return Mh(R,C)},getLineCacheInfo:function(_,T,K,x){return Eq(Lb(_,T,K,x))}});var yp=X.graph3d.RenderLite={},xi=new Array(0),_b=yp.Buffer=function(i,N,k,R){this.gl=i,this.buffer=i.createBuffer(),this.type=N||i.ARRAY_BUFFER,this.drawType=R||i.STATIC_DRAW,this.data=xi,k&&this.upload(k)};_b.prototype.upload=function(D,C,G){G||this.bind();var w=this.gl;D=D||this.data,C=C||0,this.data.byteLength>=D.byteLength?w.bufferSubData(this.type,C,D):w.bufferData(this.type,D,this.drawType),this.data=D},_b.prototype.bind=function(){var y=this.gl;y.bindBuffer(this.type,this.buffer)},_b.createVertexBuffer=function(_,t,e){return new _b(_,_.ARRAY_BUFFER,t,e)},_b.createIndexBuffer=function(u,o,K){return new _b(u,u.ELEMENT_ARRAY_BUFFER,o,K)},_b.create=function(s,A,x,V){return new _b(s,A,V)},_b.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var or=yp.Shader=function(l,x,m){this.gl=l,this.program=Bl(l,x,m),this.attributes=mh(l,this.program);var C=oc(l,this.program);this.uniforms=yf(l,C)};or.prototype.bind=function(){this.gl.useProgram(this.program)},or.prototype.destroy=function(){this.gl};var Bl=function(V,b,x){var K=Zi(V,V.VERTEX_SHADER,b),U=Zi(V,V.FRAGMENT_SHADER,x);V.getShaderParameter(U,V.COMPILE_STATUS)||console.error(V.getError());var E=V.createProgram();return V.attachShader(E,K),V.attachShader(E,U),V.linkProgram(E),V.getProgramParameter(E,V.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",V.getProgramParameter(E,V.VALIDATE_STATUS)),console.error("gl.getError()",V.getError()),""!==V.getProgramInfoLog(E)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",V.getProgramInfoLog(E)),V.deleteProgram(E),E=null),V.deleteShader(K),V.deleteShader(U),E},Zi=function(K,e,Z){var v=K.createShader(e);return K.shaderSource(v,Z),K.compileShader(v),K.getShaderParameter(v,K.COMPILE_STATUS)?v:(console.log(K.getShaderInfoLog(v)),null)},oc=function(Y,j){for(var b={},D=Y.getProgramParameter(j,Y.ACTIVE_UNIFORMS),O=0;D>O;O++){var C=Y.getActiveUniform(j,O),n=C.name.replace(/\[.*?\]/,""),w=Gi(Y,C.type);b[n]={type:w,size:C.size,location:Y.getUniformLocation(j,n),value:Si(w,C.size)}}return b},mh=function(R,u){for(var S={},V=R.getProgramParameter(u,R.ACTIVE_ATTRIBUTES),T=0;V>T;T++){var U=R.getActiveAttrib(u,T),D=Gi(R,U.type);S[U.name]={type:D,size:Wc(D),gl:R,location:R.getAttribLocation(u,U.name),pointer:Df}}return S},Df=function(V,q,N,x,X){var m=this.gl;m.enableVertexAttribArray(this.location),m.bindBuffer(V.type,V.buffer),m.vertexAttribPointer(this.location,this.size,q||m.FLOAT,N||!1,x||0,X||0)},Wc=function(n){return Gd[n]},Gd={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},Gi=function(C,M){if(!Cn){var W=b.keys(dq);Cn={};for(var D=0;D<W.length;++D){var g=W[D];Cn[C[g]]=dq[g]}}return Cn[M]},Cn=null,dq={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Si=function(Y,g){switch(Y){case"float":return 0;case"vec2":return new Float32Array(2*g);case"vec3":return new Float32Array(3*g);case"vec4":return new Float32Array(4*g);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*g);case"ivec3":return new Int32Array(3*g);case"ivec4":return new Int32Array(4*g);case"bool":return!1;case"bvec2":return ue(2*g);case"bvec3":return ue(3*g);case"bvec4":return ue(4*g);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},ue=function(x){for(var q=new Array(x),E=0;E<q.length;E++)q[E]=!1;return q},yf=function(t,C){var U={data:{}};U.gl=t;for(var m=b.keys(C),Z=0;Z<m.length;Z++){var W=m[Z],c=W.split("."),P=c[c.length-1],$=tk(c,U),u=C[W];$.data[P]=u,$.gl=t,b.defineProperty($,P,{get:Rq(P),set:$o(P,u)})}return U},Rq=function(L){var p=kj.replace("%%",L);return new Function(p)},$o=function(Q,J){var M,L=rs.replace(/%%/g,Q);return M=1===J.size?ph[J.type]:nb[J.type],M&&(L+="\nthis.gl."+M+";"),new Function("value",L)},tk=function(O,y){for(var Y=y,z=0;z<O.length-1;z++){var l=Y[O[z]]||{data:{}};Y[O[z]]=l,Y=l}return Y},kj=["return this.data.%%.value;"].join("\n"),rs=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),ph={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},nb={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},wn=X.Light=function(){ef(wn,this),this.s(vn,W[vn]),this.s(Yi,"sphere"),this.s3(20,20,20)};lp("Light",Kd,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(w,n,l){wn.superClass.onStyleChanged.apply(this,arguments),w===vn&&this.s("shape3d.color",l)}});var Kf=fb.Graph3dView=function(m,y){var T=this;T._webGLVersion=1,T._attributes=y||U.graph3dViewAttributes,T._25I={},T._view=sm(1,T);var C=T._canvas=ib(T._view);C.addEventListener("webglcontextlost",function(F){F.preventDefault(),jj(T),T._26I&&T._doBufferGC(T._26I,!0),T._26I=u,T._1o.texture=u,T._35O=!0},V),C.addEventListener("webglcontextrestored",function(){T._35O=!1,T.iv()},V),T._batchIndexMap={},T._batchModelMap={},T._wireframeIndexMap={},T._wireframeModelMap={},T._wireframeIndexMapSwap={},T._wireframeModelMapSwap={},T._polylineIndexMap={},T._polylineIndexMap={},T._polylineIndexMapSwap={},T._polylineIndexMapSwap={},T._8O=[],T._7O=sh(),T._6O=sh(),T._1o=new de(T),T._30O=new Uk(T),T._31O=new Yo(T),T._32O=new Hl(T),T._raycaster=new Ml(T),T._highlightHelper=new aj(T),T._postProcessing=new qi(T),T.vr=new ai(T),T._33Q=!0,T._eye=Qb(U.graph3dViewEye),T._center=Qb(U.graph3dViewCenter),T._up=Qb(U.graph3dViewUp),T._lightChanged=!1,T._59O=[],T._spots=[],T._dirs=[],T._frameId=0,T.overlappingBox=new Mb(T),T.dm(m?m:new ss),T._coreInteractor=new kc(this),T.setInteractors([new po(T)])},Nr={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},Hp=0;Li("Graph3dView",b,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",ym,Xq,"firstPersonMode",ro,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",Hj,Md,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:U.graph3dViewEditHelperDisabled,_devicePixelRatio:f,_boundaries:f,_moveStep:U.graph3dViewMoveStep,_rotateStep:U.graph3dViewRotateStep,_pannable:U.graph3dViewPannable,_rotatable:U.graph3dViewRotatable,_walkable:U.graph3dViewWalkable,_resettable:U.graph3dViewResettable,_zoomable:U.graph3dViewZoomable,_firstPersonMode:U.graph3dViewFirstPersonMode,_mouseRoamable:U.graph3dViewMouseRoamable,_gridVisible:U.graph3dViewGridVisible,_gridSize:U.graph3dViewGridSize,_gridGap:U.graph3dViewGridGap,_gridColor:U.graph3dViewGridColor,_originAxisVisible:U.graph3dViewOriginAxisVisible,_centerAxisVisible:U.graph3dViewCenterAxisVisible,_axisXColor:U.graph3dViewAxisXColor,_axisYColor:U.graph3dViewAxisYColor,_axisZColor:U.graph3dViewAxisZColor,_ortho:U.graph3dViewOrtho,_orthoWidth:U.graph3dViewOrthoWidth,_fovy:U.graph3dViewFovy,_near:U.graph3dViewNear,_far:U.graph3dViewFar,_headlightColor:U.graph3dViewHeadlightColor,_headlightIntensity:U.graph3dViewHeadlightIntensity,_headlightRange:U.graph3dViewHeadlightRange,_headlightDisabled:U.graph3dViewHeadlightDisabled,_rectSelectable:U.graph3dViewRectSelectable,_rectSelectBackground:U.graph3dViewRectSelectBackground,_editSizeColor:U.graph3dViewEditSizeColor,_autoMakeVisible:We,_fogDisabled:U.graph3dViewFogDisabled,_fogColor:U.graph3dViewFogColor,_fogNear:U.graph3dViewFogNear,_fogFar:U.graph3dViewFogFar,_dashDisabled:U.graph3dViewDashDisabled,_batchColorDisabled:U.graph3dViewBatchColorDisabled,_batchBlendDisabled:U.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:U.graph3dViewBatchBrightnessDisabled,setEye:function(q,I,o){1===arguments.length&&(I=q[1],o=q[2],q=q[0]);var P=this._eye;P[0]=q,P[1]=I,P[2]=o,this.fp(Hj,u,P)},setCenter:function(q,p,c){1===arguments.length&&(p=q[1],c=q[2],q=q[0]);var F=this._center;F[0]=q,F[1]=p,F[2]=c,this.fp(Md,u,F)},setUp:function(R,l,O){1===arguments.length&&(l=R[1],O=R[2],R=R[0]);var Z=this._up;Z[0]=R,Z[1]=l,Z[2]=O,this.fp("up",u,Z)},getDevicePixelRatio:function(){return this._devicePixelRatio||Ee},isTransparentMask:function(O){return O.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var P=this,b=P._aspect;return b?b:(b=P.getWidth()/P.getHeight(),b||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(x){var C=this,J=C._dataModel,N=C._selectionModel;J!==x&&(J&&(J.ump(C.handleDataModelPropertyChange,C),J.umm(C.handleDataModelChange,C),J.umd(C.handleDataPropertyChange,C),N||J.sm().ums(C.handleSelectionChange,C)),C._dataModel=x,x.mp(C.handleDataModelPropertyChange,C),x.mm(C.handleDataModelChange,C),x.md(C.handleDataPropertyChange,C),N?N._21I(x):x.sm().ms(C.handleSelectionChange,C),C._postProcessing.handleDataModleChange(J,x),C.invalidateAll(!0),C.invalidateLight(),C.fp(Vq,J,x),C._canvas.style.background=x.getBackground()||"")},handleDataModelPropertyChange:function(J){if("background"===J.property){var O=this._canvas.style.background,g=J.newValue||"";this._canvas.style.background=g,this.fp("canvasBackground",O,g)
}else"envmap"===J.property&&this.iv()},handleDataPropertyChange:function(m){var x=m.data;this.invalidateData(x),Bj(x)&&"s:light.type"===m.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(D){var m=this,T=D.property;m.iv(),m._18Q=u,"eye"===T?m._33Q=!0:"devicePixelRatio"===T?m._42(u,m.getDevicePixelRatio()):Nr[T]&&jj(m)},_5O:function(i){var L=i._22Q();return L?new L(this,i):u},getData3dUI:function(e){var L=this._25I[e._id];return L===f&&(L=this._5O(e),this._25I[e._id]=L),L},invalidateAll:function($){var q=this;if($){for(var s in q._25I){var C=q._25I[s];C&&C.dispose()}q._25I={},q.iv(),pf(q)}else pf(q),q.dm().each(function(t){q.invalidateData(t)})},invalidateSelection:function(){var $=this;$.sm().each(function(H){$.invalidateData(H)})},invalidateData:function(l){var P=this,M=P.getData3dUI(l);M&&(M.iv(),P.iv()),pf(P,l)},getShape3dText:function(R){return R.getStyle("shape3d.text")||this.getLabel(R)},invalidateBatch:function(D){var B=this,M=B._batchModelMap,J=M[D],n=[],l={};if(J){J.ds.forEach(function(r){var H=B.getData3dUI(r);H&&H.iv(),delete B._batchIndexMap[r._id],n.push(r._id)}),delete M[D];for(var d,x,o,u,p,Z,w,h,V,c=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],v=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],K=0;K<c.length;K++){var i=B[c[K]],F=B[v[K]];for(l={},h=0;h<n.length;h++){var Q=F[n[h]];if(Q){delete F[n[h]],V=Q.batch,d=i[V];var q=Q.begin,m=Q.size,_=3*q,e=3*m,z=4*q,$=4*m;for(x=d.ds,o=d.vs,u=d.cs,p=d.ps,Z=d.ls,w=Q.index,d.invalidate=!0,x[w]=f,w=_;_+e>w;w++)o[w]=f;for(w=z;z+$>w;w++)u[w]=f;for(w=z;z+$>w;w++)p[w]=f;if(Z)for(w=_;_+e>w;w++)Z[w]=f;l[V]=!0}}for(V in l){d=i[V],x=d.ds,o=d.vs,u=d.cs,p=d.ps,Z=d.ls;var X=[];for(w=0;w<x.length;w++)x[w]!==f&&X.push(x[w]);if(0===X.length)delete i[V];else{for(d.ds=X,X=[],w=0;w<o.length;w++)o[w]!==f&&X.push(o[w]);for(d.vs=X,X=[],w=0;w<u.length;w++)u[w]!==f&&X.push(u[w]);for(d.cs=X,X=[],w=0;w<p.length;w++)p[w]!==f&&X.push(p[w]);if(d.ps=X,Z){for(X=[],w=0;w<Z.length;w++)Z[w]!==f&&X.push(Z[w]);d.ls=X}}}}B.iv()}},handleDataModelChange:function(l){var S=this,s=l.kind,Q=l.data;if("add"===s)S.invalidateData(Q),ej(Q)&&Q.getEdgeGroup()&&Q.getEdgeGroup().eachSiblingEdge(S.invalidateData,S),Bj(Q)&&S.invalidateLight();else if(s===tp){var f=Q._id,A=S._25I[f];A&&(A.dispose(),delete S._25I[f],S.iv()),Q===S._currentSubGraph&&S.setCurrentSubGraph(u),pf(S,Q),Bj(Q)&&S.invalidateLight()}else s===Ch&&(S.invalidateAll(!0),S.setCurrentSubGraph(u),pf(S),S.invalidateLight())},toCanvas:function(M,m,l){var y=this,a=y.getGL();if(y.validate(),M){var q=a.getParameter(a.COLOR_CLEAR_VALUE);xe(a,M)}y._42(u,1);var J=y.getWidth(),z=y.getHeight(),L=new Uint8Array(4*J*z),C=ib(),V=C.getContext("2d");a.readPixels(0,0,J,z,a.RGBA,a.UNSIGNED_BYTE,L),Up(C,J,z,1);for(var v=V.getImageData(0,0,J,z),H=v.data,I=0;I<H.length;I+=4){var E=I/4,j=R(E/J),f=E-j*J;E=4*((z-1-j)*J+f),H[E]=L[I],H[E+1]=L[I+1],H[E+2]=L[I+2],H[E+3]=L[I+3]}if(V.putImageData(v,0,0),M&&xe(a,q),y._42(u,y.getDevicePixelRatio()),m&&l){var n=ib(),e=n.getContext("2d");return m=m,l=l,Up(n,m,l,1),U.drawImage(e,C,0,0,m,l),n}return C},toDataURL:function(S,C){var H=this,X=H.getGL();if(H.validate(),S){var J=X.getParameter(X.COLOR_CLEAR_VALUE);xe(X,S)}H._42(u,1);var T=H._canvas.toDataURL(C||"image/png",1);return S&&xe(X,J),H._42(u,H.getDevicePixelRatio()),T},getGL:function(){var z=this._26I;if(z)return this.acquireProgram(),z;var R=this,w=R._canvas,J=R._attributes;try{z=w.getContext("webgl2",J)||w.getContext("experimental-webgl2",J),z&&(R._webGLVersion=2,R._26I=z)}catch(C){}if(!z)try{z=w.getContext("webgl",J)||w.getContext("experimental-webgl",J)}catch(C){throw new Error("WebGL not supported")}R._26I=z,R._2O={},z._emptyTexture=Rd(z),z._emptyBlendTexture=Rd(z),z._bufPool={},z._id=++Hp,R._buffer={vs:ig(z),ns:ig(z),is:ig(z),uv:ig(z),batchColor:ig(z),batchBlend:ig(z),batchBrightness:ig(z),lineDistance:ig(z)},R._1O=Pb(z);var E=R._cube={vs:ig(z),ns:ig(z),is:ig(z),uv:ig(z)};return og(z,E.vs,Zp),og(z,E.ns,wl),og(z,E.uv,md),Rm(z,E.is,Rr),R.acquireProgram(),z},acquireProgram:function(){var f=this,Q=f._26I;if(Q){var h=X.Default.getImage(f.dm().getEnvmap())?!0:!1,U=f._prg&&f._prg.envMapFlag?!0:!1;if(!f._prg||h!==U){var M=f._prg=Q.createProgram();if(!M)return u;M.envMapFlag=h;var o=f._dirs.length,S=f._spots.length,x=f._59O.length,H=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];o&&H.push("uDirColor","uDirDirection"),S&&H.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),x&&H.push("uPointColor","uPointRange","uPointPosition"),xe(Q,[0,0,0,0]),Q.clearDepth(1),Q.enable(Q.DEPTH_TEST),Q.depthFunc(Q.LEQUAL),Q.enable(Q.BLEND),Q.blendFuncSeparate(Q.SRC_ALPHA,Q.ONE_MINUS_SRC_ALPHA,Q.ONE,Q.ONE_MINUS_SRC_ALPHA),Tf||(Ei=Xk(Ei.substring(0,Ei.indexOf("^#"))),hn=Xk(hn),Tf=!0);var O=["#define MAX_DIR "+o,"#define MAX_SPOT "+S,"#define MAX_POINT "+x,f._fogDisabled?"":"#define FOG",f._dashDisabled?"":"#define DASH",h?"#define USE_ENVMAP":"",f.isOrtho()?"#define ORTHOGRAPHIC":"",f._batchColorDisabled?"":"#define BATCHCOLOR",f._batchBlendDisabled?"":"#define BATCHBLEND",f._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),t=Wm(Q,M,Q.VERTEX_SHADER,Ei.replace("PREFIX",O));Q.getShaderParameter(t,Q.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",Q.getShaderInfoLog(t));var v=Wm(Q,M,Q.FRAGMENT_SHADER,hn.replace("PREFIX",O));Q.getShaderParameter(v,Q.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",Q.getShaderInfoLog(v)),q?H.push("aPosition"):(M.aPosition=0,Q.bindAttribLocation(M,0,"aPosition")),Q.linkProgram(M),H.forEach(function(x){M[x]=/^u/.test(x)?Q.getUniformLocation(M,x):Q.getAttribLocation(M,x)}),Q.useProgram(M),Q.deleteShader(t),Q.deleteShader(v)}}},getBrightness:function(e){var M=e.s("brightness"),O=this.isSelected(e)?e.s("select.brightness"):u;return M==u?O:O==u?M:M*O},setHighlightMode:function(w){var i;i="selection"===w?aj.Mode.Selection:"mouseover"===w?aj.Mode.MouseOver:aj.Mode.Disable,this._highlightHelper.mode=i},getHighlightMode:function(){var p=this._highlightHelper.mode;return p===aj.Mode.Selection?"selection":p===aj.Mode.MouseOver?"mouseover":"disable"},bindEnvMap:function(o){var D=this,r=D._prg,g=5,e=D.dm().getEnvmap(),W=X.Default.getImage(e);if(W){if(e!==D._lastEnvMap){D._envMapTexture&&o.deleteTexture(D._envMapTexture);var $=D._envMapTexture=o.createTexture();o.bindTexture(o.TEXTURE_CUBE_MAP,$),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,W),o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,W),o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,W),o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,W),o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,W),o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,W),o.bindTexture(o.TEXTURE_CUBE_MAP,null),D._lastEnvMap=e}o.activeTexture(o.TEXTURE0+g),o.bindTexture(o.TEXTURE_CUBE_MAP,D._envMapTexture),o.uniform1i(r.uEnvMap,g)}},getWireframe:function(h){var N=h.s("wf.visible"),S=h.s("wf.width");return N===!0||S>0&&"selected"===N&&this.isSelected(h)?{color:h.s("wf.color"),width:S,"short":h.s("wf.short"),mat:h.s("wf.mat")}:void 0},_transformPointToViewSpace:function(v){var e=[v[0],v[1],v[2]];return Jo(e,this._viewMatrix),e},_transformDirectionToViewSpace:function(h,K){var $=[h[0],h[1],h[2]];Jo($,this._viewMatrix);var F=K?[K[0],K[1],K[2]]:[0,0,0];Jo(F,this._viewMatrix);var _=F[0]-$[0],U=F[1]-$[1],y=F[2]-$[2],e=Math.sqrt(_*_+U*U+y*y);return e?[_/e,U/e,y/e]:[_,U,y]},getWireframeGeometry:function(J){return J.s("wf.geometry")?{color:J.s("wf.color"),width:J.s("wf.width"),mat:J.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(D){return D.s("body.color")},getMat:function(N){return N.getMat?N.getMat():N.s("mat")},getFaceMat:function(N,c){return N.getFaceMat?N.getFaceMat(c):N.s(c+".mat")},getFaceBlend:function(p,M){return p.s(M+".blend")||p.s("all.blend")},getFaceColor:function(J,h){return J.s(h+".color")||J.s("all.color")},getFaceImage:function(K,w){return K.s(w+".image")||K.s("all.image")},getFaceBlendImage:function(M,C){return M.s(C+".blend.image")||M.s("all.blend.image")},getFaceDiscardSelectable:function(D,l){var o=D.s(l+".discard.selectable");return o==u?D.s("all.discard.selectable"):o},getFaceUv:function(s,H){return s.s(H+".uv")||s.s("all.uv")},getFaceUvOffset:function(d,j){return d.s(j+".uv.offset")||d.s("all.uv.offset")},getFaceUvScale:function(H,D){return H.s(D+".uv.scale")||H.s("all.uv.scale")},getFaceLight:function(k,Q){var q=k.s(Q+".light");return q==u?k.s("all.light"):q},getFaceVisible:function(b,g){var P=b.s(g+".visible");return P==u?b.s("all.visible"):P},getFaceOpacity:function(t,Q){var R=t.s(Q+".opacity");return R==u?t.s("all.opacity"):R},getFaceTransparent:function(G,S){var f=G.s(S+".transparent");return f==u?G.s("all.transparent"):f},getFaceReverseColor:function(h,s){return h.s(s+".reverse.color")||h.s("all.reverse.color")},getFaceReverseFlip:function(H,Z){var w=H.s(Z+".reverse.flip");return w==u?H.s("all.reverse.flip"):w},getFaceReverseCull:function(S,k){var M=S.s(k+".reverse.cull");return M==u?S.s("all.reverse.cull"):M},getTextureMap:function(){return this._2O},deleteTexture:function(j){var W=this,y=W._2O[j];y&&(delete W._2O[j],W.getGL().deleteTexture(y))},invalidateShape3dCachedImage:function(E){var i=this.getData3dUI(E);i.invalidateCachedTexture(this.getGL())},isInteractive:function(s){return s.s("interactive")},getTexture:function(e,B){if(!e)return u;var t=this,p=t.getGL(),d=t._2O[e];if(!d){var V=Hi(e);if(!V)return p._emptyTexture;if(V.uuid||(V.uuid=X.Math.generateUUID()),V.tagName){if(V.dynamic)return Pb(p,V,t._1O);d=t._2O[e]=Pb(p,V)}else{var L,N=B&&B.s("shape3d.image.cache")&&!t.isInteractive(B),Z=t.vr.isPresenting();if(Z&&(B._textureUpdateFrame===p._renderInfo.frame?N=!0:B._textureUpdateFrame=p._renderInfo.frame),N&&(L=t.getData3dUI(B),d=L.getCachedTexture()),!d){if(N){if(p._renderInfo.cacheTimeCost>U.graph3dMaxVectorCacheTime)return t.redraw(),p._emptyTexture;if(!Yk(V,B))return p._emptyTexture}var v,G=B&&B.s("shape3d.fixSizeOnScreen"),H=G?p.NEAREST:p.LINEAR;G||B&&B.s("shape3d.vector.dynamic")&&(L||(L=t.getData3dUI(B)),G=L.getVectorDynamicSize(),G&&(v=t.getDevicePixelRatio(),G[0]*=v,G[1]*=v));var b,S,f=B&&B.s("shape3d.texture.scale")||1;if(G?(v||(v=t.getDevicePixelRatio()),b=G[0]>0?G[0]:f*Bp(V,B)*v,S=G[1]>0?G[1]:f*Fd(V,B)*v):(b=f*Bp(V,B),S=f*Fd(V,B)),b>=1&&S>=1){var $=0;N&&($=Date.now());var M=Jc(b,S);if(!L&&B&&(L=t.getData3dUI(B)),L&&L.interactiveInfo){var m=e;"object"==typeof m&&(m=m.uuid||(m.uuid=X.Math.generateUUID()));var g=L.interactiveInfo[m]={};M.interactiveInfo=g.bodyInfo={compInfos:[],matrix:new Vg,rect:{x:0,y:0,width:b,height:S}}}Fp(M,V,0,0,b,S,B,t),M.interactiveInfo&&(M.interactiveInfo=null),M.restore(),N||Z?(d=Pb(p,vh,null,H),L.setCachedTexture(d),p._renderInfo.cacheTimeCost+=Date.now()-$,vh=null):d=Pb(p,vh,t._1O,H)}}}}return d},redraw:function(){this.iv()},validateImpl:function(){var F=this;if(F._lightChanged){F._lightChanged=!1;var M=[],q=[],X=[];F.dm().each(function(D){if(Bj(D)){var R=D.s("light.type");R===Dp?M.push(D):R===xf?q.push(D):R===yb&&X.push(D)}}),(M.length!==F._59O.length||q.length!==F._spots.length||X.length!==F._dirs.length)&&jj(F),F._59O=M,F._spots=q,F._dirs=X}F._42(),F._1o.iv()},getRenderInfo:function(){var p=this.getGL();return p?p._renderInfo:void 0},getDebugTip:function(){var k=this,L=k.getRenderInfo();if(L){var d=k.getGL()._validBufCount||0,Y="Draw Calls: "+L.calls+"<br/>"+"Vertices: "+L.vertices+"<br/>"+"Faces: "+L.faces+"<br/>"+"Lines: "+L.lines+"<br/>"+"Buffer Count: "+d;return k.vr.isPresenting()&&(Y+="<br/>VR fps: "+k.vr.getFps()),Y}},_42:function(d,X){var b=this;if(!b._35O&&(!As||qq(As))){var $,f;d&&(d instanceof Kd?f=d:$=d);var n=b._canvas,C=b.getGL(),l=b._prg;if(C){var q=b.getWidth(),S=b.getHeight();X?d||Up(n,q,S,X):(X=b.getDevicePixelRatio(),d||q===n.clientWidth&&S===n.clientHeight||Up(n,q,S,X)),C.clear(C.COLOR_BUFFER_BIT),b.drawFilter||(C._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:d?b._frameId:++b._frameId,cacheTimeCost:0});var P=function(){if(b.overlappingBox.clear(),b._81O=u,C.clear(C.DEPTH_BUFFER_BIT),oi(C,l.uBrightness,1),oi(C,l.uOpacity,1),oi(C,l.uPartOpacity,1),C._picking=!!d,oi(C,l.uPick,!!d),oi(C,l.uTexture,!1),oi(C,l.uBlendTexture,!1),oi(C,l.uAlphaTest,W.alphaTest),oi(C,l.uTransparent,!1),oi(C,l.uFix,!1),oi(C,l.uBatchColor,!1),oi(C,l.uBatchBlend,!1),oi(C,l.uBatchBrightness,!1),oi(C,l.uReflectivity,b._envmapReflectivity||.5),oi(C,l.uCameraPosition,b.getEye()),oi(C,l.uPMatrix,b._projectMatrix=Wn(b)),oi(C,l.uViewMatrix,Pe(b,b._7O)),b.bindEnvMap(C),b._viewMatrix=Or(b._7O),d||(Ap(b,C,l),b._fogDisabled||(oi(C,l.uFogColor,b._fogColor),oi(C,l.uFogNear,b._fogNear),oi(C,l.uFogFar,b._fogFar))),Mg(C,l.aPosition),Mg(C,l.aNormal),vf(C,l.aUv),vf(C,l.aBatchColor),vf(C,l.aBatchBlend),vf(C,l.aBatchBrightness),vf(C,l.aLineDistance),f){var M=C.getParameter(C.COLOR_CLEAR_VALUE);C.clearColor(0,0,0,0),C.disable(C.BLEND),vf(C,l.aNormal),og(C,b._cube.vs,u,l.aPosition),Rm(C,b._cube.is),Vn(f,b,nk,0),Vn(f,b,gr,6),Vn(f,b,yq,12),Vn(f,b,cl,18),Vn(f,b,hk,24),Vn(f,b,nh,30),Mg(C,l.aNormal),xe(C,M)}else if($){$.value=2;var M=C.getParameter(C.COLOR_CLEAR_VALUE);C.clearColor(0,0,0,0),C.disable(C.BLEND),b._95I(C,l,$),Rh(b,$),Bk(b,b._polylineModelMap,$),Bk(b,b._wireframeModelMap,$),oi(C,l.uTransparent,!0),b._95I(C,l,$,!0),Rh(b,$,!0),Bk(b,b._polylineModelMap,$,!0),Bk(b,b._wireframeModelMap,$,!0),oi(C,l.uTransparent,!1),C.clear(C.DEPTH_BUFFER_BIT),b._swapLineMap(),b._95I(C,l,$,!1,!0),Bk(b,b._polylineModelMap,$),Bk(b,b._wireframeModelMap,$),b._swapLineMap(),b._swapLineMap(),b._95I(C,l,$,!1,!0),Bk(b,b._polylineModelMap,$),Bk(b,b._wireframeModelMap,$),oi(C,l.uTransparent,!0),b._95I(C,l,$,!0,!0),Bk(b,b._polylineModelMap,$,!0),Bk(b,b._wireframeModelMap,$,!0),oi(C,l.uTransparent,!1),b._swapLineMap(),C.disable(C.DEPTH_TEST),b.drawFilter||b._30O._42(C,l,$),C.enable(C.DEPTH_TEST),xe(C,M)}else C.disable(C.BLEND),b.drawSky(C,l),b._31O._42(C,l),b._95I(C,l),Rh(b),Bk(b,b._polylineModelMap),Bk(b,b._wireframeModelMap),C.enable(C.BLEND),oi(C,l.uTransparent,!0),C.depthMask(!1),b._95I(C,l,u,!0),Rh(b,u,!0),Bk(b,b._polylineModelMap,u,!0),Bk(b,b._wireframeModelMap,u,!0),C.depthMask(!0),oi(C,l.uTransparent,!1),C.clear(C.DEPTH_BUFFER_BIT),b._swapLineMap(),C.disable(C.BLEND),b._95I(C,l,u,!1,!0),Bk(b,b._polylineModelMap),Bk(b,b._wireframeModelMap),C.enable(C.BLEND),oi(C,l.uTransparent,!0),C.depthMask(!1),b._95I(C,l,u,!0,!0),Bk(b,b._polylineModelMap,u,!0),Bk(b,b._wireframeModelMap,u,!0),C.depthMask(!0),oi(C,l.uTransparent,!1),b._swapLineMap(),C.disable(C.DEPTH_TEST),C.disable(C.BLEND),b._32O._42(C,l),b._30O._42(C,l),b._highlightHelper._42(C,l),C.enable(C.DEPTH_TEST);og(C,u),Rm(C,u)},D=!1,H=q*X,p=S*X,J=b.vr;J.enable&&J._42(C,H,p,P)&&(D=!0);var B=b.envRenderer;B&&B.enable&&B._42(C,H,p,P)&&(D=!0);var M=b._postProcessing;M._42(C,H,p,P,d)&&(D=!0),D||(b.setViewport(C,0,0,q*X,S*X),P()),b._33Q=!1,b.drawFilter||b.countFrame(),b._doBufferGC(C)}}},enablePostProcessing:function(r,v){return this._postProcessing.enableModule(r,v)},getPostProcessingModule:function(a){return this._postProcessing.getModule(a)},setViewport:function(i,M,q,y,l){this._viewport=[M,q,y,l],i.viewport(M,q,y,l)},getViewport:function(){return this._viewport},setBufferGCInterval:function(p){this._bufferGCInterval=p},_doBufferGC:function(D,V){var F,R,S=D._bufPool,d=0,T=0,X=D._renderInfo.frame,H=this._bufferGCInterval||10;for(F in S)d++,R=S[F],R&&(V||X-R._fid>H?(D.deleteBuffer(R._buf),R._buf=null,S[F]=null):T++);if(d/2>T&&d>128){var p={};for(F in S)S[F]&&(p[F]=S[F]);D._bufPool=p}D._validBufCount=T},_swapLineMap:function(){var E=this;t=E._polylineModelMap,E._polylineModelMap=E._polylineModelMapSwap,E._polylineModelMapSwap=t,t=E._wireframeModelMap,E._wireframeModelMap=E._wireframeModelMapSwap,E._wireframeModelMapSwap=t,t=E._polylineIndexMap,E._polylineIndexMap=E._polylineIndexMapSwap,E._polylineIndexMapSwap=t,t=E._wireframeIndexMap,E._wireframeIndexMap=E._wireframeIndexMapSwap,E._wireframeIndexMapSwap=t},_updateSkyBox:function(w){if(this._skyBox&&w){var L=w.property,c=!1,J=this._skyBox;if("eye"===L||"forceUpdate"===L){var o=this._eye;J.p3(o[0],o[1],o[2]),c=!0}if("near"===L||"far"===L||"forceUpdate"===L){var d=this._near,m=this._far,y=J.getFinalScale3d();if(y[0]/=2,y[1]/=2,y[2]/=2,y[0]<=d||y[0]>=m||y[1]<=d||y[1]>=m||y[2]<=d||y[2]>=m){var h=2*d*m/(d+m),R=Math.min(y[0],y[1],y[2]),Y=h/R,A=J.getScale3d();J.setScale3d(A[0]*Y,A[1]*Y,A[2]*Y),c=!0}}c&&this.invalidateData(J)}},getSkyBox:function(){return this._skyBox},setSkyBox:function(m){var e=this._skyBox;e&&(this._skyBoxStyleMap&&e.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null,this._skyBoxAnchor3d&&e.setAnchor3d(this._skyBoxAnchor3d),this._skyBoxAnchor3d=null,this._skyBoxP3&&e.p3(this._skyBoxP3),this._skyBoxP3=null),this._skyBox=m,this.ump(this._updateSkyBox,this),m&&(m.dm()&&m.dm().remove(m),this._skyBoxStyleMap=X.Default.clone(m.getStyleMap()),this._skyBoxAnchor3d=m.getAnchor3d(),m.setAnchor3d(.5,.5,.5),this._skyBoxP3=m.p3().slice(0),m.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBox,this),this._updateSkyBox({property:"forceUpdate"})),this.fp("skyBox",e,m)},drawSky:function(E,e,G){var r=this,c=r._skyBox;if(c){var C=r._headlightIntensity,h=Ke(r._headlightColor),e=r._prg;1!==C&&(h=[h[0]*C,h[1]*C,h[2]*C]),oi(E,e.uHeadlightColor,[h[0],h[1],h[2],1]);var t=r.getData3dUI(c);if(t){var Q,T=r.isOrtho();T&&(Q=r._projectMatrix,r.setOrtho(!1),oi(E,e.uPMatrix,r._projectMatrix=Wn(r))),t._42(E,e,G,function(){return!0}),T&&(r.setOrtho(!0),oi(E,e.uPMatrix,r._projectMatrix=Q))}E.clear(E.DEPTH_BUFFER_BIT),oi(E,e.uHeadlightColor,[h[0],h[1],h[2],r._headlightDisabled?1:0])}},_95I:function(N,_,e,W,X){function l(h){if(!!h.s("shape3d.alwaysOnTop")==!!X&&k.isVisible(h)&&(!O||P)){if(!e&&k.isTransparentMask(h))return;var v=k.getData3dUI(h);v&&v._42(N,_,e,Z)}}var k=this,Z=function($){return W?$:!$};k.sky&&N.clear(N.DEPTH_BUFFER_BIT);var y=k.drawFilter;y?k.dm().each(function(f){y(f)||l(f)}):k.dm().each(function(y){l(y)})},getLogicalPoint:function(J){return _k(J,this._canvas)},isRectOverlapping:function(H){var Q=this.getData3dUI(H);return Q._rectOverlapping},getHitFaceInfo:function(H){H.target&&(H=this.lp(H));var V=this.getDataInfoAt(H);if(V){var M=this._1o.face(V.data,qp(H.x,H.y));if(M)return{data:V.data,face:M}}return u},unproject:function(w,o){var l=this,n=l.getWidth(),u=l.getHeight(),q=w.target?l.lp(w):w,x=q.x-n/2,Q=q.y-u/2,A=2*(x/n),D=2*(-1*Q/u);o=o||0;var v=sh(),h=Wn(l),t=Pe(l);Nj(v,h,t),Yc(v);var L=ho([A,D,o,1],v);return[L[0]/L[3],L[1]/L[3],L[2]/L[3]]},getDataAt:function(M){var n=this.getDataInfoAt(M);return n?n.data:u},getDataInfoAt:function(X,S){return X.target&&(X=this.lp(X)),this._1o.get(qp(X.x,X.y,S),!0)},getDatasInRect:function(X){return this._1o.get(X)},setEditable:function(r){var K=this,Y=K._editable;K._editable=r,this.fp(ll,Y,r)},isEditable:function(f){var s=this;return s._editable?xp(f)?f.s("3d.editable")?s._editableFunc?s._editableFunc(f):!0:!1:!1:!1},isSelectable:function(X){return X.s("3d.selectable")&&this.sm().isSelectable(X)},isMovable:function(m){var _=this;return ej(m)&&m.getStyle(_j)!==kp?!1:m.s("3d.movable")?_._movableFunc?_._movableFunc(m):!0:!1},isSizeEditable:function(L){return xp(L)?this._sizeEditableFunc?this._sizeEditableFunc(L):!0:!1},isRotationEditable:function(e){return xp(e)&&e.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(e):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(N){this.setZoom(Km,N)},zoomOut:function(K){this.setZoom(1/Km,K)},setZoom:function(F,$){if(1!==F){var m=this;if(m._ortho)return m.setOrthoZoom(F,$),void 0;m._14o&&m._14o.stop(!0);var I=1/F,x=m._eye,w=m._center,N=w[0]+(x[0]-w[0])*I-x[0],q=w[1]+(x[1]-w[1])*I-x[1],p=w[2]+(x[2]-w[2])*I-x[2];if(!(Di(x,w)<m._moveStep&&1>I)){if($=Ll($)){var t=Qb(x);return $.action=function(I){m.fi({kind:m._zooming?"betweenZoom":"beginZoom"}),m._zooming=1,x[0]=t[0]+N*I,x[1]=t[1]+q*I,x[2]=t[2]+p*I,m.fp(Hj,u,x)},$._37o=function(){delete m._14o,delete m._zooming,m.fi({kind:"endZoom"}),m.onZoomEnded()},m._14o=lr($)}x[0]+=N,x[1]+=q,x[2]+=p,m.fp(Hj,u,x)}}},setOrthoZoom:function(n,w){if(1!==n){var k=this;k._14o&&k._14o.stop(!0);var z=k._orthoWidth,Y=z/n-z;if(!(z<k._moveStep&&n>1))return(w=Ll(w))?(w.action=function(_){k.fi({kind:k._zooming?"betweenZoom":"beginZoom"}),k._zooming=1,k.setOrthoWidth(z+Y*_)},w._37o=function(){delete k._14o,delete k._zooming,k.fi({kind:"endZoom"}),k.onZoomEnded()},k._14o=lr(w)):(k.setOrthoWidth(z/n),void 0)}},getPositionInfo:function(L){var A=this,y=A._eye,g=A._center,q=A.getAspect(),m=L?yk(Zq(g,y,!0),Zq(L,y)):Di(y,g);if(A._ortho){var c=A._orthoWidth;return{length:m,height:c/q,width:c}}var S=2*h(A._fovy/2)*m;return{length:m,height:S,width:S*q}},getCenterInfo:function(){var R=this;return R._81O||(R._81O=R.getPositionInfo()),Qb(R._81O)},rotate:function(o,y,n,L){var i=this;if(o||y){L==u&&(L=i._firstPersonMode),i._88O&&i._88O.stop(!0);var U=i._center,c=i._eye,T=i.getCenterInfo().length,F=L?U:c,k=L?c:U,d=Zq(F,k),g=$(d[0],d[2]),z=$(r(d[0]*d[0]+d[2]*d[2]),d[1]),t=L?Md:Hj;return L&&(y=-y),(n=Ll(n))?(n.action=function(E){i.fi({kind:i._rotating?"betweenRotate":"beginRotate"}),i._rotating=1;var v=g+o*E,P=z+y*E;P=zo(P),d[0]=T*x(P)*x(v),d[1]=T*p(P),d[2]=T*x(P)*p(v),F[0]=k[0]+d[0],F[1]=k[1]+d[1],F[2]=k[2]+d[2],i.fp(t,u,F)},n._37o=function(){delete i._88O,delete i._rotating,i.fi({kind:"endRotate"}),i.onRotateEnded()},i._88O=lr(n)):(g+=o,z+=y,z=zo(z),d[0]=T*x(z)*x(g),d[1]=T*p(z),d[2]=T*x(z)*p(g),F[0]=k[0]+d[0],F[1]=k[1]+d[1],F[2]=k[2]+d[2],i.fp(t,u,F),void 0)}},pan:function(m,M,h,O){if(m||M){var N=this;O==u&&(O=N._firstPersonMode),N._89O&&N._89O.stop(!0);var X=Pe(N),k=[X[0]*m,X[4]*m,X[8]*m],R=[X[1]*M,X[5]*M,X[9]*M],p=k[0]+R[0],n=k[1]+R[1],I=k[2]+R[2],L=N._center,_=N._eye;if(O){var x=He(N.getBoundaries(),_[0],_[2],_[0]+p,_[2]+I,r(p*p+I*I));p=x[0],I=x[1]}if(h=Ll(h)){var Q=Qb(_),j=Qb(L);return h.action=function($){N.fi({kind:N._panning?"betweenPan":"beginPan"}),N._panning=1,L[0]=j[0]+p*$,L[1]=j[1]+n*$,L[2]=j[2]+I*$,_[0]=Q[0]+p*$,_[1]=Q[1]+n*$,_[2]=Q[2]+I*$,N.fp(Hj,u,_),N.fp(Md,u,L)},h._37o=function(){delete N._89O,delete N._panning,N.fi({kind:"endPan"}),N.onPanEnded()},N._89O=lr(h)}L[0]+=p,L[1]+=n,L[2]+=I,_[0]+=p,_[1]+=n,_[2]+=I,N.fp(Hj,u,_),N.fp(Md,u,L)}},walk:function(M,P,G){if(M){var B=this;G==u&&(G=B._firstPersonMode),B._90O&&B._90O.stop(!0);var o=B._center,b=B._eye,n=Zq(o,b,!0);if(G){var H=He(B.getBoundaries(),b[0],b[2],b[0]+n[0]*M,b[2]+n[2]*M,k(M));if(M=Di(H),!M)return;n=[H[0]/M,0,H[1]/M]}if(P=Ll(P)){var t=Qb(b),p=Qb(o);return P.action=function(k){B.fi({kind:B._walking?"betweenWalk":"beginWalk"}),B._walking=1;var G=M*k;b[0]=t[0]+n[0]*G,b[1]=t[1]+n[1]*G,b[2]=t[2]+n[2]*G,o[0]=p[0]+n[0]*G,o[1]=p[1]+n[1]*G,o[2]=p[2]+n[2]*G,B.fp(Hj,u,b),B.fp(Md,u,o)},P._37o=function(){delete B._90O,delete B._walking,B.fi({kind:"endWalk"}),B.onWalkEnded()},B._90O=lr(P)}b[0]+=n[0]*M,b[1]+=n[1]*M,b[2]+=n[2]*M,o[0]+=n[0]*M,o[1]+=n[1]*M,o[2]+=n[2]*M,B.fp(Hj,u,b),B.fp(Md,u,o)}},handleScroll:function(v,d){v.preventDefault();var I=this,h=I._moveStep,p=I.getDataInfoAt(v);if(p){var b=p.data;if(b&&I.isInteractive(b)){var B=I.intersectObject(v,b);if(B){var r=B.part,x=Hi(b.s(r+".image")||b.s("shape3d."+r+".image")||b.s("all.image")||b.s("shape3d.image"));if(x&&wq(x.scrollable,b,I))return}}}I.isFirstPersonMode()?I.isPannable()&&I.pan(0,d>0?h:-h):I.isZoomable()&&I.setZoom(0>d?1/tq:tq)},handlePinch:function(v,d){this.isZoomable()&&this.setZoom(d>v?1/Ko:Ko)},reset:function(){this.setCenter(U.graph3dViewCenter),this.setEye(U.graph3dViewEye),this.setUp(U.graph3dViewUp)},moveSelection:function(q,R,o){var E=this;E.dm().beginTransaction(),ze(this.sm().toSelection(this.isMovable,this),q,R,o),E.dm().endTransaction()},getMoveMode:function($,Z){var Q=Z.s("3d.move.mode");if(Q)return Q;var N="88",i="89",g="90";return xd($)||Fg[N]&&Fg[i]&&Fg[g]?"xyz":Fg[N]&&Fg[i]?"xy":Fg[N]&&Fg[g]?"xz":Fg[i]&&Fg[g]?"yz":Fg[N]?"x":Fg[i]?"y":Fg[g]?"z":"xz"},handleTick:function(){var u=this,z=!1,W=u._moveStep,C=W,Q=!1,q=!0,w=u._rotateStep*(q?-1:1);if(u.isWalkable()||(C=0),u.isPannable()||(W=0),u.isRotatable()||(w=0),u._32Q){var a=(th()-u._32Q)/50;C*=a,W*=a,w*=a}u._31Q&&(Um(u._31Q),delete u._31Q,delete u._32Q),tn()&&(z=!0,u.pan(-W,0,Q,q)),od()&&(z=!0,u.pan(W,0,Q,q)),Gc()&&(z=!0,xd()?u.pan(0,W,Q,q):u.walk(C,Q,q)),qh()&&(z=!0,xd()?u.pan(0,-W,Q,q):u.walk(-C,Q,q)),el()&&(z=!0,u.rotate(-w,0,Q,q)),bs()&&(z=!0,u.rotate(w,0,Q,q)),ek()&&(z=!0,u.rotate(0,-w/2,Q,q)),Sh()&&(z=!0,u.rotate(0,w/2,Q,q)),z&&(u._32Q=th(),u._31Q=up(u.handleTick,u))},handleKeyDown:function(n){var q=this;!Be(n)&&ad[n.keyCode]?q.handleTick():Zf(n)?q.selectAll():ws(n)?q.handleDelete(n):Db(n)&&this.isResettable()&&q.reset()},checkDoubleClickOnNote:function(d,j,L){var C=this;if(L===cf){if(j.s("note.toggleable"))return j.s(Pn,!j.s(Pn)),C.fi({kind:"toggleNote",event:d,data:j,part:L}),!0}else if(L===ic&&j.s("note2.toggleable"))return j.s(fc,!j.s(fc)),C.fi({kind:"toggleNote2",event:d,data:j,part:L}),!0;return!1},checkDoubleClickOnRotation:function(Q,p,f){return f===pq?(p.setRotationX(0),!0):f===_q?(p.setRotationY(0),!0):f===dl?(p.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(U){var Z=this;if(Z.isOrtho())return Z.getWidth()/Z.getOrthoWidth();var T=Z.getCenter(),n=Z.getHeight(),P=Z.getEye(),m=[T[0]-P[0],T[1]-P[1],T[2]-P[2]],X=[U[0]-P[0],U[1]-P[1],U[2]-P[2]],w=Math.sqrt(m[0]*m[0]+m[1]*m[1]+m[2]*m[2]),l=1/Math.tan(Z.getFovy()/2);return n*w*l/(X[0]*m[0]+X[1]*m[1]+X[2]*m[2])},inViewSpace:function(V){var g,e=this,t=e._transformPointToViewSpace(V),d=e.getAspect(),F=e.getNear(),a=e.getFar();return-t[2]<F||-t[2]>a?!1:e.isOrtho()?(g=e.getOrthoWidth()/2,Math.abs(t[0])<=g&&Math.abs(t[1]*d)<=g):(g=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])*Math.tan(e.getFovy()/2),Math.abs(t[1]<=g)&&Math.abs(t[0])<=g*d)},getPVMatrix:function(){var Y=this,g=Y.getWidth()/2,e=Y.getHeight()/2,D=Y._18Q;return D&&D._wh===g/e||(D=Wn(Y),Y._18Q=Nj(D,D,Pe(Y)),Y._18Q._wh=g/e),D},toViewPosition:function(n){var h=this,e=h.getWidth()/2,L=h.getHeight()/2,f=h.getPVMatrix();return n=ho([n[0],n[1],n[2],1],f),{x:e+e*n[0]/n[3],y:L-L*n[1]/n[3],z:n[2]/n[3]}},getHitPosition:function(M,$,A){var c=this,I=c.getWidth(),y=c.getHeight(),g=M.target?c.lp(M):M,u=g.x-I/2,w=g.y-y/2,b=c.getCenterInfo(),L=Pe(c);$=$?$:[0,0,0],A=A?A:[0,1,0],u=u/I*b.width,w=-1*w/y*b.height;var h=[L[0]*u,L[4]*u,L[8]*u],n=[L[1]*w,L[5]*w,L[9]*w],r=[h[0]+n[0],h[1]+n[1],h[2]+n[2]],P=c.getCenter(),Q=an(c,$,A,[r[0]+P[0],r[1]+P[1],r[2]+P[2]]);return Q?Q:[0,0,0]},intersectObject:function(N,S){return this._raycaster.intersectObject(N,S)},intersectObjects:function(T,S,B){return this._raycaster.intersectObjects(T,S,B)},getLineLength:function(s){this.validate();var w=this.getData3dUI(s);if(w&&w.getCache){var S=w.getCache();if(S)return S[S.length-1].length}return 0},getLineOffset:function(M,B){var w=this.getData3dUI(M);if(w&&w.getCache){var O=w.getCache();if(O){var R=Mh(O,B),i=M.r3();if(0===i[0]&&0===i[1]&&0===i[2])return R;var o=new rh(M.p3()),T=new rh(R.point).sub(o),z=new rh(R.tangent).add(T),A=(new Bd).setFromEuler(new lb(i,M.getRotationMode(),!0));return T.applyQuaternion(A),z.applyQuaternion(A),{point:T.add(o),tangent:z.sub(T).normalize()}}}return u},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(t,D,l){var d=this,i=d.getEye();i=[i[0],i[1],i[2]];var v=d.getCenter();if(v=[v[0],v[1],v[2]],t||(t=i),D||(D=v),d._flyAnim&&d._flyAnim.stop(!0),l=Ll(l),!l)return d.setEye(t[0],t[1],t[2]),d.setCenter(D[0],D[1],D[2]),delete d._flyAnim,!0;var Z=[t[0]-i[0],t[1]-i[1],t[2]-i[2]],M=[D[0]-v[0],D[1]-v[1],D[2]-v[2]];return l.action=function(j){d.setCenter(v[0]+M[0]*j,v[1]+M[1]*j,v[2]+M[2]*j),d.setEye(i[0]+Z[0]*j,i[1]+Z[1]*j,i[2]+Z[2]*j)},l._37o=function(){delete d._flyAnim},d._flyAnim=lr(l)},flyTo:function(){function U(e,z,K){if(K instanceof X.Node){s.fromArray(Ge(K,z.getMat(K)));var $=K.getAnchor3d();e.push((new rh).set(0-$.x,0-$.y,0-$.z).applyMatrix4(s)),e.push((new rh).set(0-$.x,0-$.y,1-$.z).applyMatrix4(s)),e.push((new rh).set(0-$.x,1-$.y,0-$.z).applyMatrix4(s)),e.push((new rh).set(0-$.x,1-$.y,1-$.z).applyMatrix4(s)),e.push((new rh).set(1-$.x,0-$.y,0-$.z).applyMatrix4(s)),e.push((new rh).set(1-$.x,0-$.y,1-$.z).applyMatrix4(s)),e.push((new rh).set(1-$.x,1-$.y,0-$.z).applyMatrix4(s)),e.push((new rh).set(1-$.x,1-$.y,1-$.z).applyMatrix4(s))}}var E=new rh,V=new rh,G=new rh,O=new rh,s=new $h,R=new X.Math.Quaternion,c=new lb;return function(d,z,$){var n=this;if($!==f)z={animation:z,ratio:$};else{var r=typeof z;("boolean"===r||"object"===r&&z.duration)&&(z={animation:z})}z=z||{},E.fromArray(n.getEye()),V.fromArray(n.getCenter());var w,p,l=[],s=z.center,P=z.distance===f;if(s&&G.fromArray(s),d instanceof X.Node)s||G.fromArray(d.p3()),P&&(U(l,n,d),w=l.length);else{if(d||(d=n.dm().getDatas()),!d.length)return;if((P||!s)&&(l=[],d.forEach(function(e){U(l,n,e)}),w=l.length),!w)return;if(!s){for(G.set(0,0,0),p=0;w>p;p++)G.add(l[p]);G.multiplyScalar(1/w)}}if(n.setCenter(G.x,G.y,G.z),O.subVectors(E,V),z.direction||z.worldDirection){!z.worldDirection&&d instanceof X.Node?R.setFromEuler(c.set(d.r3(),d.getRotationMode(),!0)):R.set(0,0,0,1);var N=O.length();O.fromArray(z.worldDirection||z.direction).applyQuaternion(R).setLength(N)}if(P){for(var K,W,C,b,Q,o=n.getNear(),T=10,$=z.ratio||.8;T--;){for(n._eye[0]=O.x+G.x,n._eye[1]=O.y+G.y,n._eye[2]=O.z+G.z,K=Wn(n),Nj(K,K,Pe(n)),b=!0,Q=-1/0,p=0;w>p;p++){if(C=l[p],W=ho([C.x,C.y,C.z,1],K),W[3]<o&&T){O.multiplyScalar(2),b=!1;break}Q=Math.max(Q,Math.max(Math.abs(W[0]),Math.abs(W[1]))/$-W[3])}if(b)break}O.setLength(Q+O.length()).add(G)}else O.setLength(z.distance).add(G);n._flyAnim&&n._flyAnim.stop(!0);var I=Ll(z.animation);if(I){n.setEye(E.x,E.y,E.z),n.setCenter(V.x,V.y,V.z);var h=(new rh).subVectors(O,E),v=(new rh).subVectors(G,V),Z=new rh,i=new rh;return I.action=function(H){Z.copy(E).addScaledVector(h,H),i.copy(V).addScaledVector(v,H),n.setCenter(i.x,i.y,i.z),n.setEye(Z.x,Z.y,Z.z)},I._37o=function(){delete n._flyAnim},{lastEye:E,lastCenter:V,eye:O,center:G,animation:n._flyAnim=lr(I)}}return n.setEye(O.x,O.y,O.z),delete n._flyAnim,{lastEye:E,lastCenter:V,eye:O,center:G}}}(),getBoundingBox:function(){function i(L,O,c){r.fromArray(Ge(c,O.getMat(c)));var t=c.getAnchor3d();L.push((new rh).set(0-t.x,0-t.y,0-t.z).applyMatrix4(r)),L.push((new rh).set(0-t.x,0-t.y,1-t.z).applyMatrix4(r)),L.push((new rh).set(0-t.x,1-t.y,0-t.z).applyMatrix4(r)),L.push((new rh).set(0-t.x,1-t.y,1-t.z).applyMatrix4(r)),L.push((new rh).set(1-t.x,0-t.y,0-t.z).applyMatrix4(r)),L.push((new rh).set(1-t.x,0-t.y,1-t.z).applyMatrix4(r)),L.push((new rh).set(1-t.x,1-t.y,0-t.z).applyMatrix4(r)),L.push((new rh).set(1-t.x,1-t.y,1-t.z).applyMatrix4(r))}var r=new $h;return function(l){if(l=l||this.sm().getSelection(),l instanceof X.Node&&(l=[l]),0===l.length)return u;
var Z=[];l.forEach(function(O){i(Z,this,O)},this);var A=[1/0,1/0,1/0],t=[-1/0,-1/0,-1/0];return Z.forEach(function(g){A[0]=Math.min(g.x,A[0]),A[1]=Math.min(g.y,A[1]),A[2]=Math.min(g.z,A[2]),t[0]=Math.max(g.x,t[0]),t[1]=Math.max(g.y,t[1]),t[2]=Math.max(g.z,t[2])}),{min:A,max:t}}}()}),fb.RenderEnv=function(s){this.gv=s,this.enable=!1},b.defineProperties(fb.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(I){this._debugOn=I,this.capture&&this.capture()}}}),b.assign(fb.RenderEnv.prototype,{renderEnvToCube:function(M,O,c,F){var E=this,o=E.gv;if(!M||!O||!c)return E.enable=!1,E._42=null,void 0;E.enable=!0;var e=Math.floor(F/M*O),K=o.getGL(),B=E._renderTargets;B?B.length<c&&(B=E._renderTargets=B.concat(new Array(c-B.length))):B=E._renderTargets=new Array(c);for(var T=0;c>T;T++)B[T]?B[T].setSize(K,F,e):B[T]=new fb.RenderTarget(o,K,F,e);var v=!1;E.capture=function(){v=!0,o._42(),v=!1};var Q=new rh,D=new rh,A=new rh,G=new rh,f=(new rh).setY(0),C=2*Math.PI/c,d=M/2/Math.tan(Math.PI/c),h=2*Math.atan2(O/2,d),S=M/O;E._42=function(n,m,U,y){var z=E._debugOn;if(!v&&!z)return!1;Q.copy(o.getEye()),G.copy(o.getCenter()).sub(Q);var k=Math.atan2(G.z,G.x),w=o.getNear(),R=o.getFovy(),M=o.getAspect();D.copy(o.getCenter());for(var K,r=0;c>r;r++)if(K=B[r],f.setZ(Math.cos(k)).setX(Math.sin(k)).multiplyScalar(d),k-=C,A.addVectors(Q,f),o.setNear(d),o.setCenter([A.x,A.y,A.z]),o.setFovy(h),o.setAspect(S),z){var q=Math.round(m/c);n.viewport(q*r,0,q,U),y()}else Ig(n,K.frame),n.viewport(0,0,K.width,K.height),n.clear(n.COLOR_BUFFER_BIT),y(),hm(n),K.assureTexture();return o.setNear(w),o.setCenter([D.x,D.y,D.z]),o.setFovy(R),o.setAspect(M),!0},E.capture()},getTextureInfo:function(v){var u=this._renderTargets;if(!u)return null;var x=this._renderTargets[v];return x?{index:v,texture:x.texture,textureName:x.uuid}:null}}),b.assign(fb.Graph3dView.prototype,{renderEnvToCube:function(G,K,O,U){var h=this;h.envRenderer||(h.envRenderer=new fb.RenderEnv(h)),h.envRenderer.renderEnvToCube(G,K,O,U)}}),fb.RenderTarget=function($,I,s,K,t){var x=this;t=t||{},t.samples=t.samples&&t.samples>1&&2===$._webGLVersion?t.samples:f,x.options=t,x.uuid=X.Math.generateUUID(),x.gv=$,x.init($,I,t),x.setSize(I,s,K)},b.assign(fb.RenderTarget.prototype,{bind:function(A){Ig(A,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(z){hm(z),this.options.samples&&(z.bindFramebuffer(z.READ_FRAMEBUFFER,this._MSAAFbo),z.bindFramebuffer(z.DRAW_FRAMEBUFFER,this.frame),z.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,z.COLOR_BUFFER_BIT,z.NEAREST))},init:function(f,b,t){var M=this,$=M.texture=b.createTexture();b.activeTexture(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,$),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);var x=t.samples,s=x?b.NEAREST:b.LINEAR;b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,t.minFilter||s),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,t.magFilter||s),b.bindTexture(b.TEXTURE_2D,null),M.render=b.createRenderbuffer(),M.frame=b.createFramebuffer(),x&&(M._MSAAFbo=b.createFramebuffer(),M._MSAARbO=b.createRenderbuffer()),f._2O[M.uuid]=$},assureTexture:function(){var s=this,l=s.uuid,b=s.gv._2O;b[l]||(b[l]=s.texture)},setSize:function(G,f,o){var h=this;if(f&&o&&(h.width!==f||h.height!==o)){var H=G.RGBA,L=G.TEXTURE_2D,V=G.RENDERBUFFER,w=G.FRAMEBUFFER,F=h.options.samples;Nk(G,h.texture),G.texImage2D(L,0,H,f,o,0,H,G.UNSIGNED_BYTE,u),G.bindRenderbuffer(V,h.render),F?G.renderbufferStorageMultisample(V,F,G.DEPTH_COMPONENT16,f,o):G.renderbufferStorage(V,G.DEPTH_COMPONENT16,f,o),Ig(G,h.frame),G.framebufferTexture2D(w,G.COLOR_ATTACHMENT0,L,h.texture,0),F||G.framebufferRenderbuffer(w,G.DEPTH_ATTACHMENT,V,h.render),hm(G),F&&(G.bindRenderbuffer(G.RENDERBUFFER,h._MSAARbO),G.renderbufferStorageMultisample(G.RENDERBUFFER,F,G.RGBA8,f,o),Ig(G,h._MSAAFbo),G.framebufferRenderbuffer(G.FRAMEBUFFER,G.COLOR_ATTACHMENT0,G.RENDERBUFFER,h._MSAARbO),G.framebufferRenderbuffer(w,G.DEPTH_ATTACHMENT,V,h.render),hm(G)),Nk(G,u),G.bindRenderbuffer(V,u),h.width=f,h.height=o}},toCanvas:function(){var S=this,v=S.gv.getGL();Ig(v,S.frame);var l=S.width,i=S.height,m=new Uint8Array(4*l*i);v.readPixels(0,0,l,i,v.RGBA,v.UNSIGNED_BYTE,m),hm(v);var F=Y.createElement("canvas");F.width=l,F.height=i;var T=F.getContext("2d"),j=T.createImageData(l,i);return j.data.set(m),T.putImageData(j,0,0),F}});var Rc=fb.Interactor=function(Q){this.gv=Q};Li("Interactor",b,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var po=fb.DefaultInteractor=function(i){ef(po,this,[i])};Li("DefaultInteractor",Rc,{handle_contextmenu:function(g){wb(g)},handle_mousewheel:function(N){this.gv.handleScroll(N,N.wheelDelta/40)},handle_DOMMouseScroll:function(v){2===v.axis&&this.gv.handleScroll(v,-v.detail)},handle_keydown:function(N){this.gv.handleKeyDown(N)},handle_mousedown:function(B){this.handle_touchstart(B)},handle_touchstart:function(f){wb(f);var B=this,$=B.gv,W=js(f),T=$.getDataInfoAt(f),q=T?T.data:u,L=T?T.part:u,x=$.sm(),N=dc(f),s=Wg(f);$.setFocus(f)&&(B._62O=u,B._57I=u,q?Be(f)?x.co(q)?x.rs(q):x.as(q):x.co(q)||x.ss(q):W&&(Be(f)?$.isRectSelectable()&&(B._62O=of):B._57I=Jl(f)),B._31Q&&(Um(B._31Q),delete B._31Q,delete B._32Q),B._62O||($.isFirstPersonMode()&&(xd(f)||Gh(f)||s>2?B._62O="pan":$.isMouseRoamable()||je?(B._62O="roaming",B.foward=N&&js(f),B._32Q=th(),B._31Q=up(B.tick,B)):W||(B._62O="roaming")),B._62O||(W&&N&&Ip[L]?(B._62O=L,B.p3=q.p3()):W&&N&&xp(q)&&$.isSelected(q)?$.isMovable(q)?(B._62O="move",B.p3=q.p3(),B.movedata=q):$.isInteractive(q)&&(B._62O="none"):je&&(s>2?B._62O="pan":2===s&&(B.dist=Hm(f),B._62O="pinch")))),B.point=$.lp(f),Te(B,f),Ar(f)?$.handleDoubleClick(f,q,L):$.handleClick(f,q,L))},tick:function(){var X=this,b=X.gv,A=b._moveStep;X.point&&b.isWalkable()&&(X._32Q&&(A*=(th()-X._32Q)/50),b.walk(X.foward?A:-A),X._32Q=th(),X._31Q=up(X.tick,X))},handle_mouseup:function(K){this.handle_touchend(K)},handle_touchend:function(m){var h=this._57I;h&&(Di(h,Jl(m))<=1&&this.gv.sm().cs(),this._57I=u)},handleWindowMouseMove:function(I){this.handleWindowTouchMove(I)},handleWindowTouchMove:function(j){var R,a,O=this,Y=O.gv,h=O._62O,B=O.point,P=Y.dm(),$=Y.lp(j),o=$.x-B.x,W=$.y-B.y,E=Y.getWidth(),u=Y.getHeight();if(E&&u){var w=-e*o/E,L=-e*W/u;if("roaming"===h)O.rotate(j,w/2,L/2);else if(h===pq||h===_q||h===dl)Y._86O||P.beginTransaction(),Y.fi({kind:Y._86O?"betweenEditRotation":"beginEditRotation",event:j}),Y._86O=1,Y.sm().each(function(_){if(xp(_)&&Y.isRotationEditable(_)){var K=k(w)>k(L)?w:L;h===pq?_.setRotationX(_.getRotationX()+K):h===_q?_.setRotationY(_.getRotationY()+K):h===dl&&_.setRotationZ(_.getRotationZ()+K)}});else if("move"===h||Ip[h]){h===wd||h===Wh||h===Pd?(Y._87O||P.beginTransaction(),Y.fi({kind:Y._87O?"betweenEditScale":"beginEditScale",event:j}),Y._87O=1):(Y._moving||P.beginTransaction(),Y.fi({kind:Y._moving?"betweenMove":"beginMove",event:j}),Y._moving=1);var q,r=O.p3,I=Y.getPositionInfo(r),K=Pe(Y);q=h===Cc?"x":h===yh?"y":h===bi?"z":h===wd?"sx":h===Wh?"sy":h===Pd?"sz":Y.getMoveMode(j,O.movedata),o=o/E*I.width,W=-1*W/u*I.height;var l,x,V=[K[0]*o,K[4]*o,K[8]*o],f=[K[1]*W,K[5]*W,K[9]*W],G=V[0]+f[0],n=V[1]+f[1],C=V[2]+f[2],i=[r[0]+G,r[1]+n,r[2]+C],_=Zq(Y.getEye(),i,!0);if("xyz"===q?(l=i,Y.moveSelection(G,n,C)):"xz"===q?(l=an(Y,r,[0,1,0],i),l&&Y.moveSelection(l[0]-r[0],0,l[2]-r[2])):"xy"===q?(l=an(Y,r,[0,0,1],i),l&&Y.moveSelection(l[0]-r[0],l[1]-r[1],0)):"yz"===q?(l=an(Y,r,[1,0,0],i),l&&Y.moveSelection(0,l[1]-r[1],l[2]-r[2])):"x"===q||"sx"===q?(_[0]=0,l=an(Y,r,_,i),l&&(x=l[0]-r[0],"x"===q?Y.moveSelection(x,0,0):Y.sm().each(function(U){xp(U)&&Y.isSizeEditable(U)&&(R=U.getScaleX()+x/100,a=R/U.getScaleX(),U.setScaleX(R),xd(j)&&(U.setScaleY(U.getScaleY()*a),U.setScaleTall(U.getScaleTall()*a)))}))):"y"===q||"sy"===q?(_[1]=0,l=an(Y,r,_,i),l&&(x=l[1]-r[1],"y"===q?Y.moveSelection(0,x,0):Y.sm().each(function(k){xp(k)&&Y.isSizeEditable(k)&&(R=k.getScaleTall()+x/100,a=R/k.getScaleTall(),k.setScaleTall(R),xd(j)&&(k.setScaleY(k.getScaleY()*a),k.setScaleX(k.getScaleX()*a)))}))):("z"===q||"sz"===q)&&(_[2]=0,l=an(Y,r,_,i),l&&(x=l[2]-r[2],"z"===q?Y.moveSelection(0,0,x):Y.sm().each(function(U){xp(U)&&Y.isSizeEditable(U)&&(R=U.getScaleY()+x/100,a=R/U.getScaleY(),U.setScaleY(R),xd(j)&&(U.setScaleX(U.getScaleX()*a),U.setScaleTall(U.getScaleTall()*a)))}))),!l)return;O.p3=l}else if(h===of){var S=O.div;S||(S=O.div=rp(),qr(O.getView(),S),S.op=B,S.style.background=Y.getRectSelectBackground()),Y.fi({kind:Y._rectSelecting?"betweenRectSelect":"beginRectSelect",event:j}),Y._rectSelecting=1,S.rect=ys(S.op,$),Ji(S,S.rect)}else if("pinch"===h&&2===Wg(j)){Y.fi({kind:Y._pinching?"betweenPinch":"beginPinch",event:j}),Y._pinching=1;var x=Hm(j);Y.handlePinch(x,O.dist),O.dist=x}else"pan"===h||xd(j)||Gh(j)?O.pan(j,o,W):"none"===h||Y.isFirstPersonMode()||(js(j)?O.rotate(j,w,L):(O.pan(j,o,0),Y.isWalkable()&&(Y.fi({kind:Y._walking?"betweenWalk":"beginWalk",event:j}),Y._walking=1,Y.walk(W/Y.getHeight()*Y.getCenterInfo().height))));O.point=$}},pan:function(D,K,r){var G=this.gv;if(G.isPannable()){var T=G.getWidth(),Y=G.getHeight();if(!T||!Y)return;var J=G.getCenterInfo(),Z=K/T*J.width,w=-1*r/Y*J.height;G.fi({kind:G._panning?"betweenPan":"beginPan",event:D}),G._panning=1,G.pan(-Z,-w)}},rotate:function(M,l,$){var o=this.gv;o.isRotatable()&&(o.fi({kind:o._rotating?"betweenRotate":"beginRotate",event:M}),o._rotating=1,o.rotate(l,$))},handleWindowMouseUp:function(U){this.handleWindowTouchEnd(U)},handleWindowTouchEnd:function(a){var k=this,n=k.gv,Q=n.dm(),t=k.div;if(t){var H=n.getDatasInRect(t.rect);if(!H.isEmpty()){var v=n.sm(),$=v.toSelection();H.each(function(e){v.co(e)?$.remove(e):$.add(e)}),v.ss($)}mp(t)}n._moving&&(delete n._moving,n.fi({kind:"endMove",event:a}),n.onMoveEnded(),Q.endTransaction()),n._panning&&(delete n._panning,n.fi({kind:"endPan",event:a}),n.onPanEnded()),n._rotating&&(delete n._rotating,n.fi({kind:"endRotate",event:a}),n.onRotateEnded()),n._86O&&(delete n._86O,n.fi({kind:"endEditRotation",event:a}),Q.endTransaction()),n._87O&&(delete n._87O,n.fi({kind:"endEditScale",event:a}),Q.endTransaction()),n._pinching&&(delete n._pinching,n.fi({kind:"endPinch",event:a}),n.onPinchEnded()),n._rectSelecting&&(delete n._rectSelecting,n.fi({kind:"endRectSelect",event:a}),n.onRectSelectEnded()),n._walking&&(delete n._walking,n.fi({kind:"endWalk",event:a}),n.onWalkEnded()),k.dist=k.point=k._62O=k.p3=k.movedata=k.div=k._57I=k._32Q=k._31Q=k.foward=u}});var lf=fb.MapInteractor=function(i){ef(lf,this,[i]),this._minPhi=0,this._maxPhi=5*y/12,this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right"};Li("MapInteractor",Rc,{handle_contextmenu:function(p){wb(p)},handle_mousewheel:function(I){this.gv.handleScroll(I,I.wheelDelta/40)},handle_DOMMouseScroll:function(L){2===L.axis&&this.gv.handleScroll(L,-L.detail)},handle_keydown:function(z){this.gv.handleKeyDown(z)},handle_mousedown:function(n){this.handle_touchstart(n)},handle_touchstart:function(b){wb(b);var i=this,O=i.gv;if(O.setFocus(b)){O.lp(b);var j=O.getDataInfoAt(b),m=j?j.data:u,g=j?j.part:u;if(!m||!O.isInteractive(m)){var $=i.editing={point:O.lp(b)};je?$.touch=!0:($.touch=!1,$.clickLeft=js(b),$.pan=Gh(b)?!0:"left"===this.panButton===$.clickLeft),Te(i,b)}Ar(b)?O.handleDoubleClick(b,m,g):O.handleClick(b,m,g)}},handle_mouseup:function(l){this.handle_touchend(l)},handle_touchend:function(){},handleWindowMouseMove:function(f){this.handleWindowTouchMove(f)},handleWindowTouchMove:function(j){var q=this,r=q.gv,k=q.editing;if(k){var $=r.lp(j),O=k.point,K=$.x-O.x,B=$.y-O.y;if(!k.moved){if(Math.abs(K)<q.threshold&&Math.abs(B)<q.threshold&&!(j.touches&&j.touches.length>1))return;k.moved=!0}if(k.point=$,k.touch){var P=j.touches.length;if(2!==P)q.pan(j,K,B);else{if(1>=P)return;var i=j.touches,w={x:i[0].clientX,y:i[0].clientY},F={x:i[1].clientX,y:i[1].clientY},d={x:F.x-w.x,y:F.y-w.y},W=k.lastCenter,Q=Math.atan2(d.y,d.x),b=k.theta,f=0;b==u?b=k.theta=Q:(f=Q-b,k.thetaStarted||Math.abs(f)>q.touchRotateThreshold?(k.thetaStarted=!0,k.theta=Q):f=0);var v=y*(w.y+F.y)/2/r.getHeight(),U=k.phi,V=0;U==u?U=k.phi=v:(V=v-U,k.phiStarted||Math.abs(V)>q.touchRotateThreshold?(k.phiStarted=!0,k.phi=v):V=0);var h,c=Math.sqrt(d.x*d.x+d.y*d.y),I=k.vlen;if(I){var Y=w.x-W.x,M=w.y-W.y,J=F.x-W.x,E=F.y-W.y,N=Math.sqrt(Y*Y+M*M),a=Math.sqrt(J*J+E*E),t=I/2,D=q._sign2(N-t),l=q._sign2(a-t);0>D*l||0===D&&0===l?(h=1,k.vlen=c):(h||(h=c/I),k.scaleStarted||Math.abs(h-1)>q.touchScaleThreshold?(k.vlen=c,k.scaleStarted=!0):h=1)}else I=k.vlen=c,h=1;1!==h&&r.setZoom(h),(V||f)&&q.rotate(j,f,-V),k.lastCenter={x:(F.x+w.x)/2,y:(F.y+w.y)/2}}}else if(k.pan)q.pan(j,K,B);else{var L=r.getWidth(),Z=r.getHeight();if(!L||!Z)return;var A=-e*K/L,x=-e*B/Z;q.rotate(j,A,x)}}},_sign2:function(p){return Math.abs(p)<this._touchScaleCheckAccuracy?0:p>0?1:-1},handleWindowMouseUp:function(J){this.handleWindowTouchEnd(J)},handleWindowTouchEnd:function(f){var B=this,C=B.editing;if(B.editing=null,C){var U=B.gv;if(!C.moved&&C.clickLeft){var k=U.getDataAt(f);k?U.sm().setSelection([k]):U.sm().clearSelection()}else U._panning=null,U._rotating=null,U.fi({kind:C.pan?"endPan":"endRotate",event:f})}},pan:function(x,o,w){var N=this,b=N.gv;if(b.isPannable()){var r=b.getWidth(),h=b.getHeight();if(r&&h){var z=b.getCenterInfo(),U=-o/r*z.width,D=1*w/h*z.height;b.fi({kind:b._panning?"betweenPan":"beginPan",event:x}),b._panning=1;var i=N.keepHorizon,G=N.editing.touch;if((G&&x.touches&&x.touches.length>1||!G&&xd(x))&&(i=!i),!i)return b.pan(U,D);if(U||D){var k=Pe(b),_=[k[0]*U,k[4]*U,k[8]*U],H=[k[1],0,k[9]],q=Math.sqrt(H[0]*H[0]+H[2]*H[2]);q&&(H=[H[0]/q*D,0,H[2]/q*D]);var R=_[0]+H[0],g=_[1]+H[1],c=_[2]+H[2],e=b._center,t=b._eye;e[0]+=R,e[1]+=g,e[2]+=c,t[0]+=R,t[1]+=g,t[2]+=c,b.fp(Hj,u,t),b.fp(Md,u,e)}}}},rotate:function(i,Z,f){var w=this,Y=w.gv;if(Y.isRotatable()){var t=Y._center,N=Y._eye,A=Zq(N,t),J=$(r(A[0]*A[0]+A[2]*A[2]),A[1]),e=J+f;e=Math.max(w.minPhi,Math.min(w.maxPhi,e)),f=e-J,Y.fi({kind:Y._rotating?"betweenRotate":"beginRotate",event:i}),Y._rotating=1,Y.rotate(Z,f)}}}),b.defineProperties(lf.prototype,{panButton:{get:function(){return this._panButton},set:function(R){this._panButton=R}},minPhi:{get:function(){return this._minPhi},set:function(J){this._minPhi=J}},maxPhi:{get:function(){return this._maxPhi},set:function(W){this._maxPhi=W}},keepHorizon:{get:function(){return this._keepHorizon},set:function(m){this._keepHorizon=m}},threshold:{get:function(){return this._threshold},set:function(t){this._threshold=t}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(T){this._touchScaleThreshold=T}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(w){this._touchRotateThreshold=w}}});var de=function(D){this.gv=D};xk(de,b,{_iv:!0,iv:function(){this._iv=!0},face:function(T,F){var p=this,j=p.gv.getGL();if(!j||!xp(T))return u;var L=F.x,O=F.width,H=F.height,h=p.height-F.y-H,n=R(O/2),V=new Uint8Array(4*O*H),Y=0;for(p.iv(),p.validate(T),Ig(j,p.frame),j.readPixels(L,h,O,H,j.RGBA,j.UNSIGNED_BYTE,V),hm(j),p.iv();n>=Y;Y++)for(var x=n-Y,E=n+Y,B=x;E>=B;B++)for(var y=x;E>=y;y++)if(B===x||B===E||y===x||y===E){var Z=Eh.m[V[4*(B*O+y)]];if(Z)return Z}},get:function(T,c){this.validate();var v=this,H=v.gv.getGL();if(!H)return u;var M,b,G=T.x,x=T.width,s=T.height,J=v.height-T.y-s,Q=R(x/2),I=new Uint8Array(4*x*s),g=0,D=I.length,m=c?u:new _e,l=c?u:{};if(Ig(H,v.frame),H.readPixels(G,J,x,s,H.RGBA,H.UNSIGNED_BYTE,I),hm(H),c){for(;Q>=g;g++)for(var N=Q-g,r=Q+g,P=N;r>=P;P++)for(var S=N;r>=S;S++)if((P===N||P===r||S===N||S===r)&&(M=v.info(I,4*(P*x+S))))return M}else for(;D>g;g+=4)M=v.info(I,g),M&&(b=M.data,l[b._id]||(m.add(b),l[b._id]=b));return m},info:function(s,J){return this.colorMap[(s[J]<<16)+(s[J+1]<<8)+s[J+2]+((127&s[J+3])<<24)]},validate:function(N){var H=this,p=H.gv,X=p.getGL();if(X){var Z=p.getWidth(),h=p.getHeight(),s=X.RGBA,$=X.TEXTURE_2D,B=X.RENDERBUFFER,A=X.FRAMEBUFFER;H.texture||(H.texture=Pb(X),H.render=X.createRenderbuffer(),H.frame=X.createFramebuffer()),(H.width!==Z||H.height!==h)&&(Nk(X,H.texture),X.texImage2D($,0,s,Z,h,0,s,X.UNSIGNED_BYTE,u),Vj(X,X.TEXTURE_MIN_FILTER,X.LINEAR),X.bindRenderbuffer(B,H.render),X.renderbufferStorage(B,X.DEPTH_COMPONENT16,Z,h),Ig(X,H.frame),X.framebufferTexture2D(A,X.COLOR_ATTACHMENT0,$,H.texture,0),X.framebufferRenderbuffer(A,X.DEPTH_ATTACHMENT,B,H.render),Nk(X,u),X.bindRenderbuffer(B,u),hm(X),H.width=Z,H.height=h),H._iv&&(H._iv=!1,Ig(X,H.frame),p._42(N||(H.colorMap={}),1),hm(X))}}});var Yo=function(J){this.gv=J};xk(Yo,b,{gap:0,size:0,_42:function(s,k){var x=this,S=x.gv,P=S._gridGap,K=S._gridSize;if(S._gridVisible){if(x.gap!==P||x.size!==K){for(var M=[],d=S._gridSize/2,r=P*d,t=0;2*d+1>t;t++){var b=6*t,Y=6*(2*d+1)+b;M[b]=-r,M[b+1]=0,M[b+2]=-r+t*P,M[b+3]=r,M[b+4]=0,M[b+5]=-r+t*P,M[Y]=-r+t*P,M[Y+1]=0,M[Y+2]=-r,M[Y+3]=-r+t*P,M[Y+4]=0,M[Y+5]=r}x.vs=new Jk(M),x.gap=P,x.size=K}Sb(S),Vk(s,k),cc(s),Ao(s,k,1,S._gridColor,S._buffer.vs,x.vs),Tq(s,0,x.vs.length/3,s.LINES),Sm(s),Bg(s,k)}else x.vs=x.gap=x.size=u}});var Hl=function(O){this.gv=O};xk(Hl,b,{_42:function(h,E){var S=this.gv,f=S._buffer.vs,r=S._axisXColor,U=S._axisYColor,k=S._axisZColor,F=S._originAxisVisible,m=S._centerAxisVisible;if(F||m){var c=q?h.TRIANGLES:h.TRIANGLE_FAN,A=h.LINES;if(Sb(S),Vk(h,E),cc(h),F){var j=S.getCenterInfo(),Q=I(j.width,j.height)/5,L=.8*Q,o=.05*Q;Ao(h,E,1.5,r,f,new Jk([0,0,0,Q,0,0,L,o,0,L,0,o,L,-o,0,L,0,-o,L,o,0,0,0,0,0,Q,0,o,L,0,0,L,o,-o,L,0,0,L,-o,o,L,0,0,0,0,0,0,Q,o,0,L,0,o,L,-o,0,L,0,-o,L,o,0,L])),Tq(h,0,2,A),Tq(h,1,6,c),Ao(h,E,u,U),Tq(h,7,2,A),Tq(h,8,6,c),Ao(h,E,u,k),Tq(h,14,2,A),Tq(h,15,6,c)}if(m){var Z=S._center,d=Z[0],Y=Z[1],M=Z[2],j=S.getPositionInfo(Z);Q=I(j.width,j.height)/20,Ao(h,E,1.5,r,f,new Jk([d,Y,M,d+Q,Y,M,d,Y,M,d,Y+Q,M,d,Y,M,d,Y,M+Q])),Tq(h,0,2,A),Ao(h,E,u,U),Tq(h,2,2,A),Ao(h,E,u,k),Tq(h,4,2,A)}Sm(h),Bg(h,E)}}});var aj=function(I){this.gv=I,this.onMouseOver=this.onMouseOver.bind(this),this.mode=aj.Mode.Disable};aj.Mode={Disable:0,Selection:1,MouseOver:2},xk(aj,b,{onMouseOver:function($){U.preventDefault($);var e=this.gv.getDataAt($);e!==this.mouseOverData&&(this.mouseOverData=e,this.gv.iv())},setFetchTargetFunc:function($){this.fetchTargetFunc=$},_42:function(L,Y){var s,y=this,G=y._mode;if(G!==aj.Mode.Disable&&(G===aj.Mode.Selection?s=y.gv.sm().getSelection().toArray(function(P){return P.s("highlight.visible")}):G===aj.Mode.MouseOver&&y.mouseOverData&&y.mouseOverData.s("highlight.visible")&&(s=[y.mouseOverData]),y.fetchTargetFunc&&(s=y.fetchTargetFunc(s)),s&&s.length)){var T=y.gv,Z=T.vr.isPresenting(),d=T.getWidth();if(Z){var H=T.getWidth;d/=2,T.getWidth=function(){return d};var w=T.getViewport()}var z,m=T.getDevicePixelRatio(),X=d*m,v=T.getHeight()*m;(z=y._renderTarget)?z.setSize(L,X,v):y._renderTarget=z=new fb.RenderTarget(T,L,X,v),Ig(L,z.frame),T.drawFilter=function(h){return s.indexOf(h)<0?!0:void 0},T._42({}),T.drawFilter=null,hm(L),Z&&(T.getWidth=H,T.setViewport(L,w[0],w[1],w[2],w[3])),y.shader||(y.shader=new yp.Shader(L,Yn.vs,Yn.fs));var q=y.shader;if(y.shader.bind(),L.enable(L.BLEND),L.activeTexture(L.TEXTURE0+0),L.bindTexture(L.TEXTURE_2D,z.texture),q.uniforms.image=0,q.uniforms.textureSize=[X,v],q.uniforms.edgeWidth=W["highlight.width"],y.highlightColor!==W["highlight.color"]){var e=$j(y.highlightColor=W["highlight.color"]);y.highlightColorData=[e[0]/255,e[1]/255,e[2]/255,e[3]/255]}q.uniforms.edgeColor=y.highlightColorData,y.ibuffer?(y.ibuffer.upload(),y.vbuffer.upload()):(y.ibuffer=yp.Buffer.createIndexBuffer(L,new Uint16Array([0,2,1,1,2,3])),y.vbuffer=yp.Buffer.createVertexBuffer(L,new Float32Array([0,0,1,0,0,1,1,1]))),q.attributes.pos.pointer(y.vbuffer),L.drawElements(L.TRIANGLES,6,L.UNSIGNED_SHORT,0),L.disable(L.BLEND),L.bindTexture(L.TEXTURE_2D,null),L.useProgram(Y)}}}),b.defineProperties(aj.prototype,{mode:{get:function(){return this._mode},set:function(q){var k=this._mode;q!==k&&(this._mode=q,q===aj.Mode.MouseOver?this.gv.getView().addEventListener("mousemove",this.onMouseOver,!1):k===aj.Mode.MouseOver&&this.gv.getView().removeEventListener("mousemove",this.onMouseOver))}}});var Yn={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},Uk=function(b){this.gv=b},Cc="edit_tx",yh="edit_ty",bi="edit_tz",pq="edit_rx",_q="edit_ry",dl="edit_rz",wd="edit_sx",Wh="edit_sy",Pd="edit_sz",Ip={};Ip[Cc]=1,Ip[yh]=1,Ip[bi]=1,Ip[pq]=1,Ip[_q]=1,Ip[dl]=1,Ip[wd]=1,Ip[Wh]=1,Ip[Pd]=1,xk(Uk,b,{_42:function(c,Q,t){var f=this,B=f.gv,I=B.sm().ld();if(I&&B.isEditable(I)&&!B.isEditHelperDisabled()&&xp(I)&&(!B.isFirstPersonMode()||!B.isMouseRoamable()&&!je)){Sb(B);var q,o,k=B.isMovable(I),C=B.isRotationEditable(I),n=B.isSizeEditable(I),u=B._axisXColor,h=B._axisYColor,v=B._axisZColor,D=B._editSizeColor,H=I.p3(),W=Di(B.getEye(),H)/10,b=W/(t?5:10),L=.7*W,$=.4*L,y=H[0],T=H[1],w=H[2];q=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],k&&f._17O(c,Q,I,t,Cc,u,q,[y,T-b,w,y+L,T-b,w,y+L,T,w,y+L,T,w,y,T,w,y,T-b,w,y,T-b,w+b,y+L,T-b,w+b,y+L,T-b,w,y+L,T-b,w,y,T-b,w,y,T-b,w+b]),o=y+L,n&&f._17O(c,Q,I,t,wd,D,q,[o,T-b,w,o+$,T-b,w,o+$,T,w,o+$,T,w,o,T,w,o,T-b,w,o,T-b,w+b,o+$,T-b,w+b,o+$,T-b,w,o+$,T-b,w,o,T-b,w,o,T-b,w+b]),o+=$,C&&f._17O(c,Q,I,t,pq,u,q,[o,T-b,w,o+$,T-b,w,o+$,T,w,o+$,T,w,o,T,w,o,T-b,w,o,T-b,w+b,o+$,T-b,w+b,o+$,T-b,w,o+$,T-b,w,o,T-b,w,o,T-b,w+b]),q=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],k&&f._17O(c,Q,I,t,yh,h,q,[y,T,w,y,T+L,w,y-b,T+L,w,y-b,T+L,w,y-b,T,w,y,T,w,y,T,w,y,T,w-b,y,T+L,w-b,y,T+L,w-b,y,T+L,w,y,T,w]),o=T+L,n&&f._17O(c,Q,I,t,Wh,D,q,[y,o,w,y,o+$,w,y-b,o+$,w,y-b,o+$,w,y-b,o,w,y,o,w,y,o,w,y,o,w-b,y,o+$,w-b,y,o+$,w-b,y,o+$,w,y,o,w]),o+=$,C&&f._17O(c,Q,I,t,_q,h,q,[y,o,w,y,o+$,w,y-b,o+$,w,y-b,o+$,w,y-b,o,w,y,o,w,y,o,w,y,o,w-b,y,o+$,w-b,y,o+$,w-b,y,o+$,w,y,o,w]),q=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],k&&f._17O(c,Q,I,t,bi,v,q,[y,T,w,y,T,w+L,y,T-b,w+L,y,T-b,w+L,y,T-b,w,y,T,w,y,T-b,w,y-b,T-b,w,y-b,T-b,w+L,y-b,T-b,w+L,y,T-b,w+L,y,T-b,w]),o=w+L,n&&f._17O(c,Q,I,t,Pd,D,q,[y,T,o,y,T,o+$,y,T-b,o+$,y,T-b,o+$,y,T-b,o,y,T,o,y,T-b,o,y-b,T-b,o,y-b,T-b,o+$,y-b,T-b,o+$,y,T-b,o+$,y,T-b,o]),o+=$,C&&f._17O(c,Q,I,t,dl,v,q,[y,T,o,y,T,o+$,y,T-b,o+$,y,T-b,o+$,y,T-b,o,y,T,o,y,T-b,o,y-b,T-b,o,y-b,T-b,o+$,y-b,T-b,o+$,y,T-b,o+$,y,T-b,o])}},_17O:function(l,o,K,O,s,a,G,E){var A=this.gv._buffer;Ih(l,o,O,!0,K,s),gj(l,o,u,!0,u,!0,u,!1),oi(l,o.uDiffuse,a),og(l,A.vs,new Jk(E),o.aPosition),og(l,A.ns,new Jk(G),o.aNormal),cc(l),Tq(l,0,12),Sm(l),vg(l,o)}});var Ml=X.Raycaster=function(E){this.gv=E,this.maxTriangleTest=1/0};lp("Raycaster",b,{intersect:function(Y){var X=this,W=X.gv,U=W.getDataAt(Y);return U?X.intersectObject(Y,U):null},intersectObjects:function(W,I,J){var r,_,f,R,t=this,d=1/0,D=W.origin||(new rh).fromArray(t.gv.getEye()),Y=t.maxTriangleTest,z=[];return I.forEach(function(a){J&&J(a)===!1||a.s("intersect")!==!1&&z.push(a)}),z.sort(function(e,Q){return D.distanceToSquared2(e.p3())-D.distanceToSquared2(Q.p3())}),t.countTriangles=0,z.forEach(function(g){t.countTriangles>Y||(r=t.intersectObject(W,g),r&&(_=D.distanceToSquared(r.world),d>_&&(f=g,R=r,d=_)))}),t.countTriangles=0,{data:f,intersect:R}},intersectObject:function(t,z){if(t instanceof Do)return this._intersectObjectImpl(t,z);var g,O,W=this,v=W.gv;O=v.unproject(t);var G=v.getEye();v.isOrtho()?(g=Zq(v.getCenter(),G),g[0]+=g[0],g[1]+=g[1],g[2]+=g[2]):g=G,g=new rh(g);var K=new rh(O).sub(g).normalize(),w=new X.Math.Ray(g,K);return W._intersectObjectImpl(w,z)},_intersectObjectImpl:function(){function j(){var C=new rh;return C.subVectors(v,x),P.subVectors(D,x),C.cross(P).normalize(),C}function $(o,C,_,Y,u,E,v){return Ql.barycoordFromPoint(o,C,_,Y,w),u.multiplyScalar(w.x),E.multiplyScalar(w.y),v.multiplyScalar(w.z),u.add(E).add(v),u.clone()}var a=new $h,U=new $h,Z=new Do,A=new rh,p=new rh,W=new rh,J=new rh,m=new rh,D=new rh,x=new rh,v=new rh,n=new Hh,r=new Hh,H=new Hh,P=new rh,T={vs:Zp,is:Rr,uv:md},w=new rh;return function(F,O){var I=this.gv.getData3dUI(O),K=O.mat||I.mat;if(K){a.fromArray(K),U.getInverse(a),Z.copy(F).applyMatrix4(U);var G,Q,E="body",g=I.shapeModel;if(g||(g=Hb(I)),g||(O instanceof X.Node&&!(O instanceof X.Shape)?(G=!0,g=T):(Q=!0,g=[I.left,I.front,I.right,I.back,I.top,I.bottom])),!g)return console.log("Can not find shape model."),null;En(g)||(g=[g]);var h,f,i,z,l,s,P,B,L,Y,b,c,S,C,N,u,t=1/0,M=["","top_","bottom_"],V=!1;for(h=0,f=g.length;f>h;h++)if(S=g[h])for(i=0,z=M.length;z>i;i++)if(C=M[i],P=S[C+"vs"],B=S[C+"is"],L=S[C+"uv"]||S[C+"tuv"],P){if(N=S[C+"boundingBox"]){var b=Z.intersectBox(N);if(!b)continue;if(Z.origin.distanceTo(b)>t)continue;u=!1}else S[C+"boundingBox"]=N=new X.Math.Box3,u=!0;for(l=0,s=B?B.length:P.length/3;s>l;l+=3)this.countTriangles++,B?(p.fromArray(P,3*B[l]),W.fromArray(P,3*B[l+1]),J.fromArray(P,3*B[l+2])):(p.fromArray(P,3*l),W.fromArray(P,3*(l+1)),J.fromArray(P,3*(l+2))),u&&(N.expandByPoint(p),N.expandByPoint(W),N.expandByPoint(J)),Y=Z.intersectTriangle(p,W,J,!0,A),Y&&(c=Z.origin.distanceTo(Y),t>c&&(t=c,m.copy(Y),D.copy(p),x.copy(W),v.copy(J),""!==C?E=C.slice(0,-1):G?E=gk[Math.floor(l/6)]:Q&&(E=gk[h]),L&&(V=!0,B?(n.fromArray(L,2*B[l]),r.fromArray(L,2*B[l+1]),H.fromArray(L,2*B[l+2])):(n.fromArray(L,2*l),r.fromArray(L,2*(l+1)),H.fromArray(L,2*(l+2))))))}if(!isFinite(t))return null;var _,o=m.clone().applyMatrix4(a);V&&(_=$(m,D,x,v,n,r,H));var y=j(D,x,v),R=j(D.applyMatrix4(a),x.applyMatrix4(a),v.applyMatrix4(a)),q=Z.direction.dot(y);return q>0&&(y.multiplyScalar(-1),R.multiplyScalar(-1)),{world:o,local:m.clone(),worldNormal:R,normal:y,uv:_,part:E}}}}()});var Oi=function(f,e){this.gv=f,this.s=function(D,v,R){return v==u&&(v=R),v==u?e.getStyle(D):wq(v,e,f)},this.data=e};xk(Oi,b,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(s,Z,j,I){var Q=this,y=Q.data;if(!(y instanceof ls)){var p,q,Y,z,F,R,x,T=Q.gv,c=y._id,H=Q.s("shape3d.alwaysOnTop")?null:Q.s("batch"),G=T._batchIndexMap,m=T._batchModelMap,K=T.isSelectable(y),$=T.getBrightness(y),d=$!=u&&1!==$;if(Q.needValidate(s)){if(Y=os(G,m,y,H),Q.validate(Y,H?Zd[H]||Cd:u),Y&&(z=G[c],F=z.size=Y.vs.length/3-z.begin,x=Y.rs))for($=d?$:1,R=0;F>R;R++)x.push($);if(xp(y)){var r=T.getWireframeGeometry(y);if(r)Qe(T,y,r);else{var e=T.getWireframe(y);e&&Qe(T,y,e)}}Q.labelInfo=Q.label2Info=Q.noteInfo=Q.note2Info=Q._38o=u,Q._24O(Fr,"getLabel"),Q._24O(Nb,"getLabel2"),Q._26O(cf,"getNote"),Q._26O(ic,"getNote2"),Q._15O(),Q.interactiveInfo=T.isInteractive(y)?{}:u,Q._iv=!1}d&&oi(s,Z.uBrightness,$),oi(s,Z.uAlphaTest,Q.s("alphaTest")),oi(s,Z.uUseEnvMap,y.s("envmap")?!0:!1),oi(s,Z.uReflectivity,y.s("envmap")||.01),q=Ih(s,Z,j,K,y,Id),q&&(Ec(q,G[c],m),Ec(q,T._polylineIndexMap[c],T._polylineModelMap),Ec(q,T._wireframeIndexMap[c],T._wireframeModelMap)),G[c]||Q._80o(s,Z,I),T.isLabelVisible(y)&&((p=Q.labelInfo)&&(Ih(s,Z,j,K,y,Fr),Q._28O(p,Fr,I)),(p=Q.label2Info)&&(Ih(s,Z,j,K,y,Nb),Q._28O(p,Nb,I))),T.isNoteVisible(y)&&((p=Q.noteInfo)&&(Ih(s,Z,j,K,y,cf),Q._29O(p,cf,I)),(p=Q.note2Info)&&(Ih(s,Z,j,K,y,ic),Q._29O(p,ic,I))),(p=Q._38o)&&Q._99O(s,Z,p,j,K,I),d&&oi(s,Z.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return kl},_80o:function(){},dispose:function(){},_calcAnchorMat:function(m){if(m.hasOwnProperty("_anchor")||m.hasOwnProperty("_anchorElevation")){var B=m.getAnchor3d(),S={x:B.x-.5,y:B.y-.5,z:B.z-.5},D=sh();return Ah(D,[-S.x,-S.y,-S.z]),D}},getBodyColor:function(b){var n=this.data,X=this.gv.getBodyColor(n);return X?X:b?n.getStyle(b):u},_24O:function($,_){var x=this,z=x.data,o=x.gv,p=x.s,U=o[_](z);if(U!=u){var R=p($+".scale"),C=p($+".max"),n=x[$+"Info"]={label:U,textureScale:p($+".texture.scale"),color:o[_+"Color"](z),font:p($+".font"),align:p($+".align"),background:o[_+"Background"](z)},O=n.rect=Lc(n,U);C>0&&C<O.width&&(n.labelWidth=O.width,O.width=C),O.x=O.y=0,O.width*=R,O.height*=R,n.mat=x._16O(p($+".autorotate"),p($+".position"),O,p($+".face"),p($+".t3"),p($+".r3"),p($+".rotationMode"));var y=O.width/2,e=O.height/2;n.vs=new Jk([-y,e,0,-y,-e,0,y,-e,0,y,e,0]),O.width/=R,O.height/=R}},_26O:function(l,x){var a=this,V=a.data,f=a.gv,E=a.s,I=f[x](V);if(I!=u){var b=E(l+".scale"),U=this[l+"Info"]={note:I,textureScale:E(l+".texture.scale"),expanded:E(l+".expanded"),font:E(l+".font"),color:E(l+".color"),align:E(l+".align"),borderWidth:E(l+".border.width"),borderColor:E(l+".border.color"),background:f[x+"Background"](V)};if(U.expanded){var o=E(l+".max"),X=Lc(U,I);X.width+=6,X.height+=2,o>0&&o<X.width&&(U.labelWidth=X.width,X.width=o);var B={x:-X.width/2,y:-8-X.height,width:X.width,height:X.height+8}}else B={x:-6,y:-18,width:12,height:18};U.mat=a._16O(E(l+".autorotate"),E(l+".position"),u,E(l+".face"),E(l+".t3"),E(l+".r3"),E(l+".rotationMode")),U.rect=B,1!==b&&(B=Qb(B),B.x*=b,B.height*=b,B.y=-B.height,B.width*=b);var s=B.x,T=B.y,p=B.width,k=B.height;U.vs=new Jk([s,-T,0,s,-T-k,0,s+p,-T-k,0,s+p,-T,0])}},_28O:function(T,o,m){if(m(this.s(o+".transparent"))){var U=T.rect,u=T.textureScale,W=U.width*u,I=U.height*u;if(W>=1&&I>=1){var K=Jc(W,I);1!==u&&(K.translate(K,U.x,U.y),K.scale(u,u),K.translate(K,-U.x,-U.y)),Ic(K,T),K.restore(),wf(this,o,T.mat,T.vs,!0)}}},_29O:function(K,D,N){if(N(this.s(D+".transparent"))){var k=K.rect,L=K.textureScale,q=k.x,$=k.y,R=k.width*L,j=k.height*L;if(R>=1&&j>=1){k.x=k.y=0;var M=Jc(R,j);1!==L&&M.scale(L,L),wg(M,K),M.restore(),k.x=q,k.y=$,wf(this,D,K.mat,K.vs,!1)}}},_99O:function(P,d,K,C,U,B){if(K){var g=this,S=g.gv,m=g.data,O=S._buffer,b=S._1O,L=K.icons;for(var i in L){var A=L[i],c=K.rects[i];if(c&&B(wq(A.transparent,m,S))){Ih(P,d,C,U,m,i);var G=wq(A.shape3d,m,S),N=G?[G]:wq(A.names,m,S),M=N?N.length:0,j=wq(A.textureScale,m,S)||1,V=wq(A.light,m,S);V==u&&(V=G?!0:!1),gj(P,d,wq(A.blend,m,S),V,wq(A.opacity,m,S),wq(A.reverseFlip,m,S),wq(A.reverseColor,m,S),wq(A.reverseCull,m,S));for(var f=0;M>f;f++){var J=N[f],r=c[f];if(oq(g,r.mat),G)vs(S,m,Hb(g,G),g);else{var F=Hi(J);if(F){var y=r.width*j,Q=r.height*j;if(y>=1&&Q>=1){var I=Jc(y,Q);fh(I,F,wq(A.stretch,m,S),0,0,y,Q,m,S),I.restore(),Pb(P,vh,b),cc(P,d,b,wq(A.discardSelectable,m,S),O.uv,Jn),og(P,O.vs,r.vs,d.aPosition),Er(P,O.ns,Lg,d.aNormal),Hn(P,O.is,Ci),Nq(P,0,Ci.length),Sm(P,d,b)}}}Uj(S)}vg(P,d)}}}}});var jc=function(s,C){ef(jc,this,[s,C])};xk(jc,Oi,{_16O:function(v,W,o,U,$,a,O,f,r){var k=this.data,h=k.getFinalScale3d(),K=ac(W,h,o,U,f,r);if(k.hasOwnProperty("_anchor")||k.hasOwnProperty("_anchorElevation")){var y=k.getAnchor3d();K[0]-=(y.x-.5)*h[0],K[1]-=(y.y-.5)*h[1],K[2]-=(y.z-.5)*h[2]}return Wj(sh(),K,k.p3(),U,$,a,O,v,k.getFinalRotation3d(),k.getRotationMode())},clear:function(){var J=this;J.faceMat=J.mat=J.shapeModel=J.left=J.right=J.front=J.back=J.top=J.bottom=J.csg=u},needValidate:function(I){if(this._iv)return this._validateFrameId=I._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var Q=I._renderInfo.frame;if(this._validateFrameId!==Q)return this._validateFrameId=Q,!0
}return!1},validate:function(O,B){var R=this,J=R.gv,e=R.data,n=R.shapeName=R.s(Yi),p=Hb(R,n);R._updateAutoRotation(),R._updateFixSize2d(),R._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(Cr(J,e,"_wireframeModelMap","_wireframeIndexMap"),Cr(J,e,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var r=Ge(e,J.getMat(e),p?R.s("shape3d.scaleable"):!0),G=R._calcAnchorMat(e);if(G&&Nj(r,r,G),e.mat=r,R.clear(),p||!n)if(O){var Y=[];p?be(J,e,p,R,R.getBodyColor(),[r],O,Y):(Fo(J,e,O,B,r,nk,Y,Hf),Fo(J,e,O,B,r,yq,Y,Aq),Fo(J,e,O,B,r,hk,Y,Hr),Fo(J,e,O,B,r,nh,Y,pb),Fo(J,e,O,B,r,gr,Y,Re),Fo(J,e,O,B,r,cl,Y,sj)),Y.length&&(Ab(O.vs,Y),Ab(O.ns,uh(Y)))}else R.mat=r,(R.shapeModel=p)||(R._cubeUvs=null,R.vf(nk,0),R.vf(yq,16),R.vf(gr,8),R.vf(cl,24),R.vf(hk,32),R.vf(nh,40))},_updateAutoRotation:function(){var f=new lb;return function(){var z=this,U=z.data,m=z.s("shape3d.autorotate");if(!m)return U._dynamicRotation&&delete U._dynamicRotation,void 0;var Y,c=z.gv;Y="string"==typeof m?[m.indexOf("x")<0?c._eye[0]:c._center[0],m.indexOf("y")<0?c._eye[1]:c._center[1],m.indexOf("z")<0?c._eye[2]:c._center[2]]:c._eye;var v=c._center,p=U.p3(),N=ei([p[0]+Y[0]-v[0],p[1]+Y[1]-v[1],p[2]+Y[2]-v[2]],p,c._up);f.set(0,0,0,U.getRotationMode(),!0).setFromRotationMatrix(N);var W=U._dynamicRotation;W&&Math.abs(W[0]-f.x)<1e-5&&Math.abs(W[1]-f.y)<1e-5&&Math.abs(W[2]-f.z)<1e-5||(U._dynamicRotation=[f.x,f.y,f.z])}}(),_updateFixSize2d:function(){var n=this,P=n.data,x=n.s("shape3d.fixSizeOnScreen");if(!x)return P._dynamicScale3d&&delete P._dynamicScale3d,void 0;var a=n.gv;P.getFinalScale3d();var H=Ge(P,a.getMat(P)),U=Jo([0,0,0],H),r=a.toViewPosition(U);if(!isNaN(r.x)&&!isNaN(r.y)){var O=Jo([1,0,0],H),c=a.toViewPosition(O),N=Jo([0,1,0],H),C=a.toViewPosition(N),M=c.x-r.x,d=C.y-r.y;if(M&&d){var y=P._dynamicScale3d||[1,1,1],A=Hi(P.s("shape3d.image")),h=x[0]>0?x[0]:A?Bp(A,P):20,L=x[1]>0?x[1]:A?Fd(A,P):20,$=Math.abs(M/h),w=Math.abs(d/L);Math.abs($-1)<.001&&Math.abs(w-1)<.001||(P._dynamicScale3d=[y[0]/$,y[1]/w,y[2]])}}},_updateOverlapping:function(){var D=this,h=D.s("hide.overlapping.group");if(!h)return D._rectOverlapping&&(D._rectOverlapping=f),void 0;var L,P,F,p=D.gv,a=D.data,_=Ge(a,p.getMat(a)),r=1/0,w=1/0,W=-1/0,X=-1/0,l=a.getAnchor3d(),z=l.x,H=l.y,O=l.z;for(L=0;8>L;L++){if(P=Jo([(L>>2)-z,(1&L>>1)-H,(1&L)-O],_),F=p.toViewPosition(P),isNaN(F.x)||isNaN(F.y))return;r=Math.min(r,F.x),W=Math.max(W,F.x),w=Math.min(w,F.y),X=Math.max(X,F.y)}var j={x:r,y:w,w:W-r,h:X-w};D._rectOverlapping=p.overlappingBox.isOverlapping(h,j)},getVectorDynamicSize:function(){var O,b=this,E=b.s("shape3d"),w=b.data;if("billboard"===E||"plane"===E||(O=w._currentCubeElementId)!=u){var G,$,A=b.gv,S=Ge(w,A.getMat(w)),L=w.getAnchor3d(),M=.5-L.x,s=.5-L.y,Q=.5-L.z,J=b.s("shape3d.vector.dynamic.maxsize"),y=function(X,w){X[0]+=M,X[1]+=s,X[2]+=Q,w[0]+=M,w[1]+=s,w[2]+=Q;var L=A.toViewPosition(Jo(X,S)),b=A.toViewPosition(Jo(w,S)),C=L.x-b.x,B=L.y-b.y;return Math.min(J,Math.sqrt(C*C+B*B))};if("billboard"===E)G=y([-.5,0,0],[.5,0,0]),$=y([0,-.5,0],[0,.5,0]);else if("plane"===E)G=y([-.5,0,0],[.5,0,0]),$=y([0,0,-.5],[0,0,.5]);else if(w._currentCubeElementId!=u){var z=3*Rr[O+1],X=3*Rr[O],N=3*Rr[O+2];G=y([Zp[z],Zp[z+1],Zp[z+2]],[Zp[N],Zp[N+1],Zp[N+2]]),$=y([Zp[z],Zp[z+1],Zp[z+2]],[Zp[X],Zp[X+1],Zp[X+2]])}return[G,$]}},getCachedTexture:function(){var a=this,O=a.data,e=O._currentCubeElementId;return e!=u?a._cubeCachedImage?a._cubeCachedImage[e]:null:a._shape3dCachedImage},setCachedTexture:function(w){var m=this,b=m.data,E=b._currentCubeElementId;E!=u?(m._cubeCachedImage||(m._cubeCachedImage={}),m._cubeCachedImage[E]=w):m._shape3dCachedImage=w},invalidateCachedTexture:function(J){var $,W,x,u=this;if((x=u._shape3dCachedImage)&&(J.deleteTexture(x),u._shape3dCachedImage=null),W=u._cubeCachedImage){for($ in W)J.deleteTexture(W[$]);u._cubeCachedImage=null}},vf:function(E,N){var f=this;if(f.gv.getFaceVisible(f.data,E)){var w=as(f,E);w.mat&&(f.faceMat=!0);var L=w.uv;if(L){var $=f._cubeUvs;$||($=f._cubeUvs=new Jk([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var U=0;8>U;U++)$[N+U]=L[U]}return w}},_billboardInView:function(){var _=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],e=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],Y=new Cb(new rh(-1,-1,-1),new rh(1,1,1)),w=new Cb,T=new rh,C=new $h,n=new $h;return function(x){var b=this;if(!b.mat)return!0;var P="billboard"===x?_:e;w.makeEmpty(),n.fromArray(b.mat),C.fromArray(b.gv.getPVMatrix()).multiply(n);for(var l=0,u=P.length;u>l;l+=3)w.expandByPoint(T.fromArray(P,l).applyMatrix4(C));return w.intersectsBox(Y)}}(),_80o:function(Y,C,j){var c=this;if(c._rectOverlapping)return!0;var q=c.shapeModel;if(q||!c.shapeName){var d=c.s("shape3d");if(("billboard"===d||"plane"===d)&&!c._billboardInView(d))return!0;var M=c.gv,O=c.data,D=M._cube;Sb(M,c.mat),q?vs(M,O,q,c,c.getBodyColor(),j):(og(Y,D.vs,u,C.aPosition),og(Y,D.ns,u,C.aNormal),Rm(Y,D.is),c._18O(Y,C,c.left,0,j),c._18O(Y,C,c.front,6,j),c._18O(Y,C,c.right,12,j),c._18O(Y,C,c.back,18,j),c._18O(Y,C,c.top,24,j),c._18O(Y,C,c.bottom,30,j)),Uj(M),c.faceMat&&(c._18O(Y,C,c.left,0,j,!0),c._18O(Y,C,c.front,6,j,!0),c._18O(Y,C,c.right,12,j,!0),c._18O(Y,C,c.back,18,j,!0),c._18O(Y,C,c.top,24,j,!0),c._18O(Y,C,c.bottom,30,j,!0))}},_18O:function(M,X,L,H,s,A){if(L){if(!s(L.transparent))return;if(A&&!L.mat||!A&&L.mat)return;var P=this.data.s("polygonOffset");P&&tl(M,P),A&&Sb(this.gv,L.mat);var t=this,Y=t.data;Y._currentCubeElementId=H;var z=t.gv,J=z.getTexture(L.texture,Y),T=L.uv,D=L.uvScale,e=L.uvOffset,R=L.discardSelectable;J?T?cc(M,X,J,R,z._buffer.uv,t._cubeUvs,e,D):cc(M,X,J,R,z._cube.uv,u,e,D):cc(M),gj(M,X,L.blend,L.light,L.opacity,L.reverseFlip,L.reverseColor,L.reverseCull),oi(M,X.uDiffuse,L.color||W["color.empty"]),Nq(M,H,6),vg(M,X),Sm(M,X,J),A&&Uj(z),P&&Ce(M),Y._currentCubeElementId=null}}});var Hq=function(X,V){ef(Hq,this,[X,V])};xk(Hq,Oi,{_25Q:1,validate:function(g){var q=this,w=q.gv,S=q.data,b=q.s,r=b("edge.width"),y=S._40I,V=S._41I;if(q.shapeModel=q.info=u,y&&V){var X,P,z,d,a,p,R,s,i,O,m=S.isLooped(),B=b(_j),G=U.getEdgeType(B);if(G){var K=G(S,Gr(q,w,S,m,B),w,q._19Q);if(!K.points||K.points.isEmpty())return;p=q.info={},R=K.segments,a=K.points,s=a.size();for(var W=y.getElevation(),o=V.getElevation(),J=0;s>J;J++){var C=a.get(J);C.e==u&&(C.e=W+(o-W)*J/(s-1))}i=gs(a.get(0)),O=gs(a.get(s-1));var j=s%2;0===j?(p.c1=gs(a.get(s/2-1)),p.c2=gs(a.get(s/2))):p.p3=gs(a.get((s-j)/2)),p.s1=i,p.s2=gs(a.get(1)),p.t1=gs(a.get(s-2)),p.t2=O}else{a=new _e,p=q.info={};var h=b("edge.offset"),A=b("edge.center"),T=b("edge.source.t3"),E=b("edge.target.t3"),x=y.p3(),k=V.p3();if(T&&(x[0]+=T[0],x[1]+=T[1],x[2]+=T[2]),E&&(k[0]+=E[0],k[1]+=E[1],k[2]+=E[2]),B===kp){R=b("edge.segments");var L=p.points=b(zq)||Ii;if(s=L.size()){i=gs(L.get(0)),O=gs(L.get(s-1)),!A&&h&&(z=Zq(i,x,!0),h=I(h,Di(x,i)),x=[x[0]+z[0]*h,x[1]+z[1]*h,x[2]+z[2]*h],z=Zq(k,O,!0),h=I(h,Di(O,k)),k=[k[0]-z[0]*h,k[1]-z[1]*h,k[2]-z[2]*h]);var j=s%2;0===j?(X=gs(L.get(s/2-1)),P=gs(L.get(s/2))):p.p3=gs(L.get((s-j)/2)),p.s1=x,p.s2=i,p.t1=O,p.t2=k}else!A&&h&&(z=Zq(k,x,!0),d=Di(x,k),h=An(h,d),x=[x[0]+z[0]*h,x[1]+z[1]*h,x[2]+z[2]*h],k=[k[0]-z[0]*h,k[1]-z[1]*h,k[2]-z[2]*h]),X=x,P=k;a.add({x:x[0],y:x[2],e:x[1]}),a.addAll(L),a.add({x:k[0],y:k[2],e:k[1]})}else{var Q=Gr(q,w,S,m,B);if(q._19Q||(Q=-Q),m){var n=x[0],M=x[1],v=x[2],D=y.getTall()/2+Q;X=[n-Q,M+D,v],P=[n+Q,M+D,v],a.add({x:n-Q,y:v,e:M}),a.add({x:n-Q,y:v,e:M+D}),a.add({x:n+Q,y:v,e:M+D}),a.add({x:n+Q,y:v,e:M})}else{z=Zq(k,x,!0),d=Di(x,k);var c={x:x[0],y:x[2]},N={x:k[0],y:k[2]},f=Dd(u,c,N,Q),l=f.x-c.x,t=f.y-c.y;h=An(h,d),z[0]*=h,z[1]*=h,z[2]*=h,X=[x[0]+z[0]+l,x[1]+z[1],x[2]+z[2]+t],P=[k[0]-z[0]+l,k[1]-z[1],k[2]-z[2]+t],A?(a.add({x:x[0],y:x[2],e:x[1]}),a.add({x:X[0],y:X[2],e:X[1]}),a.add({x:P[0],y:P[2],e:P[1]}),a.add({x:k[0],y:k[2],e:k[1]})):(a.add({x:X[0],y:X[2],e:X[1]}),a.add({x:P[0],y:P[2],e:P[1]}))}}p.c1=X,p.c2=P}p.list=b(Yi)===Wl?q.createTubeModel(a,R,r/2,g):q.createLineModel(a,R,r,"edge","edge.dash")}}});var vl=function(M,q){ef(vl,this,[M,q])};xk(vl,jc,{_80o:function(r,L,P){var s=this,m=s.gv,R=s.shapeModel;Sb(m,s.mat),R?vs(m,s.data,R,s,s.getBodyColor(),P):(Vp(s,r,L,s.left,P),Vp(s,r,L,s.front,P),Vp(s,r,L,s.right,P),Vp(s,r,L,s.back,P),Vp(s,r,L,s.top,P),Vp(s,r,L,s.bottom,P)),Uj(m)},validate:function(a,x){var t,i,k=this,K=k.s,g=k.data,R=g.p3(),T=g._thickness/2,o=g.isClosePath(),f=g.getPoints(),A=g.getSegments(),n=K(jn),e=a&&a.uv;if(k.clear(),0>T)i=k.shapeModel=cj(f,A,K(Ib),K(rm),n,K(ms),g.getTall(),g.getShapeElevation(),o),K(np)?K("shape3d.image")||delete i.uv:(delete i.vs,delete i.ns,delete i.uv),K("shape3d.top.image")||delete i.top_uv,K("shape3d.bottom.image")||delete i.bottom_uv;else if(K(Yi)===Wl)t=Lm(f,A,n,o),i=k.shapeModel={vs:[]},K("shape3d.image")&&(i.uv=[],i.sum=K(ms)||br(t)||1,i.len=0),K(Ib)&&!o&&(i.top_vs=[],K("shape3d.top.image")&&(i.top_uv=[])),K(rm)&&!o&&(i.bottom_vs=[],K("shape3d.bottom.image")&&(i.bottom_uv=[])),k._12O(t,T);else{var N,d,U,C,Z,F,w,m,I,c;if(t=Lm(f,A,n,o),Z=k.vf(gr,e,!1,x),T&&(F=k.vf(cl,e,!1,x),w=o?u:k.vf(nk,e,!1,x),m=o?u:k.vf(yq,e,!1,x),I=k.vf(hk,e,!1,x),c=k.vf(nh,e,!1,x)),T){for(var B=0,G=t.length;G>B;B++)t[B]=k._tryRemoveBezierPoints(t[B],T);k._12O(t,T)}else Z&&t.forEach(function(K){if(C=K.length,C>0)for(N=K[0],U=1;C>U;U++)d=K[U],k.addV(Z.vs,N,d),N=d});k._20Q(t),a||(Z&&(Z.ns=uh(Z.vs),Zj(Z,"vs"),Zj(Z,Xi)),T&&(F&&(F.ns=uh(F.vs),Zj(F,"vs"),Zj(F,Xi)),w&&(w.ns=uh(w.vs),Zj(w,"vs"),Zj(w,Xi)),m&&(m.ns=uh(m.vs),Zj(m,"vs"),Zj(m,Xi)),I&&(I.ns=uh(I.vs),Zj(I,"vs"),Zj(I,Xi)),c&&(c.ns=uh(c.vs),Zj(c,"vs"),Zj(c,Xi))))}var y=k.mat=sh();Ah(y,R),Ug(y,g.getFinalRotation3d(),g.getRotationMode());var $=g.getScale3d(),h=g._dynamicScale3d;h&&($[0]*=h[0],$[1]*=h[1],$[2]*=h[2]),_d(y,$),Ah(y,vi(R)),a&&(wk(k,y,a,i),k.clear())},_20Q:function(h){var n,L,p,k,C,z,X,t=this,$=t.front,o=t.back,A=t.top,y=t.bottom,i=$?$.tuv:u,V=o?o.tuv:u,Z=A?A.tuv:u,j=y?y.tuv:u,s=0;(i||V||Z||j)&&(n=t.s(ms)||br(h)||1,h.forEach(function(M){if(L=M.length,L>0)for(z=M[0],p=1;L>p;p++)X=M[p],k=s/n,s+=Di(z,X),C=s/n,t._14O($,k,C),t._14O(o,1-C,1-k),t._14O(A,k,C),t._14O(y,k,C),z=X}))},_14O:function(K,V,S){if(K){var k=K.uv,s=K.tuv;if(s){if(k)var L=k[0]+(k[6]-k[0])*V,D=k[1]+(k[7]-k[1])*V,x=k[2]+(k[4]-k[2])*V,C=k[3]+(k[5]-k[3])*V,h=k[2]+(k[4]-k[2])*S,m=k[3]+(k[5]-k[3])*S,Q=k[0]+(k[6]-k[0])*S,f=k[1]+(k[7]-k[1])*S;else L=V,D=0,x=V,C=1,h=S,m=1,Q=S,f=0;s.push(x,C,h,m,Q,f,Q,f,L,D,x,C)}}},_13O:function(x){var g=x.uv,a=x.tuv;a&&(g?a.push(g[2],g[3],g[4],g[5],g[6],g[7],g[6],g[7],g[0],g[1],g[2],g[3]):a.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(s,b){var B=s.length;if(4>B)return s;var T,K,J,u,M,g,r=!1,h=function(o){return s[o]},U=function(I){return s[B-1-I]};for(M=0;1>=M;M++)for(g=M?U:h,K=g(0),J=g(1),T=2;B-1>T;T++)if(u=g(T),!u.remove)if(u.b){var P=Dd(K,J,u,b);P.adjust?(u.remove=!0,r=!0):(K=J,J=u)}else K=J,J=u;if(!r)return s;var Q=[];for(T=0;B>T;T++)s[T].remove||Q.push(s[T]);return Q},_12O:function(S,l){var B,P,A,G,s,a=this;S.forEach(function(X){if(s=X.length,s>0)for(B={p:X[0],n:!0},G=1;s>G;G++)P=X[G],A=s-1>G?X[G+1]:u,a.addPoint(B,P,A,l,X)})},addPoint:function(t,I,q,r,R){var F,E,V,O,M,v,o,T,f,B=this,D=t.p,H=t.f,s=t.b,S=B.s("shape3d.side")||Of,h=B.s("shape3d.start.angle"),n=B.s("shape3d.sweep.angle"),N=B.shapeModel,W=B.data.isClosePath();if(t.n&&(t.n=!1,H=W&&R.length>2?Dd(R[R.length-2],D,I,r):Dd(u,D,I,r),s=yr(D,H),N?N.top_vs&&B._10O(s,H,S,h,n,N.top_vs,N.top_uv):(F=B.left)&&(B.addV(F.vs,s,H),B._13O(F))),E=q?Dd(D,I,q,r):W&&R.length>2?Dd(D,I,R[1],r):Dd(D,I,u,r),V=yr(I,E),N){var _,p,a=N.vs,P=N.uv,Z=N.sum;for(P&&(_=N.len/Z,N.len+=Di(D,I),p=N.len/Z),v=B._9O(s,H,S,h,n),o=B._9O(V,E,S,h,n),T=0;S>T;T++)f=T+1,Ab(a,v[f]),Ab(a,o[T]),Ab(a,v[T]),Ab(a,o[T]),Ab(a,v[f]),Ab(a,o[f]),P&&(O=T/S,M=f/S,P.push(_,M,p,O,_,O,p,O,_,M,p,M));!q&&N.bottom_vs&&B._10O(V,E,S,h,n,N.bottom_vs,N.bottom_uv,!0)}else!q&&(F=B.right)&&(B.addV(F.vs,E,V),B._13O(F)),(F=B.front)&&B.addV(F.vs,H,E),(F=B.back)&&B.addV(F.vs,V,s),(F=B.top)&&B.addH(F.vs,H,E,V,s,!0),(F=B.bottom)&&B.addH(F.vs,s,V,E,H);t.p=I,t.f=E,t.b=V},_10O:function(R,N,$,J,Z,D,r,P){var K,X,O=this,q=O.data,s=O._9O(R,N,$,J,Z),E=(R.x+N.x)/2,k=(R.y+N.y)/2,v=q.getShapeElevation(),i=0;for(i=0;$>i;i++)P?(Ab(D,s[i]),Ab(D,s[i+1])):(Ab(D,s[i+1]),Ab(D,s[i])),Ab(D,[E,v,k]),r&&(P?(K=e*(i+1)/$+J,X=e*i/$+J):(K=e*i/$+J,X=e*(i+1)/$+J),r.push(.5-.5*p(X),.5-.5*x(X),.5-.5*p(K),.5-.5*x(K),.5,.5))},_9O:function(v,M,z,I,b){var c,K,_=this,V=_.data,O=[],f=(v.x+M.x)/2,C=(v.y+M.y)/2,G=V.getTall()/2,E=V.getShapeElevation(),U=0;for(b=b||e;z>=U;U++)c=b*U/z+I,K=p(c),O.push([f+(v.x-f)*K,E+G*x(c),C+(v.y-C)*K]);return O},addV:function(p,y,t){var O=y.x,W=y.y,o=t.x,k=t.y,I=this.data,g=I.getShapeElevation(),r=I.getTall()/2;p.push(O,g-r,W,o,g-r,k,o,g+r,k,o,g+r,k,O,g+r,W,O,g-r,W)},addH:function(m,e,Q,j,G,O){var Y=this.data,z=Y.getTall()/2,B=Y.getShapeElevation()+(O?z:-z);m.push(e.x,B,e.y,Q.x,B,Q.y,j.x,B,j.y,j.x,B,j.y,G.x,B,G.y,e.x,B,e.y)},vf:function(D,f,c,$){var M,V=this,s=V.gv.getFaceVisible(V.data,D);return(c||s)&&(M=as(V,D,$),M.vs=[],M.tuv=s&&(M.texture||f)?[]:u,M.visible=s),M}});var Wo=function(I,c){ef(Wo,this,[I,c])};xk(Wo,Oi,{_25Q:1,validate:function(q){var V=this,R=V.data,h=V.s,e=R.getPoints(),T=e.size();if(V.shapeModel=V.info=u,T>1){var M=V.info={},G=R.getSegments(),K=R.getThickness(),O=gs(e.get(0)),E=gs(e.get(T-1)),x=T%2;0===x?(M.c1=gs(e.get(T/2-1)),M.c2=gs(e.get(T/2))):M.p3=gs(e.get((T-x)/2)),M.s1=O,M.s2=gs(e.get(1)),M.t1=gs(e.get(T-2)),M.t2=E,M.list=h(Yi)===Wl?V.createTubeModel(e,G,K/2,q):V.createLineModel(e,G,K,"shape.border","shape.dash")}var v=R.p3(),z=V.mat=sh();Ah(z,v),Ug(z,R.getFinalRotation3d(),R.getRotationMode());var j=R.getScale3d(),H=R._dynamicScale3d;H&&(j[0]*=H[0],j[1]*=H[1],j[2]*=H[2]),_d(z,j),Ah(z,vi(v))},_80o:function(j,q,C){var t=this,B=t.shapeModel;if(B){var P=t.gv;Sb(P,t.mat),vs(P,t.data,B,t,t.getBodyColor(),C),Uj(P)}}});var ai=X.graph3d.VR=function(S){var F=this;F.gv=S,F._controllers=[],F.switch=new Oq(F),F._enable=!1,F._defaultCallLater=X.Default.callLater,F._defaultCancelLater=Um,"undefined"!=typeof M&&"VRFrameData"in M&&(F._frameData=new M.VRFrameData),F.measureOflength=1,F.eyesOffset=[0,0,0],F._orientation=new X.Math.Quaternion,F._lastHeadPose=[0,0,0],F._offsetToBeAdd=[0,0,0],F._fpsInfo={time:0,fps:0,frames:0}};xk(ai,b,{ms_fire:!0,_42:function(q,n,r,c){var W=this,p=W.gv;if(!p.drawFilter&&W._deviceInAction){var S=W._device;if(S){var _=W._measureOflength;S.depthNear=p.getNear()*_,S.depthFar=p.getFar()*_;var E=W._offsetToBeAdd;if(W.eyesOffset[0]+=E[0],W.eyesOffset[1]+=E[1],W.eyesOffset[2]+=E[2],E[0]=0,E[1]=0,E[2]=0,S.isPresenting===!1)return W._controllers.forEach(function(T){T&&T.update()}),p.iv(),!1;var G=W._frameData;S.getFrameData(G);var y=G.pose.position;if(y){var m=W.toViewPosition(y);p.setEye(m),W._orientation.fromArray(G.pose.orientation);var e=new X.Math.Vector3(0,0,-10*W._scaleFactor);e.applyQuaternion(W._orientation),p.setCenter([m[0]+e.x,m[1]+e.y,m[2]+e.z])}W._controllers.forEach(function(O){O&&O.update()}),p.setViewport(q,0,0,n/2,r),W._viewMatrix=W._copyViewMatrix(G.leftViewMatrix),W._projectMatrix=W._copyProjectMatrix(G.leftProjectionMatrix),c(),p.setViewport(q,n/2,0,n/2,r),W._viewMatrix=W._copyViewMatrix(G.rightViewMatrix),W._projectMatrix=W._copyProjectMatrix(G.rightProjectionMatrix),c(),W._lastViewMatrix=W._viewMatrix,W._lastProjectMatrix=W._projectMatrix,W._viewMatrix=null,W._projectMatrix=null,W.submitFrame();var u=Date.now(),A=W._fpsInfo;return u-A.time>1e3?(A.fps=Math.round(1e3*(A.frames+1)/(u-A.time)),A.time=u,A.frames=0):A.frames++,!0}}},onVRDisplayPresentChange:function(){var C=this.isPresenting();this._injectGraphView(C),this.fp("present",!C,C)},getOrientation:function(){return this._orientation},addController:function(Y){Y=Y||0;var c=this,L=c.getController(Y);return L?L:(L=new lj(c,Y),c._controllers.push(L),L)},getController:function(e){e=e||0;for(var B=this._controllers,n=0,U=B.length;U>n;n++)if(B[n]&&B[n].id===e)return B[n];return null},removeController:function(c){c=c||0;for(var N=this._controllers,h=0,C=N.length;C>h;h++)if(N[h]&&N[h].id===c)return N.splice(h,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(Q,o){var k=this,g=k._scaleFactor,x=k._eyesOffset,J=k._lastHeadPose;return J[0]=Q[0]*g,J[1]=Q[1]*g,J[2]=Q[2]*g,o?(o[0]=J[0]+x[0],o[1]=J[1]+x[1],o[2]=J[2]+x[2],o):[J[0]+x[0],J[1]+x[1],J[2]+x[2]]},addEyesOffset:function(g,s,u){var G=this._offsetToBeAdd;G[0]+=g,G[1]+=s,G[2]+=u},_copyViewMatrix:function(r){var $=this.dup(r),v=this._scaleFactor;$[12]*=v,$[13]*=v,$[14]*=v;var U=this._eyesOffset;if(U&&(U[0]||U[1]||U[2])){var j=U[0],i=U[1],C=U[2];$[12]-=$[0]*j+$[4]*i+$[8]*C,$[13]-=$[1]*j+$[5]*i+$[9]*C,$[14]-=$[2]*j+$[6]*i+$[10]*C}return $},shutdown:function(){var C=this._device;C&&C.isPresenting&&C.exitPresent()},isPresenting:function(){var t=this._device;return t&&t.isPresenting},_copyProjectMatrix:function(Q){var A=this.dup(Q),L=this._scaleFactor;return A[14]*=L,A},dup:function(E,w){for(var p=E.length,r=w||new Array(p);p--;)r[p]=E[p];return r},getViewMatrix:function(R){var E=this._viewMatrix;return E?this.dup(E,R):void 0},getProjectMatrix:function(){var E=this._projectMatrix;return E?this.dup(E):void 0},submitFrame:function(){var R=this;if(R._enable&&R._deviceInAction){var N=R._device;N&&N.isPresenting&&(N.submitFrame(),R.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function(m){var D=this.gv;return D.intersectObjects(m,D.dm().getDatas())},setDevice:function(c){var m=this;m._device=c},_injectGraphView:function(){var N,L,n;return function(m){var y=this.gv;if(!m)return N&&(y.getWidth=N,y.getHeight=L,y.getDevicePixelRatio=n),void 0;var $=this._device,R=$.getEyeParameters("left"),z=R.renderWidth,l=R.renderHeight;N=y.getWidth,L=y.getHeight,n=y.getDevicePixelRatio,y.getWidth=function(){return 2*z},y.getHeight=function(){return l},y.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(q){var o=this;if(!q)return up=X.Default.callLater=o._defaultCallLater,Um=X.Default.cancelLater=o._defaultCancelLater,void 0;var o=this;up=X.Default.callLater=function(x,N,M,I){var g=o._device;return g&&g.isPresenting?I?i(function(){up(x,N,M)},I):g.requestAnimationFrame(function(){o._deviceInAction=!0,x.apply(N,M),o._deviceInAction=!1}):o._defaultCallLater(x,N,M,I)},Um=X.Default.cancelLater=function(Z,j){var f=o._device;return f&&f.isPresenting?j?_(Z):f.cancelAnimationFrame(Z):o._defaultCancelLater(Z,j)}}}),b.defineProperties(ai.prototype,{enable:{get:function(){return this._enable},set:function(l){var C=this;C._enable!==l&&(C._enable=l,l?(C.switch.showButton(),C._injectCallLaterFunc(!0)):(C.shutdown(),C.switch.hideButton(),C._injectCallLaterFunc(!1)),C.fp("enable",!l,l))}},measureOflength:{get:function(){return this._measureOflength},set:function(e){this._measureOflength=e;var q=this._scaleFactor=1/e;this._controllers.forEach(function(_){_&&_._setScaleFactor(q)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(R){this._eyesOffset=R}},controllerModel:{get:function(){return this._controllerModel},set:function(G){var f;"object"==typeof G?(f=G.mtl,G=G.obj):(f=G+".mtl",G+=".obj");var i=this,M=i._controllerModel;M&&M.obj===G&&M.mtl===f||(M=i._controllerModel={obj:G,mtl:f},U.loadObj(G,f,{finishFunc:function(P,x){i._controllerModel===M&&U.setShape3dModel("vrControllerModel",x)}}))}},interactive:{get:function(){return!!this._interactive},set:function(P){!!P!=!!this._interactive&&(this._interactive=P,P&&this.addController(0),this.gv.getCoreInteractor().enableVR(P))}}});var lj=function(Q,u){function w(u){var Z=navigator.getGamepads&&navigator.getGamepads();if(Z)for(var W=0,T=0,D=Z.length;D>W;W++){var A=Z[W];if(A){var i=A.id;if("OpenVR Gamepad"===i||"OpenVR Controller"===i||0===i.indexOf("Oculus Touch")||0===i.indexOf("Spatial Controller")){if(T===u)return A;T++}}}}function n(F,R,S){return Math.abs(F[0]-R[0])<S&&Math.abs(F[1]-R[1])<S&&Math.abs(F[2]-R[2])<S?!0:!1}var S=this;S.vr=Q,S.id=u;var M,Y,o=[0,0],G=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],Z=new Kd;Z.s("shape3d","vrControllerModel"),Z.isController=!0,Z.s("intersect",!1),S.getGamepad=function(){return Y},S.isButtonPressed=function(x){for(var f,E=0,m=G.length;m>E;E++)if(f=G[E],f.id===x)return f.pressed;return!1},S.getNode=function(){return Z};var $=.003;S.setRotationEpsilon=function(T){$=T};var P=5e-4,F=P;S.setPositionEpsilon=function(q){P=q,F=q*S.vr._scaleFactor},S._setScaleFactor=function(G){Z.s3(G,G,G),F=P*G},S._setScaleFactor(S.vr._scaleFactor);var R,l=new Bd,O=new $h,I=[0,0,0],H=[0,0,0],p=new lb,A=new rh,g=new Do;S.getRay=function(){return R?(g.origin.fromArray(I),g.direction.copy(A),R=!1,g):g},S.update=function(){if(M=Y,Y=w(u),M!=Y&&console.log("gamepad changed",Y),!Y||Y.pose===f)return Y=null,Z.s("3d.visible",!1),void 0;if(U.getShape3dModel("vrControllerModel")){Z.dm()||Q.gv.dm().add(Z),Z.s("3d.visible",!0);var V=Y.pose;if(null!==V){V.position&&(S.vr.toViewPosition(V.position,I),n(Z.p3(),I,F)||(R=!0,Z.p3(I))),V.orientation&&(l.fromArray(V.orientation),A.set(0,0,-1).applyQuaternion(l).normalize(),O.makeRotationFromQuaternion(l),p.set(0,0,0,Z.getRotationMode(),!0).setFromRotationMatrix(O),H[0]=p.x,H[1]=p.y,H[2]=p.z,n(Z.r3(),H,$)||(R=!0,Z.r3(H))),R&&Q.fp("gamepad.pose",null,{position:I,rotation:H,id:u});var X=Y.axes;(o[0]!==X[0]||o[1]!==X[1])&&(o=[X[0],X[1]],Q.fp("gamepad.axes",null,{id:u,axes:o}));var e,y,g,N,m=Y.buttons;for(e=0,y=m.length;y>e;e++)if(g=m[e],N=g.pressed,N!==G[e].pressed){G[e].pressed=N;var L={id:u},W="state";L[W]=L._62O=N?"down":"up",Q.fp("gamepad.button."+G[e].id,null,L)}}}}},Oq=function(s){this.vr=s,this._button=null};xk(Oq,b,{showButton:function(){var I=this.assureButton();if(!I.parentNode){var Z=this.vr.gv,V=Z.getView();Z._79O?V.insertBefore(I,Z._79O):V.appendChild(I)}},hideButton:function(){var T=this._button;T&&T.parentNode&&T.parentNode.removeChild(T)},assureButton:function(){var S=this._button;return S?S:this._button=this.createButton(this.vr.gv)},createButton:function(F){function x(R,e){R.textContent=e&&e.isPresenting?" VR ":" VR "}function C(N){p.style.display="",p.style.cursor="pointer",p.style.left="calc(50% - 50px)",p.style.width="100px",x(p,N),p.onmouseenter=function(){p.style.opacity="1.0"},p.onmouseleave=function(){p.style.opacity="0.5"},p.onclick=function(){N.isPresenting?N.exitPresent():N.requestPresent([{source:F.getCanvas()}])},F.vr.setDevice(N)}function y(){p.style.display="",p.style.cursor="auto",p.style.left="calc(50% - 75px)",p.style.width="150px",x(p,null),p.onmouseenter=null,p.onmouseleave=null,p.onclick=null,F.vr.setDevice(null)}function s(I){I.style.position="absolute",I.style.bottom="20px",I.style.padding="12px 6px",I.style.border="1px solid #fff",I.style.borderRadius="4px",I.style.color="#000",I.style.font="normal 13px sans-serif",I.style.textAlign="center",I.style.opacity="0.5",I.style.outline="none",I.style.zIndex="999"}if("getVRDisplays"in navigator){var p=this._button=Y.createElement("button");return p.style.display="none",s(p),M.addEventListener("vrdisplayconnect",function(k){C(k.display)},V),M.addEventListener("vrdisplaydisconnect",function(){y()},V),M.addEventListener("vrdisplaypresentchange",function(w){x(p,w.display),F.vr.onVRDisplayPresentChange()},V),navigator.getVRDisplays().then(function(r){r.length>0?C(r[0]):y()}),p}var a=Y.createElement("a");return a.href="https://webvr.info",a.innerHTML=" webvr",a.style.left="calc(50% - 90px)",a.style.width="180px",a.style.textDecoration="none",s(a),a}}),b.defineProperties(Oq.prototype,{});var qi=X.graph3d.PostProcessing=function(y){function D(){if(!$){var H=y.getGL();$=new fb.RenderTarget(y,H,null,null,{samples:W.renderTextureSamples||1}),u=new yp.Shader(H,B.vs,B.fs),X=yp.Buffer.createIndexBuffer(H,new Uint16Array([0,2,1,1,2,3])),Q=yp.Buffer.createVertexBuffer(H,new Float32Array([0,0,1,0,0,1,1,1]))}}var $,u,X,Q,f=this,T={},a=!1;!function(){b.keys(qi).forEach(function(m){T[m]=new qi[m](y)})}(),f.getModule=function(i){return i?T[i]:f},f.getModuleList=function(){return b.keys(T)},f.handleDataModleChange=function(T,x){T&&(T.setPostProcessingData(f.serialize()),T.removeSerializeListener(f.onDataModelSerialize,f)),x&&(x.addSerializeListener(f.onDataModelSerialize,f),f.deserialize(x.getPostProcessingData()))},f.onDataModelSerialize=function(k){"serialize"===k.type?y.dm()._postProcessingData=f.serialize():"deserialize"===k.type&&f.deserialize(y.dm().getPostProcessingData())},f.serialize=function(){var h,k,b,R={};for(h in T)k=T[h],R[h]={enable:k.enable},b=k.serializeProperties,b&&b.forEach(function(X){R[h][X]=k[X]});return R},f.deserialize=function(H){if(H){var R,s,e,P;for(R in H)if(s=T[R]){e=H[R],f.enableModule(R,e.enable);for(P in e)"enable"!==P&&(s[P]=e[P])}}else{var R,s;for(R in T)s=T[R],s.enable=!1,s.resetProperties&&s.resetProperties()}},f.decodeShader=function($){var X,r,b,E="",Q="";for(b=0;b<$.length;b++)X=$[b],"%"===X?X="'":"a"===X?X='"':"]"===X&&(X="\\"),r=String.fromCharCode(X.charCodeAt(0)-1),b%2?Q+=r:E=r+E;return Q+E},f.createShader=function($,C,x){var L=C.indexOf("^#"),w=f.decodeShader(C.substr(0,L)),q=f.decodeShader(C.substr(L+2));if(x){var Z=x(w,q);Z&&Z.vs&&(w=Z.vs),Z&&Z.fs&&(q=Z.fs)}return new yp.Shader($,w,q)},f.enableModule=function(B,f){var E,x,l,W=B.split(",");for(E=0,x=W.length;x>E;E++)l=W[E].trim(),T[l]&&(T[l].enable=f);a=!1;for(l in T)if(T[l].enable){a=!0;break}a&&D()};var B={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};f._42=function(H,Y,W,L,i){if(a&&!i){$.setSize(H,Y,W),$.bind(H),H.clear(H.COLOR_BUFFER_BIT|H.DEPTH_BUFFER_BIT),y.setViewport(H,0,0,Y,W),L(),$.unbind(H);var e,O=$;for(e in T)O=T[e]._42(H,O)||O;return y.setViewport(H,0,0,Y,W),H.clear(H.COLOR_BUFFER_BIT|H.DEPTH_BUFFER_BIT),u.bind(),H.activeTexture(H.TEXTURE0+0),H.bindTexture(H.TEXTURE_2D,O.texture),u.uniforms.image=0,X.upload(),Q.upload(),u.attributes.pos.pointer(Q),H.drawElements(H.TRIANGLES,6,H.UNSIGNED_SHORT,0),H.bindTexture(H.TEXTURE_2D,null),H.useProgram(y._prg),!0}}},xl=X.graph3d.PostProcessing.Bloom=function(k){function q(){var F=k.getWidth(),f=k.getHeight();if(F&&f){O=[F,f],j=!0;var m,r=k.getGL(),c=Math.round(O[0]/2),o=Math.round(O[1]/2);for(C=new fb.RenderTarget(k,r,c,o),m=0;u>m;m++)d.push(new fb.RenderTarget(k,r,c,o)),T.push(new fb.RenderTarget(k,r,c,o)),c=Math.round(c/2),o=Math.round(o/2);var p=k._postProcessing;Q=p.createShader(r,xl._34Q);for(var m=0;u>m;m++)N[m]=p.createShader(r,xl._35Q,function(E,T){return{fs:T.replace(/DEFINE_VALUE/g,B[m])}});E=p.createShader(r,xl._36Q,function(e,x){return{fs:x.replace(/NUM_MIPS/g,u)}}),x=p.createShader(r,xl.finalShader),V=yp.Buffer.createIndexBuffer(r,new Uint16Array([0,2,1,1,2,3])),y=yp.Buffer.createVertexBuffer(r,new Float32Array([0,0,1,0,0,1,1,1]))}}var n,L,g,V,y,z=this,I=!1,j=!1;this.serializeProperties="strength,threshold,radius".split(","),this.resetProperties=function(){n=1.5,L=.55,g=.4},b.defineProperties(z,{enable:{get:function(){return I},set:function(s){!!I!=!!s&&(I=s,s&&!j&&q())}},strength:{get:function(){return n},set:function(d){n=d}},threshold:{get:function(){return L},set:function(t){L=t}},radius:{get:function(){return g},set:function(H){g=H}}}),this.resetProperties();var C,Q,E,x,O=[256,256],d=[],T=[],u=5,B=[3,5,7,9,11],N=[];z._42=function(c,D){function G(z,p,w,P){Ig(c,p.frame),k.setViewport(c,0,0,p.width,p.height),P?P(c):c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT),$!==z&&z.bind();var H=0;for(var g in w){var j=w[g];j instanceof WebGLTexture&&(c.activeTexture(c.TEXTURE0+H),c.bindTexture(c.TEXTURE_2D,j),j=H,H++),z.uniforms[g]=j}for($!==z&&(V.upload(),y.upload(),z.attributes.pos.pointer(y),$=z),c.drawElements(c.TRIANGLES,6,c.UNSIGNED_SHORT,0);H--;)c.activeTexture(c.TEXTURE0+H),c.bindTexture(c.TEXTURE_2D,null);hm(c)}if(I){j||q();var $;G(Q,C,{smoothWidth:.01,luminosityThreshold:L,tDiffuse:D.texture});var b,F=C,s=Math.round(O[0]/2),r=Math.round(O[1]/2);for(b=0;u>b;b++)G(N[b],d[b],{colorTexture:F.texture,direction:[1,0],texSize:[s,r]}),G(N[b],T[b],{colorTexture:d[b].texture,direction:[0,1],texSize:[s,r]}),s=Math.round(s/2),r=Math.round(r/2),F=T[b];return G(E,d[0],{blurTexture1:T[0].texture,blurTexture2:T[1].texture,blurTexture3:T[2].texture,blurTexture4:T[3].texture,blurTexture5:T[4].texture,bloomStrength:n,bloomRadius:g,bloomTintColor:[1,1,1]}),G(x,D,{image:d[0].texture},function(O){O.enable(O.BLEND),O.blendEquation(O.FUNC_ADD),O.blendFunc(O.SRC_ALPHA,O.ONE)}),c.blendEquationSeparate(c.FUNC_ADD,c.FUNC_ADD),c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA),D}}};xl._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",xl._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d1j/t2j!p-on!viTjuhiihqj!fgxm0pnbvuT<ftwvbgsgzjjeo)h5!dwffwd!3>!!wsVpwm<pDvhobjsgGp`smnh!t~bn<qxm!f+s!31E/!3d!p>m,p!snUvfTyuuivhsjff<xv<oxj!g+p!s*n3!fwmfqdn3b!tu!f,y!T2jf{mfq<nbvto)j!g>p,s!nn!vwTffdt3v!gegjjsefd<ucjhpso/<*u$fetfgggjPowfv!!L.F!SwOVFwM!`-SfBsEvJuVyTf!UEsFpGmJpOdF!`)WEB3MfVsFvu$yeffug!j>o!f3!fTmJqHnNbBt!!E4FdGfJwOF<`cWhBsM/V*FufgtmgpgbPuw!vh!b,v!twtVjwb!o-Qfesgv)ujyof!Ugsmppmbpud!!y)-E!3jfos!vgumypfbuu!!>t!j2hfnmbq*n!b|t!s4fdufvwso<!y1!/+4!:f9{:j5T!w+o!jf!y+q!)o!p.j1u/d6f!s+j!ey!!>+!!uyf0t)g!gtPjwhvn!b3!d+f!wtj<h*nbbn*h*j0Ttgj!h-nyb)<ge~Qowbpjjtet!vnbbhj!o>)!*x!!|ubwpfmdg3!<j*ojw)Tujb{pfm!g>!!>2!/y1!!u0b!pumfgyT|j!{*f!<,,g!mjp!b<uT!VgJTEjBhSn`bM!F>O!SgFmLp!b=u!)jT!J<H2N!B>*!<j!gumopjb!u)!sxpfgjh<inuvTTvuni!h>j!fhxb!v+t!tcjhbso/Q*ewgV)w1!/-1f-s!vguTyjfhUnsbp*m<pdw!f)dE43!fesjvgugyvftuf!T>v!n",xl._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",xl.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var Yf=X.graph3d.PostProcessing.Dof=function(C){function k(){A=!0;var s=C.getGL();M=new fb.RenderTarget(C,s),j=C._postProcessing.createShader(s,Yf._38Q),z=yp.Buffer.createIndexBuffer(s,new Uint16Array([0,2,1,1,2,3])),m=yp.Buffer.createVertexBuffer(s,new Float32Array([0,0,1,0,0,1,1,1]))}var M,j,z,m,T,g,G,Y,E=this,V=!1,A=!1;
this.serializeProperties="aperture,maxblur,image".split(","),this.resetProperties=function(){this.aperture=.025,this.maxblur=1,this.image=null},b.defineProperties(E,{enable:{get:function(){return V},set:function(q){!!V!=!!q&&(V=q,q&&!A&&k())}},image:{get:function(){return g},set:function(L){g!==L&&(g=L,T&&(C.getGL().deleteTexture(T),T=null),C.iv())}},maxblur:{get:function(){return G},set:function(d){G!==d&&(G=d,C.iv())}},aperture:{get:function(){return Y},set:function(g){Y!==g&&(Y=g,C.iv())}}}),this.resetProperties(),E._42=function(L,r){function I(N,c,R,F){Ig(L,c.frame),C.setViewport(L,0,0,c.width,c.height),F?F(L):L.clear(L.COLOR_BUFFER_BIT|L.DEPTH_BUFFER_BIT),W!==N&&N.bind();var y=0;for(var p in R){var s=R[p];s instanceof WebGLTexture&&(L.activeTexture(L.TEXTURE0+y),L.bindTexture(L.TEXTURE_2D,s),s=y,y++),N.uniforms[p]=s}for(W!==N&&(z.upload(),m.upload(),N.attributes.pos.pointer(m),W=N),L.drawElements(L.TRIANGLES,6,L.UNSIGNED_SHORT,0);y--;)L.activeTexture(L.TEXTURE0+y),L.bindTexture(L.TEXTURE_2D,null);hm(L)}if(V){A||k();var W;if(!T){var o=Hi(this.image);if(!o||!o.tagName)return r;T=Pb(L,o)}var N=r.width,S=r.height;return M.setSize(L,N,S),I(j,M,{tColor:r.texture,tDepth:T,aspect:N/S,aperture:this.aperture,maxblur:this.maxblur}),M}}};Yf._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E",ae(U,{accordionViewExpandIcon:rj(Pi),accordionViewCollapseIcon:rj(Pi,!0),accordionViewLabelColor:pp,accordionViewLabelFont:bn,accordionViewTitleBackground:ed,accordionViewSelectBackground:dr,accordionViewSelectWidth:3,accordionViewSeparatorColor:f,splitViewDividerSize:1,splitViewDividerBackground:ed,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:kb,rect:[2,2,12,12],background:Pi}]},propertyViewLabelColor:ie,propertyViewLabelSelectColor:pp,propertyViewLabelFont:bn,propertyViewExpandIcon:rj(Bb),propertyViewCollapseIcon:rj(Bb,!0),propertyViewBackground:eb,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Op,propertyViewColumnLineColor:Op,propertyViewSelectBackground:dr,listViewLabelColor:ie,listViewLabelSelectColor:pp,listViewLabelFont:bn,listViewRowLineVisible:!1,listViewRowLineColor:Op,listViewSelectBackground:dr,treeViewLabelColor:ie,treeViewLabelSelectColor:pp,treeViewLabelFont:bn,treeViewExpandIcon:rj(Ik),treeViewCollapseIcon:rj(Ik,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Op,treeViewSelectBackground:dr,treeViewDoubleClickToToggle:!0,tableViewLabelColor:ie,tableViewLabelSelectColor:pp,tableViewLabelFont:bn,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Op,tableViewColumnLineColor:Op,tableViewSelectBackground:dr,treeTableViewLabelColor:ie,treeTableViewLabelSelectColor:pp,treeTableViewLabelFont:bn,treeTableViewExpandIcon:rj(Ik),treeTableViewCollapseIcon:rj(Ik,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Op,treeTableViewColumnLineColor:Op,treeTableViewSelectBackground:dr,tableHeaderLabelColor:ie,tableHeaderLabelFont:bn,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:_h,tableHeaderBackground:eb,tableHeaderMoveBackground:bq,tableHeaderInsertColor:dr,tableHeaderSortDescIcon:Hd(Bb,!0),tableHeaderSortAscIcon:Hd(Bb),tabViewTabGap:1,tabViewLabelColor:pp,tabViewLabelFont:bn,tabViewTabBackground:ed,tabViewSelectWidth:3,tabViewSelectBackground:dr,tabViewMoveBackground:bq,tabViewInsertColor:dr,toolbarLabelColor:ie,toolbarLabelSelectColor:pp,toolbarLabelFont:bn,toolbarBackground:eb,toolbarSelectBackground:dr,toolbarItemGap:8,toolbarSeparatorColor:sp},!0);var mk={translateX:1,sortColumn:1},wc={sortable:1,sortOrder:1,sortFunc:1},pr={focusData:1},cq={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Ni={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},Vr=function(p,B){B.add(p),p.hasChildren()&&p.eachChild(function(q){Vr(q,B)})},vb=function(W,d,H,n,S,g,V,m,N,M,$){var E,i=H.getValueType(M),p=H.getAlign(M);if(H.getEnumValues(M)){var J=H.toEnumLabel(d,M),D=Bo||0,c=0,A=g,Z=U.getTextSize(n,J).width;return E=Hi(H.toEnumIcon(d,M)),E&&(c=g+Bo/2,"center"===p?c+=(m-(D+Z))/2:"right"===p&&(c=c+m-(D+Z)),Xh(W,E,c,V+N/2,M,$),A=c+Bo/2),J!=u&&(E?gi(W,J,n,S,A,V,m-(A-g),N):gi(W,J,n,S,g,V,m,N,p)),void 0}return d=H.formatValue(d),d!=u?i===El?(On(W,g,V,m,N,d),void 0):i===tm||!i&&Wr(d)?(E=Hi(d?Gn:Xj),Xh(W,E,g+m/2,V+N/2,M,$),void 0):(gi(W,d,n,S,g,V,m,N,p),void 0):void 0},hr=function(P,S){var U=S.view,m=uf(P),$=S.column||S.property;U.getDataModel().beginTransaction(),S.editor=P,P.info=S,U.setCurrentEditor(P),U.getView().insertBefore(m,U._79O),Ji(P,S.editorRect),P.setFocus?P.setFocus():Kk(P),P.commitValue=function(t,O){P._17Q&&(P=P._17Q),O||U.setValue(S.data,$,P.getValue?P.getValue():P.value),P.close&&P.close(),mp(m)},$.onEditorCreated&&$.onEditorCreated(S)},hp=function(l,S,B,$,I){var E=hh(l,B),L=S.value,q=S.view,N=I.getValueType(S.data);return E.onblur=E.onchange=function(){q.endEditing()},"input"===l?(L=I.formatValue(L),L!=u&&(E.value=L),E.onkeydown=function(j){Wp(j)?q.endEditing():hj(j)&&q.endEditing(!0)},(N===Fi||N===fp)&&E.addEventListener(kd,U.numberListener,V)):l===of&&$.forEach(function(o){var G=Y.createElement("option");G.innerHTML=I.toEnumLabel(o),G.value=o,I.isEnumEqual(L,o)&&(G.selected=!0),qr(E,G)}),hr(E,S),E},Qq=X.widget={},_o=function(u,K,A){xk(Q+".widget."+u,K,A)};ae($r,{ms_value:function(i){i.getValue=function(L){var a=this.getItemById(L),l=a.element;return Bs(l)?l:l?l.getValue?l.getValue():l.value:a.selected},i.setValue=function(X,K){var n=this.getItemById(X);if(n){var m=n.element;m&&!Bs(m)?m.setValue?m.setValue(K):m.value=K:Wr(K)?(n.selected=K,this.iv()):(n.element=K,this.iv())}},i.v=function(A,i){var f=this;if(2===arguments.length)f.setValue(A,i);else{if(!Il(A))return f.getValue(A);for(var _ in A)f.setValue(_,A[_])}return f}},_46o:function(c){c._icon=u,c._accessType=u,c._valueType=u,c._editable=!1,c._batchEditable=!0,c._align=nk,c._nullable=!0,c._emptiable=!1,c.setParent=Dq,c.formatValue=function(S){var N=this,J=N._valueType;return N.getEnumValues()?N.toEnumLabel(S):J===tm?!!S:S!=u&&J===Fi?w(S):S},c.setEnum=function(b,r,S,h,x,C,s){var Z=this;b&&!En(b)&&b.values&&(h=b.editable,S=b.icons,r=b.labels,x=b.strict,C=b.maxHeight,s=b.dropDownWidth,b=b.values),hq(b)&&(b=b._as),hq(r)&&(r=r._as),hq(S)&&(S=S._as),Z._enumValues=b,Z._enumLabels=r,Z._enumIcons=S,Z._enumEditable=h,Z._enumStrict=x==u?!0:x,Z._enumMaxHeight=C,Z._enumDropDownWidth=s,b&&b.length&&Pr(b[0])&&(Z._valueType=fp),Z.fp("enum",!1,!0)},c.getEnumDropDownWidth=function(){return this._enumDropDownWidth},c.getEnumMaxHeight=function(){return this._enumMaxHeight},c.isEnumEditable=function(){return this._enumEditable},c.getEnumValues=function(){return this._enumValues},c.getEnumLabels=function(){return this._enumLabels},c.getEnumIcons=function(){return this._enumIcons},c.isEnumStrict=function(){return this._enumStrict},c.isEnumEqual=function(X,$){return this._enumStrict?X===$:X==$},c.toEnumLabel=function(p,t){var s=this,k=s.getEnumValues(t),K=s.getEnumLabels(t);if(k&&K)for(var J=0;J<k.length;J++)if(s.isEnumEqual(p,k[J]))return K[J];return p},c.toEnumIcon=function(E,m){var L=this,v=L.getEnumValues(m),r=L.getEnumIcons(m);if(v&&r)for(var u=0;u<v.length;u++)if(L.isEnumEqual(E,v[u]))return r[u];return f}},_45o:function(o){o._87o=function(N,U,i,u,Z,S){if(N){var o=this,e=o._90I,s=rp(1);o._columnLineVisible&&(Z-=1),o._rowLineVisible&&(S-=1),0>=Z||0>=S||(o._90I||(e=o._90I={}),e[U]||(e[U]=new _e),Ji(s,o.tx()+i,o.ty()+u,Z,S),qr(s,N),o._view.insertBefore(s,o._79O),N.onParentAdded&&N.onParentAdded(s),e[U].add(s))}},o._76o=function(){var e=this,K=e._90I;if(K){for(var H in K)K[H].each(function(b){mp(b)});delete e._90I}},o._77o=function(W){var G=this;if(G._90I){var F=G._90I[W];F&&(F.each(function(x){mp(x)}),delete G._90I[W])}}},_47o:function(n){n.getValue=function(o,y){return y.getValue?y.getValue(o,y,this):Tp(o,y.getAccessType(),y.getName())},n.setValue=function(S,I,_){if(I.isEmptiable(S)||""!==_||(_=f),I.isNullable(S)||_!=u){var e=this,w=I.getName(S),m=I.getAccessType(S),y=I.getValueType(S);y===Fi&&Bs(_)?_=A(_):y===fp&&Bs(_)?_=parseFloat(_):y===tm&&Bs(_)&&(_="true"===_),e._batchEditable&&I._batchEditable&&e.isSelected(S)?e.sm().each(function(C){I.setValue?I.setValue(C,I,_,e):Qn(C,m,w,_)}):I.setValue?I.setValue(S,I,_,e):Qn(S,m,w,_)}},n.setCurrentEditor=function(B){this.endEditing(),this._currentEditor=B,this.redraw()},n.isEditing=function(w,O){var K=this,R=K._currentEditor;if(!R)return!1;if(O){var e=R.info;return e?(e.column||e.property)===O&&e.data===w:!1}return!0},n.endEditing=function(Q){var c=this,y=c._currentEditor;y&&(delete c._currentEditor,y.commitValue&&y.commitValue(y.info,Q),c.redraw(),c.getDataModel().endTransaction())},n.beginEditing=function(i){this.endEditing();var e=this,n=i.column||i.property;if(n.beginEditing)n.beginEditing(i);else{var L=i.data,Y=i.value,H=e.getSelectBackground(L),w=n.getEnumValues(L),U=n.getSlider(L),Q=n.getColorPicker(L);if(U){var q=xo(Qq.Slider,U);return q.setValue(Y),q.getView().onblur=function(){e.endEditing()},q.isInstant()&&(q.onValueChanged=function(){e.setValue(L,n,q.getValue())}),hr(q,i),void 0}if(Q||n.getValueType(L)===El){var X=xo(Qq.ColorPicker,Q);return X.setValue(Y),X.onClosed=function(){e.endEditing()},X.isInstant()&&(X.onValueChanged=function(M,v){e.setValue(L,n,v)}),hr(X,i),X.open(),void 0}if(w){if(Qq.ComboBox){var y=new Qq.ComboBox;y.setValue(Y),y.setValues(w),y.setLabels(n.getEnumLabels(L)),y.setIcons(n.getEnumIcons(L)),y.setEditable(n.isEnumEditable(L)),y.setStrict(n.isEnumStrict(L)),y.setMaxHeight(n.getEnumMaxHeight(L)),y.setDropDownWidth(n.getEnumDropDownWidth(L)),y.onClosed=function(){e.endEditing()},hr(y,i),y.open()}else hp(of,i,H,w,n);return}var E=n.getValueType(L);if(E===tm||Wr(Y))return e.setValue(L,n,!Y),void 0;if(n.getItemEditor(L)){var z=Ff(n.getItemEditor(L)),W=new z(L,n,e,i),F=W.getView();return F._17Q=W,W.setValue(Y),Ad(F),hr(F,i),W.editBeginning&&W.editBeginning(),void 0}hp("input",i,H,u,n)}}},_44o:function(w){w.init=function(D){var q=this,b=q.th=new cp(D),E=q._view=sm(1,q);q.tv=q._tableView=D,qr(E,b.getView()),qr(E,D.getView()),b.mp(function(K){K.property===tj&&q.iv()}),q.iv()},w.getTableView=function(){return this.tv},w.getTableHeader=function(){return this.th},w.getDataModel=function(){return this.tv.dm()},w.getColumnModel=function(){return this.tv.getColumnModel()},w.setColumns=function(c){this.tv.setColumns(c)},w.addColumns=function(n){this.tv.addColumns(n)},w.endEditing=function(){this.tv.endEditing()},w.validateImpl=function(){var P=this,d=P.th,B=bo(d),i={x:0,y:0,width:P.getWidth(),height:B};Ji(d,i),i.y=B,i.height=l(0,P.getHeight()-B),Ji(P.tv,i)}},ms_vs:function(e){e._41o=function(){return this._29I.height<this._59I},e._43o=function(){var h=this;h._41o()&&(h._58I||(i(function(){h._94O()},uk),h.iv()),h._58I=new Date)},e._94O=function(){var y=this;if(y._58I){var s=new Date;s.getTime()-y._58I.getTime()>=uk?(delete y._58I,y.iv()):i(function(){y._94O()},uk)}},e._93I=function(){var f=this,g=f._27I;if(f._58I||!f._autoHideScrollBar){g||qr(f._79O,g=f._27I=rp());var i=f._29I,l=i.height,W=f._59I,c=f.getScrollBarSize(),K=i.width-c-2,H=l*(-f.ty()/W),m=l*(l/W),o=g.style;W>l?(qn>m&&(H=H+m/2-qn/2,0>H&&(H=0),H+qn>l&&(H=l-qn),m=qn),o.visibility=pl,o.background=f.getScrollBarColor(),o.borderRadius=c/2+Lf,Ji(g,K,H,c,m)):o.visibility=Ie}else g&&(g.style.visibility=Ie)}},ms_hs:function(z){z._40o=function(){return this._29I.width<this._91I},z._42o=function(){var B=this;B._40o()&&(B._95O||(i(function(){B._94I()},uk),B.iv()),B._95O=new Date)},z._94I=function(){var y=this;if(y._95O){var X=new Date;X.getTime()-y._95O.getTime()>=uk?(delete y._95O,y.iv()):i(function(){y._94I()},uk)}},z._92I=function(){var M=this,m=M._28I;if(M._95O||!M._autoHideScrollBar){m||qr(M._79O,m=M._28I=rp());var P=M._29I,Z=P.width,H=M._91I,T=M.getScrollBarSize(),J=P.height-T-2,Q=Z*(-M.tx()/H),B=Z*(Z/H),x=m.style;H>Z?(qn>B&&(Q=Q+B/2-qn/2,0>Q&&(Q=0),Q+qn>Z&&(Q=Z-qn),B=qn),x.visibility=pl,x.background=M.getScrollBarColor(),x.borderRadius=T/2+Lf,Ji(m,Q,J,B,T)):x.visibility=Ie}else m&&(m.style.visibility=Ie)}}}),bh(Gn,$q(16,16,[{type:Ej,rect:[1,1,14,14],background:dr},{type:Vd,rect:[1,1,14,14],width:1,color:Oe},{type:Kn,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),bh(Xj,$q(16,16,{type:Vd,rect:[1,1,14,14],width:1,color:Oe})),bh(Gj,$q(16,16,[{type:Yl,rect:[2,2,12,12],borderWidth:1,borderColor:Oe,background:"#FFF"},{type:Yl,rect:[4,4,8,8],background:dr}])),bh(dg,$q(16,16,{type:Yl,rect:[2,2,12,12],borderWidth:1,borderColor:Oe})),$r._15Q=function(V){V._29I=Wi,V._59I=0,V._91I=0,V._5o=function(a){var f=this;f._30I=new _e,f._rows=new _e,f._rowMap={},f._31I=0,f._14I=0,f._view=sm(1,f),f._canvas=ib(f._view),qr(f._view,f._79O=rp()),f.dm(a?a:new ss)},V.getCheckIcon=function(a){var q=this.sm(),g=q.co(a);return q.sg()?Hi(g?Gj:dg):Hi(g?Gn:Xj)},V.checkData=function(M){var a=this.sm(),h=a.co(M);a.sg()&&h||(this._32o=1,h?a.rs(M):a.as(M),delete this._32o)},V.getDataAt=function(H){H.target&&(H=this.lp(H));var F=R(H.y/this._rowHeight),w=this._rows;return 0>F||F>=w.size()?u:w.get(F)},V.onDataDoubleClicked=function(){},V.onDataClicked=function(){},V.adjustTranslateX=function(){return 0},V.adjustTranslateY=function(G){var R=this.getHeight()-this._59I;return R>G&&(G=R),G>0?0:w(G)},V.onPropertyChanged=function(K){var q=this,x=K.property;cq[x]?q.ivm():pr[x]||q.redraw(),x===$k?q._42o():x===jg&&q._43o()},V.getLabel=function(T){return T.toLabel()},V.getLabelFont=function(){return this._labelFont},V.getLabelColor=function(t){var W=this;if(W.isCheckMode()){if(W._focusData===t)return W._labelSelectColor}else if(W.isSelected(t))return W._labelSelectColor;return W._labelColor},V.getStartRowIndex=function(){return this._31I},V.getEndRowIndex=function(){return this._14I},V.getRowDatas=function(){return this._rows},V.getRowIndex=function(V){return this._rowMap[V._id]},V.getRowSize=function(){return this._rows.size()},V.getViewRect=function(){return Qb(this._29I)},V.isVisible=function(z){return this._visibleFunc?this._visibleFunc(z):!0},V.getCurrentSortFunc=function(){return this._sortFunc},V.setDataModel=function(u){var Q=this,K=Q._dataModel,i=Q._selectionModel;K!==u&&(K&&(K.umm(Q.handleDataModelChange,Q),K.umd(Q.handleDataPropertyChange,Q),K.umh(Q.handleHierarchyChange,Q),i||K.sm().ums(Q.handleSelectionChange,Q)),Q._dataModel=u,u.mm(Q.handleDataModelChange,Q),u.md(Q.handleDataPropertyChange,Q),u.mh(Q.handleHierarchyChange,Q),i?i._21I(u):u.sm().ms(Q.handleSelectionChange,Q),Q.fp("dataModel",K,u))},V.validateModel=function(){var H=this;H._rows.clear(),H._rowMap={},H.buildChildren(H._dataModel._roots);var P=H._rows=H._rows.toList(H.isVisible,H),D=0,G=H.getCurrentSortFunc(),L=P.size();for(G&&P.sort(G);L>D;D++)H._rowMap[P.get(D)._id]=D},V.buildChildren=function(y){var $=this;y.each(function(b){$._rows.add(b),$.buildChildren(b._children)})},V.handleDataModelChange=function(){this.ivm()},V.handleDataPropertyChange=function(S){"parent"===S.property?this.ivm():this.invalidateData(S.data)},V.handleHierarchyChange=function(){this.ivm()},V.handleSelectionChange=function(D){D.datas.each(this.invalidateData,this),this.onSelectionChanged(D)},V.onSelectionChanged=function(O){var G=this,w=G.sm();!G.isAutoMakeVisible()||1!==w.size()||"set"!==O.kind&&"append"!==O.kind||G._32o||G.makeVisible(w.ld())},V.handleBackgroundClick=function(h){js(h)&&!this.isCheckMode()&&this.sm().cs()},V.makeVisible=function(X){X&&(this._23I=X,this.iv())},V.scrollToIndex=function(I){var A=this,U=A._29I,s=U.height,L=A._rowHeight,Z=L*I;I>=0&&I<A._rows.size()&&s>0&&(Z+L>U.y+s?A.ty(-Z+s-L):Z<U.y&&A.ty(-Z))},V.autoScroll=function(r,B){var k=this,j=k._rowHeight,o=j,J=j/4,R=k._29I,Y=k.lp(r),_={x:k.tx(),y:k.ty()};return j>0&&R&&(Y.x-R.x<o?k.translate(J,0):R.x+R.width-Y.x<o&&k.translate(-J,0),Y.y-R.y<o?k.translate(0,J):R.y+R.height-Y.y<o&&k.translate(0,-J)),_.x=k.tx()-_.x,_.y=k.ty()-_.y,B&&(B.x+=_.x,B.y+=_.y),_},V.getTopRowOrderSelection=function(){var F=this.sm().getTopSelection(),W={},$=new _e;return F.each(function(c){W[c._id]=c}),this._rows.each(function(d){W[d._id]&&$.add(d)}),$},V.getRowOrderSelection=function(){var s=new _e;return this._rows.each(function(O){this.isSelected(O)&&s.add(O)},this),s},V.ivm=function(){this.invalidateModel()},V.invalidateModel=function(){var i=this;i._96I||(i._96I=1,i._32I=1,delete i._24I),i.iv()},V.redraw=function(){var H=this;H._32I||(H._32I=1,delete H._24I,H.iv())},V.invalidateData=function(a){var Y=this;zj?Y.redraw():Y._32I||(Y._24I||(Y._24I={}),Y._24I[a._id]=a,Y.iv())},V.getFocusData=function(){return this._focusData},V.setFocusDataById=function(q){this.setFocusData(this.dm().getDataById(q))},V.setFocusData=function(A){var s=this,S=s._focusData;S!==A&&(s._focusData=A,s.fp("focusData",S,A),S&&s.invalidateData(S),A&&(s.invalidateData(A),s.isAutoMakeVisible()&&s.makeVisible(A)))},V.drawRowBackground=function(q,d,c,T,H,k,P){var L=this,r=L.isCheckMode();(d===L._focusData&&r||c&&!r)&&On(q,T,H,k,P,L.getSelectBackground(d))},V.drawData=function(j,f,A){var q=this,D=q._rowHeight,C=D*A,z=q._29I,k=z.x,c=z.width;j.save(),j.beginPath(),j.rect(k,C,c,D),j.clip(),q._87o(q.drawRow(j,f,q.isSelected(f),k,C,c,D),A,k,C,c,D),j.restore(),q._rowLineVisible&&On(j,k,C+D-1,c,1,q._rowLineColor)},V._12I=function(E){var j=this,G=j._31I,F=j._29I,u=F.x,t=F.y,c=F.width,d=F.height;for(E.beginPath(),E.rect(u,t,c,d),E.clip(),E.clearRect(u,t,c,d),j._76o(),j._93db(E);G<j._14I;G++)j.drawData(E,j._rows.get(G),G);j._92db(E)},V._13I=function(W){for(var _,t=this,j=t._rowHeight,o=t._29I,m=o.x,f=o.width,C=t._31I,r=t._30I;C<t._14I;C++)_=t._rows.get(C),t._24I[_._id]&&r.add({data:_,index:C});r.isEmpty()||(W.beginPath(),r.each(function(K){W.rect(m,K.index*j,f,j)}),W.clip(),r.each(function(b){W.clearRect(m,b.index*j,f,j)}),r.each(function(h){t._77o(h.index)}),t._93db(W),r.each(function(V){t.drawData(W,V.data,V.index)}),t._92db(W),r.clear())},V.preValidateModel=function(){this.endEditing&&this.endEditing()},V.validateImpl=function(){var b=this,w=b._canvas,I=b.getWidth(),H=b.getHeight(),B=b._rowHeight,v=b._32I;(I!==w.clientWidth||H!==w.clientHeight)&&(Up(w,I,H),v=1);var z=O&&!P;b._96I&&!z&&(b.preValidateModel(),b.validateModel());var T=b._29I,r={x:-b.tx(),y:-b.ty(),width:I,height:H},F=b._rows.size(),A=Cp(w),y=b._23I;v||Me(r,T)||(v=1),b._29I=r,b._59I=F*B+b.getScrollBarSize(),b._31I=R(r.y/B),b._14I=n((r.y+r.height)/B),b._31I<0&&(b._31I=0),b._14I>F&&(b._14I=F),b._99I&&v&&b._99I(),er(A,b.tx(),b.ty(),1),v?b._12I(A):b._24I&&b._13I(A),b._93I(),b._92I(),A.restore(),b._32I=b._24I=b._96I=u,y&&(b.scrollToIndex(b.getRowIndex(y)),delete b._23I),b.tx(b.tx()),b.ty(b.ty())}},$r._48o=function(o){o._rootVisible=!0,o._rootData=u,o._35o=function(){this._expandMap={},this._levelMap={}},o.validateModel=function(){var A=this,X=A._rootData;A._rows.clear(),A._levelMap={},A._rowMap={},A._currentLevel=0,X?A._rootVisible?A.isVisible(X)&&A.buildData(X):A.buildChildren(X):A.buildChildren(),delete A._currentLevel},o.buildData=function(x){var s=this,Z=x._id,e=s._rows;s._rowMap[Z]=e.size(),e.add(x),s._levelMap[Z]=s._currentLevel,s.isExpanded(x)&&(s._currentLevel++,s.buildChildren(x),s._currentLevel--)},o.buildChildren=function(L){var E=this,s=L?L._children:E._dataModel._roots,y=E.getCurrentSortFunc();y&&E.isChildrenSortable(L)?s.toList(E.isVisible,E).sort(y).each(E.buildData,E):s.each(function(g){E.isVisible(g)&&E.buildData(g)})},o.getLevel=function(C){return this._levelMap[C._id]},o.getToggleIcon=function(t){var $=this,e=$._loader,F=$._collapseIcon;return e&&!e.isLoaded(t)?F:t.hasChildren()?$.isExpanded(t)?$._expandIcon:F:u},o.isCheckMode=function(){return this._checkMode!=u},o.isChildrenSortable=function(){return!0},o.handleDataModelChange=function($){var q=this;$.kind===tp?delete q._expandMap[$.data._id]:$.kind===Ch&&(q._expandMap={}),q.ivm()},o.toggle=function(j){var D=this;D.isExpanded(j)?D.collapse(j):D.expand(j)},o.isExpanded=function(f){return 1===this._expandMap[f._id]},o.expand=function(N){var $=this,e=$._loader;$.isExpanded(N)||(e&&!e.isLoaded(N)&&e.load(N),$._expandMap[N._id]=1,$.ivm(),$.onExpanded(N))},o.onExpanded=function(){},o.collapse=function(g){var N=this;N.isExpanded(g)&&(delete N._expandMap[g._id],N.ivm(),N.onCollapsed(g))},o.onCollapsed=function(){},o.expandAll=function(u){if(u)this.expand(u),u.eachChild(function(z){this.expandAll(z)},this);else{var I=this;I._dataModel.each(function(b){b.hasChildren()&&(I._expandMap[b._id]=1)}),I.ivm()}},o.collapseAll=function(){this._expandMap={},this.ivm()},o.makeVisible=function(F){if(F){var Z=this;if(!Z._rootData||F.isDescendantOf(Z._rootData)){for(var D=F._parent;D;)Z.expand(D),D=D._parent;Z._23I=F,Z.iv()}}},o.checkData=function(b){var N,I=this,x=I._checkMode,l=I.sm(),j=l.co(b);if(!l.sg()||!j){if(I._32o=1,x===fk)j?l.rs(b):l.as(b);else if(x===vc)N=new _e(b),N.addAll(b._children);else if("descendant"===x)N=new _e,Vr(b,N);else if("all"===x&&(N=new _e,Vr(b,N),!j))for(var t=b._parent;t;)N.add(t),t=t._parent;N&&(j?l.rs(N):l.as(N)),delete I._32o}},o._97I=function(N,R,o,f,U,$,B){var c=this,e=c._indent,a=c._levelMap[R._id],P=c.getIconWidth(R),s=Hi(c.getToggleIcon(R));s?(f+=e*a,Xh(N,s,f+e/2,U+B/2,R,c),f+=e):f+=e*(a+1),c._checkMode&&(Xh(N,c.getCheckIcon(R),f+e/2,U+B/2,R,c),f+=e),c.drawIcon(N,R,f,U,P,B),c.drawLabel(N,R,f+P,U,B)}},$r._14Q=function(M){M.getIcon=function(u){return u.getIcon()},M.getIconWidth=function(X){return this.getIcon(X)?this._indent:0},M.drawIcon=function(d,m,J,D,F,A){if(F){var Q=this,f=Q.getBodyColor(m),G=Hi(Q.getIcon(m),f);G&&(A-=Q.isRowLineVisible()?1:0,fh(d,G,zs,J,D,F,A,m,Q,f),ti(d,Q.getBorderColor(m),J,D,F,A))}},M.drawLabel=function(B,i,A,r,O){var q=this;gi(B,q.getLabel(i),q.getLabelFont(i),q.getLabelColor(i),A,r,0,O)}},$r._50o=function(i){i._98I=function(){var M=this,E=M._39o=new ss;M._60I=new _e,E.mm(M._17o,M),E.md(M._18o,M),E.mh(M._19o,M)},i.setColumns=function(c){this._39o.clear(),this.addColumns(c)},i.addColumns=function(m){var H=this._39o;m.forEach(function($){if(!($ instanceof _g)){var Q=Ff($.className);$=xo(Q?Q:_g,$)}H.add($)})},i.onColumnClicked=function(){},i.onCheckColumnClicked=function(){},i._3Q=function(H){for(var w,P=0,F=this._60I,G=F.size();G>P;P++)if(w=F.get(P),w.column===H)return w;return u},i.getColumnAt=function(c){var X=this._4Q(c);return X?X.column:u},i._4Q=function(l){for(var H=this,k=l.target?H.lp(l).x:l.x,J=H._60I,O=0;O<J.size();O++){var I=J.get(O),i=I.startX;if(k>=i&&k<i+I.column.getWidth())return I}return u},i.getToolTip=function(d){var F=this,V=F.getDataAt(d),B=F.getColumnAt(d);return V&&B?B.getToolTip(V,F):u},i.adjustTranslateX=function(X){var k=this.getWidth()-this._91I;return k>X&&(X=k),X>0?0:w(X)},i._99I=function(){var b=this,A=b._29I,B=b._60I;B.clear(),b._91I=0,b._39o._roots.each(function(K){if(K.isVisible()){var e=b._91I+K.getWidth();b._91I<=A.x+A.width&&e>=A.x&&B.add({column:K,startX:b._91I}),b._91I=e}}),b._91I+=b.getScrollBarSize()},i.drawData=function(S,V,u){var l=this,W=l._rowHeight,M=W*u,t=l.isSelected(V),N=l._29I,w=N.x,s=N.width;l.drawRowBackground(S,V,t,w,M,s,W),l._60I.each(function(Y){var z=Y.column,N=Y.startX,O=z.getWidth();O>0&&!l.isEditing(V,z)&&(S.save(),S.beginPath(),S.rect(N,M,O,W),S.clip(),l._87o(l.drawCell(S,V,t,z,N,M,O,W),u,N,M,O,W),l._columnLineVisible&&On(S,N+O-1,M,1,W,l._columnLineColor),S.restore())}),l._rowLineVisible&&On(S,w,M+W-1,s,1,l._rowLineColor)},i.drawCell=function(q,l,b,f,O,w,J,m){var A=this;if(f.drawCell)return f.drawCell(q,l,b,f,O,w,J,m,A);var z=A.getValue(l,f);vb(q,z,f,A.getLabelFont(l,f,z),A.getLabelColor(l,f,z),O,w,J,m,l,A)},i.getColumnModel=function(){return this._39o},i._17o=function(){this.redraw()},i._18o=function(f){var c=this;f.data===c._sortColumn&&wc[f.property]?c.ivm():(c._42o(),c.redraw())},i._19o=function(){this.redraw()},i.getCurrentSortFunc=function(){var $=this,D=$._sortColumn;if(D&&D.isSortable()){var b=D.getSortFunc(),G=mj===D.getSortOrder()?1:-1;return b||(b=hi),function(U,H){return b.call($,$.getValue(U,D),$.getValue(H,D),U,H)*G}}return $._sortFunc},i.isCellEditable=function($,S,x){return S.isEditable()&&this.isEditable()?S.isCellEditable?S.isCellEditable($,S,x,this):!0:!1},i._37O=function(w,e){if(js(e))for(var S=this,Y=S.lp(e),F=S._60I,$=S._rowHeight,k=S._29I,s=k.x,d=k.y,W=k.width,x=k.height,H=0;H<F.size();H++){var Z=F.get(H),o=Z.startX,h=Z.column,b=h.getWidth();if(h!==S._31o&&h!==S._4o&&Y.x>=o&&Y.x<o+b&&S.isCellEditable(w,h,e)){var g={x:o,y:S.getRowIndex(w)*$,width:b,height:$},v={x:g.x+S.tx(),y:g.y+S.ty(),width:g.width,height:g.height},t=0,X=0;return g.x<s?t=g.x-s:g.x+g.width>s+W&&(t=g.x+g.width-s-W),t&&(S.tx(S.tx()-t),v.x-=t),g.y<d?X=g.y-d:g.y+$>d+x&&(X=g.y+$-d-x),X&&(S.ty(S.ty()-X),v.y-=X),S.beginEditing({data:w,column:h,value:S.getValue(w,h),event:e,rect:g,editorRect:v,view:S}),void 0}}}},Qq.BaseItemEditor=function(m,V,D,w){this._data=m,this._column=V,this._master=D,this._editInfo=w},_o("BaseItemEditor",b,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var $b=X.Tab=function(){ef($b,this)};lp("Tab",lc,{ms_ac:["view","closable","disabled","visible"],_icon:u,_closable:!1,_disabled:!1,_visible:!0,setParent:Dq});var _g=X.Column=function(){ef(_g,this)};lp("Column",lc,{_46o:1,ms_ac:["accessType","valueType",pl,ll,Yd,ir,"align",El,"sortOrder",Kj,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:mj,_sortFunc:u,_sortable:!0,_clickable:!0,setWidth:function(c){16>c&&(c=16);var P=this._width;this._width=c,this.fp(ir,P,c)},getToolTip:function($,P){return this.formatValue(P.getValue($,this))}});var il=X.Property=function(){ef(il,this)};lp("Property",lc,{_46o:1,ms_ac:["accessType","valueType",ll,Yd,"categoryName",El,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:u,getToolTip:function(f,Z,P){var G=this;return Z?G.formatValue(P.getValue(f,G)):P.getPropertyName(G)}}),Qq.AccordionView=function(){var e=this;e._20o={},e._21o=new _e,e._10o=u,e._9o=u,e._11o=u,e._view=sm(0,e),e.iv()},_o("AccordionView",b,{ms_v:1,ms_fire:1,ms_ac:[Dr,cs,"titleHeight",fd,nj,"titleBackground","selectWidth",Fc,"orientation","separatorColor"],_expandIcon:U.accordionViewExpandIcon,_collapseIcon:U.accordionViewCollapseIcon,_titleHeight:zl,_labelColor:U.accordionViewLabelColor,_labelFont:U.accordionViewLabelFont,_titleBackground:U.accordionViewTitleBackground,_selectBackground:U.accordionViewSelectBackground,_selectWidth:U.accordionViewSelectWidth,_orientation:"v",_separatorColor:U.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(i,U,F,v){var B=this,m=rp();if(B._20o[i])throw i+" already exists";m.onmousedown=wb,m.style.cursor=bf,m.addEventListener(je?ks:zb,function(C){wb(C)},V),m.addEventListener(je?uo:Xe,function(r){wb(r),js(r)&&(B._10o===i?B.collapse():B.expand(i))},V),qr(B._view,m),B._20o[i]={content:U,div:m,canvas:ib(m),icon:v},B._21o.add(i),F&&B.expand(i),B.iv()
},remove:function(U){var y=this,V=y._20o[U];V&&(mp(V.div),delete y._20o[U],y._21o.remove(U),y.iv())},clear:function(){var J=this;J._21o.toArray().forEach(J.remove,J),J._20o={},J._21o.clear(),J.iv()},isExpanded:function($){return this._10o===$},expand:function(Z){var N=this;N._20o[Z]&&N._10o!==Z&&(N._10o=Z,N.onExpanded(Z),N.iv())},onExpanded:function(){},collapse:function(){var c=this;c._10o&&(c.onCollapsed(c._10o),delete c._10o,c.iv())},onCollapsed:function(){},initCanvas:function(e,w,v){Up(e,w,v);var $=Cp(e);return er($,0,0,1),$.clearRect(0,0,w,v),$},drawTitle:function(l,O,q,F,t){var h=this,L=Hi(t.icon),J=h.isExpanded(O),g=h._titleHeight,p=h._titleBackground,U=h._selectWidth,v=h._separatorColor,u=Hi(J?h._expandIcon:h._collapseIcon),A=U+4;On(l,0,0,q,F,p),J&&U&&On(l,0,0,U,F,h._selectBackground),(J||h._21o.get(h._21o.size()-1)!==O)&&On(l,0,F-1,q,1,v?v:Xm(p)),L&&(Xh(l,L,A+Bp(L)/2,g/2),A+=Bp(L)+2),gi(l,O,h.getLabelFont(O),h.getLabelColor(O),A,0,0,g),u&&Xh(l,u,q-Bp(u)/2-4,g/2)},validateImpl:function(){var u=this,q=u._view,n=0,Q=0,t=u.getWidth(),w=u.getHeight(),d=u._titleHeight,W=u._21o.size()*d,P=u._11o,H=u._9o;delete u._11o,delete u._9o,u._21o.each(function($){var Z,P,b=u._20o[$],s=b.content,R=u._10o===$;lo(u)?(Ji(b.div,n,0,d,w),Z=u.initCanvas(b.canvas,d,w),vk(Z,0,w),ts(Z,-N),u.drawTitle(Z,$,w,d,b),Z.restore(),R?(P=l(0,t-W),s&&(u._11o=s,u._9o=uf(s),Ji(s,n+d,0,P,w)),n+=d+P):n+=d):(Ji(b.div,0,Q,t,d),Z=u.initCanvas(b.canvas,t,d),u.drawTitle(Z,$,t,d,b),Z.restore(),R?(P=l(0,w-W),s&&(u._11o=s,u._9o=uf(s),Ji(s,0,Q+d,t,P)),Q+=d+P):Q+=d)});var x=u._9o;P&&P!==u._11o&&P.endEditing&&P.endEditing(),x&&x!==H&&qr(q,x),H&&H!==x&&mp(H)}}),Qq.SplitView=function(d,A,b,O){var R=this,k=R._dividerDiv=rp(),n=R._60O=ib(),e=R._61O=ib(),I=n.style,x=e.style;R._view=sm(1,R),qr(R._view,k),I.msTouchAction=qf,I.pointerEvents=qf,I.cursor=bf,x.msTouchAction=qf,x.pointerEvents=qf,x.cursor=bf,d&&R.setLeftView(d),A&&R.setRightView(A),b&&R.setOrientation(b),O!=u&&R.setPosition(O),R.setStatus(Mn),new Oo(R)},_o("SplitView",b,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:U.splitViewDividerSize,_dividerBackground:U.splitViewDividerBackground,_dragOpacity:U.splitViewDragOpacity,_toggleIcon:U.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function($,x){var z=this,O=z._position;isNaN($)||(x||(z._82O=0>$?-1:$>1?1:0),z._position=$,z.fp(Xl,O,$))},getLeftView:function(){return this._leftView},setLeftView:function(D){var X=this,N=X._leftView,I=X._view;if(X._leftView!==D){if(N&&N!==X._rightView){var o=uf(N);o.parentNode===I&&mp(o)}if(X._leftView=D,D){var f=uf(D);f.parentNode!==I&&I.insertBefore(f,X._dividerDiv)}X.fp("leftView",N,D)}},getRightView:function(){return this._rightView},setRightView:function(l){var N=this,t=N._rightView,w=N._view;if(N._rightView!==l){if(t&&t!==N._leftView){var X=uf(t);X.parentNode===w&&mp(X)}if(N._rightView=l,l){var f=uf(l);f.parentNode!==w&&w.insertBefore(f,N._dividerDiv)}N.fp("rightView",t,l)}},validateImpl:function(){var U=this,H=U._draggable,D=U._position,W=U.getWidth(),a=U.getHeight(),j=U._dividerSize,T=U._dividerBackground,K=je?18:8,Z=U._dividerDiv,J=U._82O,F=U._60O,o=U._61O,p=U._toggleIcon,V=U._status,n=Z.style,$=null,z=je?20:4,b=p.comps[0];j>=K||0===j?U._coverDiv&&(mp(U._coverDiv),delete U._coverDiv):U._coverDiv||(U._coverDiv=rp(),q&&(U._coverDiv.style.background=Go),qr(Z,U._coverDiv)),U._togglable?F.parentNode||(qr(Z,F),qr(Z,o)):(mp(F),mp(o));var v=U._coverDiv,r=U._leftView,_=U._rightView;if(lo(U)){if(j>W&&(j=W),V===Mn)if(1===J)var f=I(D,W),C=l(0,W-j-f);else-1===J?(C=I(-D,W),f=l(0,W-j-C)):(f=w((W-j)*D),C=l(0,W-j-f));else"cl"===V?(f=0,C=l(0,W-j)):"cr"===V&&(C=0,f=l(0,W-j));r&&Ji(r,0,0,f,a),_&&Ji(_,f+j,0,C,a),Ji(Z,f,0,j,a),U._22o=f,v&&(Ji(v,j/2-K/2,0,K,a),v.style.cursor=H?Bn:""),Z.style.cursor=H?Bn:"";var G=Z.clientHeight/2,P=Z.clientWidth;Up(F,P,P),Ji(F,0,G-P-z,P,P),$=Cp(F),er($,0,0,1),b.rotation=-N,Fp($,p,0,0,P,P),$.restore(),Up(o,P,P),Ji(o,0,G+z,P,P),$=Cp(o),er($,0,0,1),b.rotation=N,Fp($,p,0,0,P,P),$.restore()}else{if(j>a&&(j=a),V===Mn)if(1===J)var m=I(D,a),u=l(0,a-j-m);else-1===J?(u=I(-D,a),m=l(0,a-j-u)):(m=w((a-j)*D),u=l(0,a-j-m));else"cl"===V?(m=0,u=l(0,a-j)):"cr"===V&&(u=0,m=l(0,a-j));r&&Ji(r,0,0,W,m),_&&Ji(_,0,m+j,W,u),Ji(Z,0,m,W,j),U._22o=m,v&&(Ji(v,0,j/2-K/2,W,K),v.style.cursor=H?pe:""),n.cursor=H?pe:"";var Y=Z.clientWidth/2,P=Z.clientHeight;Up(F,P,P),Ji(F,Y-P-z,0,P,P),$=Cp(F),er($,0,0,1),b.rotation=0,Fp($,p,0,0,P,P),$.restore(),Up(o,P,P),Ji(o,Y+z,0,P,P),$=Cp(o),er($,0,0,1),b.rotation=y,Fp($,p,0,0,P,P),$.restore()}n.background=T}});var Oo=function(X){this.sv=X,this.addListeners()};xk(Oo,b,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(g){var H=this,M=H.sv,w=M._dividerDiv,e=M._60O,j=M._61O,k=M._status,U=g.target;if(U===e)k===Mn?M.setStatus("cl"):"cr"===k&&M.setStatus(Mn);else if(U===j)k===Mn?M.setStatus("cr"):"cl"===k&&M.setStatus(Mn);else if(dc(g)&&(U===w||U===M._coverDiv)&&(wb(g),M.isDraggable())){M.getLeftView(),M.getRightView();var D=H.maskDiv=rp();if(D.style.left=0,D.style.top=0,D.style.width=M.getWidth()+"px",D.style.height=M.getHeight()+"px",M.getView().appendChild(D),!M.isContinuousLayout()){var x=H.resizeDiv=rp();x.style.left=w.style.left,x.style.top=w.style.top,x.style.width=w.style.width,x.style.height=w.style.height,x.style.opacity=M.getDragOpacity(),x.style.background=M.getDividerBackground(),qr(H.getView(),x)}H._lastAbsPosition=M._22o,H._86o=lo(M)?Jl(g).x:Jl(g).y,Te(H,g)}},handleWindowTouchMove:function(P){dc(P)&&this.update(P,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(h){var i=this;i.update(h,!0),i.sv.setStatus(Mn),i.maskDiv&&mp(i.maskDiv),i.resizeDiv&&mp(i.resizeDiv),i.maskDiv=i.resizeDiv=u},handle_mousedown:function(Y){js(Y)&&this.handle_touchstart(Y)},handleWindowMouseMove:function(p){this.handleWindowTouchMove(p)},handleWindowMouseUp:function(O){this.handleWindowTouchEnd(O)},update:function(O,p){var U=this,f=U.sv,M=lo(f)?f.getWidth():f.getHeight(),I=f._dividerSize,e=U._lastAbsPosition-U._86o;lo(f)?(e+=Jl(O).x,e>M-I&&(e=M-I),0>e&&(e=0),U.resizeDiv&&(U.resizeDiv.style.left=e+Lf)):(e+=Jl(O).y,e>M-I&&(e=M-I),0>e&&(e=0),U.resizeDiv&&(U.resizeDiv.style.top=e+Lf)),p&&M!==I&&(1===f._82O?f.setPosition(e,1):-1===f._82O?f.setPosition(e-M+I,1):f.setPosition(e/(M-I),1))}}),Qq.TabView=function(){var O=this,Z=O._view=sm(1,O),b=O._91O=rp(1),z=O._tabModel=new ss,r=z.sm(),M=O.invalidate;O._7o=new _e,O._canvas=ib(b),qr(Z,b),qr(Z,O._92O=rp(1)),r.setSelectionMode(sr),r.ms(O.handleSelectionChange,O),z.mm(M,O),z.mh(M,O),z.md(M,O),O._interactor=new ri(O),O.iv()},_o("TabView",b,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",fd,nj,"tabBackground","selectWidth",Fc,"moveBackground","insertColor"],_tabPosition:hk,_tabHeight:zl,_tabGap:U.tabViewTabGap,_labelColor:U.tabViewLabelColor,_labelFont:U.tabViewLabelFont,_tabBackground:U.tabViewTabBackground,_selectWidth:U.tabViewSelectWidth,_selectBackground:U.tabViewSelectBackground,_moveBackground:U.tabViewMoveBackground,_insertColor:U.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(s,R,H){var z,A=this._tabModel;return s instanceof $b?(z=s,R&&z.setView(R)):(z=new $b,z.setName(s),z.setView(R)),A.add(z),H&&A.sm().ss(z),z},getLabel:function(k){return k.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(F){this._23o=F,this.iv()},get:function(D){var S=this,t=S._tabModel;if(Pr(D))return t._roots.get(D);if(Bs(D)){var A;return t.each(function(H){D===S.getLabel(H)&&(A=H)}),A}return D instanceof $b?D:u},select:function(C){this._tabModel.sm().ss(this.get(C))},remove:function(H){var M=this;if(H=M.get(H)){var n=M._tabModel,S=n._roots.indexOf(H);M._tabModel.remove(H),M.selectByIndex(--S)}},getCurrentTab:function(){return this._8o},hideTabView:function(H,R){R.parentNode===this._92O&&(Oh(R)?(R.style.display=mg,R._tab_=H):mp(R),rk())},showTabView:function(Z,l){Oh(l)&&(l.style.display="block",l._tab_=Z),l.parentNode!==this._92O&&(qr(this._92O,l),rk())},_24o:function(){var O,d=this,E=d._8o,I=d._9o,s=d._tabModel.sm().ld();s&&(O=uf(s.getView())),O!==I&&(I&&(E.getView()&&E.getView().endEditing&&E.getView().endEditing(),d.hideTabView(E,I)),O&&d.showTabView(s,O)),d._8o=s,d._9o=O,E!==s&&d.onTabChanged(E,s)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(n,D){this.selectByIndex(--D)},selectByIndex:function(G){var p=this,e=p._tabModel,R=e.size();if(R&&!e.sm().ld()){G==u&&(G=0),G>=R&&(G=R-1),0>G&&(G=0);for(var w=G;w>=0;w--){var T=p.get(w);if(!T.isDisabled())return p.select(T),T}for(w=G+1;R>w;w++)if(T=p.get(w),!T.isDisabled())return p.select(T),T}},getTabWidth:function(d){var q=4,y=Hi(d.getIcon());y&&(q+=Bp(y,d)+4);var H=this.getLabel(d);return H&&(q+=Nh(this.getLabelFont(d),H).width+4),d.isClosable()&&(q+=10),q},drawTab:function(A,K,x,B,v,k,m){var d,X=this,g=X._tabPosition,Y=x+4,n=X._selectWidth,L=Hi(K.getIcon()),I=K.isDisabled(),R=X.getLabelColor(K),f=X.getLabelFont(K),F=X.getLabel(K),l=X._selectBackground,W=g===nk+"-vertical",D=g===yq+"-vertical";(W||D)&&(Y=B+4),I&&(A.globalAlpha=id),On(A,x,B,v,k,m),K===X._8o&&n&&(g===hk?On(A,x,B+k-n,v,n,l):g===nk?On(A,x+v-n,B,n,k,l):g===yq?On(A,x,B,n,k,l):W?On(A,x+v-n,B,n,k,l):D?On(A,x,B,n,k,l):On(A,x,B,v,n,l));var o=v/2;if(W&&(vk(A,o,B+k/2),ts(A,y),vk(A,-o,-B-k/2)),L){var M=Fd(L,K),$=Bp(L,K);if(W||D){var H=x+v/2,i=Y+M/2;vk(A,H,i),ts(A,N),vk(A,-H,-i),Xh(A,L,x+v/2,Y+M/2,K,X),vk(A,H,i),ts(A,-N),vk(A,-H,-i),Y+=M+4}else Xh(A,L,Y+$/2,B+k/2,K,X),Y+=$+4}return W||D?(vk(A,v/2,Y+v/2),ts(A,N),vk(A,-v/2,-Y-v/2),gi(A,F,f,R,x,Y,k,v),vk(A,v/2,Y+v/2),ts(A,-N),vk(A,-v/2,-Y-v/2)):gi(A,F,f,R,Y,B,v,k),W&&(vk(A,o,B+k/2),ts(A,-y),vk(A,-o,-B-k/2)),K.isClosable()&&(d=D?{x:x+v-12,y:B+k-12,width:12,height:12}:{x:x+v-12,y:B+2,width:12,height:12},this.drawCloseIcon(K,A,R,d)),I&&(A.globalAlpha=1),d},drawCloseIcon:function(L,B,h,x){var D=x.x,U=x.y;B.strokeStyle=h,B.lineWidth=1,B.beginPath(),B.moveTo(D+2,U+8),B.lineTo(D+8,U+2),B.moveTo(D+8,U+8),B.lineTo(D+2,U+2),B.stroke()},getTabAt:function(B){var j=this._interactor._8Q(B);return j?j.tab:null},validateImpl:function(){var R=this;R._24o();var X,L=R._canvas,y=R._tabPosition,t=R._91O,D=R._92O,H=R._tabModel,a=R.getWidth(),E=R.getHeight(),G=R._tabHeight,u=R._7o,m=R._tabGap,Z=y===hk,k=y===nk,g=y===yq,W=y===nk+"-vertical",o=y===yq+"-vertical",K=R._23o,F=0;if((k||g)&&H._roots.each(function(U){F=l(R.getTabWidth(U),F)}),Z?(Ji(t,0,0,a,G),X={x:0,y:G,width:a,height:l(0,E-G)}):k?(Ji(t,0,0,F,E),X={x:F,y:0,width:l(0,a-F),height:E}):g?(Ji(t,a-F,0,F,E),X={x:0,y:0,width:l(0,a-F),height:E}):W?(Ji(t,0,0,G,E),X={x:G,y:0,width:l(0,a-G),height:E}):o?(Ji(t,a-G,0,G,E),X={x:0,y:0,width:l(0,a-G),height:E}):(Ji(t,0,E-G,a,G),X={x:0,y:0,width:a,height:l(0,E-G)}),Ji(D,X),W||o){R._9o&&(X.x=0,Ji(R._8o.getView(),X)),Up(L,G,E);var T=Cp(L),U=0;if(er(T,0,R.ty(),1),T.clearRect(0,0,G,E),u.clear(),H._roots.each(function(B){if(B.isVisible()){var s,$=R.getTabWidth(B);K&&K.tab===B||(s=R.drawTab(T,B,0,U,G,$,R._tabBackground)),u.add({_75o:s,tab:B,startY:U,endY:U+$,height:$}),U+=$+m}}),R._23Q=l(0,U-m),K){var n=K.position;R.drawTab(T,K.tab,0,K.startY,G,K.height,R._moveBackground),On(T,0,n,G,1,R._insertColor)}if(T.restore(),R._selectionChanged){R._selectionChanged=!1;for(var $=R.ty(),M=0;M<u.size();M++){var e=u.get(M);if(e.tab===R._8o){if(e.endY+$<0){R.ty(-e.startY);break}if(e.startY+$>E){R.ty(E-e.endY);break}}}}R.ty(R.ty())}else if(k||g){R._9o&&(X.x=0,Ji(R._8o.getView(),X)),Up(L,F,E);var T=Cp(L),U=0;if(er(T,0,R.ty(),1),T.clearRect(0,0,F,E),u.clear(),H._roots.each(function(x){if(x.isVisible()){var v;K&&K.tab===x||(v=R.drawTab(T,x,0,U,F,G,R._tabBackground)),u.add({_75o:v,tab:x,startY:U,endY:U+G,height:G}),U+=G+m}}),R._23Q=l(0,U-m),K){var n=K.position;R.drawTab(T,K.tab,0,K.startY,F,K.height,R._moveBackground),On(T,0,n,F,1,R._insertColor)}if(T.restore(),R._selectionChanged){R._selectionChanged=!1;for(var $=R.ty(),M=0;M<u.size();M++){var e=u.get(M);if(e.tab===R._8o){if(e.endY+$<0){R.ty(-e.startY);break}if(e.startY+$>E){R.ty(E-e.endY);break}}}}R.ty(R.ty())}else{R._9o&&(X.y=0,Ji(R._8o.getView(),X)),Up(L,a,G);var T=Cp(L),x=0;if(er(T,R.tx(),0,1),T.clearRect(0,0,a,G),u.clear(),H._roots.each(function(f){if(f.isVisible()){var d,Q=R.getTabWidth(f);K&&K.tab===f||(d=R.drawTab(T,f,x,0,Q,G,R._tabBackground)),u.add({_75o:d,tab:f,startX:x,endX:x+Q,width:Q}),x+=Q+m}}),R._64I=l(0,x-m),K){var n=K.position;R.drawTab(T,K.tab,K.startX,0,K.width,G,R._moveBackground),Eo(T,R._insertColor,n,0,G)}if(T.restore(),R._selectionChanged){R._selectionChanged=!1;for(var _=R.tx(),M=0;M<u.size();M++){var e=u.get(M);if(e.tab===R._8o){if(e.endX+_<0){R.tx(-e.startX);break}if(e.startX+_>a){R.tx(a-e.endX);break}}}}R.tx(R.tx())}for(var P=[],f=D.children,M=0;M<f.length;M++){var i=f[M],z=i._tab_;z&&!H.contains(z)&&P.push(i)}P.forEach(function(K){D.removeChild(K)})}});var ri=function(G){this.tv=G,this.addListeners()};xk(ri,b,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(p){this.handleScroll(p,10*(p.wheelDelta/40))},handle_DOMMouseScroll:function(D){this.handleScroll(D,10*-D.detail)},handleScroll:function(w,D){wb(w);var K=this.tv,f=K._tabPosition;!K._40o()||f!==hk&&f!==nh||K.tx(this.tv.tx()+D),!K._41o()||f!==nk&&f!==yq&&f!==nk+"-vertical"&&f!==yq+"-vertical"||K.ty(this.tv.ty()+D)},_8Q:function(b){var B,x,G=this.tv,o=G._tabPosition,Z=G._7o;if(o===hk||o===nh){var I=G.lp(b).x;for(B=0;B<Z.size();B++)if(x=Z.get(B),x.startX<=I&&I<=x.endX)return x}else if(o===nk||o===yq||o===nk+"-vertical"||o===yq+"-vertical"){var N=G.lp(b).y;for(B=0;B<Z.size();B++)if(x=Z.get(B),x.startY<=N&&N<=x.endY)return x}return u},isClickable:function(F){var c=this.tv,e=c._tabPosition,k=this._73o=this._8Q(F);return!c._40o()||e!==hk&&e!==nh?!c._41o()||e!==nk&&e!==yq&&e!==nk+"-vertical"&&e!==yq+"-vertical"?k&&(!k.tab.isDisabled()||c.isMovable()):!0:!0},handle_mousemove:function($){var w=this;eg?w._74o=w._8Q($):w.getView().style.cursor=w.isClickable($)?bf:""},handle_mousedown:function(A){this.handle_mousemove(A),this.handle_touchstart(A)},handle_touchstart:function(e){var s=this,m=s.tv,a=m._tabPosition;wb(e),js(e)&&s.isClickable(e)&&(a===hk||a===nh?(s.x=Jl(e).x,s.lp=m.lp(e),s.tx=m.tx()):(s.y=Jl(e).y,s.lp=m.lp(e),s.ty=m.ty()),Te(s,e))},handleWindowMouseMove:function(P){this.handleWindowTouchMove(P)},handleWindowTouchMove:function(L){var v,d=this,u=d.tv,X=u._tabPosition,s=d._73o;if(X===hk||X===nh){if(v=Jl(L).x-d.x,!d._25o&&!d.moving&&k(v)>2&&(u._40o()&&!Be(L)?d._25o=1:s&&u.isMovable()&&(d.moving=1)),d._25o)u.tx(d.tx+v);else if(d.moving){var a=d.lp.x+v,t=u._tabGap/2;u._7o.each(function(E){var i=E.endX,A=a-E.startX<i-a;a>=E.startX&&i>=a&&u._7Q({tab:s.tab,startX:s.startX+v,width:s.width,front:A,insertTab:E.tab,position:A?l(0,E.startX-t):I(u._64I,i+t)})})}}else if(v=Jl(L).y-d.y,!d._25o&&!d.moving&&k(v)>2&&(u._41o()&&!Be(L)?d._25o=1:s&&u.isMovable()&&(d.moving=1)),d._25o)u.ty(d.ty+v);else if(d.moving){var K=d.lp.y+v,t=u._tabGap/2;u._7o.each(function(B){var z=B.endY,$=K-B.startY<z-K;K>=B.startY&&z>=K&&u._7Q({tab:s.tab,startY:s.startY+v,height:s.height,front:$,insertTab:B.tab,position:$?l(0,B.startY-t):I(u._23Q,z+t)})})}},handleWindowMouseUp:function(I){this.handleWindowTouchEnd(I)},handleWindowTouchEnd:function(){var y=this,Y=y.tv,_=Y._tabPosition,H=Y.getTabModel(),j=H._roots,A=y._73o;if(y.moving){var X=Y._23o;if(X&&X.insertTab!==X.tab){var N=X.tab,g=j.remove(N),J=j.indexOf(X.insertTab);J>=0&&(X.front||J++,J<=j.size()&&(j.add(N,J),H._38I(N,g,J)))}Y._7Q(u),delete y.moving}else if(!y._25o&&A){N=A.tab;var p=y._74o;if(!p||p.tab===N)if(!N.isDisabled()&&oj(A._75o,y.lp)){var D=function(){var w=j.indexOf(N);H.remove(N),Y.onTabClosed(N,w)};Y.onTabClosing(N,D)&&D()}else N.isDisabled()||Y._8o===N||H.sm().ss(N)}y._25o=y._73o=y._74o=_===hk||_===nh?y.x=y.lp=y.tx=u:y.y=y.lp=y.ty=u}}),Qq.PropertyView=function(P){var y=this;y._view=sm(1,y),y._canvas=ib(y._view),qr(y._view,y._79O=rp()),y._rows=new _e,y._28o=new _e,y._26o={},y._26Q={};var d=y._propertyModel=new ss,e=y.ivm;d.mm(e,y),d.md(e,y),d.mh(e,y),y.dm(P?P:new ss),new we(y)},_o("PropertyView",b,{ms_ac:[fd,Br,nj,ll,Yd,"categorizable",xn,Kj,ro,Dr,cs,Gl,bb,Jm,"selectRowIndex",Fc,"background",bm,yc,wi,nc,$e],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Wi,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Bo,_background:U.propertyViewBackground,_expandIcon:U.propertyViewExpandIcon,_collapseIcon:U.propertyViewCollapseIcon,_scrollBarColor:Yb,_scrollBarSize:ck,_autoHideScrollBar:ag,_selectBackground:U.propertyViewSelectBackground,_rowHeight:Ir,_rowLineVisible:U.propertyViewRowLineVisible,_rowLineColor:U.propertyViewRowLineColor,_10I:.5,_columnLineVisible:U.propertyViewColumnLineVisible,_columnLineColor:U.propertyViewColumnLineColor,_labelColor:U.propertyViewLabelColor,_labelSelectColor:U.propertyViewLabelSelectColor,_labelFont:U.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(S){0>S&&(S=0),S>1&&(S=1);var x=this,w=x._10I;x._10I=S,x.fp("columnPosition",w,S)},getPropertyName:function(c){return c.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(y,s,J){return J===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(G,p){return p===this._selectRowIndex?this._labelSelectColor:G.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(n){var Y=this.getHeight()-this._59I;return Y>n&&(n=Y),n>0?0:w(n)},isExpanded:function(e){if(!e)return!0;var $=this._26o[e];return $?$.isExpanded:!(this._26Q[e]===!1)},toggle:function(M){var R=this;R.isExpanded(M)?R.collapse(M):R.expand(M)},expandAll:function(){this.validate();for(var T in this._26o)this.expand(T)},expand:function(y){if(y&&y!==mg){var R=this,c=R._26o[y];c&&!c.isExpanded&&(c.isExpanded=!0,R.onExpanded(y),R.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var H in this._26o)this.collapse(H)},collapse:function(Z){if(Z&&Z!==mg){var o=this,S=o._26o[Z];S&&S.isExpanded&&(S.isExpanded=!1,o.onCollapsed(Z),o.ivm())}},onCollapsed:function(){},getCategoryName:function(y){if(!this.isCategorizable())return mg;var b=y.getCategoryName();return b?b:mg},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(N){var O=this,v=O._dataModel;v!==N&&(v&&(v.umd(O.handlePropertyChange,O),O._selectionModel||v.sm().ums(O.handleSelectionChange,O)),O._dataModel=N,N.md(O.handlePropertyChange,O),O._selectionModel?O._selectionModel._21I(N):N.sm().ms(O.handleSelectionChange,O),O.fp(Vq,v,N))},isVisible:function(D){return this._visibleFunc?this._visibleFunc(D):!0},onPropertyChanged:function(C){var M=this,I=C.property;Ni[I]?M.ivm():M.iv(),I===jg&&M._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:Ii},handlePropertyChange:function(x){this._27o===x.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var V=this;V._96I||(V.setSelectRowIndex(-1),V._96I=1,V.iv())},redraw:function(){this.iv()},validateModel:function(){var N=this,K=N._rows,u=N._28o,d={},V=new _e,A=N._27o;N.updateCurrentData(),A!==N._27o&&N.endEditing(),K.clear(),u.clear(),N.getRawProperties().each(function(P){if(N.isVisible(P)){V.add(P);var y=N.getCategoryName(P);d[y]||(u.add(y,y===mg?0:f),d[y]={isExpanded:N.isExpanded(y),properties:new _e})}}),N._sortFunc&&V.sort(N._sortFunc);for(var l in N._26o)N._26Q[l]=N.isExpanded(l);N._26o=d,u.each(function(a){a!==mg&&K.add(a);var H=d[a];H.isExpanded&&V.each(function(c){N.getCategoryName(c)===a&&(H.properties.add(c),K.add({property:c,data:N._27o}))},N)})},validateImpl:function(){var i=this;i._76o(),i._96I&&(i.validateModel(),delete i._96I);var d=i._canvas,c=i.getWidth(),F=i.getHeight(),P=-i.ty(),s=i._rowHeight,O=i._indent,B=c-O,b=i._rows,G=b.size(),p=i._9I=O+B*i._10I,K=i._59I=G*s;Up(d,c,F),i._29I={x:0,y:P,width:c,height:F},i._31I=R(P/s),i._14I=n((P+F)/s),i._31I<0&&(i._31I=0),i._14I>G&&(i._14I=G);var X,$=Cp(d),f=i._background;er($,0,-P,1),$.beginPath(),$.rect(0,P,c,F),$.clip(),$.clearRect(0,P,c,F),i._93db($),f&&On($,0,0,O,K,f);for(var Q=i._31I;Q<i._14I;Q++){var h=b.get(Q),P=s*Q;if(Bs(h))f&&On($,O,P,B,s,f),X=Hi(i.isExpanded(h)?i._expandIcon:i._collapseIcon),X&&fh($,X,zs,0,P,O,s),$.save(),$.beginPath(),$.rect(O,P,B,s),$.clip(),i.drawCategoryName($,h,Q,O,P,B,s),$.restore();else{var t=h.property,J=h.data,X=Hi(t.getIcon()),H=i._selectRowIndex===Q?i.getSelectBackground():u;if(X&&fh($,X,zs,0,P,O,s),H&&On($,O,P,B,s,H),$.save(),$.beginPath(),$.rect(O,P,p-O,s),$.clip(),i.drawPropertyName($,t,Q,O,P,p-O,s),$.restore(),!i.isEditing(J,t)){var W=p+1,N=c-p-1;$.save(),$.beginPath(),$.rect(W,P,N,s),$.clip(),i._87o(i.drawPropertyValue($,t,i.getValue(J,t),Q,W,P,N,s,J),Q,W,P,N,s),$.restore()}}i._rowLineVisible&&On($,O,P+s-1,B,1,i._rowLineColor)}i._columnLineVisible&&(On($,p,0,1,K,i._columnLineColor),On($,c-1,0,1,K)),i._92db($),i._93I(),$.restore(),i.ty(i.ty())},drawCategoryName:function(G,X,B,U,w,g,k){gi(G,X,this.getCategoryFont(X),this.getCategoryColor(X),U,w,g,k)},drawPropertyName:function(D,H,p,M,F,Q,J){return H.drawPropertyName?(H.drawPropertyName(D,H,p,M,F,Q,J,this),void 0):(gi(D,this.getPropertyName(H),this.getPropertyFont(H,p),this.getPropertyColor(H,p),M,F,Q,J),void 0)},drawPropertyValue:function(S,r,e,u,B,p,T,n,$){return r.drawPropertyValue?r.drawPropertyValue(S,r,e,u,B,p,T,n,$,this):(vb(S,e,r,this.getLabelFont(r,e,u),this.getLabelColor(r,e,u),B,p,T,n,$,this),void 0)},isPropertyEditable:function(b){return b.isEditable()&&this.isEditable()},setProperties:function(m){this._propertyModel.clear(),this.addProperties(m)},addProperties:function(X){if(X){var L=this._propertyModel;X.forEach(function(g){if(!(g instanceof il)){var b=Ff(g.className);g=xo(b?b:il,g)}L.add(g)})}},getRowIndexAt:function(T){var Q=this,l=R(Q.lp(T).y/Q._rowHeight);return l>=0&&l<Q._rows.size()?l:-1},getPropertyAt:function(o){var x=this,L=x.getRowIndexAt(o);return L>=0?x._rows.get(L).property:u},getToolTip:function(M){var x=this,z=x.getPropertyAt(M),P=x._27o;return z&&P?z.getToolTip(P,x._9I<x.lp(M).x,x):u}});var we=function(O){this.pv=O,this.addListeners()};xk(we,b,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(o){this.getView().style.cursor=o},clear:function(){var X=this;X._62O=X.cp=X.ty=X.p=u,X.setCursor(fk)},handle_mousedown:function(_){this.handle_touchstart(_)},handle_touchstart:function(_){var P=this,S=P.pv;wb(_),S.setFocus(_)&&(js(_)?(P.cp=Jl(_),P.ty=S.ty(),P.p=S.getColumnPosition(),P.handle_touchmove(_)):S.setSelectRowIndex(S.getRowIndexAt(_)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(V){this.handle_touchend(V)},handle_touchend:function(p){var $=this;if($.cp&&!$._62O){var T=$.pv,E=T.lp(p),F=E.x,C=E.y,t=T._indent,P=T.getRowIndexAt(p),U=T._9I;if(P>=0){var S=T._rowHeight,g=S*P,X=T._rows.get(P),I=X.property;if(Bs(X))Hi(T.isExpanded(X)?T._expandIcon:T._collapseIcon)&&F>=0&&t>=F&&C>=g&&g+S>=C?T.toggle(X):Ar(p)&&T.toggle(X);else if(F>U&&T.isPropertyEditable(I,p)){var q={x:U+1,y:g,width:T.getWidth()-U-1,height:S},W={x:q.x+T.tx(),y:q.y+T.ty(),width:q.width,height:q.height},K=0,i=T._29I;q.y<i.y?K=q.y-i.y:q.y+S>i.y+i.height&&(K=q.y+S-i.y-i.height),K&&(T.ty(T.ty()-K),W.y-=K),T.beginEditing({data:X.data,property:I,value:T.getValue(X.data,I),event:p,rect:q,editorRect:W,view:T})}}T.setSelectRowIndex(P)}$.clear()},handleWindowMouseMove:function(L){this.handleWindowTouchMove(L)},handleWindowTouchMove:function(b){var H=this,O=H.pv,v=H.ty,R=H.cp,g=Jl(b),X=H._62O;if("p"===X)O.setTranslateY(v+g.y-R.y);else if("c"===X){var y=O.getWidth()-O._indent;if(y>16){var m=H.p-(R.x-g.x)/y,S=16/y;S>m&&(m=S),m>1-S&&(m=1-S),O.setColumnPosition(m)}}else"s"===X&&O.setTranslateY(v+(R.y-g.y)*O._59I/O._29I.height)},handle_mousemove:function(A){this.handle_touchmove(A)},handle_touchmove:function(B){if(!eg&&js(B)){var m=this,W=m.pv,r=k(W.lp(B).x-W._9I)<=(je?8:3);m.cp?m._62O||(r?(m._62O="c",Te(m)):k(Jl(B).y-m.cp.y)>=2&&(m._62O=m.isV(B)?"s":"p",Te(m))):(r?m.setCursor(Bn):m.setCursor(fk),m.isV(B)&&W._43o())}},isV:function(M){var k=this.pv,m=k._29I;return k._41o()&&m.x+m.width-k.lp(M).x<zi},handle_mousewheel:function(C){this.handleScroll(C,C.wheelDelta/40)},handle_DOMMouseScroll:function(H){2===H.axis&&this.handleScroll(H,-H.detail)},handleScroll:function(K,t){var c=this.pv;wb(K),c.endEditing(),c.translate(0,t*c.getRowHeight())},handle_keydown:function(X){var P=this.pv,l=P._rows.size(),h=P._selectRowIndex+(ek(X)?-1:1);(ek(X)||Sh(X))&&(0>h&&(h=0),h>=l&&(h=l-1),P.setSelectRowIndex(h))}}),Qq.ListView=function(p){this._5o(p),new Np(this)},_o("ListView",b,{ms_ac:[fd,Br,nj,bm,xn,yc,wi,Kj,ro,Gl,bb,Jm,Xq,Fc],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Bo,_rowHeight:Ir,_rowLineVisible:U.listViewRowLineVisible,_rowLineColor:U.listViewRowLineColor,_scrollBarColor:Yb,_scrollBarSize:ck,_autoMakeVisible:We,_autoHideScrollBar:ag,_selectBackground:U.listViewSelectBackground,_labelColor:U.listViewLabelColor,_labelSelectColor:U.listViewLabelSelectColor,_labelFont:U.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(P){var A=this,D=A._checkMode;A._checkMode=P,A.fp(kk,D,P)},drawRow:function(v,f,d,s,u,Y,X){var m=this,y=0,g=m._indent,K=m.getIconWidth(f);m.drawRowBackground(v,f,d,s,u,Y,X),m._checkMode&&(Xh(v,Hi(m.getCheckIcon(f)),y+g/2,u+X/2,f,m),y+=g),m.drawIcon(v,f,y,u,K,X),m.drawLabel(v,f,y+K,u,X)}});var Np=function(o){this.list=o,this._lastSelectDataTime=th(),this.addListeners()};xk(Np,b,{ms_listener:1,getView:function(){return this.list._view},clear:function(G){var X=this,o=X.list;G&&"d"===X._62O&&!X.dragCancel&&o.handleDragAndDrop(G,"end"),o.draggingData&&(o.draggingData=null,o.redraw()),X.dragCancel=X._62O=X._isV=X._isH=X.cp=X.tx=X.ty=u},handle_mousedown:function(C){this.handle_touchstart(C)},handle_touchstart:function(e){var E=this,y=E.list;if(wb(e),y.setFocus(e)){var W=y.getDataAt(e);E.cp=Jl(e),E.tx=y.tx(),E.ty=y.ty(),js(e)?W&&y.handleDragAndDrop&&!E.isV(e)&&!E.isH(e)&&(y.draggingData=W,y.redraw(),y.handleDragAndDrop(e,"prepare")):(W&&E._33o(e,W),E.clear(e))}},handleWindowMouseUp:function(v){this.clear(v)},handleWindowTouchEnd:function(B){this.clear(B)},handle_mouseup:function(J){this.handle_touchend(J)},handle_touchend:function(e){var Y=this,V=Y.list;if(!Y._isV&&!Y._isH&&Y.cp&&!Y._62O){var x=V.getDataAt(e);x?(V.isCheckMode()?Y._34o(e,x):Y._33o(e,x),Ar(e)?V.onDataDoubleClicked(x,e):V.onDataClicked(x,e)):V.handleBackgroundClick(e)}Y.clear(e)},handleWindowMouseMove:function(b){this.handleWindowTouchMove(b)},handleWindowTouchMove:function(S){var c=this,C=c.list,e=c._62O,d=c.tx,A=c.ty,W=c.cp,J=Jl(S),w=C._29I;"p"===e?C.setTranslate(d+J.x-W.x,A+J.y-W.y):"v"===e?C.ty(A+(W.y-J.y)*C._59I/w.height):"h"===e?C.tx(d+(W.x-J.x)*C._91I/w.width):"d"===e&&(c.dragCancel||C.handleDragAndDrop(S,"between"))},handle_mousemove:function($){this.handle_touchmove($)},handle_touchmove:function(d){if(!eg&&js(d)){var H=this,T=H.list;if(H._isV=H.isV(d),H._isH=H.isH(d),H.cp){if(!H._62O){if(Di(Jl(d),H.cp)<2)return;H._isV?H._62O="v":H._isH?H._62O="h":T.draggingData&&!this.dragCancel?(H._62O="d",T.handleDragAndDrop(d,"begin")):H._62O="p",H._62O&&"d"!==H._62O&&T.draggingData&&(T.draggingData=null,T.redraw()),Te(H)}}else H._isV&&T._43o(),H._isH&&T._42o()}},isV:function(X){var H=this.list,j=H._29I;return H._41o()&&j.x+j.width-H.lp(X).x<zi},isH:function(S){var t=this.list,q=t._29I;return t._40o()&&q.y+q.height-t.lp(S).y<zi},handle_mousewheel:function(O){this.handleScroll(O,O.wheelDelta/40,O.wheelDelta!==O.wheelDeltaX)},handle_DOMMouseScroll:function(j){this.handleScroll(j,-j.detail,1)},handleScroll:function(g,w,J){var D=this.list;wb(g),D.endEditing&&D.endEditing(),J&&D._41o()?D.translate(0,w*D.getRowHeight()):D._40o()&&D.translate(10*w,0)},handle_keydown:function(A){if(!U.isInput(A.target)){var G,R=this.list,r=R.sm(),k=R._rows,h=k.size();if(Zf(A))R.selectAll();else if(ws(A))R.handleDelete&&R.handleDelete(A);else if(hj(A))"d"!==this._62O||this.dragCancel||(R.handleDragAndDrop(A,"cancel"),this.dragCancel=!0);else if(Db(A))R.isCheckMode()&&(G=R.getFocusData(),G&&R.checkData(G));else if(ek(A)||Sh(A)){var u=R.isCheckMode();if(G=u?R.getFocusData():r.ld()){var l=R.getRowIndex(G);l>=0&&(ek(A)?0!==l&&(G=k.get(l-1),u?R.setFocusData(G):r.ss(G)):l!==h-1&&(G=k.get(l+1),u?R.setFocusData(G):r.ss(G)))}else h>0&&(G=k.get(0),u?R.setFocusData(G):r.ss(G))}}},_34o:function(x,W){var $=this.list,_=$.lp(x).x;return _>=0&&_<=$._indent?($.checkData(W),void 0):($.setFocusData(W),void 0)},_33o:function(g,V){var q=this.list,G=q.sm(),R=G.ld();if(Be(g))q.isSelected(V)?G.rs(V):G.as(V);else if(xd(g))if(R)for(var Z=q.getRowIndex(R),t=q.getRowIndex(V);Z!==t;)Z+=t>Z?1:-1,G.as(q._rows.get(Z));else G.ss(V);else if(js(g)){var C=th();if(G.contains(V)){var K=C-this._lastSelectDataTime;q.handleDataDoubleSelect&&K>500&&1500>K&&q.handleDataDoubleSelect(g,V)}G.ss(V),this._lastSelectDataTime=C}else G.contains(V)||G.ss(V)}}),Qq.TreeView=function(r){var e=this;e._35o(),e._5o(r),new If(e)},_o("TreeView",b,{ms_ac:[fd,Br,nj,"rootVisible",kk,"rootData",Kj,ro,Gl,bb,Jm,xn,bm,yc,wi,Dr,cs,Xq,Fc,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:u,_indent:Bo,_rowHeight:Ir,_rowLineVisible:U.treeViewRowLineVisible,_rowLineColor:U.treeViewRowLineColor,_scrollBarColor:Yb,_scrollBarSize:ck,_autoHideScrollBar:ag,_expandIcon:U.treeViewExpandIcon,_collapseIcon:U.treeViewCollapseIcon,_autoMakeVisible:We,_selectBackground:U.treeViewSelectBackground,_labelColor:U.treeViewLabelColor,_labelSelectColor:U.treeViewLabelSelectColor,_labelFont:U.treeViewLabelFont,_doubleClickToToggle:U.treeViewDoubleClickToToggle,drawRow:function(U,A,f,S,X,G,T){var z=this;z.drawRowBackground(U,A,f,S,X,G,T),z._97I(U,A,f,0,X,G,T)},isOnToggleIcon:function(b){var e=this.getDataAt(b);if(e){var q=this.getIndent(),U=this.lp(b).x;if(Hi(this.getToggleIcon(e))){var n=q*this.getLevel(e);if(U>=n&&n+q>=U)return!0}}return!1}});var If=function($){ef(If,this,[$])};xk(If,Np,{toggle:function(i,u,D,E){var v=this.list,Y=v.lp(i).x;if(Hi(v.getToggleIcon(u))){var Z=D*E;if(Y>=Z&&Z+D>=Y)return v.toggle(u),!0}return v.isDoubleClickToToggle()&&Ar(i)?(v.toggle(u),!0):!1},_34o:function(R,z){var X=this.list,J=X.lp(R).x,I=X._levelMap[z._id],O=X._indent,L=O*(I+1);return J>=L&&L+O>=J?(X.checkData(z),void 0):(this.toggle(R,z,O,I)||X.setFocusData(z),void 0)},_33o:function(G,a){var H=this,S=H.list;H.toggle(G,a,S._indent,S.getLevel(a))||If.superClass._33o.call(H,G,a)},handle_keydown:function(X){if(el(X)||bs(X)){var B=this.list,D=B._rows,j=B.isCheckMode(),w=B.sm(),R=j?B.getFocusData():w.ld();R?R.hasChildren()&&(el(X)?B.collapse(R):B.expand(R)):D.size()>0&&(R=D.get(0),j?B.setFocusData(R):w.ss(R))}else If.superClass.handle_keydown.call(this,X)}});var ud=Qq.TableView=function(w){this._98I(),this._5o(w),new Kc(this)};_o("TableView",b,{ms_ac:[fd,Br,nj,"sortMode",ll,Yd,bm,yc,wi,nc,$e,"sortColumn",Kj,ro,Gl,bb,Jm,Xq,Fc],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:cb,_editable:!0,_batchEditable:!1,_rowHeight:Ir,_rowLineVisible:U.tableViewRowLineVisible,_rowLineColor:U.tableViewRowLineColor,_columnLineVisible:U.tableViewColumnLineVisible,_columnLineColor:U.tableViewColumnLineColor,_scrollBarColor:Yb,_scrollBarSize:ck,_autoHideScrollBar:ag,_autoMakeVisible:We,_selectBackground:U.tableViewSelectBackground,_labelColor:U.tableViewLabelColor,_labelSelectColor:U.tableViewLabelSelectColor,_labelFont:U.tableViewLabelFont,getCheckColumn:function(){var $=this;
if(!$._31o){var S=$._31o=new _g;S.setEditable(!0),S.setWidth(40),S.getValue=$.getCheckColumValue,S.drawCell=$.drawCheckColumnCell}return $._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(G){var T=this,P=T._39o,q=T.getCheckColumn();G!==T.isCheckMode()&&(G?P.add(q,0):P.remove(q),T.fp(kk,!G,G))},getCheckColumValue:function(Q,U,L){return L.isSelected(Q)},drawCheckColumnCell:function(q,Q,F,U,X,M,V,b,Z){Xh(q,Z.getCheckIcon(Q),X+V/2,M+b/2,Q,Z)}});var Kc=function(r){ef(Kc,this,[r])};xk(Kc,Np,{_34o:function(f,u){var A=this.list,p=A._31o;if(A.isCellEditable(u,p,f)){var s=A._3Q(p),c=A.lp(f).x;if(s&&c>=s.startX&&c<s.startX+p.getWidth())return A.checkData(u),void 0}A._37O(u,f),A.setFocusData(u)},_33o:function($,h){this.list._37O(h,$),Kc.superClass._33o.apply(this,arguments)}});var cn=Qq.TreeTableView=function(S){var y=this,o=y._4o=new _g;y._35o(),y._98I(),y._5o(S),o.setDisplayName("Name"),o.setEditable(!0),o.setWidth(180),o.drawCell=Jq,o.getValue=fm,y._39o.add(o),new Dn(y)},Jq=function(E,g,t,H,S,F,v,D,x){x._97I(E,g,t,S,F,v,D)},fm=function(g,i,f){return f.getLabel(g)};_o("TreeTableView",b,{ms_ac:[fd,Br,nj,"sortMode",ll,Yd,xn,kk,"rootData","rootVisible",Kj,ro,"sortColumn",Dr,cs,Gl,bb,Jm,Xq,wi,bm,yc,nc,$e,Fc,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:cb,_checkMode:u,_editable:!0,_batchEditable:!1,_indent:Bo,_rowHeight:Ir,_rowLineVisible:U.treeTableViewRowLineVisible,_rowLineColor:U.treeTableViewRowLineColor,_columnLineVisible:U.treeTableViewColumnLineVisible,_columnLineColor:U.treeTableViewColumnLineColor,_expandIcon:U.treeTableViewExpandIcon,_collapseIcon:U.treeTableViewCollapseIcon,_scrollBarColor:Yb,_scrollBarSize:ck,_autoHideScrollBar:ag,_autoMakeVisible:We,_selectBackground:U.treeTableViewSelectBackground,_labelColor:U.treeTableViewLabelColor,_labelSelectColor:U.treeTableViewLabelSelectColor,_labelFont:U.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var Dn=function(Z){ef(Dn,this,[Z])};xk(Dn,Np,{_34o:function(o,Z){var I=this.list,v=I._4o,i=I._3Q(v),W=I.lp(o).x;if(i){var q=I._indent,E=i.startX+q*I.getLevel(Z);if(Hi(I.getToggleIcon(Z))&&W>=E&&E+q>=W)return I.toggle(Z),void 0;if(I.isCellEditable(Z,v)&&(E+=q,W>=E&&E+q>=W))return I.checkData(Z),void 0}I._37O(Z,o),I.setFocusData(Z)},_33o:function(V,X){var t=this.list,A=t.lp(V).x;if(Hi(t.getToggleIcon(X))){var T=t._3Q(t._4o);if(T){var U=t._indent,h=T.startX+U*t.getLevel(X);if(A>=h&&h+U>=A)return t.toggle(X),void 0}}t._37O(X,V),Dn.superClass._33o.apply(this,arguments)}});var cp=Qq.TableHeader=function(v){var V=this,O=V._view=sm(1,V),j=V._39o=v.getColumnModel(),x=V.iv;V.tv=V._tableView=v,V._60I=new _e,V._canvas=ib(O),O.style.background=U.tableHeaderBackground||"",O.style.height=bg+Lf,j.mm(x,V),j.md(x,V),j.mh(x,V),v.mp(function(z){mk[z.property]&&V.iv()},V),new Yr(V),V.iv()};_o("TableHeader",b,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",fd,nj,xn,"moveBackground","insertColor",nc,$e,"resizable","movable"],_checkIcon:Xj,_movable:!0,_resizable:!0,_labelColor:U.tableHeaderLabelColor,_labelFont:U.tableHeaderLabelFont,_columnLineColor:U.tableHeaderColumnLineColor,_columnLineVisible:U.tableHeaderColumnLineVisible,_sortDescIcon:U.tableHeaderSortDescIcon,_sortAscIcon:U.tableHeaderSortAscIcon,_moveBackground:U.tableHeaderMoveBackground,_insertColor:U.tableHeaderInsertColor,_indent:Bo,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(B){return B.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(W){return W.getColor()||this._labelColor},getLabelAlign:function(C){return C._align},onPropertyChanged:function(){this.iv()},_5Q:function(N){this._61I=N,this.iv()},getLogicalPoint:function(N){return _k(N,this._canvas,this.tv.tx())},validateImpl:function(){var s=this,_=s._canvas,U=s.getWidth(),T=s.getHeight(),I=s.tv,m=s._60I,F=s._61I,c=-I.tx(),X=0;(U!==_.clientWidth||T!==_.clientHeight)&&Up(_,U,T),m.clear(),s._39o._roots.each(function(F){if(F.isVisible()){var e=X+F.getWidth();c+U>=X&&e>=c&&m.add({column:F,startX:X}),X=e}});var Y=Cp(_);if(er(Y,-c,0,1),Y.beginPath(),Y.rect(c,0,U,T),Y.clip(),Y.clearRect(c,0,U,T),m.each(function(J){var W=J.column,h=J.startX,u=W.getWidth();u>0&&(Y.save(),Y.beginPath(),Y.rect(h,0,u,T),Y.clip(),F&&F.column===W||s.drawColumn(Y,W,h,0,u,T),s._columnLineVisible&&On(Y,h+u-1,0,1,T,s._columnLineColor),Y.restore())}),F){var $=F.column,X=F.startX,o=F.position,W=$.getWidth();Y.save(),Y.beginPath(),Y.rect(X,0,W,T),Y.clip(),Y.fillStyle=s._moveBackground,Y.fill(),s.drawColumn(Y,$,X,0,W,T),Y.restore(),Eo(Y,s._insertColor,o,0,T)}Y.restore()},_6Q:function(w){var y=this.tv;return y._31o===w&&y.sm().getSelectionMode()===Bq},drawColumn:function(p,x,H,w,L,Q){var u=this,g=u.tv,I=Hi(x.getIcon()),U=u.getLabelAlign(x);if(u._6Q(x)){var E=Hi(u._checkIcon);Xh(p,E,H+L/2,w+Q/2,x,u)}else{var q=u.getLabel(x),V=u.getLabelFont(x),_=u.getLabelColor(x),a=Nh(V,q).width,i=I?u._indent:0;U===nk?(I&&fh(p,I,zs,H,w,i,Q),gi(p,q,V,_,H+i,w,L,Q,nk)):U===yq?(I&&fh(p,I,zs,H+L-a-i,w,i,Q),gi(p,q,V,_,H,w,L,Q,yq)):(I&&fh(p,I,zs,H+(L-a-i)/2,w,i,Q),gi(p,q,V,_,H+(L-a+i)/2,w,0,Q,nk))}if(x.isSortable()&&g.getSortColumn()===x&&(I=Hi(x.getSortOrder()===mj?u._sortAscIcon:u._sortDescIcon))){var R=Bp(I,x)/2+2;Xh(p,I,U===yq?H+R:H+L-R,w+Q/2,x,g)}}});var Yr=function(I){var b=this;b.th=I,b.tv=I._tableView,b.addListeners()};xk(Yr,b,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(A){this.getView().style.cursor=A},handle_mousemove:function(S){if(!eg){var s=this;delete s._29o,s.setCursor(fk);for(var Q=s.th,J=Q._60I,r=Q.lp(S).x,q=J.size()-1;q>=0;q--){var V=J.get(q),E=V.column,c=V.startX+E.getWidth();if(Q.isResizable()&&k(c-r)<=(je?10:3))return s._29o=V,s.setCursor(Bn),void 0;r>V.startX&&c>r&&(s._29o=V),(E.isClickable()||E.isSortable()||Q.isMovable()||s.tv.getCheckColumn&&E===s.tv.getCheckColumn())&&r>V.startX&&c>r&&s.setCursor(bf)}}},handle_mousedown:function(s){this.handle_touchstart(s)},handle_touchstart:function(t){var k=this;wb(t),k.tv.endEditing(),k.handle_mousemove(t),k._29o&&(k.x=Jl(t).x,k.lx=k.th.lp(t).x,k.w=k._29o.column.getWidth(),Te(k,t))},handleWindowMouseMove:function(E){this.handleWindowTouchMove(E)},handleWindowTouchMove:function(C){var q=this,K=q.th,o=q.getView().style.cursor,c=q._29o,U=Jl(C).x-q.x;if(q.resizing||q.moving||(o===Bn?q.resizing=1:K.isMovable()&&o===bf&&k(U)>2&&(q.moving=1)),q.resizing)c.column.setWidth(q.w+U);else if(q.moving){var y=q.lx+U;K._60I.each(function(S){var G=S.startX,_=G+S.column.getWidth();if(y>=G&&_>=y){var J={column:c.column,startX:c.startX+U,front:_-y>y-G,insertColumn:S.column};J.position=J.front?G:_,K._5Q(J)}})}},_16Q:function(g,Y){var N=this,Q=N.tv,X=N.th,D=X._checkIcon;if(X._6Q(g)){var K=Hi(D),a=N.lx,U=g.getWidth(),m=Bp(K,g);if(a>=Y+U/2-m&&Y+U/2+m>=a){X.setCheckIcon(D===Gn?Xj:Gn);var w=Q.sm(),u=Q._rows;return D===Gn?w.rs(u):w.ss(u),Q.onCheckColumnClicked(g),!0}}return!1},handleWindowMouseUp:function(s){this.handleWindowTouchEnd(s)},handleWindowTouchEnd:function(x){var y=this,o=y.tv,p=y.th,J=y._29o;if(y.moving){var m=p._61I;if(m&&m.insertColumn!==m.column){var w=m.column,A=o.getColumnModel()._roots,S=A.remove(w),Y=A.indexOf(m.insertColumn);Y>=0&&(m.front||Y++,Y<=A.size()&&(A.add(w,Y),o.getColumnModel()._38I(w,S,Y)))}p._5Q(u),delete y.moving}else if(!y.resizing&&J){w=J.column;var P=p.lp(x).x,Z=J.startX,E=!0;if(p.onColumnClicked){var H=p.onColumnClicked(w,x,Z);H===!1&&(E=!1)}if(E&&P>=Z&&P<=Z+w.getWidth()&&!y._16Q(w,Z)){if(w.isSortable()){var F=o.getSortMode(),n=w.getSortOrder();F===cb?o.getSortColumn()===w?(n===Cf&&o.setSortColumn(u),w.setSortOrder(n===mj?Cf:mj)):o.setSortColumn(w):"bistate"===F&&(o.getSortColumn()===w?w.setSortOrder(n===mj?Cf:mj):o.setSortColumn(w))}o.onColumnClicked(w,x,Z)}}y._29o=y.resizing=y.x=y.lx=y.w=u}}),Qq.TablePane=function(o){this.init(new ud(o))},_o("TablePane",b,{ms_v:1,_44o:1}),Qq.TreeTablePane=function(I){this.init(new cn(I))},_o("TreeTablePane",b,{ms_v:1,_44o:1}),Qq.Toolbar=function(J){var l=this,O=l._view=sm(1,l),i=O.style;i.background=U.toolbarBackground||"",i.height=zl+Lf,l._canvas=ib(O),l._30o=new _e,l._90I=new _e,l.setItems(J||[]),O.handleGroupSelectedChanged=function(v){if(v.isSelected()){var d=v.getGroupId();null!=d&&l._items.forEach(function(X){var b=X.element;b&&b!==v&&b.setSelected&&b.getGroupId&&b.getGroupId()===d&&b.setSelected(!1)})}},new jl(l)},_o("Toolbar",b,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Sp,fd,nj,Br,Fc,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:U.toolbarLabelColor,_labelSelectColor:U.toolbarLabelSelectColor,_labelFont:U.toolbarLabelFont,_selectBackground:U.toolbarSelectBackground,_itemGap:U.toolbarItemGap,_separatorColor:U.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(K){var D=this.getItemInfoAt(K);return D?D.item.toolTip:u},getLabelColor:function(G){return G&&G.selected&&G.type!==Gn&&G.type!==Zg?this._labelSelectColor:this._labelColor},onPropertyChanged:function(G){this.iv(),G.property===Sp&&this._items.forEach(function(f){Io(f)})},redraw:function(){this.iv()},addItem:function(E,v){var Y=this._items;v==u?Y.push(E):Y.splice(v,0,E),this.fp(Sp,u,Y)},removeItem:function(b){if(b)for(var X=this._items,U=0;U<X.length;U++)b===X[U]&&(X.splice(U,1),this.fp(Sp,u,X))},removeItemById:function(T){if(T!=u)for(var n=this._items,N=0;N<n.length;N++)if(T===n[N].id){var P=n.splice(N,1)[0];return this.fp(Sp,u,n),P}},getItemById:function(Y){if(Y!=u)for(var V=this._items,G=0;G<V.length;G++){var l=V[G];if(Y===l.id)return l}},setItemVisible:function(w,t){var j=this.getItemById(w);j&&(j.visible=t)},getItemInfos:function(){return this._30o},getItemInfoAt:function(k){var A=this,Q=0,X=A._30o,I=A.lp(k),B=I.x,D=I.y;if(D>=0&&D<=A.getHeight())for(;Q<X.size();Q++){var W=X.get(Q);if(W.startX<=B&&B<=W.endX)return W}return u},drawItem:function(G,K,t,h,F){if(K.visible===!1)return 0;if(Ze(K.visible)&&!K.visible())return 0;var R=this,C=K.disabled;C&&(G.globalAlpha=id);var A=R.drawItemImpl(G,K,t,h,F),Z=R._itemGap;return C&&(G.globalAlpha=1),this._currentItem!==K||"separator"===K||K.separator===!0||K.unfocusable||ti(G,R._separatorColor,t-Z/2,0,A+Z,h),A},drawItemImpl:function(b,x,K,v,s){var I=this,h=I._view,c=I._itemGap,g=v/2,W=x.type,B=x.element,X=x.label;Bs(B)&&(X=B,B=u);var n,e=I.getLabelFont(x),R=I.getLabelColor(x),F=x.selected,L=Hi(x.icon),U=Bp(L,x),i=0,H=U+(X?Nh(e,X).width:0);if("separator"===x||x.separator===!0)return Eo(b,I._separatorColor,K,v/4,g),1;if(B){L&&Xh(b,L,K+U/2,g,x,I),gi(b,X,e,R,K+U,0,0,v);var z=uf(B);s||I._90I.add(z),z.parentNode!==h&&qr(h,z),B.iv&&B.iv(),B.validate&&B.validate();var k=z.getBoundingClientRect(),S=k.width,a=z.style;return Ad(z),a.left=I.tx()+K+H+Lf,a.top=(v-k.height)/2+Lf,H+S}return W===Zg?n=Hi(F?Gj:dg):W===Gn&&(n=Hi(F?Gn:Xj)),n?(i=Bp(n,x),Xh(b,n,K+i/2,g,x,I),K+=i,H+=i):F&&On(b,K-c/2,0,H+c,v,I.getSelectBackground(x)),L&&Xh(b,L,K+U/2,g,x,I),gi(b,X,e,R,K+U,0,0,v),H},validateImpl:function(){var y=this,a=y._canvas,U=y.getWidth(),D=y.getHeight(),e=y._30o,n=y._items;Up(a,U,D);var f=Cp(a),m=y._itemGap,h=m/2;er(f,y.tx(),0,1),f.clearRect(0,0,U,D);var c=y._90I;y._90I=new _e,e.clear(),n.forEach(function(_){var W=y.drawItem(f,_,h,D);e.add({item:_,startX:h,endX:h+W,width:W}),W&&(h+=W+m)}),c.each(function(P){y._90I.contains(P)||mp(P)});var S=y._64I;y._64I=l(0,h),f.restore(),y._stickToRight?(y._65O=0,f=Cp(a),h=U-y._64I+m,er(f,0,0,1),f.clearRect(0,0,U,D),e.clear(),n.forEach(function(L){var V=y.drawItem(f,L,h,D,!0);e.add({item:L,startX:h,endX:h+V,width:V}),V&&(h+=V+m)}),f.restore()):y.tx(y.tx()),S!==y._64I&&y.onSumWidthChanged(S,y._64I)},onSumWidthChanged:function(){},handleClick:function(M,J){var Q=this,R=M.type,v=M.action,X=M.groupId,D=M.selected;M.disabled||(X!=u?D||(M.selected=!0,this._items.forEach(function(q){q.groupId===X&&M!==q&&(q.selected=!1)}),v&&M.action(M,Q,J)):R===Gn||"toggle"===R?(M.selected=!D,v&&M.action(M,Q,J)):v&&M.action(M,Q,J)),rk(),Q.iv()}});var jl=function(c){this.tb=c,this.addListeners()};xk(jl,b,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(g){this.handleScroll(g,10*(g.wheelDelta/40))},handle_DOMMouseScroll:function(r){this.handleScroll(r,10*-r.detail)},handleScroll:function(F,w){wb(F);var A=this.tb;A.isScrollable()&&!A._stickToRight&&(A.tx(A.tx()+w),Ok())},handle_mousemove:function(c){var O=this;eg||O.setItem(c)},handle_mouseout:function(D){var A=this;D.target===A.getView()?A.tb.setCurrentItem(u):A.handle_mousemove(D)},handle_mousedown:function(I){this.handle_mousemove(I),this.handle_touchstart(I)},handle_touchstart:function(m){var d=this,W=d.tb,_=m.target;js(m)&&(_===d.getView()||_===W._canvas)&&(wb(m),W.setFocus(m)&&(this.setItem(m,!0),(W.isScrollable()||d.info&&!d.info.item.disabled)&&(d.x=Jl(m).x,d.tx=W.tx(),Te(d,m))))},handleWindowMouseMove:function(s){this.handleWindowTouchMove(s)},handleWindowTouchMove:function(R){var M=this,c=M.tb;if(!c._stickToRight){var J=Jl(R).x-M.x;!M._25o&&k(J)>2&&c.isScrollable()&&(M._25o=1),M._25o&&c.tx(M.tx+J)}},handleWindowMouseUp:function(F){this.handleWindowTouchEnd(F)},handleWindowTouchEnd:function(_){var Z=this,C=Z.tb,e=Z.info,m=Z.tb.getItemInfoAt(_);if(!Z._25o&&e){var t=e.item;m&&m.item===t&&C.handleClick(t,_)}Z._25o=Z.x=Z.tx=u,Z.setItem()},setItem:function(U,M){var s=this,E=s.tb,q=s.info=U?E.getItemInfoAt(U):u,D=q?q.item:u;E.setCurrentItem(D),M&&D&&Ze(D.onDown)&&D.onDown(U)}}),Qq.BorderPane=function(){this._view=sm(1,this),this.iv()},_o("BorderPane",b,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(e,M){this._12o("leftView",e),M!=u&&this.setLeftWidth(M)},getRightView:function(){return this._rightView},setRightView:function(W,Y){this._12o("rightView",W),Y!=u&&this.setRightWidth(Y)},getTopView:function(){return this._topView},setTopView:function(F,M){this._12o("topView",F),M!=u&&this.setTopHeight(M)},getBottomView:function(){return this._bottomView},setBottomView:function(l,V){this._12o("bottomView",l),V!=u&&this.setBottomHeight(V)},getCenterView:function(){return this._centerView},setCenterView:function(s){this._12o("centerView",s)},_12o:function(z,x){var f=this,y="_"+z,V=f._view,q=f[y];q!==x&&(q&&(q.getView?mp(q.getView()):mp(q)),f[y]=x,x&&(x.getView?qr(V,x.getView(),1):qr(V,x,1)),f.fp(z,q,x))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var e=this,p=e._topView,T=e._bottomView,L=e._leftView,S=e._rightView,z=e._centerView,q=e.getWidth(),B=e.getHeight(),X=0,n=0,E=q,f=B,s=0,v=0,m=0,b=0;p&&(s=e._topHeight==u?bo(p):e._topHeight,n=s),T&&(v=e._bottomHeight==u?bo(T):e._bottomHeight,f=B-v),L&&(m=e._leftWidth==u?Vc(L):e._leftWidth,X=m),S&&(b=e._rightWidth==u?Vc(S):e._rightWidth,E=q-b);var h=l(0,E-X),R=l(0,f-n);p&&Ji(p,0,0,q,s),T&&Ji(T,0,f,q,v),L&&Ji(L,0,n,m,R),S&&Ji(S,E,n,b,R),z&&Ji(z,X,n,h,R)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);