!function(u,g){"use strict";var l="position",z="absolute",V="relative",Y="px",O="left",I="right",i="top",k="bottom",R="display",M="none",c="block",_=ht.Default,n=_.getInternal(),E=Math.floor,d=Math.ceil,o=Math.PI,U=null,J=u.parseInt,m=function(o){return o.getContext("2d")},v=function(){return document},q=function(P){return v().createElement(P)},b=function(){return q("canvas")},L=function(E,K,$){E.style.setProperty(K,$,U)},r=function(f,b,e){_.def(ht.widget[f],b,e)},s=function(b,i){b.appendChild(i)},j=function(T,H){T.removeChild(H)},D=_.eventListenerOptionsFalse,f=(_.eventListenerOptionsTrue,function(o,W,n,U){o.addEventListener(W,n,U?D:D)}),S=function(p,R,l,v){p.removeEventListener(R,l,v?D:D)};ht.widget.RulerFrame=function(P){var Z=this,w=Z._view=n.createView(null,Z),D=Z.$1k=b(),A=Z.$2k=b(),d=Z.$3k=b(),t=Z.$4k=b();Z._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},Z._topRulerConfig={visible:!0},Z._rightRulerConfig={visible:!1},Z._bottomRulerConfig={visible:!1},Z._leftRulerConfig={visible:!0},s(w,D),s(w,d),s(w,A),s(w,t),L(w,l,V),L(w,"box-sizing","border-box"),L(w,"-moz-box-sizing","border-box"),L(D,l,z),L(A,l,z),L(d,l,z),L(t,l,z),Z.$14k=function(){Z.$13k=1,Z.iv()},Z.$15k=function(E){if(Z._topRulerConfig.guideVisible||Z._rightRulerConfig.guideVisible||Z._bottomRulerConfig.guideVisible||Z._leftRulerConfig.guideVisible||Z._defaultRulerConfig.guideVisible||(Z._topRulerConfig.guideTipVisible||Z._rightRulerConfig.guideTipVisible||Z._bottomRulerConfig.guideTipVisible||Z._leftRulerConfig.guideTipVisible||Z._defaultRulerConfig.guideTipVisible)&&Z._component){var z=w.getBoundingClientRect();Z.$16k={x:E.clientX-z.left,y:E.clientY-z.top},Z.$5k()}},Z.setComponent(P)},r("RulerFrame",g,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(T){var R=this,O=R._component,A=R.getView();if(A){if(R._component=T,R.fp("component",O,T),O){var I=R.getComponentView(O);j(A,I),S(A,"mousemove",R.$15k),R.removeComponentPropertyChangeListener(O,R.$14k)}if(T){var w=R.getComponentView(T);s(A,w),L(w,l,z),f(A,"mousemove",R.$15k),R.addComponentPropertyChangeListener(T,R.$14k)}}},addComponentPropertyChangeListener:function(M,A){M&&M.mp&&M.mp(A)},removeComponentPropertyChangeListener:function($,F){$&&$.ump&&$.ump(F)},getComponentHZoom:function(R){return R&&R.getZoom?R.getZoom():1},getComponentVZoom:function(O){return O&&O.getZoom?O.getZoom():1},getComponentViewRect:function(V){return V&&V.getViewRect?V.getViewRect():void 0},getComponentView:function(G){return G&&G.getView?G.getView():G},invalidateComponent:function(u){u&&u.iv&&u.iv()},validateComponent:function(L){L&&L.validate&&L.validate()},$7k:function(D,q,F,Y,y,C,a,A,d,x,$,f){if(q.visible){var O=this._defaultRulerConfig,v="borderStyle",m="borderColor",z="borderWidth",j="background",X=q[v]||O[v],o=q[m]||O[m],b=q[z]||O[z],S=q.size!=U?q.size:O.size,l=q[j]||O[j],Z=S+b,h=this.$6k(b,X,o,D,F,y,Z,a,A,d,x,$,f);L(D,y,"0px"),C?n.setCanvas(D,Y-h,S):n.setCanvas(D,S,Y-h),L(D,"background",l),L(D,R,c)}else L(D,R,M),L(this.getComponentView(this._component),y,"0px")},$6k:function(J,W,w,h,N,D,B,M,j,G,e,F,u){var _=0;return L(h,N,J+"px "+W+" "+w),L(this.getComponentView(this._component),D,B+Y),M?(L(h,j,G+Y),_+=G):L(h,j,"0px"),e?(L(h,F,u+Y),_+=u):L(h,F,"0px"),_},validateImpl:function(){var q=this,Z=q._component,C=q.$1k,z=q.$2k,T=q.$3k,e=q.$4k,J=q._view,r=q._defaultRulerConfig,X=q._topRulerConfig,E=q._rightRulerConfig,N=q._bottomRulerConfig,K=q._leftRulerConfig,v=r.size;if(J&&Z){var g=X.size!=U?X.size:v,_=E.size!=U?E.size:v,D=N.size!=U?N.size:v,S=K.size!=U?K.size:v;q.$7k(C,X,"border-bottom",J.offsetWidth,i,!0,K.visible,O,S,E.visible,I,_),q.$7k(z,E,"border-left",J.offsetHeight,I,!1,X.visible,i,g,N.visible,k,D),q.$7k(T,N,"border-top",J.offsetWidth,k,!0,K.visible,O,S,E.visible,I,_),q.$7k(e,K,"border-right",J.offsetHeight,O,!1,X.visible,i,g,N.visible,k,D),q.$13k?delete q.$13k:q.invalidateComponent(Z),q.validateComponent(Z),q.$5k()}},$5k:function(){function r(r,M,z,G,p,L){if(M.visible){var X=m(r),R=M[i]||E,P=M[n]!=U?M[n]:y,H=M[e]||c,k=M[S]||o,D=M.size!=U?M.size:Q,mn=M[s]||x,Xf=M[j]||F,nb=M[t]||N,ac=M[W]!=U?M[W]:Z,zs=M[d]!=U?M[d]:A,xe=M[T]!=U?M[T]:g,dg=M[B]!=U?M[B]:Y,um=M[f]!=U?M[f]:b,ap=M[u]!=U?M[u]:J,Jb=M[a]||Al,Ii=M[K]||Zp;P&&(R=O[L]=O.$8k(O[L]||R,M[v]||h,M[I]||_,G?l:$,Xf)),z.call(O,X,q,C,w,V,D,G?l:$,R,H,k,p,mn,nb);var qj=O.$16k;(ac||zs)&&qj&&(G?O.$9k(X,qj.x,D,Jb,Ii,ac,zs,xe,dg,um,ap):O.$10k(X,qj.y,D,Jb,Ii,ac,zs,xe,dg,um,ap,p))}}var O=this,R=O.$1k,M=O.$2k,G=O.$3k,p=O.$4k,L=O._topRulerConfig,D=O._rightRulerConfig,z=O._bottomRulerConfig,H=O._leftRulerConfig,k=O._defaultRulerConfig,P=O._component,X=O.getComponentViewRect(P),l=O.getComponentHZoom(P),$=O.getComponentVZoom(P),q=X.x*l,w=q+X.width*l,C=X.y*$,V=C+X.height*$,Q=O._defaultRulerConfig.size,i="defaultMajorTickSpacing",v="maxPhysicalMajorTickSpacing",I="minPhysicalMajorTickSpacing",n="tickSpacingAdaptable",e="majorTickTextFont",S="majorTickTextColor",s="majorTickColor",t="minorTickColor",W="guideVisible",d="guideTipVisible",T="guideTipBorderColor",B="guideTipTextColor",f="guideTipTextFont",u="guideTipBackground",a="guideColor",K="guideWidth",j="minMajorTickSpacing",E=k[i],h=k[v],_=k[I],y=k[n],c=k[e],o=k[S],x=k[s],F=k[j],N=k[t],Z=k[W],A=k[d],g=k[T],Y=k[B],b=k[f],J=k[u],Al=k[a],Zp=k[K];O._view&&P&&(r(R,L,O.$11k,!0,!1,"_currentTopMajorTickSpacing"),r(M,D,O.$12k,!1,!0,"_currentRightMajorTickSpacing"),r(G,z,O.$11k,!0,!0,"_currentBottomMajorTickSpacing"),r(p,H,O.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(u,e,D,Z,v){return D>u*Z?u=E(e/Z/v)*v:u*Z>e&&(u=d(D/Z/v)*v),u},getHTipText:function(c){var x=this,n=x._component,U=0,k=x._view.getBoundingClientRect();return n.lp?U=J(n.lp({x:c.x+k.left,y:c.y}).x):U-=J(this.getComponentView(n).style.left)||0,U},$9k:function(S,o,x,Q,f,M,u,G,A,e,d){var F=this,w=F._component;S.save(),n.translateAndScale(S,0,0,1);var c=o-(J(this.getComponentView(w).style.left)||0),$=0;if(o=F.getHTipText(F.$16k),M&&(S.beginPath(),S.fillStyle=Q,S.rect(c,$,f,x),S.fill()),u){S.beginPath(),S.textAlign="center",S.textBaseline="middle",S.font=e;var s=S.measureText(o).width+6;S.fillStyle=d,S.rect(c-s/2,$,s,x),S.fill(),S.strokeStyle=G,S.stroke(),S.beginPath(),S.fillStyle=A,S.fillText(o,c,$+x/2)}S.restore()},getVTipText:function(A){var E=this,X=E._component,V=0,P=E._view.getBoundingClientRect();return X.lp?V=J(X.lp({x:A.x,y:A.y+P.top}).y):V-=J(this.getComponentView(X).style.top)||0,V},formatScaleText:function(x){return Math.round(x)},$10k:function(m,Q,F,C,A,G,g,B,I,P,V,Y){var p=this,w=p._component;m.save(),n.translateAndScale(m,0,0,1);var z=F/2,L=Q-(J(this.getComponentView(w).style.top)||0);if(Q=p.getVTipText(p.$16k),G&&(m.beginPath(),m.fillStyle=C,m.rect(z-F/2,L,F,A),m.fill()),g){m.translate(z,L),m.rotate((Y?90:-90)*o/180),m.translate(-z,-L),m.beginPath(),m.textAlign="center",m.textBaseline="middle",m.font=P;var H=m.measureText(Q).width+6;m.fillStyle=V,m.rect(z-H/2,L-F/2,H,F),m.fill(),m.strokeStyle=B,m.stroke(),m.fillStyle=I,m.fillText(Q,z,L)}m.restore()},$11k:function(A,O,W,x,H,z,D,i,I,g,$,F,w){A.save(),W=0;var X=O,Y=x,T=(X+Y)/2;O=0,x=Y-X,n.translateAndScale(A,0,0,1);var e=0,S=0,M=J(z/2),N=z-M,P=$?0:M,L=i*D,B=L/10;O-=L,x+=L,A.clearRect(O,0,x-O,z),A.beginPath(),A.fillStyle=w;var G=E(T/B)*B-X;for(e=G;x>e;e+=B)A.rect(e,W+P,1,N);for(e=G;e>O;e-=B)A.rect(e,W+P,1,N);for(A.fill(),P=$?0:1,A.beginPath(),A.fillStyle=F,G=E(T/L)*L-X,e=G;x>e;e+=L)A.rect(e,W+P,1,z-1);for(e=G;e>O;e-=L)A.rect(e,W+P,1,z-1);A.fill();var q=J(/\d+px/.exec(I)[0]),t=(q||10)/2;A.textBaseline="middle",P=$?z-t-2:t+2,A.beginPath(),A.fillStyle=g,A.font=I;var b=E(T/L)*L/D;for(e=G,S=b;x>e;e+=L,S+=i){var f=this.getHScaleText?this.getHScaleText(e):S;A.fillText(this.formatScaleText(f),e+2,W+P)}for(e=G,S=b;e>O;e-=L,S-=i){var f=this.getHScaleText?this.getHScaleText(e):S;A.fillText(this.formatScaleText(f),e+2,W+P)}A.restore()},$12k:function(D,U,u,N,j,p,R,P,b,B,g,m,F){function _(K,E,q,y,T,s){T=l.getVScaleText?l.getVScaleText(q):T,T=l.formatScaleText(T),D.translate(K+E,q),D.rotate(-y),D.translate(-K-E,-q),D.fillText(T,K+E+(s?2:1),q),D.translate(K+E,q),D.rotate(y),D.translate(-K-E,-q)}D.save(),U=0;var h=u,t=j,Z=(h+t)/2;u=0,j=t-h,n.translateAndScale(D,0,0,1);var v=0,l=this,s=0,C=J(p/2),e=p-C,d=g?0:C,q=P*R,T=q/10;u-=q,j+=q,D.clearRect(U,0,p,j-u),D.beginPath(),D.fillStyle=F;var A=E(Z/T)*T-h;for(v=A;j>v;v+=T)D.rect(U+d,v,e,1);for(v=A;v>u;v-=T)D.rect(U+d,v,e,1);for(D.fill(),d=g?0:1,D.beginPath(),D.fillStyle=m,A=E(Z/q)*q-h,v=A;j>v;v+=q)D.rect(U+d,v,p-1,1);for(v=A;v>u;v-=q)D.rect(U+d,v,p-1,1);D.fill();var V=J(/\d+px/.exec(b)[0]),k=(V||10)/2,M=90*o/180;D.textBaseline="middle",d=g?p-k:k+2,M=g?-M:M,D.beginPath(),D.fillStyle=B,D.font=b;var Y=E(Z/q)*q/R;for(v=A,s=Y;j>v;v+=q,s+=P)_(U,d,v,M,s,g);for(v=A,s=Y;v>u;v-=q,s-=P)_(U,d,v,M,s,g);D.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var W=this,A=W._component,Y=W._view;A&&W.removeComponentPropertyChangeListener(A,W.$14k),Y&&(S(Y,"mousemove",W.$15k),j(Y.parentNode,Y),W._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);