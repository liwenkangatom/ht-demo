!function(c,j,K){"use strict";var l="ht",G=c[l],v=G.Default,a=G.graph,J=v.getInternal(),p=J.ui(),E=p.NodeUI.prototype,O=p.ShapeUI.prototype,Z=a.GraphView,Q=Z.prototype,x=p.EdgeUI.prototype,e=G.Node,d=G.Shape,U=G.Edge,P=G.Group,o=v.isTouchable,M=v.preventDefault,q=c.setTimeout,h=v.grow,V=v.isDragging,F=v.getDistance,w=null,I=G.List,T="undefined"!=typeof Float32Array?Float32Array:Array,W=Math,t=W.PI,B="Crossing",k="No Crossing",N=t/2,y=2*t,H=W.atan2,Y=W.sqrt,u=W.pow,_=W.sin,r=W.cos,D=W.min,n=W.max,A=W.abs,z=W.ceil,g=W.round,S=v.unionPoint,X=v.unionRect,L=v.containsPoint,m=v.clone,C="rgb(52, 152, 219)",i="red",$={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},f={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var a=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],t=0;t<a.length;t++){var u=a[t];u=0===t%2?u/400*f.width:u/100*f.height,a[t]=u}return f.width>120&&(a[4]=f.width-26,a[6]=f.width-40,a[10]=f.width-40,a[12]=f.width-26,a[18]=33),a}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},s={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:C,rotation:.61},{type:"circle",rect:[200,120,70,70],background:C,rotation:.61},{type:"circle",rect:[200,220,70,70],background:C,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:C},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:C}]},R={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:i,rotation:.61}]},b={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:C},{type:"circle",rect:[0,210,90,90],background:C},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:C}]},Eo={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:i},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:i}]},nc={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:C}]},Qn={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:i}]},wd={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},ic={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},sj=function(B){var h=B.touches[0];return h?h:B.changedTouches[0]},Tq=function(h,y,k,I){return H(I-y,k-h)},Ye=function(K,q){return{x:K.x*q,y:K.y*q}},Lc=function(b,G){b.each(function(T){return b.isSelected(T)?G(T):void 0})},hb=function(P,j){P.reverseEach(function(n){return P.isSelected(n)?j(n):void 0})},$e=function(n,K,k){var u,c,o,y,S,h=this,G=K,t=h.gv;if(n instanceof d){o=n.getSegments();var l=t.getDataUI(n);S=l._55O.$15l,o&&o.size()||(o=qi(S)),n.isClosePath()&&o.indexOf(5)<0&&(o=new I(o._as),o.add(5)),u=lm(n,l,G),c=S[u]}else{var F=t.getDataUI(n);S=Lk(F,n.s("edge.points")),o=n.s("edge.segments"),o&&o.size()||(o=qi(S)),S=S._as,u=lm(n,F,G),c=S[u]}if(o&&(y=o.get(G)),2===y||1===y||5===y){var Z=S[u+1];5===y&&(Z=S[0]);var V=kh(c,k,Z);return V}return k},yj=function(Q,M,B,k){var S=M/2,P=B/2,p=ap(Q,-S,-P,k),X=ap(Q,S,-P,k),Y=ap(Q,-S,P,k),i=ap(Q,S,P,k),w=ap(Q,0,-P,k),t=ap(Q,S,0,k),O=ap(Q,0,P,k),v=ap(Q,-S,0,k);return[p,X,Y,i,w,t,O,v]},kh=function(K,o,_){var p={x:o.x-K.x,y:o.y-K.y},V={x:_.x-K.x,y:_.y-K.y},H=Y(u(_.x-K.x,2)+u(_.y-K.y,2)),C={x:V.x/H,y:V.y/H},v=p.x*C.x+p.y*C.y,j={x:C.x*v,y:C.y*v};return{x:K.x+j.x,y:K.y+j.y}},ap=function(q,Y,C,n){var E=r(n)*Y-_(n)*C,s=_(n)*Y+r(n)*C;return q?{x:q.x+E,y:q.y+s}:{x:E,y:s}},Cn=function(V,u){return u>2*V?V:u/2},ef=function(z,Q,e,I){var q=F(z,Q);return e=I?D(e,q):Cn(e,q),q?e/=q:e=0,{x:z.x+(Q.x-z.x)*e,y:z.y+(Q.y-z.y)*e}},Ub=function(t,$){var K,L,h=t.gv,v=t._data,D=v._40I,j=v._41I,q=v.s("edge.offset"),p=v.s("edge.source.position"),z=v.s("edge.target.position"),i=v.s("edge.source.offset.x"),S=v.s("edge.source.offset.y"),H=v.s("edge.target.offset.x"),k=v.s("edge.target.offset.y"),V=v.s("edge.source.anchor.x"),o=v.s("edge.source.anchor.y"),f=v.s("edge.target.anchor.x"),d=v.s("edge.target.anchor.y");if($?(K=J.getEdgeAgentPosition(h,D,p,i,S,V,o),L=J.getEdgeAgentPosition(h,j,z,H,k,f,d)):(K=J.getEdgeAgentPosition(h,D,p,0,0,V,o),L=J.getEdgeAgentPosition(h,j,z,0,0,f,d)),"points"===v.s("edge.type")&&q&&!v.s("edge.center")&&K){var u=v.s("edge.points")||new I,r=u.size(),W=ef(K,r?u.get(0):L,q,r),E=ef(L,r?u.get(r-1):K,q,r);K=W,L=E}return[K,L]},Lk=function(Q,E,r){var f=Q._78o,F=Q._data,N=F.s("edge.type"),Z=[f.sourcePoint,f.targetPoint];return"points"===N?r&&(Z=Ub(Q)):Z=f.center?N?r?Ub(Q):Ub(Q,!0):r?Ub(Q):[f.c1,f.c2]:r?Ub(Q):Ub(Q,!0),E=new I(E?E._as:w),E.add(Z[0],0),E.add(Z[1]),E},_l=function(_){return _=new I(_._as),_.removeAt(0),_.removeAt(_.size()-1),_},qi=function(L){L._as||(L=new I(L));var x=new I;x.add(1);for(var O=1;O<L.size();O++)x.add(2);return x},Im=function(W,J){return{x:(W.x+J.x)/2,y:(W.y+J.y)/2}},xg=function(u,Z){return{x:u.x+1*(Z.x-u.x)/4,y:u.y+1*(Z.y-u.y)/4}},jp=function(V,Y){return{x:V.x+3*(Y.x-V.x)/4,y:V.y+3*(Y.y-V.y)/4}},Vb=function(j,h,B,$){var l=h.x+h.width/2,C=h.y+h.height/2,e=Y(l*l+C*C),X=H(C,l)+B;return{x:$.x+e*r(X),y:$.y+e*_(X)}},Ui=Q.validateImpl,ni=Q.isRectEditable,mp=Q.isPointEditable,Tf=Q._42,Oh=O._79o,qh=x._79o,Dr=O._48O,Qj=O._47O,rl=E._48O,ac=E._80o,md=O._80o,zp=E.getSelectWidth,Tg=E._47O,Ni=x._47O,yc=Q.isEditable,tl=["northwest","north","northeast","east","southeast","south","southwest","west"],Qm=function(x,Z,A,U,J,V,n,k,a,i){var h=x.x,r=x.y,l=x.width,R=x.height,C={x:h+l/2,y:r+R/2};U=U||0,Z=ap(C,Z.x-C.x,Z.y-C.y,-U),n&&!k&&(Z.x+=a,Z.y+=i);var t=.01;if("northwest"===A?(Z.x+J>h+l-t&&(Z.x=h+l-J-t),Z.y+J>r+R-t&&(Z.y=r+R-J-t),x=S(Z,{x:h+l,y:r+R})):"north"===A?(Z.y+J>r+R-t&&(Z.y=r+R-J-t),x=S({x:h,y:Z.y},{x:h+l,y:r+R})):"northeast"===A?(Z.x<h+J+t&&(Z.x=h+J+t),Z.y+J>r+R-t&&(Z.y=r+R-J-t),x=S({x:h,y:Z.y},{x:Z.x,y:r+R})):"west"===A?(Z.x+J>h+l-t&&(Z.x=h+l-J-t),x=S({x:Z.x,y:r},{x:h+l,y:r+R})):"east"===A?(Z.x<h+J+t&&(Z.x=h+J+t),x=S({x:h,y:r},{x:Z.x,y:r+R})):"southwest"===A?(Z.x+J>h+l-t&&(Z.x=h+l-J-t),Z.y<r+J+t&&(Z.y=r+J+t),x=S({x:Z.x,y:r},{x:h+l,y:Z.y})):"south"===A?(Z.y<r+J+t&&(Z.y=r+J+t),x=S({x:h,y:r},{x:h+l,y:Z.y})):"southeast"===A&&(Z.x<h+J+t&&(Z.x=h+J+t),Z.y<r+J+t&&(Z.y=r+J+t),x=S({x:h,y:r},Z)),"keepRatio"===V&&(!n&&k||n&&!k)&&("northeast"===A||"southeast"===A||"northwest"===A||"southwest"===A)){var H=x.width,o=x.height,s=H/l,L=o/R,G=D(s,L);x.width=l*G,x.height=R*G,"northeast"===A?x.y=r+(R-x.height):"northwest"===A?(x.y=r+(R-x.height),x.x=h+(l-x.width)):"southwest"===A&&(x.x=h+(l-x.width))}x.x-=C.x,x.y-=C.y;var I=Vb(w,x,U,C);return x.x=I.x-x.width/2,x.y=I.y-x.height/2,x},pe=function(R,U,f,r){var V=R.getRotation(),W=U,n=W.x,s=W.y,K=W.width,w=W.height,d={x:n+W.width/2,y:s+W.height/2};r=ap(d,r.x-d.x,r.y-d.y,-V),"northwest"===f?W=S(r,{x:n+K,y:s+w}):"north"===f?W=S({x:n,y:r.y},{x:n+K,y:s+w}):"northeast"===f?W=S({x:n,y:r.y},{x:r.x,y:s+w}):"west"===f?W=S({x:r.x,y:s},{x:n+K,y:s+w}):"east"===f?W=S({x:n,y:s},{x:r.x,y:s+w}):"southwest"===f?W=S({x:r.x,y:s},{x:n+K,y:r.y}):"south"===f?W=S({x:n,y:s},{x:n+K,y:r.y}):"southeast"===f&&(W=S({x:n,y:s},r)),R.setRect(W),W.x-=d.x,W.y-=d.y;var N=Vb(R,W,V,d);R.p(N.x,N.y)},fg=function(T,f,B,S,A,d,c,L){var n=w;d?(n=ap(w,A.x-f.x,A.y-f.y,-B),n.x-=c.x,n.y-=c.y):n=ap(w,A.x-f.x,A.y-f.y,0);var v={x:f.x+n.x,y:f.y+n.y};L&&(v=L(v.x,v.y)),v.e=T.getPoints().get(S).e,T.setPoint(S,v);var N=T.getWidth(),g=T.getHeight(),b=T.p().x-N/2,O=T.p().y-g/2;b-=f.x,O-=f.y;var y=Vb(T,{x:b,y:O,width:N,height:g},B,f);T.p(y.x,y.y)},lm=function(f,m,o){var X,T;if(f instanceof d?(X=f.getPoints(),T=f.getSegments()):f instanceof U&&"points"===f.s("edge.type")&&(X=f.s("edge.points"),T=f.s("edge.segments"),X=Lk(m,X)),T&&T.size()||(T=qi(X)),f instanceof d&&f.isClosePath()&&T.indexOf(5)<0&&(T=new I(T._as),T.add(5)),T)for(var k=-1,n=0;n<T.size();n++){if(n===o)return k;var F=T.get(n);1===F?k+=1:2===F?k+=1:3===F?k+=2:4===F&&(k+=3)}},Gc=function(P,e,l){var J,w;if(P instanceof d?(J=P.getPoints(),w=P.getSegments()):P instanceof U&&"points"===P.s("edge.type")&&(J=P.s("edge.points"),w=P.s("edge.segments"),J=Lk(e,J)),w&&w.size()||(w=qi(J)),w)for(var H=-1,Y=0;Y<w.size();Y++){var B=w.get(Y);if(1===B?H+=1:2===B?H+=1:3===B?H+=2:4===B&&(H+=3),H===l)return Y}},eq=function(i,d){var R=[i[0]-d[0],i[1]-d[1],i[2]-d[2]];return R},Lj=function(){var J=new T(16);return J[0]=1,J[1]=0,J[2]=0,J[3]=0,J[4]=0,J[5]=1,J[6]=0,J[7]=0,J[8]=0,J[9]=0,J[10]=1,J[11]=0,J[12]=0,J[13]=0,J[14]=0,J[15]=1,J},xr=function(e,m){var P=e[0],s=e[1],J=e[2];return e[0]=m[0]*P+m[4]*s+m[8]*J+m[12],e[1]=m[1]*P+m[5]*s+m[9]*J+m[13],e[2]=m[2]*P+m[6]*s+m[10]*J+m[14],e},Ne=function(Y,a){if(a){var M=_(a),H=r(a),S=Y[0],W=Y[1],t=Y[2],V=Y[3],Q=Y[8],D=Y[9],y=Y[10],N=Y[11];Y[0]=S*H-Q*M,Y[1]=W*H-D*M,Y[2]=t*H-y*M,Y[3]=V*H-N*M,Y[8]=S*M+Q*H,Y[9]=W*M+D*H,Y[10]=t*M+y*H,Y[11]=V*M+N*H}},lc=function(B,I){for(var H=B.s("grid.row.count"),Q=B.s("grid.column.count"),E=0;H>E;E++)for(var r=0;Q>r;r++){var y=B.getCellRect(E,r);if(L(y,I))return{rowIndex:E,columnIndex:r,rect:y,grid:B}}return null},Fd=function(D,i,A,p,L,e){var J={},N=A-D,H=p-i,c=W.sqrt(N*N+H*H),z=N/c,j=H/c,w=(-D+L)*z+(-i+e)*j;return 0>=w?(J.x=D,J.y=i):w>=c?(J.x=A,J.y=p):(J.x=D+w*z,J.y=i+w*j),N=L-J.x,H=e-J.y,J.z=W.sqrt(N*N+H*H),J},Gl=function(M,V){var P,k,K,O,o,b,x,m,N=M.getPoints(),f=M.getSegments(),d=M.p(),E=M.getRotation();if(!f||!(f.indexOf(3)>0||f.indexOf(4)>0)){for(m=0;m<=N.size()-1;m++)if(m===N.size()-1?(o=N.get(0),O=N.get(m)):(O=N.get(m),o=N.get(m+1)),O=ap(d,O.x-d.x,O.y-d.y,E),o=ap(d,o.x-d.x,o.y-d.y,E),b=Fd(O.x,O.y,o.x,o.y,V.x,V.y),x=b.z,x<(M.s("shape.border.width")||10)){k=O,K=o,P=m;break}if(P!=w){var v=Fd(k.x,k.y,K.x,K.y,V.x,V.y),h=F(k,v);return{attachIndex:P,attachOffset:h}}}},Zq=function(F){for(var b=F._data,k=b.p(),g=b.getRotation(),j=b.getPoints(),H=w,G=[],o=0;o<j.size();o++)H=j.get(o),G.push(ap(k,H.x-k.x,H.y-k.y,g));F._55O.$15l=G};v.setImage("xeditinteractor_parentIcon",s),v.setImage("xeditinteractor_hostIcon",R),v.setImage("xeditinteractor_edgeIcon",b),v.setImage("xeditinteractor_removeIcon",Eo),v.setImage("xeditinteractor_sourceIcon",nc),v.setImage("xeditinteractor_targetIcon",Qn),v.setImage("xeditinteractor_elevationIcon",wd),v.setImage("xeditinteractor_tallIcon",ic),Q._editPointSize=o?24:9,Q._edgeHelpers=["parent","remove","source","target"],Q._leftTopHelpers=["parent"],Q._rightTopHelpers=["host"],Q._leftBottomHelpers=["edge"],Q._rightBottomHelpers=["remove"],tl=tl.concat(tl).concat(tl),x._79o=function(){var l=this,z=l.gv,V=z.getZoom(),e=z._editInteractor,j=qh.call(l);if(!j)return null;var r=Ub(l,!0),K=r[0],C=r[1],F={x:j.x,y:j.y,width:j.width,height:j.height},_=S(K,C);if(e instanceof a.XEditInteractor){F=X(F,_);var W=l._55O,N=z.getEditPointSize()/V+2,t=0;W&&W._43O&&(t+=N/2,h(F,t))}return F},x._47O=function(O){var D=this,Z=D.gv,q=Z._editInteractor;q instanceof a.XEditInteractor||Ni.call(D,O)},x.rectIntersects=function(Z){var y=this,e=y._data,h=y.gv,N=h.getZoom(),j=y._55O,t=h._editInteractor;if(t instanceof a.XEditInteractor&&h.isEditable(e)&&j&&j._43O&&"points"===e.s("edge.type")){var r=e.s("edge.points"),x=e.s("edge.segments");r=Lk(y,r),x&&x.size()||(x=qi(r)),r=r._as;var f=!1,K=o?5:1,l=Z.x+K,M=Z.y+K,m={x:l,y:M};if(t._edge===e&&t._hoverSegmentIndex>=0){var C=h._editInteractor._hoverSegmentIndex,D=x.get(C),S=lm(e,y,C),I=w;if(S!=w&&S>=0){var Y=r[S],A=h.getSegmentHoverWidth()/N;if(2===D||1===D){var p=r[S+1];I=sc(new lr(Y.x,Y.y),new lr(p.x,p.y),new lr(m.x-A,m.y-A),new lr(m.x+2*A,m.y+2*A)),I.$62l===B&&(f=!0)}else if(3===D){var G=r[S+1],p=r[S+2];I=Jh(new lr(Y.x,Y.y),new lr(G.x,G.y),new lr(p.x,p.y),new lr(m.x-A,m.y-A),new lr(m.x+2*A,m.y+2*A)),I.$62l===B&&(f=!0)}else if(4===D){var U=r[S+1],E=r[S+2];p=r[S+3],I=ir(new lr(Y.x,Y.y),new lr(U.x,U.y),new lr(E.x,E.y),new lr(p.x,p.y),new lr(m.x-A,m.y-A),new lr(m.x+2*A,m.y+2*A)),I.$62l===B&&(f=!0)}}}if(f)return!0}return w},O._47O=function(I){var F=this,h=F.gv,b=h._editInteractor;b instanceof a.XEditInteractor||Qj.call(F,I)},O.rectIntersects=function(T){var Q=this,D=Q._data,W=Q.gv,i=W.getZoom(),m=Q._55O,O=W._editInteractor;if(O instanceof a.XEditInteractor&&W.isEditable(D)&&m&&m._43O){var U=m.$15l,l=!1,E=o?5:1,H=T.x+E,s=T.y+E,r={x:H,y:s};if(U&&U.length===D.getPoints().size()||(Zq(Q),U=m.$15l),O._shape===D&&O._hoverSegmentIndex>=0){var y=D.getSegments();y&&y.size()||(y=qi(U));var Y=W._editInteractor._hoverSegmentIndex,h=y.get(Y),g=lm(D,Q,Y),F=w;if(g!=w&&g>=0){var b=U[g],V=W.getSegmentHoverWidth()/i;if(2===h||1===h){var G=U[g+1];F=sc(new lr(b.x,b.y),new lr(G.x,G.y),new lr(r.x-V,r.y-V),new lr(r.x+2*V,r.y+2*V)),F.$62l===B&&(l=!0)}else if(3===h){var k=U[g+1],G=U[g+2];F=Jh(new lr(b.x,b.y),new lr(k.x,k.y),new lr(G.x,G.y),new lr(r.x-V,r.y-V),new lr(r.x+2*V,r.y+2*V)),F.$62l===B&&(l=!0)}else if(4===h){var L=U[g+1],u=U[g+2];G=U[g+3],F=ir(new lr(b.x,b.y),new lr(L.x,L.y),new lr(u.x,u.y),new lr(G.x,G.y),new lr(r.x-V,r.y-V),new lr(r.x+2*V,r.y+2*V)),F.$62l===B&&(l=!0)}}}if(l)return!0}return w},O._48O=function(){var R=this,p=R.gv,G=p._editInteractor;G instanceof a.XEditInteractor?(E._48O.call(R),R._55O._43O&&Zq(R)):Dr.call(R)},O._79o=function(){var F=this,s=F.gv,w=s.getZoom(),C=s._editInteractor,u=Oh.call(F);if(u){var c={x:u.x,y:u.y,width:u.width,height:u.height};if(C instanceof a.XEditInteractor){var v=F._55O,V=s.getEditPointSize()/w+2,S=0;v&&v._43O&&(S+=V/2,h(c,S))}return c}},E._47O=function($){var p=this,X=p.gv,i=X._editInteractor;if(i instanceof a.XEditInteractor);else{var R=p._55O;R&&R._98o&&Tg.call(p,$)}},E.getSelectWidth=function(){var J=this,i=J.gv,L=i._editInteractor,S=J._data;return i.isEditable(S)&&L instanceof a.XEditInteractor?0:zp.call(J)},E._80o=function(F){var S=this,q=S.gv._editInteractor;if(ac.call(S,F),q&&q._debug){F.save(),F.beginPath(),F.lineWidth=1,F.strokeStyle="green";var B=S._79o();B&&(F.rect(B.x,B.y,B.width,B.height),F.stroke()),F.restore()}},O._80o=function(r){var L=this,H=L.gv._editInteractor;if(md.call(L,r),H&&H._debug){r.save(),r.beginPath(),r.lineWidth=1,r.strokeStyle="green";var T=L._79o();r.rect(T.x,T.y,T.width,T.height),r.stroke(),r.restore()}},E._48O=function(){var u=this,P=u.gv,y=u._data,r=P._editInteractor,$=u._55O,Z=y.p(),S=y.getRotation();if(r instanceof a.XEditInteractor){if($._42O){var i=yj(Z,y.getWidth(),y.getHeight(),S),H=i[0],l=i[1],G=i[2],W=i[3],e=i[4],v=i[5],c=i[6],z=i[7];$.$45l=[H,e,l,v,W,c,G,z]}}else rl.call(u)},Q.getResizeMode=function(){return this.$25l||"normal"},Q.setResizeMode=function(t){var O=this.$25l;this.$25l=t,this.fp("resizeMode",O,t)},Q.getSnapAngle=function(){return this.$26l||Math.PI/36},Q.setSnapAngle=function(u){var y=this.$26l;this.$26l=u,this.fp("snapAngle",y,u)},Q.getSnapSpacing=function(){return this.$27l},Q.setSnapSpacing=function(m){var Q=this.$27l;this.$27l=m,this.fp("snapSpacing",Q,m)},Q.getPointSnapSpacing=function(){return this._pointSnapSpacing},Q.setPointSnapSpacing=function(w){var g=this._pointSnapSpacing;this._pointSnapSpacing=w,this.fp("pointSnapSpacing",g,w)},Q.setHelperEditableFunc=function(D){var m=this._helperEditableFunc;this._helperEditableFunc=D,this.fp("helperEditableFunc",m,D)},Q.getHelperEditableFunc=function(){return this._helperEditableFunc},Q.setLeftTopHelpers=function(n){var b=this._leftTopHelpers;this._leftTopHelpers=n,this.fp("leftTopHelpers",b,n)},Q.getLeftTopHelpers=function(){return this._leftTopHelpers},Q.setLeftTopHelpersAlign=function(l){var x=this._leftTopHelpersAlign;this._leftTopHelpersAlign=l,this.fp("leftTopHelpersAlign",x,l)},Q.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},Q.setRightTopHelpers=function(Y){var e=this._rightTopHelpers;this._rightTopHelpers=Y,this.fp("rightTopHelpers",e,Y)},Q.getRightTopHelpers=function(){return this._rightTopHelpers},Q.setRightTopHelpersAlign=function(n){var s=this._rightTopHelpersAlign;this._rightTopHelpersAlign=n,this.fp("rightTopHelpersAlign",s,n)},Q.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},Q.setLeftBottomHelpers=function(T){var w=this._leftBottomHelpers;this._leftBottomHelpers=T,this.fp("leftBottomHelpers",w,T)},Q.getLeftBottomHelpers=function(){return this._leftBottomHelpers},Q.setLeftBottomHelpersAlign=function(q){var X=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=q,this.fp("leftBottomHelpersAlign",X,q)},Q.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},Q.setRightBottomHelpers=function(w){var H=this._rightBottomHelpers;this._rightBottomHelpers=w,this.fp("rightBottomHelpers",H,w)},Q.getRightBottomHelpers=function(){return this._rightBottomHelpers},Q.setRightBottomHelpersAlign=function(r){var C=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=r,this.fp("rightBottomHelpersAlign",C,r)},Q.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},Q.setEdgeHelpers=function(V){var h=this._edgeHelpers;this._edgeHelpers=V,this.fp("edgeHelpers",h,V)},Q.getEdgeHelpers=function(){return this._edgeHelpers},Q.isHelperEditable=function(x,Z){return x instanceof U&&("host"===Z||"edge"===Z||"elevation"===Z||"tall"===Z)?!1:x instanceof e&&("source"===Z||"target"===Z)?!1:"pointElevation"===Z?this._helperEditableFunc?this._helperEditableFunc(x,Z):!1:this._helperEditableFunc?this._helperEditableFunc(x,Z):!0},Q.getEditHelperSize=function(){return this._editHelperSize||(o?28:16)},Q.setEditHelperSize=function(P){var B=this._editHelperSize;this._editHelperSize=P,this.fp("editHelperSize",B,P)},Q.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},Q.setEditRectBorderColor=function(i){var $=this.$28l;this.$28l=i,this.fp("editRectBorderColor",$,i)},Q.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},Q.setNodeBorderColor=function(D){var r=this.$29l;this.$29l=D,this.fp("nodeBorderColor",r,D)},Q.getEditRectBorderStyle=function(){return this.$30l||"dashed"},Q.setEditRectBorderStyle=function(Z){var X=this.$30l;this.$30l=Z,this.fp("editRectBorderStyle",X,Z)},Q.getControlPointBackground=function(){return this.$31l||"#ff0"},Q.setControlPointBackground=function(T){var U=this.$31l;this.$31l=T,this.fp("controlPointBackground",U,T)},Q.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},Q.setControlPointBorderColor=function(V){var R=this.$32l;this.$32l=V,this.fp("controlPointBorderColor",R,V)},Q.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},Q.setJoinPointBackground=function(H){var X=this.$33l;this.$33l=H,this.fp("joinPointBackground",X,H)},Q.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},Q.setJoinPointBorderColor=function(A){var r=this.$34l;this.$34l=A,this.fp("joinPointBorderColor",r,A)},Q.getDirectionLineColor=function(){return this.$35l||"#888"},Q.setDirectionLineColor=function(S){var T=this.$35l;this.$35l=S,this.fp("directionLineColor",T,S)},Q.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},Q.setSegmentHoverColor=function(a){var l=this.$36l;this.$36l=a,this.fp("segmentHoverColor",l,a)},Q.getSegmentHoverWidth=function(){return this.$22l||(o?16:8)},Q.setSegmentHoverWidth=function(X){var Y=this.$22l;this.$22l=X,this.fp("segmentHoverWidth",Y,X)},Q.getSnapPointBorderColor=function(){return this.$38l||"#f00"},Q.setSnapPointBorderColor=function(D){var G=this.$38l;this.$38l=D,this.fp("snapPointBorderColor",G,D)},Q.getEditRectPadding=function(){return this.$39l!=w?this.$39l:6},Q.setEditRectPadding=function(E){var O=this.$39l;this.$39l=E,this.fp("editRectPading",O,E)},Q.isRectEditable=function(v){var S=this,p=S._editInteractor;return p instanceof a.XEditInteractor?S._rectEditableFunc?S._rectEditableFunc(v):!0:ni.call(S,v)},Q.isPointEditable=function(W){var K=this,X=K._editInteractor;return X instanceof a.XEditInteractor?K._pointEditableFunc?K._pointEditableFunc(W):!0:mp.call(K,W)},Q.validateImpl=function(){var o=this,V=o.$14l,n=o._editInteractor;if(V){var F=o.getWidth(),s=o.getHeight();(F!==V.clientWidth||s!==V.clientHeight)&&(n&&(n._68I=1),J.setCanvas(V,F,s),o._32I=1)}Ui.call(this)},Q.isEditable=function(v){var y=yc.call(this,v),X=this._editInteractor;if(X instanceof a.XEditInteractor&&v instanceof U){if(!v.s("2d.editable"))return!1;var R=this.getEditableFunc();y=R?R(v):!0}return y},Q._42=function(X,q){var O=this,m=O._editInteractor;Tf.call(O,X,q),m instanceof a.XEditInteractor&&m._68I&&m._42()},Q.isSnapPoint=function(){return!0};var gl=function(p){arguments.length>0&&this.$58l(p)},vd=gl.prototype;vd.$58l=function(l){this.$62l=l,this.points=new Array},vd.$56l=function(K){this.points.push(K)},vd.$57l=function(k){this.points=this.points.concat(k)};var lr=function(E,p){arguments.length>0&&this.$58l(E,p)},hk=lr.prototype;hk.$58l=function(X,S){this.x=X,this.y=S},hk.add=function(t){return new lr(this.x+t.x,this.y+t.y)},hk.addEquals=function(v){return this.x+=v.x,this.y+=v.y,this},hk.$55l=function(F){return new lr(this.x*F,this.y*F)},hk.eq=function(i){return this.x==i.x&&this.y==i.y},hk.lt=function(Z){return this.x<Z.x&&this.y<Z.y},hk.lte=function(o){return this.x<=o.x&&this.y<=o.y},hk.gt=function(x){return this.x>x.x&&this.y>x.y},hk.gte=function(w){return this.x>=w.x&&this.y>=w.y},hk.lerp=function(H,T){return new lr(this.x+(H.x-this.x)*T,this.y+(H.y-this.y)*T)},hk.distanceFrom=function(o){var J=this.x-o.x,I=this.y-o.y;return Y(J*J+I*I)},hk.min=function(W){return new lr(D(this.x,W.x),D(this.y,W.y))},hk.max=function(j){return new lr(n(this.x,j.x),n(this.y,j.y))},hk.toString=function(){return this.x+","+this.y};var vc=function(){this.$58l(arguments)},Xn=vc.prototype;vc.TO=1e-6,vc.AC=6,Xn.$58l=function(l){this.co=new Array;for(var j=l.length-1;j>=0;j--)this.co.push(l[j])},Xn.$55l=function(x){for(var h=new vc,i=0;i<=this.$50l()+x.$50l();i++)h.co.push(0);for(var i=0;i<=this.$50l();i++)for(var H=0;H<=x.$50l();H++)h.co[i+H]+=this.co[i]*x.co[H];return h},Xn.$59l=function(){for(var y=this.$50l();y>=0&&A(this.co[y])<=vc.TO;y--)this.co.pop()},Xn.$50l=function(){return this.co.length-1},Xn.$51l=function(){var P;switch(this.$59l(),this.$50l()){case 0:P=new Array;break;case 1:P=this.$52l();break;case 2:P=this.$53l();break;case 3:P=this.$54l();break;case 4:P=this.$63l();break;default:P=new Array}return P},Xn.$52l=function(){var R=new Array,P=this.co[1];return 0!=P&&R.push(-this.co[0]/P),R},Xn.$53l=function(){var S=new Array;if(2==this.$50l()){var P=this.co[2],i=this.co[1]/P,r=this.co[0]/P,b=i*i-4*r;if(b>0){var W=Y(b);S.push(.5*(-i+W)),S.push(.5*(-i-W))}else 0==b&&S.push(.5*-i)}return S},Xn.$63l=function(){var y=new Array;if(4==this.$50l()){var e=this.co[4],l=this.co[3]/e,D=this.co[2]/e,N=this.co[1]/e,c=this.co[0]/e,z=new vc(1,-D,l*N-4*c,-l*l*c+4*D*c-N*N).$54l(),M=z[0],J=l*l/4-D+M;if(A(J)<=vc.TO&&(J=0),J>0){var C=Y(J),K=3*l*l/4-C*C-2*D,E=(4*l*D-8*N-l*l*l)/(4*C),i=K+E,k=K-E;if(A(i)<=vc.TO&&(i=0),A(k)<=vc.TO&&(k=0),i>=0){var T=Y(i);y.push(-l/4+(C+T)/2),y.push(-l/4+(C-T)/2)}if(k>=0){var T=Y(k);y.push(-l/4+(T-C)/2),y.push(-l/4-(T+C)/2)}}else if(0>J);else{var E=M*M-4*c;if(E>=-vc.TO){if(0>E&&(E=0),E=2*Y(E),K=3*l*l/4-2*D,K+E>=vc.TO){var v=Y(K+E);y.push(-l/4+v/2),y.push(-l/4-v/2)}if(K-E>=vc.TO){var v=Y(K-E);y.push(-l/4+v/2),y.push(-l/4-v/2)}}}}return y},Xn.$54l=function(){var t=new Array;if(3==this.$50l()){var R=this.co[3],F=this.co[2]/R,s=this.co[1]/R,k=this.co[0]/R,h=(3*s-F*F)/3,P=(2*F*F*F-9*s*F+27*k)/27,w=F/3,L=P*P/4+h*h*h/27,z=P/2;if(A(L)<=vc.TO&&(L=0),L>0){var d,I,i=Y(L);d=-z+i,I=d>=0?u(d,1/3):-u(-d,1/3),d=-z-i,d>=0?I+=u(d,1/3):I-=u(-d,1/3),t.push(I-w)}else if(0>L){var V=Y(-h/3),g=H(Y(-L),-z)/3,J=r(g),G=_(g),Z=Y(3);t.push(2*V*J-w),t.push(-V*(J+Z*G)-w),t.push(-V*(J-Z*G)-w)}else{var d;d=z>=0?-u(z,1/3):u(-z,1/3),t.push(2*d-w),t.push(-d-w)}}return t};var yr=function(_,D){arguments.length>0&&this.$58l(_,D)},Cd=yr.prototype;Cd.$58l=function(L,O){this.x=L,this.y=O},Cd.length=function(){return Y(this.x*this.x+this.y*this.y)},Cd.$60l=function(v){return this.x*v.x+this.y*v.y};var Nj=function(y,w,o,z){var Y,x=(z.x-o.x)*(y.y-o.y)-(z.y-o.y)*(y.x-o.x),e=(w.x-y.x)*(y.y-o.y)-(w.y-y.y)*(y.x-o.x),v=(z.y-o.y)*(w.x-y.x)-(z.x-o.x)*(w.y-y.y);if(0!=v){var R=x/v,T=e/v;R>=0&&1>=R&&T>=0&&1>=T?(Y=new gl(B),Y.points.push(new lr(y.x+R*(w.x-y.x),y.y+R*(w.y-y.y)))):Y=new gl(k)}else Y=0==x||0==e?new gl("C"):new gl("P");return Y},ce=function(M,D,P,g,n){var C,A,J,H,y,d,O,o=g.min(n),S=g.max(n),r=new gl(k);C=D.$55l(-2),J=M.add(C.add(P)),C=M.$55l(-2),A=D.$55l(2),H=C.add(A),y=new lr(M.x,M.y),O=new yr(g.y-n.y,n.x-g.x),d=g.x*n.y-n.x*g.y;for(var i=new vc(O.$60l(J),O.$60l(H),O.$60l(y)+d).$51l(),X=0;X<i.length;X++){var j=i[X];if(j>=0&&1>=j){var F=M.lerp(D,j),$=D.lerp(P,j),Q=F.lerp($,j);g.x==n.x?o.y<=Q.y&&Q.y<=S.y&&(r.$62l=B,r.$56l(Q)):g.y==n.y?o.x<=Q.x&&Q.x<=S.x&&(r.$62l=B,r.$56l(Q)):Q.gte(o)&&Q.lte(S)&&(r.$62l=B,r.$56l(Q))}}return r},Jh=function(t,o,s,u,K){var Y=u.min(K),Z=u.max(K),V=new lr(Z.x,Y.y),w=new lr(Y.x,Z.y),h=ce(t,o,s,Y,V),z=ce(t,o,s,V,Z),y=ce(t,o,s,Z,w),L=ce(t,o,s,w,Y),_=new gl(k);return _.$57l(h.points),_.$57l(z.points),_.$57l(y.points),_.$57l(L.points),_.points.length>0&&(_.$62l=B),_},as=function(v,p,y,Q,V,T){var J,r,t,G,H,d,e,R,F,s,h=V.min(T),o=V.max(T),D=new gl(k);J=v.$55l(-1),r=p.$55l(3),t=y.$55l(-3),G=J.add(r.add(t.add(Q))),H=new yr(G.x,G.y),J=v.$55l(3),r=p.$55l(-6),t=y.$55l(3),G=J.add(r.add(t)),d=new yr(G.x,G.y),J=v.$55l(-3),r=p.$55l(3),t=J.add(r),e=new yr(t.x,t.y),R=new yr(v.x,v.y),s=new yr(V.y-T.y,T.x-V.x),F=V.x*T.y-T.x*V.y;for(var $=new vc(s.$60l(H),s.$60l(d),s.$60l(e),s.$60l(R)+F).$51l(),f=0;f<$.length;f++){var b=$[f];if(b>=0&&1>=b){var X=v.lerp(p,b),N=p.lerp(y,b),U=y.lerp(Q,b),Z=X.lerp(N,b),u=N.lerp(U,b),S=Z.lerp(u,b);V.x==T.x?h.y<=S.y&&S.y<=o.y&&(D.$62l=B,D.$56l(S)):V.y==T.y?h.x<=S.x&&S.x<=o.x&&(D.$62l=B,D.$56l(S)):S.gte(h)&&S.lte(o)&&(D.$62l=B,D.$56l(S))}}return D},ir=function($,P,Y,A,b,J){var G=b.min(J),t=b.max(J),j=new lr(t.x,G.y),s=new lr(G.x,t.y),U=as($,P,Y,A,G,j),h=as($,P,Y,A,j,t),e=as($,P,Y,A,t,s),V=as($,P,Y,A,s,G),Q=new gl(k);return Q.$57l(U.points),Q.$57l(h.points),Q.$57l(e.points),Q.$57l(V.points),Q.points.length>0&&(Q.$62l=B),Q},sc=function(C,g,M,Y){var Z=M.min(Y),p=M.max(Y),T=new lr(p.x,Z.y),R=new lr(Z.x,p.y),u=Nj(Z,T,C,g),K=Nj(T,p,C,g),I=Nj(p,R,C,g),A=Nj(R,Z,C,g),F=new gl(k);return F.$57l(u.points),F.$57l(K.points),F.$57l(I.points),F.$57l(A.points),F.points.length>0&&(F.$62l=B),F},eo=a.XEditInteractor=function(K){var h=this,_=h._view=document.createElement("canvas");_.className="editCanvas",_.style.position="absolute",eo.superClass.constructor.call(h,K)};v.def(eo,a.Interactor,{ms_edit:1,setUp:function(){var s=this,P=s.gv,w=P.getView(),D=s._view;eo.superClass.setUp.call(s),P.setEditInteractor(s),P.$14l=D,P._79O?w.insertBefore(D,P._79O):w.appendChild(D);var W=s.$49l=s.$11l.bind(s);P.dm().md(W),P.sm().ms(W),P.mp(W)},tearDown:function(){var b=this,n=b.gv,s=n.getView(),W=b.$49l;eo.superClass.tearDown.call(b),n.setEditInteractor(w),n.$14l=w,s.removeChild(b._view),n.dm().umd(W),n.sm().ums(W),n.ump(W)},clear:function(){var M=this,h=M.gv;delete M._hoverSegmentIndex,delete M._edge,delete M._shape,delete h._editing,delete M.$10l,delete M.$13l,delete M.$9l,delete M._removePointIndex,delete M._lp,M.$12l="",delete M.$40l,delete M.$67l,delete M.$72l,delete M.$73l,delete M.$75l,delete M.$1l,delete M.$3l,delete M.$2l,delete M.$92l,delete M.$93l,delete M.$94l,M.clearDragging()},handle_keydown:function(O){this.$48l!==O.shiftKey&&(this.$48l=O.shiftKey,this.handle_mousemove(O,K,!0))},handle_keyup:function(o){this.$48l!==o.shiftKey&&(this.$48l=o.shiftKey,this.handle_mousemove(o,K,!0))},handle_touchstart:function(J){this.handle_mousemove(J),this.handle_mousedown(J)},handle_mousedown:function(A){M(A);var x=this,E=x.$13l,J=x.gv,_=J.dm(),K=J.sm(),u=J.getZoom(),Q=J.lp(A),D=v.isDoubleClick(A),k=v.isLeftButton(A),y=x.$7l,I=x._shape,n=x._hoverSegmentIndex,B=x._edge,Z=x.$87l,g=x.$88l,H=function(){x._68I||Z===x.$87l&&g===x.$88l||x.$43l()};if(7!==x.$67l&&(delete x.$87l,delete x.$88l),k&&(I||B)&&n>=0&&D&&(I&&K.contains(I)||B&&K.contains(B))){var d=$e.call(x,I||B,n,Q);return x.addShapePoint(I||B,n,d),q(function(){x.handle_mousemove(A)},40),void 0}if(k&&(I||B)&&x._removePointIndex>=0&&D)return x.removeShapePoint(),x.$5l=1,q(function(){x.handle_mousemove(A)},40),void 0;if(!k||!J._editing)return H(),void 0;if(I&&E>=0){var b=I.getPoints().get(E),O=I.p(),s=ap(O,b.x-O.x,b.y-O.y,-y+I.getRotation());h=ap(O,Q.x-O.x,Q.y-O.y,-y),x.$24l={x:h.x-s.x,y:h.y-s.y},x.startDragging(A),_.beginTransaction(),x.fi({kind:"beginEditPoint",event:A,data:I,index:E}),x.$88l=E,x.$87l=I}else if(x.$10l){var S=J.sm().getSelection(),l=x.$6l,r=x.$1l={},T=x.$3l={},G=x.$16l[$[x.$10l]],p={x:l.x,y:l.y},c={x:l.x+l.width/2,y:l.y+l.height/2};x.$24l={x:Q.x-G.x/u,y:Q.y-G.y/u},x.$2l=m(x.$8l),x.$4l=m(l),S.each(function(n){if(n instanceof e){var P=n.p(),U=n.getWidth(),t=n.getHeight(),S=ap(c,P.x-c.x,P.y-c.y,-y);r[n.getId()]={x:P.x-U/2,y:P.y-t/2,width:U,height:t},T[n.getId()]={x:(S.x-p.x)/l.width,y:(S.y-p.y)/l.height}}}),x.startDragging(A),_.beginTransaction(),x.fi({kind:"beginEditRect",event:A,direction:x.$10l})}else if(B&&E>=0){var R=Lk(J.getDataUI(B),B.s("edge.points")),b=R.get(E);x.$24l={x:Q.x-b.x,y:Q.y-b.y},x.startDragging(A),_.beginTransaction(),x.fi({kind:"beginEditPoint",event:A,data:B,index:E}),x.$88l=E,x.$87l=B}else if(x.$40l){var l=x.$6l,c={x:l.x+l.width/2,y:l.y+l.height/2},W=m(x.$23l);W.x/=u,W.y/=u;var Y=ap(c,W.x-c.x,W.y-c.y,-y),h=ap(c,Q.x-c.x,Q.y-c.y,-y);x.$24l={x:h.x-Y.x,y:h.y-Y.y},x.startDragging(A),_.beginTransaction(),x.fi({kind:"beginEditRotation",event:A,data:x._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(x.$67l)>=0){var i=x.$67l;(7===i||8===i||9===i)&&_.beginTransaction(),x.startDragging(A)}else if(x.$71l&&D&&x.$79l(x.$71l,Q)){var P=K.toSelection();_.beginTransaction(),P.each(function(o){_.remove(o)}),_.endTransaction()}H()},$11l:function(){var T=this,e=T.gv;e._editing&&(T.$13l==w||T._shape==w&&T._edge==w)&&(T.$73l==w||1!==T.$67l&&5!==T.$67l&&6!==T.$67l)||(T.$5l=1),T._68I=1},$46l:function(F){var O=this,h=O.gv,g=h.lp(F),d=[];return hb(h,function(q){var R=h.getDataUI(q);if(R){var T=R._79o();L(T,g)&&d.push(q)}}),d},$47l:function(J){var L=this,N=L.$13l,f=L.gv.dm();L.$10l?(L.fi({kind:"endEditRect",event:J,direction:L.$10l}),f.endTransaction()):L._shape&&N>=0?(L.fi({kind:"endEditPoint",event:J,data:L._shape,index:N}),f.endTransaction()):L._edge&&N>=0?(L.fi({kind:"endEditPoint",event:J,data:L._edge,index:N}),f.endTransaction()):L.$23l&&L.$40l&&(L.fi({kind:"endEditRotation",event:J}),f.endTransaction())},handleWindowTouchEnd:function(E){this.handleWindowMouseUp(E)},handleWindowMouseUp:function(V){var p=this,Y=p.gv,s=Y.dm(),t=p._shape,S=p._edge,m=p.$13l,E=p.$40l,q=p.$9l,L=p.$10l,Q=p.$67l;if((t||S)&&m>=0&&q>=0){var M,j;if(t){var O=t.p(),Z=t.getRotation();M=t.getPoints(),j=M.get(q),fg(t,O,Z,m,j,!1)}else if(M=Lk(Y.getDataUI(S),S.s("edge.points"),!0),j=M.get(q),0===m){var k=M.get(0);S.s("edge.source.offset.x",j.x-k.x),S.s("edge.source.offset.y",j.y-k.y)}else if(m===M.size()-1){var I=M.get(M.size()-1);S.s("edge.target.offset.x",j.x-I.x),S.s("edge.target.offset.y",j.y-I.y)}else"points"===S.s("edge.type")&&(M.set(m,j),S.s("edge.points",_l(M)))}p.$47l(V);var D=p.$73l;1===Q?(s.beginTransaction(),D?Y.sm().each(function(r){if(r.setHost&&Y.isHelperEditable(r,"host")){r.setHost(D);
var R=p.$75l,U=p.$74l;R&&(r.s("attach.row.index",R.rowIndex),r.s("attach.column.index",R.columnIndex)),U&&(r.s("attach.index",U.attachIndex),r.s("attach.offset",U.attachOffset),r.s("attach.offset.relative",!1),r.s("attach.offset.opposite",!1))}}):Y.sm().each(function(X){X.setHost&&Y.isHelperEditable(X,"host")&&(X.setHost(w),X.s("attach.row.index",K),X.s("attach.column.index",K),X.s("attach.index",K),X.s("attach.offset",K),X.s("attach.offset.relative",!1),X.s("attach.offset.opposite",!1))}),s.endTransaction()):2===Q?(s.beginTransaction(),D?Y.sm().each(function(s){s.setParent&&Y.isHelperEditable(s,"parent")&&s.setParent(D)}):Y.sm().each(function(E){E.setParent&&Y.isHelperEditable(E,"parent")&&E.setParent(w)}),s.endTransaction()):3===Q?D&&(s.beginTransaction(),Y.sm().each(function(P){if(Y.isHelperEditable(P,"edge")&&P instanceof e&&D instanceof e){var W=new G.Edge;s.add(W),W.setSource(P),W.setTarget(D),p.onEdgeCreated&&p.onEdgeCreated(V,W)}}),s.endTransaction()):5===Q||6===Q?D&&(s.beginTransaction(),Y.sm().each(function(G){G instanceof U&&D instanceof e&&(5===Q&&Y.isHelperEditable(G,"source")?G.setSource(D):6===Q&&Y.isHelperEditable(G,"source")&&G.setTarget(D))}),s.endTransaction()):(7===Q||8===Q||9===Q)&&s.endTransaction(),(L||E)&&p.$43l(!0),o?(p.clear(),delete p.$64l,p._68I||p.$43l()):(p.handle_mousemove(V,!0),Q&&!p._68I&&p.$43l())},handleWindowTouchMove:function(d){this.handleWindowMouseMove(d)},handleWindowMouseMove:function(b){this._78I(b)},handle_mousemove:function(T,k,q){if(!this._pause){if(!q){var l=o?sj(T):T;this.$61l={clientX:l.clientX,clientY:l.clientY}}if(k===!0||!V()){var L=this,t=L.gv,b=!1,y=w;L.clear(),t.sm().size()>0&&(y=t.lp(q?L.$61l:T),b=L._79I(T,y)),b&&(t._editing=1),L.$12l!==L.$65l&&(L.$65l=L.$12l,L.setCursor(L.$12l)),L.$40l!==L.$64l&&(L.$64l=L.$40l,L._68I||L.$43l()),L._hoverSegmentIndex!==L.$66l&&(L.$66l=L._hoverSegmentIndex,L._68I||L.$43l())}}},_78I:function(l){this.autoScroll(l);var I=this,S=I.gv,c=S.lp(l),j=S.getZoom(),n=I.$13l;if((I._shape||I._edge)&&n>=0){var s,D,o,C=I._shape,a=I._edge,O=I.$24l,T=S.getPointSnapSpacing(),i=function(R,k){return T==w||isNaN(T)?{x:R,y:k}:{x:g(R/T)*T,y:g(k/T)*T}};if(C){s=C.getPoints();var r=C.p(),h=C.getRotation(),u=0;D=ap(r,c.x-r.x,c.y-r.y,-h),fg(C,r,h,n,c,!0,O,i),I.fi({kind:"betweenEditPoint",event:l,data:C,index:n})}else if(a){s=Lk(S.getDataUI(a),a.s("edge.points"),!0),c.x-=O.x,c.y-=O.y,D=c;var m,k,R=a.s("edge.offset"),p=s.size(),x=p>2;if(0===n){var B=s.get(0);R&&(B=ef(B,s.get(1),-R,x),c=ef(c,s.get(1),-R,x)),m=c.x-B.x,k=c.y-B.y,o=i(m,k),a.s("edge.source.offset.x",o.x),a.s("edge.source.offset.y",o.y)}else if(n===p-1){var M=s.get(p-1);R&&(M=ef(M,s.get(p-2),-R,x),c=ef(c,s.get(p-2),-R,x)),m=c.x-M.x,k=c.y-M.y,o=i(m,k),a.s("edge.target.offset.x",o.x),a.s("edge.target.offset.y",o.y)}else"points"===a.s("edge.type")&&(o=i(c.x,c.y),o.e=s.get(n).e,s.set(n,o),a.s("edge.points",_l(s)));I.fi({kind:"betweenEditPoint",event:l,data:a,index:n})}if(delete I.$9l,S.isSnapPoint(C)||S.isSnapPoint(a))for(u=0;u<s.size();u++)if(u!==n){var z=s.get(u);if(F(z,D)<S.getEditPointSize()/j){I.$9l=u;break}}}else if(I.$10l){var O=I.$24l;c.x-=O.x,c.y-=O.y;var Q=S.sm().getSelection(),E=I.$1l,V=I.$7l,b=I.$10l,_=I.$4l,J=I.$2l,Z=S.getEditRectPadding()/j,L=2*Z,W=S.getSnapSpacing(),X=W!=w&&!isNaN(W),P=Qm(J,c,b,V,2*Z,S.getResizeMode(),X,!0),f=I.$6l;if(X){var $=P.width-L,K=P.height-L,G=g($/W)*W,Dj=g(K/W)*W,bk=G-$,Cp=Dj-K;("west"===b||"northwest"===b||"southwest"===b)&&(bk=-bk),("north"===b||"northwest"===b||"northeast"===b)&&(Cp=-Cp),P=Qm(J,c,b,V,2*Z,S.getResizeMode(),X,!1,bk,Cp)}I.$8l=P,f.x=P.x+Z,f.y=P.y+Z,f.width=P.width-L,f.height=P.height-L;var dq=P.x+P.width/2,np=P.y+P.height/2,qf=f.x,Bn=f.y,Te=f.width/_.width,Qn=f.height/_.height;Q.each(function(d){if(d instanceof e&&S.isEditable(d)&&S.isRectEditable(d)){var j=E[d.getId()],q=I.$3l[d.getId()],p={x:j.x+j.width/2,y:j.y+j.height/2},N=0,k=0,a=b,H=180*A(V-d.getRotation())/t;"northeast"===b?H>=315||45>H?(N=j.width*Te+j.x,k=j.height*(1-Qn)+j.y,a="northeast"):H>=45&&135>H?(N=j.width*(1-Qn)+j.x,k=j.height*(1-Te)+j.y,a="northwest"):H>=135&&225>H?(N=j.width*(1-Te)+j.x,k=j.height*Qn+j.y,a="southwest"):(N=j.width*Qn+j.x,k=j.height*Te+j.y,a="southeast"):"north"===b?H>=315||45>H?(k=j.height*(1-Qn)+j.y,a="north"):H>=45&&135>H?(N=j.width*(1-Qn)+j.x,a="west"):H>=135&&225>H?(k=j.height*Qn+j.y,a="south"):(N=j.width*Qn+j.x,a="east"):"northwest"===b?H>=315||45>H?(N=j.width*(1-Te)+j.x,k=j.height*(1-Qn)+j.y,a="northwest"):H>=45&&135>H?(N=j.width*(1-Qn)+j.x,k=j.height*Te+j.y,a="southwest"):H>=135&&225>H?(N=j.width*Te+j.x,k=j.height*Qn+j.y,a="southeast"):(N=j.width*Qn+j.x,k=j.height*(1-Te)+j.y,a="northeast"):"west"===b?H>=315||45>H?(N=j.width*(1-Te)+j.x,a="west"):H>=45&&135>H?(k=j.height*Te+j.y,a="south"):H>=135&&225>H?(N=j.width*Te+j.x,a="east"):(k=j.height*(1-Te)+j.y,a="north"):"southwest"===b?H>=315||45>H?(N=j.width*(1-Te)+j.x,k=j.height*Qn+j.y,a="southwest"):H>=45&&135>H?(N=j.width*Qn+j.x,k=j.height*Te+j.y,a="southeast"):H>=135&&225>H?(N=j.width*Te+j.x,k=j.height*(1-Qn)+j.y,a="northeast"):(N=j.width*(1-Qn)+j.x,k=j.height*(1-Te)+j.y,a="northwest"):"east"===b?H>=315||45>H?(N=j.width*Te+j.x,a="east"):H>=45&&135>H?(k=j.height*(1-Te)+j.y,a="north"):H>=135&&225>H?(N=j.width*(1-Te)+j.x,a="west"):(k=j.height*Te+j.y,a="south"):"south"===b?H>=315||45>H?(k=j.height*Qn+j.y,a="south"):H>=45&&135>H?(N=j.width*Qn+j.x,a="east"):H>=135&&225>H?(k=j.height*(1-Qn)+j.y,a="north"):(N=j.width*(1-Qn)+j.x,a="west"):"southeast"===b&&(H>=315||45>H?(N=j.width*Te+j.x,k=j.height*Qn+j.y,a="southeast"):H>=45&&135>H?(N=j.width*Qn+j.x,k=j.height*(1-Te)+j.y,a="northeast"):H>=135&&225>H?(N=j.width*(1-Te)+j.x,k=j.height*(1-Qn)+j.y,a="northwest"):(N=j.width*(1-Qn)+j.x,k=j.height*Te+j.y,a="southwest"));var x=ap(p,N-p.x,k-p.y,d.getRotation());pe(d,j,a,{x:x.x,y:x.y});var U=qf+f.width*q.x,w=Bn+f.height*q.y,_={x:U,y:w};_=ap({x:dq,y:np},_.x-dq,_.y-np,V),d.p(_.x,_.y)}}),I.fi({kind:"betweenEditRect",event:l,direction:b})}else if(I.$23l&&I.$40l){var Ao=I.$8l,Wn=Ao.width,pg=Ao.height,r={x:Ao.x+Wn/2,y:Ao.y+pg/2},O=I.$24l,Yf=I.$23l,Tn=Yf.x/j-r.x,rf=Yf.y/j-r.y,Gj=Y(Tn*Tn+rf*rf),yd=Math.asin(O.x/Gj),so=S.sm().getSelection(),Bf=N+H(c.y-r.y,c.x-r.x)-yd,eg=S.getSnapAngle(),Bf=g(Bf/eg)*eg;0>Bf&&(Bf+=y);var Ih=Bf-I.$7l,gp=[r.x,0,r.y];so.each(function(y){if(S.isEditable(y)&&S.isRotationEditable(y)&&S.isVisible(y)){var c=eq(y.p3(),gp),d=Lj();Ne(d,-Ih),y.setRotation(y.getRotation()+Ih),xr(c,d),y.p3(gp[0]+c[0],gp[1]+c[1],gp[2]+c[2])}}),I.$7l=Bf,I.fi({kind:"betweenEditRotation",event:l})}else if([1,2,3,5,6].indexOf(I.$67l)>=0)I.$72l=l,I.$78l||(I.$78l=1,q(function(){v.isDragging()&&I.$43l(),delete I.$78l},12));else if(7===I.$67l){if(I.$87l instanceof d){var C=I.$87l,Vi=I.$88l,zq=v.clone(C.getPoints().get(Vi)),af=c.y-zq.y;zq.e||(zq.e=0),I.$92l||(I.$92l=zq.e),zq.e=I.$92l-af,C.setPoint(Vi,zq)}else if(I.$87l instanceof U){var a=I.$87l,Vi=I.$88l,s=Lk(S.getDataUI(a),a.s("edge.points")),zq=s.get(Vi),af=c.y-zq.y;zq.e||(zq.e=0),I.$92l||(I.$92l=zq.e),zq.e=I.$92l-af,s.set(Vi,zq),a.s("edge.points",_l(s))}}else if(8===I.$67l){var so=S.sm().getSelection(),er=I.$93l;er||(er=I.$93l={}),so.each(function(K){if(K.p3){var f=K.p3(),l=er[K.getId()];l==w&&(l=er[K.getId()]=f[1]),K.p3([f[0],l-(c.y-I.$90l.y/j),f[2]])}})}else if(9===I.$67l){var so=S.sm().getSelection(),Yh=I.$94l;Yh||(Yh=I.$94l={}),so.each(function(O){if(O.s3){var P=O.s3(),s=Yh[O.getId()];s==w&&(s=Yh[O.getId()]=P[1]);var E=s-(c.y-I.$91l.y/j);0>E&&(E=.01),O.s3([P[0],E,P[2]])}})}},$79l:function(D,j){var T=this,M=T.gv,k=M.getZoom(),l=M.getEditHelperSize(),z=D.x/k,x=D.y/k,U=l/k,N=U/2;return L({x:z-N,y:x-N,width:U,height:U},j)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(q,F){for(var I=this,b=I.gv,A=b.getZoom(),T=b.getEditPointSize(),G=T/A,$=G/2,k=I.$46l(q),p=0;p<k.length;p++){var K,j,o=k[p],z=b.getDataUI(o);if(z&&z._55O){var a=z._55O;if(a._43O&&o instanceof U){if(K=o.s("edge.points"),K=Lk(z,K),j=o.s("edge.segments"),j&&j.size()||(j=qi(K)),I.$42l(o,F,K._as,j,"edge"))return!0;if("points"===o.s("edge.type")&&I.$41l(o,F,K._as,j,"edge"))return}if(a._43O&&o instanceof d&&a.$15l&&a.$15l.length===o.getPoints().size()){if(K=a.$15l,j=o.getSegments(),j&&j.size()||(j=qi(K)),I.$42l(o,F,K,j,"shape"))return!0;if(I.$41l(o,F,K,j,"shape"))return}}}if(I.$16l){var K,s=I.$16l,V=s[3].x-s[7].x,i=s[3].y-s[7].y,x=Y(V*V+i*i),R=s[1].x-s[5].x,Q=s[1].y-s[5].y,l=Y(R*R+Q*Q),h={x:F.x*A,y:F.y*A};if(I._80I(h,0,s[0],"northwest",x,l)||I._80I(h,1,s[1],"north",x,l)||I._80I(h,2,s[2],"northeast",x,l)||I._80I(h,7,s[7],"west",x,l)||I._80I(h,3,s[3],"east",x,l)||I._80I(h,6,s[6],"southwest",x,l)||I._80I(h,5,s[5],"south",x,l)||I._80I(h,4,s[4],"southeast",x,l))return!0}if(I.$23l){var t=I.$23l,O=t.x/A,C=t.y/A;if(L({x:O-$,y:C-$,width:G,height:G},F))return I.$40l=1,I.$12l=I.getHelperCursor("rotation")||"crosshair",!0}return I.$68l&&I.$79l(I.$68l,F)?(I.$67l=1,I.$12l=I.getHelperCursor("host")||"crosshair",!0):I.$69l&&I.$79l(I.$69l,F)?(I.$67l=2,I.$12l=I.getHelperCursor("parent")||"crosshair",!0):I.$70l&&I.$79l(I.$70l,F)?(I.$67l=3,I.$12l=I.getHelperCursor("edge")||"crosshair",!0):I.$71l&&I.$79l(I.$71l,F)?(I.$67l=4,I.$12l=I.getHelperCursor("remove")||"crosshair",!0):I.$82l&&I.$79l(I.$82l,F)?(I.$67l=5,I.$12l=I.getHelperCursor("source")||"crosshair",!0):I.$83l&&I.$79l(I.$83l,F)?(I.$67l=6,I.$12l=I.getHelperCursor("target")||"crosshair",!0):I._pointElevationHelperPoint&&I.$79l(I._pointElevationHelperPoint,F)?(I.$67l=7,I.$12l=I.getHelperCursor("pointElevation")||"crosshair",!0):I.$90l&&I.$79l(I.$90l,F)?(I.$67l=8,I.$12l=I.getHelperCursor("elevation")||"crosshair",!0):I.$91l&&I.$79l(I.$91l,F)?(I.$67l=9,I.$12l=I.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(n,N,Q,U,T,B){var v=this,k=v.gv,A=k.getEditPointSize(),C=A/2,$=k.sm(),r=k.isDirectionEditable;if(r&&1===$.size()){var V=$.ld();if(r=r.bind(k),V instanceof e){if(!r(V,U))return!1;if("east"===U){if(r(V,"northeast")&&r(V,"southeast")&&2*A>=B)return!1}else if("west"===U){if(r(V,"northwest")&&r(V,"southwest")&&2*A>=B)return!1}else if("north"===U){if(r(V,"northwest")&&r(V,"northeast")&&2*A>=T)return!1}else if("south"===U&&r(V,"southwest")&&r(V,"southeast")&&2*A>=T)return!1}}else{if(2*A>=T&&("north"===U||"south"===U))return!1;if(2*A>=B&&("east"===U||"west"===U))return!1}if(L({x:Q.x-C,y:Q.y-C,width:A,height:A},n)){if(v.$10l!==U){var m=180*v.$7l/t,J="";m>=337.5||22.5>m?J="north":m>=22.5&&67.5>m?J="northeast":m>=67.5&&112.5>m?J="east":m>=112.5&&157.5>m?J="southeast":m>=157.5&&202.5>m?J="south":m>=202.5&&247.5>m?J="southwest":m>=247.5&&292.5>m?J="west":m>=292.5&&337.5>m&&(J="northwest");var I=tl.indexOf(J),J=tl[N-(1-I)+8];switch(J){case"northwest":v.$12l="nwse-resize";break;case"northeast":v.$12l="nesw-resize";break;case"southwest":v.$12l="nesw-resize";break;case"southeast":v.$12l="nwse-resize";break;case"north":v.$12l="ns-resize";break;case"east":v.$12l="ew-resize";break;case"south":v.$12l="ns-resize";break;case"west":v.$12l="ew-resize"}v.$10l=U}return!0}return!1},$42l:function(F,Q,J,P,u){var x,o=this,I=o.gv,G=I.getEditPointSize(),l=G/I.getZoom(),m=-1,p={x:Q.x,y:Q.y,width:0,height:0},n=function(m){"shape"===u?o._shape=F:o._edge=F,o._removePointIndex=m},r=function(Z){"shape"===u?o._shape=F:o._edge=F,o.$13l=Z,o.$12l="crosshair"};for(h(p,l/2),m=J.length-1,x=P.size()-1;x>=0;x--){var Z=P.get(x);if(1===Z||2===Z)m-=1;else if(3===Z){var B=J[m-1];if(L(p,B))return r(m-1),!0;m-=2}else if(4===Z){var v=J[m-1],y=J[m-2];if(L(p,v))return r(m-1),!0;if(L(p,y))return r(m-2),!0;m-=3}}for(m=J.length-1,x=P.size()-1;x>=0;x--){var Z=P.get(x),w=J[m];if(L(p,w))return n(m),r(m),!0;1===Z||2===Z?m-=1:3===Z?m-=2:4===Z&&(m-=3)}return!1},$41l:function(c,_,f,Q,H){var i=this,T=i.gv,v=-1,A=0,N={x:_.x,y:_.y,width:0,height:0},O=function(r,$){i._hoverSegmentIndex=$,i._lp=_,"shape"===H?i._shape=c:i._edge=c};for(h(N,T.getSegmentHoverWidth()/2/T.getZoom()),c instanceof d&&c.isClosePath()&&Q.indexOf(5)<0&&(Q=new I(Q._as),Q.add(5));A<Q.size();A++){var C=Q.get(A);if(1===C){var V=f[v],l=f[v+1];if(V){var s=sc(new lr(V.x,V.y),new lr(l.x,l.y),new lr(N.x,N.y),new lr(N.x+N.width,N.y+N.height));if(s.$62l===B&&s.points.length>0)return O(s,A),!0}v+=1}else if(2===C){var V=f[v],l=f[v+1],s=sc(new lr(V.x,V.y),new lr(l.x,l.y),new lr(N.x,N.y),new lr(N.x+N.width,N.y+N.height));if(s.$62l===B&&s.points.length>0)return O(s,A),!0;v+=1}else if(3===C){var V=f[v],P=f[v+1],x=f[v+2],s=Jh(new lr(V.x,V.y),new lr(P.x,P.y),new lr(x.x,x.y),new lr(N.x,N.y),new lr(N.x+N.width,N.y+N.height));if(s.$62l===B)return O(s,A),!0;v+=2}else if(4===C){var V=f[v],K=f[v+1],S=f[v+2],x=f[v+3],s=ir(new lr(V.x,V.y),new lr(K.x,K.y),new lr(S.x,S.y),new lr(x.x,x.y),new lr(N.x,N.y),new lr(N.x+N.width,N.y+N.height));if(s.$62l===B)return O(s,A),!0;v+=3}else if(5===C){var V=f[v],l=f[0];if(V){var s=sc(new lr(V.x,V.y),new lr(l.x,l.y),new lr(N.x,N.y),new lr(N.x+N.width,N.y+N.height));if(s.$62l===B&&s.points.length>0)return O(s,A),!0}}}return!1},addShapePoint:function(a,B,P){var K=this,p=K.gv,k=p.dm();if(k.beginTransaction(),0===arguments.length&&(a=K._shape||K._edge,B=K._hoverSegmentIndex,P=K._lp),a instanceof d||a instanceof U){var q=lm(a,p.getDataUI(a),B);if(!isNaN(B)&&P&&!isNaN(q)){var E=P;if(a instanceof d){var V=a.p(),J=a.getRotation(),w=a.toSegments();w&&w.size()||(w=qi(a.getPoints())),a.isClosePath()&&w.indexOf(5)<0&&(w=new I(w._as),w.add(5));var Q=w.get(B),X="addPoint",A="removePointAt";if(2===Q||1===Q){var n={x:E.x,y:E.y};w.add(Q,B),n=ap(V,n.x-V.x,n.y-V.y,-J),a[X](n,q+1)}else if(3===Q){var i=a.getPoints(),Z=i.get(q),L=i.get(q+2),n={x:E.x,y:E.y};n=ap(V,n.x-V.x,n.y-V.y,-J);var G=Im(Z,n),M=Im(n,L);w.removeAt(B),w.add(3,B),w.add(3,B),a.setPoint(q+1,n),a[X](M,q+2),a[X](G,q+1)}else if(4===Q){var i=a.getPoints(),Z=i.get(q),L=i.get(q+3),n={x:E.x,y:E.y};n=ap(V,n.x-V.x,n.y-V.y,-J);var G=xg(Z,n),M=jp(Z,n),r=xg(n,L),m=jp(n,L);w.removeAt(B),w.add(4,B),w.add(4,B),a[A](q+1),a[A](q+1),a[X](n,q+1),a[X](m,q+2),a[X](r,q+2),a[X](M,q+1),a[X](G,q+1)}else if(5===Q){var n={x:E.x,y:E.y};w.add(2,B),n=ap(V,n.x-V.x,n.y-V.y,-J),a[X](n,q+1)}a.isClosePath()&&w.remove(5),a.setSegments(w);var v=a.getWidth(),T=a.getHeight(),e=a.p().x-v/2,x=a.p().y-T/2;e-=V.x,x-=V.y;var $=Vb(a,{x:e,y:x,width:v,height:T},J,V);a.p($.x,$.y)}else if(a instanceof U){if("points"!==a.s("edge.type"))return k.endTransaction(),void 0;var i=a.s("edge.points");w=a.s("edge.segments"),i=Lk(p.getDataUI(a),i),w&&w.size()||(w=qi(i)),w=new I(w._as.slice(0)),i=new I(i._as.slice(0));var Q=w.get(B);if(2===Q||1===Q){var n={x:E.x,y:E.y};w.add(Q,B),i.add(n,q+1)}else if(3===Q){var Z=i.get(q),L=i.get(q+2),n={x:E.x,y:E.y},G=Im(Z,n),M=Im(n,L);w.removeAt(B),w.add(3,B),w.add(3,B),i.set(q+1,n),i.add(M,q+2),i.add(G,q+1)}else if(4===Q){var Z=i.get(q),L=i.get(q+3),n={x:E.x,y:E.y},G=xg(Z,n),M=jp(Z,n),r=xg(n,L),m=jp(n,L);w.removeAt(B),w.add(4,B),w.add(4,B),i.removeAt(q+1),i.removeAt(q+1),i.add(n,q+1),i.add(m,q+2),i.add(r,q+2),i.add(M,q+1),i.add(G,q+1)}a.s("edge.points",_l(i)),a.s("edge.segments",w)}}}k.endTransaction()},removeShapePoint:function(f,w){var E=this,b="removeAt",$=E.gv,p=$.dm();if(p.beginTransaction(),0===arguments.length&&(f=E._shape||E._edge,w=E._removePointIndex),w>=0&&(f instanceof d||f instanceof U)){var M=Gc(f,E.gv.getDataUI(f),w),X=w;if(f instanceof d){var y=f.p(),v=f.toSegments();v&&v.size()||(v=qi(f.getPoints()));var L=v.get(M),c="removePointAt";if(1===L&&0===X)if(f.getPoints().size()>1){var u=v.get(M+1);v[b](M+1),3===u?f[c](X+1):4===u&&(f[c](X+2),f[c](X+1)),f[c](X)}else f.dm().remove(f);else 2===L||1===L?(v[b](M),f[c](X)):3===L?(v[b](M),f[c](X),f[c](X-1)):4===L&&(v[b](M),f[c](X),f[c](X-1),f[c](X-2));f.setSegments(v);var T=f.getWidth(),H=f.getHeight(),R=f.p().x-T/2,o=f.p().y-H/2;R-=y.x,o-=y.y;var Y=Vb(f,{x:R,y:o,width:T,height:H},f.getRotation(),y);f.p(Y.x,Y.y)}else if(f instanceof U){if("points"!==f.s("edge.type"))return p.endTransaction(),void 0;var l=f.s("edge.points");if(v=f.s("edge.segments"),l&&(l=Lk(E.gv.getDataUI(f),l),v&&v.size()||(v=qi(l))),0===w||w===l.size()-1)return p.endTransaction(),void 0;v=new I(v._as.slice(0)),l=new I(l._as.slice(0));var L=v.get(M);2===L||1===L?(v[b](M),l[b](X)):3===L?(v[b](M),l[b](X),l[b](X-1)):4===L&&(v[b](M),l[b](X),l[b](X-1),l[b](X-2)),f.s("edge.segments",v),f.s("edge.points",_l(l))}}p.endTransaction()},changeShapeSegment:function(T,S,Y){var h=this,C=h.gv,H=C.dm();if(H.beginTransaction(),1!==arguments.length||isNaN(T)||(Y=T,T=h._shape||h._edge,S=h._hoverSegmentIndex),T instanceof d||T instanceof U){var s=lm(T,h.gv.getDataUI(T),S);if(!isNaN(S)&&!isNaN(s))if(T instanceof d){var R=T.p(),v=T.toSegments();v&&v.size()||(v=qi(T.getPoints()));var t=v.get(S),z=T.toPoints();if(1===Y||2===Y)1===t||2===t?v.set(S,Y):3===t?(v.set(S,Y),z.removeAt(s+1)):4===t&&(v.set(S,Y),z.removeAt(s+1),z.removeAt(s+1));else if(3===Y){var p=function(){var e=z.get(s),g=z.get(s+1),C=Im(e,g);v.set(S,3),z.add(C,s+1)};2===t||1===t?p():4===t&&(z.removeAt(s+1),z.removeAt(s+1),p())}else if(4===Y){var n=function(){var r=z.get(s),w=z.get(s+1),O=xg(r,w),C=jp(r,w);v.set(S,4),z.add(O,s+1),z.add(C,s+2)};2===t||1===t?n():3===t&&(z.removeAt(s+1),n())}T.setSegments(v),T.setPoints(z);var y=T.getWidth(),_=T.getHeight(),f=T.p().x-y/2,b=T.p().y-_/2;f-=R.x,b-=R.y;var k=new Vb(T,{x:f,y:b,width:y,height:_},T.getRotation(),R);T.p(k.x,k.y)}else if(T instanceof U){if("points"!==T.s("edge.type"))return H.endTransaction(),void 0;var z=T.s("edge.points");v=T.s("edge.segments"),z&&(z=Lk(h.gv.getDataUI(T),z),v&&v.size()||(v=qi(z))),v=new I(v._as.slice(0)),z=new I(z._as.slice(0));var t=v.get(S);if(1===Y||2===Y)1===t||2===t?v.set(S,Y):3===t?(v.set(S,Y),z.removeAt(s+1)):4===t&&(v.set(S,Y),z.removeAt(s+1),z.removeAt(s+1));else if(3===Y){var p=function(){var $=z.get(s),u=z.get(s+1),x=Im($,u);v.set(S,3),z.add(x,s+1)};2===t||1===t?p():4===t&&(z.removeAt(s+1),z.removeAt(s+1),p())}else if(4===Y){var n=function(){var j=z.get(s),k=z.get(s+1),G=xg(j,k),T=jp(j,k);v.set(S,4),z.add(G,s+1),z.add(T,s+2)};2===t||1===t?n():3===t&&(z.removeAt(s+1),n())}T.s("edge.points",_l(z)),T.s("edge.segments",v)}}H.endTransaction()},getDefaultSegments:function(W){var h=this.gv,_=h.getDataUI(W);if(W instanceof U){var K=W.s("edge.points");return K=Lk(_,K),qi(K)}if(W instanceof d){var K=W.getPoints(),D=W.getSegments();return D&&D.size()>0?D:qi(K)}},$43l:function(e){var R=this;e&&(R.$5l=1),R._68I=1,R._42()},_42:function(){var L=this;if(L._68I){delete L._68I;var W=L.gv,H=L.$5l,A=W.getZoom(),u=W.getEditPointSize(),T=u/2,j=new I,l=L._view,O=L._edge,n=L._shape,b=l.getContext("2d"),g=W.tx(),E=W.ty(),V=w,p=W.getEditPointBackground(),t=W.getControlPointBackground(),D=W.getControlPointBorderColor(),B=W.getEditPointBorderColor(),q=W.getEditRectBorderColor(),a=W.getDirectionLineColor(),Z=W.getSegmentHoverColor(),x=W.getSnapPointBorderColor(),Q=W.getJoinPointBackground(),r=W.getJoinPointBorderColor(),K=W.getSegmentHoverWidth(),_=[5,5],k=W.getEditRectBorderStyle();Lc(W,function(B){W.isSelected(B)&&W.isVisible(B)&&j.add(B)}),b.clearRect(0,0,z(l.width),z(l.height)),b.save(),J.translateAndScale(b,g,E,1);var R=w,F={x:0,y:0,width:0,height:0},$=0,o=0,N=0,M=0,s=0,c=0,Or=0,Bm=0,ji=0,Uc=0,Tl=[];if(H?(delete L.$6l,delete L.$8l,delete L.$7l,delete L.$16l,delete L.$23l):(R=L.$6l,V=L.$7l),delete L.$68l,delete L.$69l,delete L.$71l,delete L.$70l,delete L.$82l,delete L.$83l,delete L._pointElevationHelperPoint,delete L.$90l,delete L.$91l,delete L.$75l,delete L.$74l,j.each(function(k){var z=W.getDataUI(k);if(z){var g=z._55O;if(W.isEditable(k))g._56O&&k instanceof e&&o++,Tl.push(k),g._42O&&k instanceof e&&$++,W.isHelperEditable(k,"host")&&M++,W.isHelperEditable(k,"parent")&&N++,W.isHelperEditable(k,"remove")&&s++,W.isHelperEditable(k,"edge")&&c++,W.isHelperEditable(k,"source")&&Or++,W.isHelperEditable(k,"target")&&Bm++,W.isHelperEditable(k,"elevation")&&ji++,W.isHelperEditable(k,"tall")&&Uc++;else if(k instanceof P&&k.isExpanded()){var I=!0,d=W.getEditableFunc();d&&(I=d(k)),I&&(W.isHelperEditable(k,"host")&&M++,W.isHelperEditable(k,"parent")&&N++,W.isHelperEditable(k,"remove")&&s++,W.isHelperEditable(k,"edge")&&c++,W.isHelperEditable(k,"source")&&Or++,W.isHelperEditable(k,"target")&&Bm++,W.isHelperEditable(k,"elevation")&&ji++,W.isHelperEditable(k,"tall")&&Uc++,Tl.push(k))}}}),b.beginPath(),b.lineWidth=1,b.strokeStyle=W.getNodeBorderColor(),Tl.forEach(function(s){var i=W.getDataUI(s),o=i._55O;if(H)if(V==w&&(V=s instanceof U?0:s instanceof P&&s.isExpanded()?0:s.getRotation(),L.$7l=V),R==w){var j,C,d;if(s instanceof P&&s.isExpanded()||s instanceof U){var t=W.getDataUIBounds(s);C=t.width,d=t.height,j={x:t.x+C/2,y:t.y+d/2}}else j=s.p(),C=s.getWidth(),d=s.getHeight();R={x:j.x,y:j.y,width:0,height:0},F.x=j.x-C/2,F.y=j.y-d/2,F.width=C,F.height=d,R=X(R,F)}else{var j,C,d,M,h=R.x+R.width/2,_=R.y+R.height/2,T={x:h,y:_};if(s instanceof P&&s.isExpanded()||s instanceof U){M=0;var t=W.getDataUIBounds(s);C=t.width,d=t.height,j={x:t.x+C/2,y:t.y+d/2}}else j=s.p(),C=s.getWidth(),d=s.getHeight(),M=s.getRotation();var k={x:j.x-C/2,y:j.y-d/2,width:C,height:d},J={x:k.x,y:k.y},n={x:k.x+k.width,y:k.y},D={x:k.x,y:k.y+k.height},z={x:k.x+k.width,y:k.y+k.height},J=ap(j,J.x-j.x,J.y-j.y,M),D=ap(j,D.x-j.x,D.y-j.y,M),z=ap(j,z.x-j.x,z.y-j.y,M),n=ap(j,n.x-j.x,n.y-j.y,M),r=-V,v=ap(T,J.x-T.x,J.y-T.y,r),a=ap(T,n.x-T.x,n.y-T.y,r),Y=ap(T,D.x-T.x,D.y-T.y,r),G=ap(T,z.x-T.x,z.y-T.y,r),Q=S([v,a,Y,G]);R=X(R,Q),R.x-=h,R.y-=_;var c=Vb(w,R,V,T);R.x=c.x-R.width/2,R.y=c.y-R.height/2}if($>1&&W.isEditable(s)&&W.isRectEditable(s)&&s instanceof e){var g=s.getRect(),E=o.$45l,u=Ye(E[0],A),m=Ye(E[2],A),y=Ye(E[4],A),q=Ye(E[6],A);s.getRotation()?(b.moveTo(u.x,u.y),b.lineTo(m.x,m.y),b.lineTo(y.x,y.y),b.lineTo(q.x,q.y),b.lineTo(u.x,u.y)):b.rect(g.x*A,g.y*A,g.width*A,g.height*A)}}),b.stroke(),R){L.$6l=m(R),h(R,W.getEditRectPadding()/A);var Xh={x:R.x+R.width/2,y:R.y+R.height/2},_n=yj(Xh,R.width,R.height,V),xe=_n[0],Tp=_n[1],Dn=_n[2],Ah=_n[3],bj=_n[4],Mi=_n[5],Nq=_n[6],ms=_n[7];if(xe=Ye(_n[0],A),Tp=Ye(_n[1],A),Dn=Ye(_n[2],A),Ah=Ye(_n[3],A),bj=Ye(_n[4],A),Mi=Ye(_n[5],A),Nq=Ye(_n[6],A),ms=Ye(_n[7],A),L.$8l=R,$>0&&(L.$16l=[xe,bj,Tp,Mi,Ah,Nq,Dn,ms],b.beginPath(),b.lineWidth=1,b.strokeStyle=q,"dashed"===k&&b.setLineDash&&b.setLineDash(_),b.moveTo(xe.x,xe.y),b.lineTo(Tp.x,Tp.y),b.lineTo(Ah.x,Ah.y),b.lineTo(Dn.x,Dn.y),b.lineTo(xe.x,xe.y),b.stroke(),"dashed"===k&&b.setLineDash&&b.setLineDash([])),b.beginPath(),b.lineWidth=1,b.fillStyle=p,b.strokeStyle=B,$>0){var ii=Mi.x-ms.x,yb=Mi.y-ms.y,Ur=Y(ii*ii+yb*yb),Uq=bj.x-Nq.x,hc=bj.y-Nq.y,wm=Y(Uq*Uq+hc*hc),jd=2*u;if(W.isDirectionEditable&&1===Tl.length){var Le=Tl[0],sq=W.getDataUI(Le),Eh=sq._55O,rf=W.isDirectionEditable.bind(W);if(Eh._42O){var zn,up,Mg,ub;rf(Le,"northwest")&&(zn=!0,b.rect(xe.x-T,xe.y-T,u,u)),rf(Le,"northeast")&&(up=!0,b.rect(Tp.x-T,Tp.y-T,u,u)),rf(Le,"southwest")&&(Mg=!0,b.rect(Dn.x-T,Dn.y-T,u,u)),rf(Le,"southeast")&&(ub=!0,b.rect(Ah.x-T,Ah.y-T,u,u)),rf(Le,"north")&&(zn&&up?Ur>jd&&b.rect(bj.x-T,bj.y-T,u,u):b.rect(bj.x-T,bj.y-T,u,u)),rf(Le,"south")&&(ub&&Mg?Ur>jd&&b.rect(Nq.x-T,Nq.y-T,u,u):b.rect(Nq.x-T,Nq.y-T,u,u)),rf(Le,"west")&&(Mg&&zn?wm>jd&&b.rect(ms.x-T,ms.y-T,u,u):b.rect(ms.x-T,ms.y-T,u,u)),rf(Le,"east")&&(ub&&up?wm>jd&&b.rect(Mi.x-T,Mi.y-T,u,u):b.rect(Mi.x-T,Mi.y-T,u,u))}}else Ur>jd&&(b.rect(bj.x-T,bj.y-T,u,u),b.rect(Nq.x-T,Nq.y-T,u,u)),wm>jd&&(b.rect(Mi.x-T,Mi.y-T,u,u),b.rect(ms.x-T,ms.y-T,u,u)),b.rect(xe.x-T,xe.y-T,u,u),b.rect(Tp.x-T,Tp.y-T,u,u),b.rect(Dn.x-T,Dn.y-T,u,u),b.rect(Ah.x-T,Ah.y-T,u,u)}if(o>0){var Sr=L.$23l=ap(bj,0,2*-u,V);b.moveTo(Sr.x+T,Sr.y),b.arc(Sr.x,Sr.y,T,0,y,!1)}b.fill(),b.stroke(),L.$40l&&L.$44l(b,R,V);var pd,Ci,_f=W.getLeftTopHelpers(),pb=W.getRightTopHelpers(),ug=W.getLeftBottomHelpers(),Pr=W.getRightBottomHelpers(),Jf=W.getEdgeHelpers(),Rn=W.getEditHelperSize(),Ek=Rn/2,Hh=function(x,u,n,i){"leftTop"===u?(pd=R.x*A-Rn-T-("h"===i?n*(Rn+T):0)-1,Ci=R.y*A-Rn-T-("v"===i?n*(Rn+T):0)-1):"rightTop"===u?(pd=(R.x+R.width)*A+T+("h"===i?n*(Rn+T):0)+1,Ci=R.y*A-Rn-T-("v"===i?n*(Rn+T):0)-1):"leftBottom"===u?(pd=R.x*A-Rn-T-("h"===i?n*(Rn+T):0)-1,Ci=(R.y+R.height)*A+T+("v"===i?n*(Rn+T):0)+1):"rightBottom"===u&&(pd=(R.x+R.width)*A+T+("h"===i?n*(Rn+T):0)+1,Ci=(R.y+R.height)*A+T+("v"===i?n*(Rn+T):0)+1);var q=pd+Ek,S=Ci+Ek,j=(R.x+R.width/2)*A,K=(R.y+R.height/2)*A,$=ap({x:j,y:K},q-j,S-K,V);if("host"===x){if(M>0)return L.$77l(b,V,$),!0}else if("edge"===x){if(c>0)return L.$80l(b,V,$),!0}else if("remove"===x){if(s>0)return Tl&&1===Tl.length&&Tl[0]instanceof U?L.$81l(b,V,{x:j+Rn/2+5,y:K}):L.$81l(b,V,$),!0}else if("parent"===x){if(N>0)return Tl&&1===Tl.length&&Tl[0]instanceof U?L.$76l(b,V,{x:j-Rn/2-5,y:K}):L.$76l(b,V,$),!0}else if("elevation"===x){if(ji>0)return L.$85l(b,V,$),!0}else if("tall"===x){if(Uc>0)return L.$86l(b,V,$),!0}else if("source"===x||"target"===x){var y=Tl[0],w=W.getDataUI(y),C=Ub(w,!0),o=C[0],G=C[1];if(Or&&"source"===x)return L.$84l(b,R,o,!0,y.isLooped(),u,n,i),!0;if(Bm&&"target"===x)return L.$84l(b,R,G,!1,y.isLooped(),u,n,i),!0}};if(_f&&_f.length>0){var zk=0;_f.forEach(function(q){Hh(q,"leftTop",zk,W.getLeftTopHelpersAlign()||"h")&&zk++})}if(pb&&pb.length>0){var zk=0;pb.forEach(function(m){Hh(m,"rightTop",zk,W.getRightTopHelpersAlign()||"h")&&zk++})}if(ug&&ug.length>0){var zk=0;ug.forEach(function(B){Hh(B,"leftBottom",zk,W.getLeftBottomHelpersAlign()||"h")&&zk++})}if(Pr&&Pr.length>0){var zk=0;Pr.forEach(function(F){Hh(F,"rightBottom",zk,W.getRightBottomHelpersAlign()||"h")&&zk++})}if(Jf&&Jf.length>0&&((Or||Bm)&&Tl&&1===Tl.length&&Tl[0]instanceof U?!0:!1)){var zk=0;Jf.forEach(function(d){Hh(d,"edge",zk,"h")&&zk++})}if(L.$72l){var vr,Ff=L.$67l,Od=L.$68l,qq=L.$69l,qk=(L.$71l,L.$70l),Ue=L.$82l,sm=L.$83l;if(1===Ff?vr=Od:2===Ff?vr=qq:3===Ff?vr=qk:5===Ff?vr=Ue:6===Ff&&(vr=sm),vr){var Kb=W.lp(L.$72l),zr=W.getDataAt(L.$72l);if(zr&&zr instanceof e){var Ad,mj,Ii;if(L.$73l=zr,1===Ff)if(zr instanceof G.Grid)Ad=L.$75l=lc(zr,Kb);else if(zr instanceof G.Shape){Ii=L.$74l=Gl(zr,Kb);var ad=zr.getPoints();if(Ii){var ab=Ii.attachIndex,vs=lm(zr,W.getDataUI(zr),ab)+1,Ji=vs+1>=ad.size()?0:vs+1,pn=ad.get(vs),hm=ad.get(Ji),bn=zr.p(),bi=zr.getRotation();pn=ap(bn,pn.x-bn.x,pn.y-bn.y,bi),hm=ap(bn,hm.x-bn.x,hm.y-bn.y,bi),b.beginPath(),b.strokeStyle=Z,b.lineWidth=K,b.moveTo(pn.x*A,pn.y*A),b.lineTo(hm.x*A,hm.y*A),b.stroke()}}Ad?mj=Ad.rect:(mj=v.clone(W.getDataUIBounds(zr)),v.grow(mj,2)),b.beginPath(),b.rect(mj.x*A,mj.y*A,mj.width*A,mj.height*A),b.strokeStyle=1===Ff||4===Ff||6===Ff?i:C,b.lineWidth=2,b.setLineDash&&b.setLineDash([8,8]),b.stroke()}else delete L.$73l;Kb.x=Kb.x*A,Kb.y=Kb.y*A;var Zp=Tq(vr.x,vr.y,Kb.x,Kb.y),_p=ap(vr,Kb.x-vr.x,Kb.y-vr.y,-Zp),Aq=_p.x-vr.x;b.save(),b.translate(vr.x,vr.y),b.rotate(Zp),f.width=Aq,f.height=40;var kr=C;(1===Ff||4===Ff||6===Ff)&&(kr=i),f.comps[0].gradientColor=kr,v.drawImage(b,f,0,-20,Aq,40),b.restore()}}}if(j.each(function(H){var f=W.getDataUI(H);if(f){var k,e,q=f._55O,C=f._78o;if(q&&q._43O&&H instanceof d?(k=q.$15l,e=H.getSegments(),e&&e.size()||(e=qi(k)),H.isClosePath()&&e.indexOf(5)<0&&(e=new I(e._as),e.add(5))):q&&C&&q._43O&&(k=H.s("edge.points"),e=H.s("edge.segments"),k=Lk(f,k),e&&e.size()||(e=qi(k)),k&&(k=k._as)),k&&e){var E=0,m=e.size(),G=L._hoverSegmentIndex;k=k.slice(0);for(var z=0;z<k.length;z++)k[z]=Ye(k[z],A);b.beginPath(),b.strokeStyle=a,b.lineWidth=1,E=0;for(var z=0;m>z;z++){var i=e.get(z);if(1===i||2===i)E++;else if(3===i){var v=k[E-1],R=k[E],P=k[E+1];b.moveTo(v.x,v.y),b.lineTo(R.x,R.y),b.lineTo(P.x,P.y),E+=2}else if(4===i){var v=k[E-1],u=k[E],S=k[E+1],P=k[E+2];b.moveTo(v.x,v.y),b.lineTo(u.x,u.y),b.moveTo(S.x,S.y),b.lineTo(P.x,P.y),E+=3}}if(b.stroke(),n===H||O===H&&"points"===O.s("edge.type")){b.beginPath(),E=0,b.strokeStyle=Z,b.lineWidth=K;for(var z=0;m>z;z++){var i=e.get(z);if(1===i||2===i){if(G===z){var v=k[E-1],P=k[E];b.moveTo(v.x,v.y),b.lineTo(P.x,P.y);break}E++}else if(3===i){if(G===z){var v=k[E-1],R=k[E],P=k[E+1];b.moveTo(v.x,v.y),b.quadraticCurveTo(R.x,R.y,P.x,P.y);break}E+=2}else if(4===i){if(G===z){var v=k[E-1],u=k[E],S=k[E+1],P=k[E+2];b.moveTo(v.x,v.y),b.bezierCurveTo(u.x,u.y,S.x,S.y,P.x,P.y);break}E+=3}else if(5===i&&G===z){var v=k[E-1],P=k[0];b.moveTo(v.x,v.y),b.lineTo(P.x,P.y);break}}b.stroke()}b.beginPath(),E=0,b.strokeStyle=r,b.lineWidth=1,b.fillStyle=Q;for(var z=0;m>z;z++){var i=e.get(z);if(1===i||2===i){var P=k[E];b.moveTo(P.x+T,P.y),b.arc(P.x,P.y,T,0,y,!0),E++}else if(3===i){var P=k[E+1];b.moveTo(P.x+T,P.y),b.arc(P.x,P.y,T,0,y,!0),E+=2}else if(4===i){var P=k[E+2];b.moveTo(P.x+T,P.y),b.arc(P.x,P.y,T,0,y,!0),E+=3}}b.fill(),b.stroke(),b.beginPath(),E=0,b.strokeStyle=D,b.lineWidth=1,b.fillStyle=t;for(var z=0;m>z;z++){var i=e.get(z);if(1===i||2===i)E++;else if(3===i){var R=k[E];b.moveTo(R.x+T,R.y),b.arc(R.x,R.y,T,0,y,!0),E+=2}else if(4===i){var u=k[E],S=k[E+1];b.moveTo(u.x+T,u.y),b.arc(u.x,u.y,T,0,y,!0),b.moveTo(S.x+T,S.y),b.arc(S.x,S.y,T,0,y,!0),E+=3}}if(b.fill(),b.stroke(),b.beginPath(),E=0,b.strokeStyle=x,b.lineWidth=2,(n===H||O===H)&&L.$9l!=w){var P=k[L.$9l];b.moveTo(P.x+T,P.y),b.arc(P.x,P.y,T,0,y,!0),b.stroke()}}}}),L.$87l&&W.sm().contains(L.$87l)){var Mn,Zi=L.$87l,Af=L.$88l,Rn=W.getEditHelperSize(),Ek=Rn/2;if(W.isHelperEditable(Zi,"pointElevation"))if(Zi instanceof d){var Tj=Zi.getPosition();Mn=v.clone(Zi.getPoints().get(Af)),Mn=ap({x:Tj.x,y:Tj.y},Mn.x-Tj.x,Mn.y-Tj.y,Zi.getRotation()),Mn.x*=A,Mn.y*=A,b.translate(Mn.x,Mn.y),v.drawImage(b,v.getImage("xeditinteractor_elevationIcon"),Ek,-Ek,Rn,Rn),b.translate(-Mn.x,-Mn.y),L._pointElevationHelperPoint={x:Mn.x+Rn,y:Mn.y}}else if(Zi instanceof U){var vf=Lk(W.getDataUI(Zi),Zi.s("edge.points")),Mn=v.clone(vf.get(Af));Mn.x*=A,Mn.y*=A,b.translate(Mn.x,Mn.y),v.drawImage(b,v.getImage("xeditinteractor_elevationIcon"),Ek,-Ek,Rn,Rn),b.translate(-Mn.x,-Mn.y),L._pointElevationHelperPoint={x:Mn.x+Rn,y:Mn.y}}}b.restore(),L.$5l=0}},$89l:function(M,X,R,g){M.save();var j=this,$=j.gv,l=$.getEditHelperSize(),_=l/2;M.beginPath(),M.translate(R.x,R.y),M.rotate(X),v.drawImage(M,g,-_,-_,l,l),M.restore()},$85l:function(g,q,I){var r=this;r.$90l=I,r.$89l(g,q,I,v.getImage("xeditinteractor_elevationIcon"))},$86l:function(k,l,O){var C=this;C.$91l=O,C.$89l(k,l,O,v.getImage("xeditinteractor_tallIcon"))},$77l:function($,z,i){var n=this;n.$68l=i,n.$89l($,z,i,v.getImage("xeditinteractor_hostIcon"))},$80l:function(g,j,A){var b=this;b.$70l=A,b.$89l(g,j,A,v.getImage("xeditinteractor_edgeIcon"))},$81l:function(S,c,Q){var a=this;a.$71l=Q,a.$89l(S,c,Q,v.getImage("xeditinteractor_removeIcon"))},$76l:function(W,k,c){var b=this;b.$69l=c,b.$89l(W,k,c,v.getImage("xeditinteractor_parentIcon"))},$84l:function(L,u,R,i,C){var d,p=this,D=p.gv,h=D.getZoom(),w=D.getEditHelperSize(),a=w/2;R.x*=h,R.y*=h,C&&(i?R.x-=a+5:R.x+=a+5),R.y-=w-2,i?(p.$82l=R,d=v.getImage("xeditinteractor_sourceIcon")):(p.$83l=R,d=v.getImage("xeditinteractor_targetIcon")),L.beginPath(),L.translate(R.x,R.y),v.drawImage(L,d,-a,-a,w,w),L.translate(-R.x,-R.y)},$44l:function(L,x,q){L.save();var d=this.gv.getZoom(),v=Y(u(x.width,2)+u(x.height,2))/2*d+10,b=v,n=b+8,C=b+18,k=q,$=x.x+x.width/2,G=x.y+x.height/2;L.translate($*d,G*d),L.beginPath(),L.strokeStyle="rgb(150, 150, 150)";for(var J=0,w=0,P=0,R=0,f=0,M=0;360>M;M++)J=M*t/180,0===M%5&&(w=r(J)*b,P=_(J)*b,R=r(J)*n,f=_(J)*n,L.moveTo(w,P),L.lineTo(R,f)),0===M%45&&(w=r(J)*b,P=_(J)*b,R=r(J)*C,f=_(J)*C,L.moveTo(w,P),L.lineTo(R,f));L.stroke(),L.beginPath(),L.rotate(-N),L.beginPath(),L.fillStyle="rgba(255, 0, 0, 0.1)",L.strokeStyle="rgb(157, 157, 157)",L.moveTo(0,0),L.arc(0,0,C,0,q,!1),L.fill(),L.beginPath(),L.moveTo(0+C,0),L.arc(0,0,C,0,q,!1),L.stroke(),L.rotate(N),L.font="bold 12px Verdana, Arial";var E=20*_(k),D=20*r(k),H=g(180*k/t)+"";L.textAlign="center",L.textBaseline="middle",L.beginPath();var T=L.measureText("365.").width;L.fillStyle="white",L.rect(E-T/2,-D-10,T,20),L.fill(),L.beginPath(),L.fillStyle="rgb(79,79,79)",L.fillText(H,E,-D),L.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);