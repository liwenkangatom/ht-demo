!function(C){"use strict";var k="ht",Y=C[k],e=function(){return document},f=function(){return e().body},V=function(g,u,Z){g.style.setProperty(u,Z,null)},d=function(x){return e().createElement(x)},$=function(){return d("div")},c=function(){var X=d("canvas");return X},t=function(O,l){V(O,"-webkit-transform",l),V(O,"-ms-transform",l),V(O,"transform",l)},h=function(s,H){V(s,"-webkit-transform-origin",H),V(s,"-ms-transform-origin",H),V(s,"transform-origin",H)},p=function(N,V){N.appendChild(V)},E=function(m,Z){m.removeChild(Z)},m=C.parseInt,M=Y.Default,X=M.eventListenerOptionsFalse,y=(M.eventListenerOptionsTrue,function(Y,c,L,S){Y.addEventListener(c,L,S?X:X)}),_=M.getInternal(),J=Math.PI,G="white-space",r="visibility",s="left",w="top",Q="width",H="height",a="position",i="display",o="z-index",O="px",j="0 0",W="absolute",n="visible",S="hidden",N="none",D="block",U="nowrap",A="rgba(0, 0, 0, 0.005)";M.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var P=Y.graph.GraphView.prototype,l=P._42;P.adjustHtmlNodeIndex=!0,P._42=function(D,Q){if(l.call(this,D,Q),this.adjustHtmlNodeIndex)for(var O=this.getDataModel()._datas._as,E=O.length,b=1,Y=0;E>Y;Y++){var q=O[Y];if(q instanceof g){var P=this.getDataUI(q);V(P.$2f,o,b+""),V(P.$3f,o,b+1+""),b+=2}}};var x=Y.HtmlNodeUI=function(n,e){var I=this;x.superClass.constructor.call(I,n,e);var s=I.$2f=$(),k=I.$3f=c();V(s,a,W),V(s,r,S),V(s,G,U),k.draggable=!1,V(k,a,W),V(k,i,N),h(k,j),y(s,"change",function(C){var x=C.target,m=x.bind||x.getAttribute("bind"),B=x.type&&"checkbox"===x.type?x.checked:x.value,w=e.getContext();m&&w&&(w[m]=B,I.$4f=JSON.stringify(w))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(e){y(s,e,this.$9f.bind(this))},I)};M.def(x,_.ui().NodeUI,{_visible:!0,$11f:function(){var k=this,K=k.$3f,C=k._data,Z=C.getDraggerImageWidth(),d=C.getDraggerImageHeight(),g=C.getDraggerImage(),S=_.initContext(K);S.beginPath(),_.setCanvas(K,Z,d),_.translateAndScale(S,0,0,1),S.clearRect(0,0,Z,d),M.drawImage(S,M.getImage(g),0,0,Z,d),S.restore()},_80o:function(l){x.superClass._80o.call(this,l);var c=this,M=c._data,f=M._padding,q=2*f,j=c.$2f,E=c.$3f,v=c.gv,K=v.getZoom(),R=v.getTranslateX(),C=v.getTranslateY(),Z=v.getView(),d=c._83o,g=M._width,z=M._height,Y=d.position,T=d.rotation,h=(g-q)/M.$5f*K,B=(z-q)/M.$6f*K,e=c._html,I=M._html,k=M.getHtmlType();if("html"===k){var P=M.getContext()||{},b=c.$4f,u=M.$10f,U=JSON.stringify(P);e&&b&&e===I&&b===U||(c.$4f=U,c._html=I,j.innerHTML=u?u(P):I)}else if(null!=k){var y=M.getHtml();"ht"===k&&(y=y.getView()),e&&e===y&&j.contains(e)||(c._html=y,j.innerHTML="",p(j,y))}if(!j.parentNode){var L=v.$1f;if(!L){var G=$();V(G,a,W),V(G,o,"0"),L=v.$1f=G;var F=v._canvas.nextSibling;F?Z.insertBefore(G,F):p(Z,G)}p(L,j),p(L,E),M.onContentInitialized&&M.onContentInitialized(j)}if(M._scalable){var X=M.$5f,_=M.$6f;t(j,"rotate("+180*(T/J)+"deg) scale("+h+","+B+")"),V(j,Q,""),V(j,H,""),V(j,s,(Y.x-X/K/2)*K+R+O),V(j,w,(Y.y-_/K/2)*K+C+O)}else{var am=m(j.style.width),ij=m(j.style.height),Op=m((g-q)*K),Id=m((z-q)*K),gi="100%",Iq=j.children[0];V(Iq,Q,gi),V(Iq,H,gi),(am!==Op||ij!==Id)&&(V(j,Q,Op+O),V(j,H,Id+O),"ht"===k&&I.invalidate()),t(j,"rotate("+180*(T/J)+"deg)"),V(j,s,(Y.x-Op/K/2)*K+R+O),V(j,w,(Y.y-Id/K/2)*K+C+O)}var Mr=c.dragRect;v.isMovable(M)&&v.isSelected(M)&&Mr?(l.save(),l.fillStyle=A,l.fillRect(Mr.x,Mr.y,Mr.width,Mr.height),l.restore(),V(E,s,Mr.x*K+R+O),V(E,w,Mr.y*K+C+O),t(E,"scale("+K+","+K+")"),V(E,i,D),c.$11f()):V(E,i,N),V(j,r,this._visible?n:S)},dispose:function(){var f=this.gv.$1f;this.$2f.parentNode===f&&f.removeChild(this.$2f),this.$3f.parentNode===f&&f.removeChild(this.$3f)},_84o:function(R){this._visible=R,V(this.$2f,r,R?n:S),V(this.$3f,i,R?D:N)},_3O:function(){var T=this,n=T.gv,H=T._data;x.superClass._3O.call(T);var Q=H.getRect();n.isEditable(H)&&(T.dragRect={x:Q.x+Q.width+H._padding,y:Q.y+10,width:H.getDraggerImageWidth(),height:H.getDraggerImageHeight()},T._68o(T.dragRect))},rectIntersects:function(M){var n=this._79o();return Y.Default.intersection(n,M)?!0:void 0},$9f:function(j){var g=this.gv,l=this._data;g.sm().contains(l)&&j.stopPropagation()}});var g=Y.HtmlNode=function(){g.superClass.constructor.call(this)};Y.Default.def(g,Y.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:Y.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(b){var d=this,G=d._html;d._html=b,"html"===d.getHtmlType()&&"Handlebars"in C&&(d.$10f=Handlebars.compile(b)),d.$13f(),d.fp("html",G,b)},setContext:function(T){var F=this,q=F._context;F._context=T,F.fp("context",q,T),F.$13f()},setScalable:function(I){var b=this,J=b._scalable;b._scalable=I,b.fp("scalable",J,I),b.$13f()},getHtmlType:function(){var w=this._html;return w?"string"==typeof w?"html":w.getView?"ht":"dom":null},$13f:function(){var y=this,m=y._html,x=y.$10f;if(m){var j=$(),J=!1,l=y.getHtmlType();if(V(j,a,W),V(j,G,U),V(j,r,S),"html"===l?(j.innerHTML=x?x(y.getContext()||{}):m,J=!0):"ht"===l?(p(j,m.getView()),J=!0):"dom"===l&&(p(j,m),J=!0),J){var c=2*y._padding;p(f(),j),y.$5f=j.scrollWidth,y.$6f=j.scrollHeight,y._width=y.$5f+c,y._height=y.$6f+c,y._originWidth=y._width,y._originHeight=y._height,E(f(),j)}}},getUIClass:function(){return Y.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);